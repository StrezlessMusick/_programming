<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8" /><link rel="stylesheet" href="../tpl/style.css@f4e332aa" type="text/css" /><link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css' /><style type="text/css">h1,h2,h3,h4{font-family:'Open Sans',sans-serif}</style><link rel="canonical" href="../2827.rfc" /><meta name="Robots" content="noindex, nofollow" /><title>Перевод RFC 2827 — Защита от DoS-атак с использованием подмена IP-адресов</title><link rel="alternate" type="application/rss+xml" title="RFC2.ru - Русские Переводы RFC" href="../rss.xml"></head><body><div id="content"><div id="nav"><div class="icon i0"></div> <a href="../index.html" accesskey="`">На Главную</a></div><div id="search" class="ya-site-form ya-site-form_inited_no"><form action="http://yandex.ru/sitesearch" method="get" target="_blank"><input type="hidden" name="searchid" value="2154295"/><input type="hidden" name="l10n" value="ru"/><input type="hidden" name="reqenc" value=""/><input type="hidden" name="submit" value="Найти"/><input type="search" value="" name="text" placeholder="Поиск по RFC2.ru" /></form></div><div itemscope itemtype="http://schema.org/ScholarlyArticle"><meta itemprop="inLanguage" content="ru" /><meta itemprop="editor" content="ru" /><div id="header"><h1><a itemprop="headline" href="../2827.rfc">RFC 2827 — Защита от DoS-атак с использованием подмена IP-адресов</a></h1></div><dl class="mute"><dt></dt><dd><div class="icon i1"></div> RFC: 2827</dd><dd><div class="icon i3"></div> Оригинал: <a href="original" target="_blank"><span itemprop="alternativeHeadline">Network Ingress Filtering: Defeating Denial of Service Attacks which employ IP Source Address Spoofing</span></a></dd><dd><div class="icon i7"></div> Предыдущие версии: RFC 2267</dd><dd><div class="icon i2"></div> Категория: <span itemprop="articleSection">Лучший современный опыт</span></dd><dd><div class="icon i4"></div> Дата публикации: <time itemprop="datePublished" datetime="2000-05-01">Май 2000</time></dd><dd><div class="icon i5"></div> Авторы: <span itemprop="author">P. Ferguson</span>, <span itemprop="author">D. Senie</span></dd><dd><div class="icon i6"></div> Перевод: <span itemprop="editor">Николай Малых</span></dd></dl><div id="text" itemprop="articleBody"><h3>Статус документа</h3><p>Этот документ содержит информацию для сообщества Internet. Документ может распространяться без ограничений</p><h3>Тезисы</h3><p>Недавно наблюдавшиеся DoS-атаки с использованием подмены адреса отправ ителя показали наличие серьезной опасности для провайдеров Internet (ISP) и сообщества Internet в целом. В этом документе рассматривается простой и эффектив ный метод борьбы с такими путем фильтрации входящего трафика с целью блокировки DoS, в которых используются адреса IP, не относящиеся к точкам агрегирования ISP.</p><h3>Оглавление</h3><ul class="map"><li><a href="print#p1">1. Введение</a></li><li><a href="print#p2">2. Основы</a></li><li><a href="print#p3">3. Ограничение фальсифицированного трафика</a></li><li><a href="print#p4">4. Дополнительные возможности сетевого оборудования</a></li><li><a href="print#p5">5. Недостатки</a></li><li><a href="print#p6">6. Заключение</a></li><li><a href="print#p7">7. Вопросы безопасности</a></li><li><a href="print#p8">8. Благодарности</a></li><li><a href="print#p9">9. Литература</a></li><li><a href="print#p10">10. Адреса авторов</a></li></ul><h3 id="p1">1. Введение</h3><p>Организация DoS-атак на различные сайты Internet [1] заставляет провайдеров и организации, связанные с безопасностью, искать новые методы смягчения таких атак. Достижение этой цели сопряжено с многочисленными трудностями, однако существует ряд простых средств, позволяющих ограничить эффективность и область распространения таких атак. Эти средства борьбы с атаками реализованы пока недостаточно широко.</p><p>Этот тип атак известен уже достаточно давно. Защита от таких атак однако еще находится на этапе становления. В статье [2] сказано, что Билл Чесвик (Bill Cheswick) - автор книги "Firewalls and Internet Security" [3] - заявил, что в последний момент он исключил из своей книги главу с описанием таких атак, поскольку у администратора атакуемой системы нет эффективных способов защиты, а описывая метод [атаки], следует учитывать возможность его практического применения.</p><p>Хотя предложенный здесь метод ничуть не поможет при лавинных атаках с использованием корректных IP-адресов, возможности использования атакующими подставных адресов будут ограничены правилами фильтрации сетей, из которых организуются атаки. Всем провайдерам настоятельно рекомендуется реализовать описанные в данном документе фильтры для того, чтобы лишить атакующих возможности использовать подставные адреса за пределами легитим но анонсируемых префиксов. Иными словами, если ISP агрегирует маршрутные анонсы для множества обслуживаемых им сетей, этот провайдер должен использовать строгую фильтрацию для предотвращения трафика, переданного с указанием адресов отправителя за пределами агрегируемого блока адресов.</p><p>Дополнительным преимуществом предложенного метода является простота отслеживания источников атак, поскольку атакующие будут вынуждены использовать в поле отправ ителя легитимные адреса.</p><h3 id="p2">2. Основы</h3><p>Ниже показана упрощенная схема атаки путем создания лавины пакетов TCP SYN:</p><pre>                                                204.69.207.0/24
host &lt;----- router &lt;--- Internet &lt;----- router &lt;-- attacker

         TCP/SYN
     &lt;---------------------------------------------
           Source: 192.168.0.4/32
SYN/ACK
no route
         TCP/SYN
     &lt;---------------------------------------------
           Source: 10.0.0.13/32
SYN/ACK
no route
         TCP/SYN
     &lt;---------------------------------------------
           Source: 172.16.0.2/32
SYN/ACK
no route

[etc.]</pre><p>Сделаем следующие предположения:</p><ul class="dot"><li>Хост является атакуемым узлом.</li><li>Атакуемый находится в сети с корректным префиксом 204.69.207.0/24.</li><li>Атакующий использует случайные значения адреса отправителя; в данном примере атакующий случайно выбирает адреса из приватных блоков [4], которые в общем случае не присутствуют в глобальных таблицах маршрутизации Internet и, следовательно, не являются доступными. Однако в реальных атаках могут применяться любые недоступные адреса.</li></ul><p>Следует принимать во внимание и случаи использования обманных адресов отправителя, которые относятся к легитимным сетям, присутствующим в глобальных таблицах маршрутизации. Например, атакующий, используя корректный сетевой адрес может создавать видимость, что атака организована из сети организации, которая, по сути, не имеет к этой атаке никакого отношения. В таких случаях администратор атакуемой системы может активизировать фильтрацию трафика из сети, которую атакующий использовал для выбора подставных адресов. Такие фильтры будут приводить к блокированию трафика от легитимных узлов. И в этом случае администратор атакуемой системы становится невольным помощником атакующего.</p><p>Дополнительную сложность во время лавинных атак TCP SYN вызывает поток откликов SYN-ACK, которые передаются одному или множеству хостов, не имеющих отношения к атаке, но становящихся ее дополнительными жертвами. Это позволяет атакующему наносить вред одновременно множеству систем.</p><p>Предпринимались попытки организации подобных атак с использованием лавины потоков UDP и ICMP. Вариант с лавиной UDP использует обманные пакеты для попыток "подключения" к сетевым службам chargen, что должно приводить к передаче потока символов в адрес хоста, чей адрес был использован в запросах. Системные администраторы должны блокировать пакеты UDP, адресованные в диагностические порты системы и приходящие извне административного домена. Другой вариант атаки (ICMP flooding) использует хитрость в механизме репликации широков ещательных пакетов IP, адресованных в подсеть. Эти атаки базируются на том, что маршрутизаторы, обслуживающие крупные широковещательные сети, преобразуют широковещательные адреса IP (например, 10.255.255.255 для пакетов, адресованных всем хостам сети 10.0.0.0/8) в широковещательные кадры уровня 2 (например для Ethernet, FF:FF:FF:FF:FF:FF). Сетевые адаптеры Ethernet (MAC-уровень) при нормальной работе прослушивают ограниченное число адресов. Одним из адресов, прослушиваемых каждым устройством Ethernet в нормальном режиме, является широковещательный адрес FF:FF:FF:FF:FF:FF. При обнаружении такого пакета в среде передачи устройство будет принимать его и инициировать прерывание для обработки полученного кадра. Таким образом, лавина подобных широковещательных кадров может поглотить все доступные ресурсы конечной системы [9]. Представляется разумным рассмотрение системными администраторами вопроса о приеме и пересылке адресованных всей сети широковещательных пакетов на граничных маршрутизаторах и отключение принятой по умолчанию обработки таких пакетов.</p><p>При организации атаки TCP SYN с использованием недостижимых адресов в поле отправителя, атакуемый хост пытается сохранять выделенные ресурсы в ожидании отклика. Атакующие безостановочно меняет обманные адреса для каждого генерируем ого пакета, что достаточно быстро приводит к исчерпанию ресурсов атакуемого хоста.</p><p>Если же атакующий указывает в пакетах легитимные адреса отправителя, атакуемая система будет слать большое число пакетов SYN/ACK предполагаемым инициаторам соединений. В этом случае атакующий нарушает работу двух систем — непосредственного объекта атаки и хоста, адрес которого используется в качестве подставного.</p><p>В результате оба варианта атаки существенно снижают производительность атакуемой системы и в некоторых случаях могут привести к полной потере работоспособности объекта атаки.</p><p>В результате этих типов атак производители большинства операционных систем обновили свои программы чтобы обеспечить устойчивость серверов к атакам с высокой частотой попыток организации соединения. Эти обновления весьма полезны и являются одной из необходимых компонент решения проблемы в целом. Распространение систем фильтрации на входе (Ingress filtering) займет некоторое время, а обновить операционные системы можно значительно быстрее. Комбинация этих способов позволит обеспечить эффективную защиту от атак с подменой адресов. Сведения о программных обновлениях для ОС различных производителей можно найти в документе [1].</p><h3 id="p3">3. Ограничение фальсифицированного трафика</h3><p>Проблемы, связанные с этим типом атак, достаточно многочисленны и включают недостатки реализации используемых хостами программ, методы маршрутизации и стек TCP/IP в целом. Однако, ограничение транзитного трафика из обслуживаемых сетей известными и осознанно анонсируемыми префиксами адресов позволит существенно снизить возможность организации атак с подменой адресов.</p><pre>                      11.0.0.0/8
                          /
                      router 1
                        /
                       /
                      /                       204.69.207.0/24
ISP &lt;----- ISP &lt;---- ISP &lt;--- ISP &lt;-- router &lt;-- attacker
 A          B         C        D         2
           /
          /
         /
     router 3
       /
   12.0.0.0/8</pre><p>В приведенном примере атакующий находится в сети 204.69.207.0/24, подключение которой к Internet обеспечивает провайдер ISP D. Фильтрация входящего трафика на интерфейсе маршрутизатора 2, обеспечивающего связь с сетью атакующего, которая позволит принимать лишь те пакеты, где адрес отправителя относится к блоку 9.0.0.0/8, заблокирует возможность атаки с использованием подставных адресов из другого блока.</p><p>Фильтр входящих пакетов на маршрутизаторе 2 работает по следующему алгоритму:</p><p>IF адрес отправителя в пакете относится к сети 204.69.207.0/24<br />THEN пакет пересылается в направлении получателя<br />IF если адрес отправителя в пакете относится к любому другому блоку<br />THEN пакет отбрасывается (drop).</p><p>Администраторы должны вести журнал отбрасываемых пакетов, который обеспечит постоянный мониторинг любых подозрительных действий.</p><h3 id="p4">4. Дополнительные возможности сетевого оборудования</h3><p>Следует рассмотреть дополнительные функции, которые могут использоваться в новых реализациях. Ниже кратко описана одна из таких возможностей:</p><blockquote><p>Реализация автоматических фильтров на серверах доступа. В большинств е случаев доступ по коммутируемым линиям обеспечивается для индивидуальных пользователей, которые работают с одним ПК. Единственным корректным адресом отправителя в таких случаях является адрес, выделенный провайдером для этой сессии. Сервер удаленного доступа может проверять каждый пакет на входе для предотвращения возможности применения пользователем подставных адресов. Обычно в таких устройствах должна быть предусмотрена и возможность удаленного подключения не отдельного компьютера, а сети, использующей свой маршрутизатор. Такая возможность может быть реализована как опция. Некоторые провайдеры и производители оборудования уже сообщают о реализации фильтров на серверах доступа.</p></blockquote><p>Рассматривался также вариант проверки IP-адреса отправителя, предложенный в [8], но этот метод недостаточно хорошо работает в реальных сетях. Этот метод заключается в просмотре адресов отправителя на предмет соответствия принявшего пакет интерфейса пути, через который обеспечивается доставка отправителю данного пакета. При наличии в Internet асимметричных маршрутов использование такой проверки представляется проблематичным.</p><h3 id="p5">5. Недостатки</h3><p>Фильтрация по своей природе может нарушать работу некоторых "специальных" служб. Для поставщиков подобных типов сервиса целесообразно рассмотреть другие варианты организации работы этих служб, чтобы избежать влияния входных фильтров.</p><p>Одной из служб, на которые оказывает влияние фильтрация на входе, является Mobile IP [6]. Трафик в направлении мобильных узлов передается с использованием туннелей, но трафик от мобильных узлов туннелирования не использует. В результате пакеты от мобильного узла могут содержать адрес отправителя, не соответствующий принявшей пакет сети. Рабочая группа Mobile IP для решения этой проблемы предложила "обратные туннели" [7]. Предложенный метод основан на том, что мобильная станция сначала туннелирует данные домашнему агенту (home agent) и только после этого информация передается в Internet. Дополнительным преимуществом такой схемы является повышение эффективности обработки группового трафика, что является добавочным стимулом реализации обратных туннелей в мобильных системах IP.</p><p>Как было отмечено выше, фильтрация на входе существенно осложняет проведение атак с подменой адресов, но такая фильтрация не может помещать атакующему использовать подставные адреса хостов из корректно для сети атакующего блока адресов. Однако в таких случаях наличие входных фильтров дает администратору достоверные сведения о местонахождении источника атаки и значительно упрощает поиск атакующего. По крайней мере, администратор всегда может блокировать диапазон адресов, в который входит используемый атакующим подставной адрес или адреса, пока конкретный источник атаки не будет обнаружен.</p><p>Если входные фильтры применяются в средах, где используется протокол DHCP или BOOTP, администратор должен обеспечить корректную доставку пакетов с адресом отправителя 0.0.0.0 и пакетов с адресом получателя 255.255.255.255. Область распространения пакетов directed broadcast должна быть контролируемой, а их произвольная пересылка недопустима.</p><h3 id="p6">6. Заключение</h3><p>Входная фильтрация трафика на периферии подключенных к Internet сетей будет снижать эффективность DoS-атак с подменой адреса отправителя. Провайдеры и администраторы корпоративных сетей уже начали использование этого типа фильтрации на периферийных маршрутизаторах. Всем сервис-провайдерам рекомендуется реализовать такие фильтры как можно скорее. В дополнение к избавлению сообщества Internet от атак этого типа предложенный метод также помогает провайдерам локализовать источник атаки в своей сети, если входные фильтры реализованы на маршрутизаторах, используемых для подключения заказчиков.</p><p>Администраторам корпоративных сетей также следует реализовать такие фильтры, чтобы предотвратить возможность организации атак из своей сети. Фильтрация также позволит избавиться от проблем, связанных с некорректным подключением систем к сети.</p><p>На всех сетевых администраторов ложится ответственность за предотв ращение атак с подменой адресов отправителей из контролируемых ими сетей.</p><h3 id="p7">7. Вопросы безопасности</h3><p>Основной задачей данного документа является повышение уровня осведомленности и безопасности сообщества Internet в целом. Чем больше провайдеров Internet и корпоративных пользователей реализует в своих маршрутизаторах входные фильтры, тем сложнее будет организовать атаки с подменой адресов отправителей в пакетах. Фильтрация также упрощает поиск источников атак. Снижение числа атак в сети Internet позволит более эффективно использовать ресурсы для отслеживания атак, которые все-таки будут происходить время от времени.</p><h3 id="p8">8. Благодарности</h3><p>Авторы благодарят группу NANOG [5] за активное обсуждение вопроса и участие в поисках возможных решений. Благодарим также Justin Newton [Priori Networks] и Steve Bielagus [IronBridge Networks] за их комментарии и вклад в работу.</p><h3 id="p9">9. Литература</h3><table itemprop="references"><tr><td>[1]</td><td>CERT Advisory CA-96.21; TCP SYN Flooding and IP Spoofing Attacks; September 24, 1996.</td></tr><tr><td>[2]</td><td>B. Ziegler, «Hacker Tangles Panix Web Site», Wall Street Journal, 12 September 1996.</td></tr><tr><td>[3]</td><td>«Firewalls and Internet Security: Repelling the Wily Hacker»; William R. Cheswick and Steven M. Bellovin, Addison-Wesley Publishing Company, 1994; ISBN 0-201-63357-4.</td></tr><tr><td>[4]</td><td>Rekhter, Y., Moskowitz, R., Karrenberg, D., de Groot, G., and E. Lear, <a href="../1918.rfc" title="RFC 1918 - Распределение адресов в частных IP-сетях">«Распределение адресов в частных IP-сетях», RFC 1918</a>, Февраль 1996.</td></tr><tr><td>[5]</td><td>The North American Network Operators Group; http://www.nanog.org.</td></tr><tr><td>[6]</td><td>Perkins, C., «IP Mobility Support», RFC 2002, October 1996.</td></tr><tr><td>[7]</td><td>Montenegro, G., «Reverse Tunneling for Mobile IP», RFC 2344, Май 1998.</td></tr><tr><td>[8]</td><td>Baker, F., «Requirements for IP Version 4 Routers», RFC 1812, Июнь 1995.</td></tr><tr><td>[9]</td><td>Thanks to: Craig Huegen; See: http://www.quadrunner.com/~chuegen/smurf.txt.</td></tr></table><h3 id="p10">10. Адреса авторов</h3><p>Paul Ferguson<br />Cisco Systems, Inc.<br />13625 Dulles Technology Dr.<br />Herndon, Virginia 20170 USA<br />EMail: <bdo dir="rtl">&#109;&#111;&#99;&#46;&#111;&#99;&#115;&#105;&#99;&#64;&#110;&#111;&#115;&#117;&#103;&#114;&#101;&#102;</bdo></p><p>Daniel Senie<br />Amaranth Networks Inc.<br />324 Still River Road<br />Bolton, MA 01740 USA<br />EMail: <bdo dir="rtl">&#109;&#111;&#99;&#46;&#101;&#105;&#110;&#101;&#115;&#64;&#115;&#116;&#100;</bdo></p></div></div><div id="disqus_thread"></div><script type="text/javascript">var disqus_shortname="rfc2",disqus_title="RFC 2827 - Защита от DoS-атак с использованием подмена IP-адресов",disqus_identifier="2827.rfc",disqus_url="http://rfc2.ru/2827.rfc";(function(){var dsq=document.createElement("script");dsq.type="text/javascript";dsq.async=true;dsq.src = "//"+disqus_shortname+".disqus.com/embed.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(dsq);})();</script><div class="bubble">2007 - 2014 © <a href="../index.html" title="Русские переводы RFC">Русские переводы RFC</a>, IETF, ISOC.</div></div><div id="bottom" style="position:static !important;bottom:auto !important"><div class="bubble"><ul><li><!--723572853672--></li></ul></div></div><!-- Yandex.Metrika counter --><script type="text/javascript">(function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter4680559 = new Ya.Metrika({id:4680559, webvisor:true, clickmap:true, accurateTrackBounce:true, trackHash:true, ut:"noindex"}); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="http://mc.yandex.ru/watch/4680559?ut=noindex" style="position:absolute; left:-9999px;" alt="" /></div></noscript><!-- /Yandex.Metrika counter --></body></html>