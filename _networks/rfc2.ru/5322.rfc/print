<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8" /><link rel="stylesheet" href="../tpl/style.css@f4e332aa" type="text/css" /><link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css' /><style type="text/css">h1,h2,h3,h4{font-family:'Open Sans',sans-serif}</style><link rel="canonical" href="../5322.rfc" /><meta name="Robots" content="noindex, nofollow" /><title>Перевод RFC 5322 — Формат сообщений Internet (IMF)</title><link rel="alternate" type="application/rss+xml" title="RFC2.ru - Русские Переводы RFC" href="../rss.xml"></head><body><div id="content"><div id="nav"><div class="icon i0"></div> <a href="../index.html" accesskey="`">На Главную</a></div><div id="search" class="ya-site-form ya-site-form_inited_no"><form action="http://yandex.ru/sitesearch" method="get" target="_blank"><input type="hidden" name="searchid" value="2154295"/><input type="hidden" name="l10n" value="ru"/><input type="hidden" name="reqenc" value=""/><input type="hidden" name="submit" value="Найти"/><input type="search" value="" name="text" placeholder="Поиск по RFC2.ru" /></form></div><div itemscope itemtype="http://schema.org/ScholarlyArticle"><meta itemprop="inLanguage" content="ru" /><meta itemprop="editor" content="ru" /><div id="header"><h1><a itemprop="headline" href="../5322.rfc">RFC 5322 — Формат сообщений Internet (IMF)</a></h1></div><dl class="mute"><dt></dt><dd><div class="icon i1"></div> RFC: 5322</dd><dd><div class="icon i3"></div> Оригинал: <a href="original" target="_blank"><span itemprop="alternativeHeadline">Internet Message Format</span></a></dd><dd><div class="icon i7"></div> Предыдущие версии: RFC 724, RFC 733, RFC 822, RFC 2822</dd><dd><div class="icon i2"></div> Категория: <span itemprop="articleSection">Проект стандарта</span></dd><dd><div class="icon i4"></div> Дата публикации: <time itemprop="datePublished" datetime="2008-10-01">Октябрь 2008</time></dd><dd><div class="icon i5"></div> Автор: <span itemprop="author">Peter W. Resnick</span></dd><dd><div class="icon i6"></div> Перевод: <span itemprop="editor">Николай Малых</span></dd></dl><div id="text" itemprop="articleBody"><h3>Статус документа</h3><p>Это документ содержит проект стандарта протокола Internet для сообщества Internet и служит приглашением к дискуссии в целях развития и совершенствования протокола. Текущее состояние стандартизации и статус протокола можно узнать из текущей версии документа "Internet Official Protocol Standards" (STD 1). Допускается свободное распространение документа.</p><h3>Тезисы</h3><p>Этот документ задает формат сообщений Internet (IMF) — синтаксис текстовых сообщений, передаваемых между пользователями компьютеров через систему электронной почты. Данная спецификация является пересмотром RFC 2822, который, в свою очередь, пересматривает RFC 822, "Стандарт для формата текстовых сообщений ARPA Internet", с учетом опыта использования и накопленных изменений, отраженных в других RFC.</p><h2>Оглавление</h2><ul class="map"><li><a href="print#p1">1. Введение</a></li><li class="lia"><a href="print#p1.1">1.1. Рамки документа</a></li><li class="lia"><a href="print#p1.2">1.2. Система обозначений</a></li><li class="lib"><a href="print#p1.2.1">1.2.1. Обзначение уровня требований</a></li><li class="lib"><a href="print#p1.2.2">1.2.2. Синтаксические обозначения</a></li><li class="lib"><a href="print#p1.2.3">1.2.3. Структура документа</a></li><li><a href="print#p2">2. Лексический анализ сообщений</a></li><li class="lia"><a href="print#p2.1">2.1. Общее описание</a></li><li class="lib"><a href="print#p2.1.1">2.1.1. Предельные размеры строк</a></li><li class="lia"><a href="print#p2.2">2.2. Поля заголовков</a></li><li class="lib"><a href="print#p2.2.1">2.2.1. Бесструктурные поля заголовков</a></li><li class="lib"><a href="print#p2.2.2">2.2.2. Структурированные поля заголовков</a></li><li class="lib"><a href="print#p2.2.3">2.2.3. Длинные поля заголовков</a></li><li class="lia"><a href="print#p2.3">2.3. Тело письма</a></li><li><a href="print#p3">3. Синтаксис</a></li><li class="lia"><a href="print#p3.1">3.1. Введение</a></li><li class="lia"><a href="print#p3.2">3.2. Лексемы</a></li><li class="lib"><a href="print#p3.2.1">3.2.1. Квотрирование символов</a></li><li class="lib"><a href="print#p3.2.2">3.2.2. Пробелы для фальцовки и комментарии</a></li><li class="lib"><a href="print#p3.2.3">3.2.3. Атом</a></li><li class="lib"><a href="print#p3.2.4">3.2.4. Строки в кавычках</a></li><li class="lib"><a href="print#p3.2.5">3.2.5. Прочие лексемы</a></li><li class="lia"><a href="print#p3.3">3.3. Задание даты и времен</a></li><li class="lia"><a href="print#p3.4">3.4. Задание адреса</a></li><li class="lib"><a href="print#p3.4.1">3.4.1. Задание addr-spec</a></li><li class="lia"><a href="print#p3.5">3.5. Общий синтаксис сообщений</a></li><li class="lia"><a href="print#p3.6">3.6. Определения полей</a></li><li class="lib"><a href="print#p3.6.1">3.6.1. Поле даты создания</a></li><li class="lib"><a href="print#p3.6.2">3.6.2. Поля источника</a></li><li class="lib"><a href="print#p3.6.3">3.6.3. Поля адресов получателей</a></li><li class="lib"><a href="print#p3.6.4">3.6.4. Поля идентификации</a></li><li class="lib"><a href="print#p3.6.5">3.6.5. Информационные поля</a></li><li class="lib"><a href="print#p3.6.6">3.6.6. Поля пересылки</a></li><li class="lib"><a href="print#p3.6.7">3.6.7. Поля трассировки</a></li><li class="lib"><a href="print#p3.6.8">3.6.8. Дополнительные поля</a></li><li><a href="print#p4">4. Устаревший синтаксис</a></li><li class="lia"><a href="print#p4.1">4.1. Прочие устаревшие маркеры</a></li><li class="lia"><a href="print#p4.2">4.2. Устаревшие пробелы для фальцовки</a></li><li class="lia"><a href="print#p4.3">4.3. Устаревшие форматы даты и времени</a></li><li class="lia"><a href="print#p4.4">4.4. Устаревшая адресация</a></li><li class="lia"><a href="print#p4.5">4.5. Устаревшие поля заголовков</a></li><li class="lib"><a href="print#p4.5.1">4.5.1. Устаревшее поле даты создания</a></li><li class="lib"><a href="print#p4.5.2">4.5.2. Устаревшие поля отправителя</a></li><li class="lib"><a href="print#p4.5.3">4.5.3. Устаревшие поля адресов получателей</a></li><li class="lib"><a href="print#p4.5.4">4.5.4. Устаревшие поля идентификации</a></li><li class="lib"><a href="print#p4.5.5">4.5.5. Устаревшие информационные поля</a></li><li class="lib"><a href="print#p4.5.6">4.5.6. Устаревшие поля пересылки</a></li><li class="lib"><a href="print#p4.5.7">4.5.7. Устаревшие поля трассировки</a></li><li class="lib"><a href="print#p4.5.8">4.5.8. Устаревшие дополнительные поля</a></li><li><a href="print#p5">5. Вопросы безопасности</a></li><li><a href="print#p6">6. Согласование с IANA</a></li><li><a href="print#p.appendix.a">Приложение A. Примеры сообщений</a></li><li class="lia"><a href="print#p.appendix.a1">Приложение A.1. Примеры адресации</a></li><li class="lib"><a href="print#p.appendix.a1.1">Приложение A.1.1. Сообщение от одного лица другому с простой адресацией</a></li><li class="lib"><a href="print#p.appendix.a1.2">Приложение A.1.2. Различные типы почтовых ящиков</a></li><li class="lib"><a href="print#p.appendix.a1.3">Приложение A.1.3. Групповые адреса</a></li><li class="lia"><a href="print#p.appendix.a2">Приложение A.2. Ответные сообщения</a></li><li class="lia"><a href="print#p.appendix.a3">Приложение A.3. Пересылка сообщений</a></li><li class="lia"><a href="print#p.appendix.a4">Приложение A.4. Сообщения с полями трассировки</a></li><li class="lia"><a href="print#p.appendix.a5">Приложение A.5. Пробелы, комментарии и другие странности</a></li><li class="lia"><a href="print#p.appendix.a6">Приложение A.6. Устаревшие формы</a></li><li class="lib"><a href="print#p.appendix.a6.1">Приложение A.6.1. Устаревшая адресация</a></li><li class="lib"><a href="print#p.appendix.a6.2">Приложение A.6.2. Устаревшие даты</a></li><li class="lib"><a href="print#p.appendix.a6.3">Приложение A.6.3. Устаревшие пробелы и комментарии</a></li><li><a href="print#p.appendix.b">Приложение B. Отличия от ранних спецификаций</a></li><li><a href="print#p.appendix.c">Приложение C. Благодарности</a></li><li><a href="print#p7">7. Литература</a></li><li class="lia"><a href="print#p7.1">7.1. Нормативные документы</a></li><li class="lia"><a href="print#p7.2">7.2. Дополнительные ссылки</a></li></ul><h2 id="p1">1. Введение</h2><h3 id="p1.1">1.1. Рамки документа</h3><p>Этот документ задает формат сообщений Internet (IMF) — синтаксис текстовых сообщений, передаваемых между пользователями компьютеров через систему электронной почты. Данная спецификация является пересмотром RFC 2822 [RFC2822], который, в свою очередь, пересматривает RFC 822, "Стандарт для формата текстовых сообщений ARPA Internet" [RFC0822], с учетом опыта использования и накопленных изменений, отраженных в других RFC (таких, как [RFC1123]).</p><p>В этом документе задан синтаксис только для текстовых сообщений. В частности, не рассматриваются вопросы передачи изображений, звука и иной структурированной информации в сообщениях электронной почты. Опубликовано несколько расширений (таких, как серия документов MIME — [RFC2045], [RFC2046], [RFC2049]), описывающих механизмы передачи таких данных в сообщениях электронной почты за счет расширения описанного здесь синтаксиса или за счет структурирования сообщений в соответствии с описанным синтаксисом. Такие механизмы выходят за пределы настоящей спецификации.</p><p>В контексте электронной почты сообщения представляются состоящими из конверта и тела (содержимого) письма. Конверт содержит информацию, требуемую для <a href="../5321.rfc" title="RFC 5321 - Простой протокол передачи электронной почты (SMTP)">передачи и доставки сообщения</a> (см. [RFC5321]). Тело письма является объектом, который доставляется адресату. Данная спецификация применима только к формату и части семантики содержимого писем. Документ не включает спецификации данных, включаемых в конверт сообщения.</p><p>Однако некоторые системы обработки сообщений могут использовать информацию из тела письма для создания конверта. Одной из задач настоящей спецификации является упрощение извлечения такой информации программными средствами.</p><p>Назначением этой спецификации является задание формата содержимого писем, передаваемых между системами. Хотя некоторые системы локально хранят сообщения в описанном здесь формате (это избавляет от необходимости преобразования форматов), а другие используют свои форматы хранения, вопросы локального хранения сообщений выходят за пределы данной спецификации.</p><p class="note">Примечание. В задачи этой спецификации не входит задание внутренних форматов, используемых сайтами, конкретных характеристик систем обработки сообщений или пользовательского интерфейса программ для создания и просмотра сообщений. Кроме того, данный документ не задает кодирования символов для транспортировки или хранения почты и не задает число и битов в представлении символов и способы передачи или хранения этих битов.</p><h3 id="p1.2">1.2. Система обозначений</h3><h4 id="p1.2.1">1.2.1. Обзначение уровня требований</h4><p>В этом документе используются термины, выделенные полужирным шрифтом. Ключевые слова необходимо (MUST), недопустимо (MUST NOT), требуется (REQUIRED), нужно (SHALL), не нужно (SHALL NOT), следует (SHOULD), не следует (SHOULD NOT), рекомендуется (RECOMMENDED), возможно (MAY), необязательно (OPTIONAL) в данном документе используются для обозначения уровня требований и интерпретируются в соответствии с [RFC2119].</p><h4 id="p1.2.2">1.2.2. Синтаксические обозначения</h4><p>В этой спецификации используется нотация ABNF [RFC5234] для формального определения синтаксиса сообщений. Символы задаются десятичным кодом (например, значение %d65 представляет латинский символ A, %d97 - a) или регистронезависимыми литералами, заключенными в кавычки (например, "A" для представления A или a).</p><h4 id="p1.2.3">1.2.3. Структура документа</h4><p>Документ делится на несколько частей.</p><p>В первом разделе содержитсякраткое введение.</p><p>В разделе 2 приведено общее описание сообщения и его компонент. Этот обзор поможет понять некоторые общие принципы, используемые в оставшейся части документа. Приведенные в этом разделе примеры недопустимо трактовать, как формальный синтаксис каких-либо компонент сообщения.</p><p>В разделе 3 даны формальные правила ABNF для структуры каждой части сообщения (синтаксис) и описаны связи между этими частями, а также их трактовка в контексте сообщения (семантика). Т. е., в этом разделе дается структурная схема каждой части сообщения (синтаксис), а также описание компонент и инструкции по их интерпретации (семантика). Раздел включает анализ семантики и синтаксиса субкомпонент сообщения, имеющих свою структуру. Рассмотренный в разделе 3 синтаксис представляет сообщения в том виде, в котором они должны создаваться. В этом разделе также указано, какие опции синтаксиса следует использовать.</p><p>Разделы 2 и 3 описывают сообщения, соответствующие данной спецификации.</p><p>В разделе 4 рассматривается «устаревший» синтаксис, на элементы которого приведены ссылки в разделе 3. Правила устаревшего синтаксиса являются элементами, которые были включены в ранние версии этой спецификации или широко использовались в почте Internet. Поэтому такие элементы должны интерпретироваться средствами разбора сообщений (parser) для обеспечения соответствия настоящей спецификации. Однако, поскольку элементы такого синтаксиса были сочтены неинтероперабельными или вызывающими проблемы у получателей сообщений, использование таких элементов при создании сообщений недопустимо.</p><p>В разделе 5 рассматриваются вопросы безопасности, которые следует принимать во внимание при реализации данной спецификации.</p><p>Приложение A содержит примеры сообщения. Приведенный набор примеров не является исчерпывающим списком всех появляющихся в Internet типов сообщений, но может служить иллюстрацией к некоторым синтаксическим формам.</p><p>В Приложении B перечислены отличия данной спецификации от более ранних версий спецификации формата сообщений Internet.</p><p>В Приложении C содержатся благодарности.</p><h2 id="p2">2. Лексический анализ сообщений</h2><h3 id="p2.1">2.1. Общее описание</h3><p>На базовом уровне сообщение представляет собой последовательность символов. Сообщения, соответствующие данной спецификации, включают символы с десятичными кодами от 1 до 127, интерпретируемые в соответствии с кодировкой US-ASCII [ANSI.X3-4.1986]. Для краткости в этом документе такие символы будут называться просто «символами US-ASCII».</p><p>Символы сообщения делятся на строки. Строка представляет собой последовательность символов, завершающуюся кодами возврата каретки и перевода строки — в конце строки помещается символ возврата каретки (CR, десятичный код ASCII — 13), непосредственно за которым следует символ перевода строки (LF, десятичный код ASCII - 10). В данном документе такая последовательность обозначается «CRLF».</p><p>Сообщение состоит из полей заголовков (совокупность этих полей называют разделом заголовков сообщения), за которыми может следовать тело сообщения. Раздел заголовков представляет собой последовательность символьных строк, синтаксис которых описан в данной спецификации. Тело сообщения представляет собой последовательность символов, которая следует после раздела заголовков и отделена от него пустой строкой (строкой, содержащей только CRLF).</p><h4 id="p2.1.1">2.1.1. Предельные размеры строк</h4><p>Данная спецификация вносит два ограничения на число символов в строке. Строка должна содержать не более 988 символов; следует использовать строки размером не более 78, без учета CRLF.</p><p>Ограничение в 998 обусловлено возможностями множества реализаций в части передачи, приема и хранения, которые не позволяют работать с сообщениями IMF, содержащими строки размером более 998 символов. Системы приема могут из соображений отказоустойчивости отказываться от ограничесния на размер строк. Однако существует множество реализаций, которые (в соответствии с транспортными требованиями [RFC5321]) не принимают сообщения со строками размером более 1000 (включая CR и LF в конце строки), — разработчикам важно принимать этот факт во внимание.</p><p>Рекомендация использовать строки размером не более 78 обусловлена параметрами пользовательского интерфейса многих реализаций, которые могут отсекать лишние символы или неаккуратно переносить слова при наличии в строке более 78 символов, несмотря на то, что такие реализации не соответствуют требованиям данной спецификации (и [RFC5321], если приводят к потере символов. Однако наличие такого ограничения не запрещает реализациям корректно отображать сообщения со строками произвольной длины (по крайней мере, строками, содержащими не более 998 символов) для повышения уровня отказоустойчивости.</p><h3 id="p2.2">2.2. Поля заголовков</h3><p>Поля заголовков представляют собой строки, начинающиеся с имени поля, за которым следует двоеточие (":"), содержимое поля и знак завершения строки CRLF. Имя поля должно состоять только из печатаемых символов US-ASCII (т. е., символов с кодами от 33 до 126, включительно), исключая двоеточие. Значение поля может включать печатаемые символы US-ASCII, символы пробела (SP, код ASCII - 32) и горизонтальной табуляции (HTAB, код ASCII — 9), которые вместе называют также пробельными символами. В значение поля недопустимо включать символы CR и LF, за исключением их использования в «фальцованных» и «нефальцованных» полях, как описанов в параграфе 2.2.3. Значения полей должны соответствовать синтаксису, описанному в разделах 3 и 4 настоящей спецификации.</p><h4 id="p2.2.1">2.2.1. Бесструктурные поля заголовков</h4><p>Некоторые поля заголовков в этой спецификации определены просто как неструктурированные (в параграфе 3.2.5 указано, что эти поля содержат произвольный набор печатаемых символов US-ASCII и пробельных символов) без дополнительных ограничений. Такие поля будем называть бесструктурными. Семантически бесструктурное поле трактуется просто как строка символов без дополнительной обработки (за исключением фальцовки, описанной в параграфе 2.2.3).</p><h4 id="p2.2.2">2.2.2. Структурированные поля заголовков</h4><p>Синтаксис некоторых полей в данной спецификации вносит дополнительные ограничения по сравнению с описанными выше бесструктурными полями. Такие поля называются структурированными. Структурированное поле представляет собой последовательность лексем, описанных в рзделах 3 и 4 данной спецификации. Многие из таких лексем (в соответствии с их синтаксисом) допускают включение комментариев в начале или в конце лексемы (см. параграф 3.2.2), а также пробельных символов, которые могут использоваться для фальцовки, как описано в параграфе 2.2.3. Семантический анализ структурированных полей приводится вместе с описанием их синтаксиса.</p><h4 id="p2.2.3">2.2.3. Длинные поля заголовков</h4><p>Каждое поле заголовка логически представляет собой строку символов, состоящую из имени поля, двоеточия и тела (значения) поля. Однако для удобства и с учетом ограничения размеров строки (998/78 символов), значение поля может быть разбито на несколько строк; это называется «фальцовкой» (folding). Общим правило заключается в том, что данная спецификация разрешает включение последовательности CRLF (новая строка) перед любыми пробельными символами.</p><p>Например, поле заголовка</p><pre>Subject: This is a test</pre><p>можно записать в форме</p><pre>Subject: This
 is a test</pre><p class="note">Note: Хотя структурированные поля определены таким образом, что фальцовка может выполняться между множеством лексем (и даже внутри некоторых лексем), фальцовку следует ограничивать включением CRLF на синтаксических границах верхних уровней. Например, если тело поля определено, как разделенные запятыми значения, рекомендуется выполнять фальцовку после запятой, разделяющей элементы структуры, а не в других местах (даже если это разрешено).</p><p>Процесс преобразования фальцованного многострочного представления поля в обычное однострочное называется расфальцовкой (unfolding) и выполняется путем простого удаления всех последовательностей CRLF, непосредственно за которыми следуют пробельные символы (WSP). Каждое поле заголовка для дальнейшего синтаксического и семантического анализа следует трактовать в его нефальцованном представлении. На нефальцованные поля заголовков не накладываются ограничения по размеру и они, следовательно, могут иметь любую длину.</p><h3 id="p2.3">2.3. Тело письма</h3><p>Тело сообщения представляет собой простые строки символов US-ASCII. Для содержимого сообщения существует только два типа ограничений:</p><ul class="dot"><li>символы CR и LF должны использоваться только совместно, как CRLF; недопустимо использование этих символов в теле сообщения по-отдельности;</li><li>строки символов должны быть не длиннее 998 символов, следует ограничивать размер строк 78 символами (без учета CRLF).</li></ul><h2 id="p3">3. Синтаксис</h2><h3 id="p3.1">3.1. Введение</h3><p>Описанный в этом разделе синтаксис задает корректный формат почтовых сообщений Internet. Сообщения, соответствующие данной спецификации, должны использовать описанный в этом разделе синтаксис. При наличии опций в этом разделе указано (в тексте или примечании), когда следует генерировать одну опцию.</p><p>Для определяемых выражений дается краткое описание синтаксиса и применения, после чего приводится синтаксис в формате ABNF и семантический анализ. Часть примитивов, используемых в документе, не определена здесь и заимствована из основных правил, приведенных в Приложении B.1 документа [RFC5234]. К таким примитивам относятся: CR, LF, CRLF, HTAB, SP, WSP, DQUOTE, DIGIT, ALPHA и VCHAR.</p><p>В некоторых определениях будут встреяаться элементы, имена которых начинаются с префикса "obs-". Такие элементы обозначают лексемы, относящиеся к устаревшему синтаксису и описанные в разделе 4. Во всех случаях такие конструкции при генерации корректных почтовых сообщений Internet игнорируются и их недопустимо использовать в качестве компонент сообщения. Однако при интерпретации сообщений такие лексемы должны рассматриваться как синтаксически корректные. В этом смысле раздел 3 описывает элементы "obs-", как игнорируемые, а раздел 4 добавляет описание интерпретации сообщений с такими элементами.</p><h3 id="p3.2">3.2. Лексемы</h3><p>В этом разделе описаны правила, используемые для определения базового лексического анализатора, который представляет лексемы анализаторам верхнего уровня. Раздел определяет лексемы, используемые в структурированных полях заголовков.</p><h4 id="p3.2.1">3.2.1. Квотрирование символов</h4><p>Некоторые символы имеют специальное значение (например, используются в качестве границ лексем). Для использования таких символов в общепринятом смысле служит механизм квотирования (добавления «кавычек»).</p><pre>quoted-pair     =   ("\" (VCHAR / WSP)) / obs-qp</pre><p>При появлении любой пары с квотированием (quoted-pair) она интерпретируется как отдельный символ. Т. е., символ \, являющийся частью пары с квотированием, становится семантически «невидимым».</p><h4 id="p3.2.2">3.2.2. Пробелы для фальцовки и комментарии</h4><p>Пробельные символы, включая и те, которые служат для фальцовки (см. параграф 2.2.3), могут появляться между разными элементами в теле полей заголовков. Строки символов, трактуемые, как комментарии, также могут включаться в тело структурированных полей заголовков с заключением их в скобки. Ниже определяется конструкция пробелов для фальговки (FWS) и комментариев.</p><p>Строки символов, заключенные в скобки, рассматриваются, как комментарии, если они не являются частью строки с квотированием, определенной в параграфе 3.2.4. Комментарии могут быть вложенными.</p><p>В этой спецификации есть несколько мест, где комментарии и FWS могут вставляться свободно. Для согласования с таким синтаксисом определена дополнительная лексема CFWS, показывающая возможность включения комментариев и/или FWS. Однако в тех случаях, где в данной спецификации разрешается CFWS, недопустимо использовать их так, чтобы фальцованное поле заголовка включало только символы WSP и ничего другого.</p><pre>FWS             =   ([*WSP CRLF] 1*WSP) /  obs-FWS
                                       ; пробельные символы для фальцовки

ctext           =   %d33-39 /          ; печатаемые символы US-ASCII,
                    %d42-91 /          ; не включая
                    %d93-126 /         ; "(", ")" и "\"
                    obs-ctext

ccontent        =   ctext / quoted-pair / comment

comment         =   "(" *([FWS] ccontent) [FWS] ")"

CFWS            =   (1*([FWS] comment) [FWS]) / FWS</pre><p>В этой спецификации появление FWS (пробельные символы для фальцовки) означает указание места, где возможно выполнение фальцовки, как описано в параграфе 2.2.3. Всякий раз при использовании фальцовки (т.е., поля заголовка, содержащего последовательность CRLF, за которой следейт любой символ WSP) в сообщении должна выполняться расфальцовка (удаление CRLF) до любого семантического анализа, выполняемого по отношению к заголовку в соответствии с данной спецификацией. Т. е., любые последовательности CRLF, включенные в FWS, являются семантически невидимыми.</p><p>Комментарии обычно используются в теле структурированных полей для обеспечения некой дополнительной информации для человека. Поскольку в комментариях могут содержаться символы FWS, это позволяет выполнять фальцовку внутри комментария. Отметим также, что возможность использования в комментариях пар с квотированием, позволяет включать в комментарии скобки и символы обратной дробной черты (\), если они задаются в форме пары с квотированием. Семантически внешние скобки не являются частью комментария — комментарием является то, что заключено в эти скобки. Как было отмечено выше, символы «\» в парах с квотированием и последовательности CRLF внутри FWS внутри комментариев являются семантически невидимыми и, следовательно, не являются частью комментария.</p><p>FWS в качестве комментария (CFWS) между лексемами в структурированном поле заголовка семантически интерпретируется как один символ пробела.</p><h3 id="p3.2.3">3.2.3. Атом</h3><p>Некоторые конструкции в теле структурированных полей заголовков представляют собой просто строки некоторых базовых символов. Такие конструкции называют атомами.</p><p>В некоторых структурированных полях заголовков допускается включение точки («.», код ASCII - 46) в atext. Для таких конструкций определена дополнительная лексема «атом с точкой» (dot-atom).</p><pre>atext           =   ALPHA / DIGIT /    ; Печатаемые символы US-ASCII,
                    "!" / "#" /        ; не включая специальных символов.
                    "$" / "%" /        ; Используются для атомов.
                    "&amp;" / "'" /
                    "*" / "+" /
                    "-" / "/" /
                    "=" / "?" /
                    "^" / "_" /
                    "`" / "{" /
                    "|" / "}" /
                    "~"

atom            =   [CFWS] 1*atext [CFWS]

dot-atom-text   =   1*atext *("." 1*atext)

dot-atom        =   [CFWS] dot-atom-text [CFWS]

specials        =   "(" / ")" /        ; Специальные символы, которые не
                    "&lt;" / "&gt;" /        ; появляются в atext
                    "[" / "]" /
                    ":" / ";" /
                    "@" / "\" /
                    "," / "." /
                    DQUOTE</pre><p>Лексемы atom и dot-atom интерпретируются, как единый элемент, включающий строку символов. Семантически дополнительные комментарии и FWS, окружающие остальные символы, не являются частью атома — атом представляет собой только символы atext (или atext и «.» для dot-atom).</p><h4 id="p3.2.4">3.2.4. Строки в кавычках</h4><p>Строки, включающие символы, недопустимые для использования в атомах, могут быть представлены с использованием двойных кавычек (DQUOTE, код ASCII - 34), окружающих такие символы.</p><pre>qtext           =   %d33 /             ; Печатаемые символы US-ASCII,
                    %d35-91 /          ; не включая "\"
                    %d93-126 /         ; и символа кавычек
                    obs-qtext

qcontent        =   qtext / quoted-pair

quoted-string   =   [CFWS]
                    DQUOTE *([FWS] qcontent) [FWS] DQUOTE
                    [CFWS]</pre><p>Строка в кавычках трактуется как единый элемент. Т. е., семантически строка в кавычках эквивалентна атому. Поскольку строки в кавычках могут содержать FWS, в них возможна фальцовка. Отметим также, что благодаря возможности использования внутри кавычек пар с квотированием, строки в кавычках могут содержать также символы кавычек и обратной дробной черты, если они представлены в форме пар с квотированием.</p><p>Семантически, ни опциональные CFWS за пределами кавычек, ни сами символы кавычек не являются частью строки в кавычках — к такой строке относятся только символы, расположенные между кавычками. Как было отмечено выше, символ «\» в паре с квотированием или CRLF в FWS/CFWS, включенные в строку в кавычках, семантически невидимы и, следовательно, не являются частью строки в кавычках.</p><h4 id="p3.2.5">3.2.5. Прочие лексемы</h4><p>Определены ти дополнительных лексемы: слово (word) и фраза (phrase) для комбинаций атомов и/или строк в кавычках и неструктурированный текст (unstructured) для использования в бесструктурных полях заголовков и в некоторых местах структурированных полей.</p><pre>word            =   atom / quoted-string

phrase          =   1*word / obs-phrase

unstructured    =   (*([FWS] VCHAR) *WSP) / obs-unstruct</pre><h3 id="p3.3">3.3. Задание даты и времен</h3><p>Значения даты и времени появляются в нескольких полях заголовка. В этом параграфе определяет синтаксис для задания даты и времени. Хотя спецификация даты/времени допускает включение пробельных символов фальцовки, рекомендуется использовать один пробел в каждом случае включения FWS (так, где это требуется или допускается); некоторые старые реализации неспособны корректно интерпретировать пробельные символы фальцовки.</p><pre>date-time       =   [ day-of-week "," ] date time [CFWS]

day-of-week     =   ([FWS] day-name) / obs-day-of-week

day-name        =   "Mon" / "Tue" / "Wed" / "Thu" /
                    "Fri" / "Sat" / "Sun"

date            =   day month year

day             =   ([FWS] 1*2DIGIT FWS) / obs-day

month           =   "Jan" / "Feb" / "Mar" / "Apr" /
                    "May" / "Jun" / "Jul" / "Aug" /
                    "Sep" / "Oct" / "Nov" / "Dec"

year            =   (FWS 4*DIGIT FWS) / obs-year

time            =   time-of-day zone

time-of-day     =   hour ":" minute [ ":" second ]

hour            =   2DIGIT / obs-hour

minute          =   2DIGIT / obs-minute

second          =   2DIGIT / obs-second

zone            =   (FWS ( "+" / "-" ) 4DIGIT) / obs-zone</pre><p>Дата (day) показывает порядковый номер дня в месяце. Год (year) может принимать любое значение, не ранее 1900.</p><p>Время суток (time-of-day) показывает число часов, минут и (опционально) секунд, прошедщих с полуночи указанной даты.</p><p>Значения date и time-of-day следует указывать по местному времени.</p><p>Часовой пояс (zone) показывает смещение относительно универсального времени (UTC, ранее использовался термин GMT) значений местного времени, указанного в date и time-of-day. Знаки «+» и «-» показывают направление смещения — вперед (т. е., к востоку) или назад (к западу) от универсального времени. Первые две цифры показывают разницу с универсальным временем в часах, а две последних — дополнителюную разницу в минутах. Следовательно, +hhmm означает смещение на +(hh * 60 + mm) минут от универсального времени, а -hhmm — на -(hh * 60 + mm) минут. Для индикации часового пояса, время которого совпадает с универсальным, следует использовать форму +0000. Хотя вариант -0000 указывает на тот же часовой пояс, этот вариант используется для индикации того, что время было указано системой, которая может находиться в часовом поясе, отличном от UT, а значение date-time не содержит информации о часовом поясе.</p><p>Значение date-time должно быть семантически корректным. Т. е., значение day-of-week (при его наличии) должно содержать день недели, числовое значение day-of-month должно находиться в диапазоне от 1 до числа дней в соответствующем месяце (указанного года), значение time-of-day должно находиться в диапазоне от 00:00:00 до 23:59:60 (число секунд, допустимое для смены суток; см. [RFC1305]), а две последних цифры поля zone должны иметь значение от 00 до 59.</p><h3 id="p3.4">3.4. Задание адреса</h3><p>Адреса появляются в нескольких полях заголовка для индикации отправителей и получателей сообщения. Адрес может задавать персональный почтовый ящик или группу почтовых ящиков.</p><pre>address         =   mailbox / group

mailbox         =   name-addr / addr-spec

name-addr       =   [display-name] angle-addr

angle-addr      =   [CFWS] "&lt;" addr-spec "&gt;" [CFWS] /
                    obs-angle-addr

group           =   display-name ":" [group-list] ";" [CFWS]

display-name    =   phrase

mailbox-list    =   (mailbox *("," mailbox)) / obs-mbox-list

address-list    =   (address *("," address)) / obs-addr-list

group-list      =   mailbox-list / CFWS / obs-group-list</pre><p>Почтовый ящик принимает почту. Это концептуальный объект, который не обязательно связан с файловым хранилищем. Например, некоторые сайты могут выводить почтовые сообщения на принтер или передавать их на специальные адресуемые устройства вывода.</p><p>Обычно почтовый ящик состоит из двух частей: (1) необязательное отображаемое имя, которое идентифицирует имя получателя (человека или системы) и может выводиться пользователю в почтовых программах и (2) поле addr-spec, заключенное в угловые скобки (<code>&lt;</code> и <code>&gt;</code>). Существует дополнительная форма указания почтового ящика, в которой имя получателя отсутствует, а addr-spec указывается без угловых скобок. Описание addr-spec для адресов Internet приведено в параграфе 3.4.1.</p><p class="note">Примечание. Некоторое унаследованные реализации используют простую форму, где addr-spec указывается без угловых скобок, а имя получателя указывается в скобках, как комментарий вслед за addr-spec. Поскольку трактовка комментариев не задается спецификацией, реализациям для задания связанного с почтовым ящиком отображаемого имения следует использовать полную форму name-addr взамен такой унаследованной формы. Кроме того, поскольку некоторые унаследованные реализации интерпретируют комментарии, в общем случае не следует использовать комментарии в поле адреса во избежание возможной путаницы.</p><p>Когда желательно трактовать несколько почтовых ящиков, как один объект (например, список рассылки), может использоваться групповая конструкция. Такая конструкция позволяет отправителю указать именованную группу получателей. Это обеспечивается путем создания для группы отображаемого имени, за которым следует список разделенных запятыми почтовых ящиков произвольного (включая 0) размера, завершающийся точкой с запятой (;). Поскольку список почтовых ящиков может быть пустым, использование групповой конструкции также обеспечивает простой способ взаимодействия с адресатами, когда сообщение передается одной или множеству именованных групп адресатов без указания иднивидуальных почтовых ящиков этих адресатов.</p><h4 id="p3.4.1">3.4.1. Задание addr-spec</h4><p>Поле addr-spec представляет собой специфический для Internet идентификатор, содержащий локально интерпретируемую строку, за которой следует символ @ (код ASCII - 64) и доменное имя Internet. Эта локально интерпретируемая строка представляет собой строку в кавычках или атом с точкой. Если строка может быть представлена атомом с точкной (т. е., не содержит символов, кроме atext и завершающей точки или, за которой следуют символы atext), следует использовать форму dot-atom и не следует применять форму quoted-string. Комментарии и пробельные символы фальцовки не следует помещать рядом с @ в поле addr-spec.</p><p class="note">Примечание. Здесь приведен либеральный синтаксис для доменной части addr-spec. Однако доменная часть содержит адресную информацию, задаваемую и используемую другими протоколами (например, [RFC1034], [RFC1035], [RFC1123], [RFC5321]). Следовательно, на реализации возлагается ответственность за соответствие синтаксиса адресов контексту, в котором они используются.</p><pre>addr-spec       =   local-part "@" domain

local-part      =   dot-atom / quoted-string / obs-local-part

domain          =   dot-atom / domain-literal / obs-domain

domain-literal  =   [CFWS] "[" *([FWS] dtext) [FWS] "]" [CFWS]

dtext           =   %d33-90 /          ; Печатаемые символы US-ASCII,
                    %d94-126 /         ; не включая
                    obs-dtext          ; "[", "]", or "\"</pre><p>Доменная часть идентифицирует точку, в которую доставляется почта. В форме dot-atom она интерпретируется, как доменное имя Internet (имя хоста или узла MXMX) в соответствии с описаниями в [RFC1034], [RFC1035] и [RFC1123]. В форме domain-literal доменная часть интерпретируется, как «дословный» Internet-адрес конкретного хоста. В обоих случаях использование адресации и транспортировка почты на конкретный хост определяются отдельными документами (такими, как [RFC5321]). Эти механизмы выходят за пределы настоящей спецификации.</p><p>Локальная часть (local-part) зависит от домена. В адресах она просто интерпретируется на конкретном хосте, как имя почтового ящика.</p><h3 id="p3.5">3.5. Общий синтаксис сообщений</h3><p>Сообщение состоит из полей заголовка, за которыми может следовать тело сообщения. Строки сообщения должны иметь размер не более 998 символов, не считая CRLF, но рекомендуется использовать строки не длиннее 78 без учета CRLF (см. параграф 2.1.1). Хотя в теле сообщения могут появляться любые символы, перечисленные в правиле text, использование управляющих символов US-ASCII (коды 1-8, 11, 12, 14-31) не является хорошим тоном, поскольку их интерпретация при отображении на приемной стороне не гарантируется.</p><pre>message         =   (fields / obs-fields)
                    [CRLF body]

body            =   (*(*998text CRLF) *998text) / obs-body

text            =   %d1-9 /            ; Символы, за исключением
                    %d11 /             ; CR и LF
                    %d12 /
                    %d14-127</pre><p>Поля заголовков, несущие основную семантическую информацию, определены в параграфе 3.6. Тело сообщения представляет собой просто набор строк текста, интерпретируемых в соответствии с настоящей спецификацией.</p><h3 id="p3.6">3.6. Определения полей</h3><p>В этом параграфе определены поля заголовка сообщения. Все поля заголовка имеют одинаковую синтаксическую структуру: имя поля, за которым следует двоеточие (:) и тело (значение) поля. Конкретный синтаксис каждого поля заголовка определен в соответствующем подпараграфе.</p><p>Важно подчеркнуть, что порядок следования полей заголовка не гарантируется. Поля заголовков могут появляться в произвольном порядке. Более того, известно, что порядок полей заголовков может изменяться при передаче сообщений через Internet. Однако в соответствиии с данной спецификацией порядок полей заголовка не следует менять при передаче или преобразовании сообщений. Более важно отметить, что порядок трассировочных полей и полей resent изменять недопустимо и следует сохранять эти поля в блоках, добавляемых в начало сообщения (prepend). Дополнительная информация об этих полях содержится в параграфах 3.6.6 и 3.6.7.</p><p>Обязательными полями заголовка являются только поле даты и поле адреса отправителя сообщения. Все остальные поля являются синтаксически опциональными. Дополнительная информация приведена в таблице вслед за определением.</p><pre>fields          =   *(trace
                      *optional-field /
                      *(resent-date /
                       resent-from /
                       resent-sender /
                       resent-to /
                       resent-cc /
                       resent-bcc /
                       resent-msg-id))
                    *(orig-date /
                    from /
                    sender /
                    reply-to /
                    to /
                    cc /
                    bcc /
                    message-id /
                    in-reply-to /
                    references /
                    subject /
                    comments /
                    keywords /
                    optional-field)</pre><p>Приведенная ниже таблица показывает минимальное и максимальное число полей каждого типа в разделе заголовков сообщения, а также ограничения на использование полей. Звездочка (*) после в колонке минимального или максимального числа полей говорит о наличии дополнительных ограничений, указанных в колонке «Примечания».</p><table><tr><td>Поле</td><td>Минимум</td><td>Максимум</td><td>Примечания</td></tr><tr><td>trace</td><td>0</td><td>Не ограничен</td><td>Блок добавляется в начало, см. параграф 3.6.7</td></tr><tr><td>resent-date</td><td>0*</td><td>Не ограничен*</td><td>Одно на блок; требуется при наличии других полей resent, см. параграф 3.6.6</td></tr><tr><td>resent-from</td><td>0</td><td>Не ограничен*</td><td>Одно на блок, см. параграф 3.6.6</td></tr><tr><td>resent-sender</td><td>0*</td><td>Не ограничен*</td><td>Одно на блок; должно присутствовать при наличии множества адресов, см. параграф 3.6.6</td></tr><tr><td>resent-to</td><td>0</td><td>Не ограничен*</td><td>Одно на блок, см. параграф 3.6.6</td></tr><tr><td>resent-cc</td><td>0</td><td>Не ограничен*</td><td>Одно на блок, см. параграф 3.6.6</td></tr><tr><td>resent-bcc</td><td>0</td><td>Не ограничен*</td><td>Одно на блок, см. параграф 3.6.6</td></tr><tr><td>resent-msg-id</td><td>0</td><td>Не ограничен*</td><td>Одно на блок, см. параграф 3.6.6</td></tr><tr><td>orig-date</td><td>1</td><td>1</td><td></td></tr><tr><td>from</td><td>1</td><td>1</td><td>См. sender и параграф 3.6.2</td></tr><tr><td>sender</td><td>0*</td><td>1</td><td>Должно присутствовать при наличии множества адресов, см. параграф 3.6.2</td></tr><tr><td>reply-to</td><td>0</td><td>1</td><td></td></tr><tr><td>to</td><td>0</td><td>1</td><td></td></tr><tr><td>cc</td><td>0</td><td>1</td><td></td></tr><tr><td>bcc</td><td>0</td><td>1</td><td></td></tr><tr><td>message-id</td><td>0*</td><td>1</td><td>Следует включать, см. параграф 3.6.4</td></tr><tr><td>in-reply-to</td><td>0*</td><td>1</td><td>Следует включать, см. параграф 3.6.4</td></tr><tr><td>references</td><td>0*</td><td>1</td><td>Следует включать, см. параграф 3.6.4</td></tr><tr><td>subject</td><td>0</td><td>1</td><td></td></tr><tr><td>comments</td><td>0</td><td>Не ограничен</td><td></td></tr><tr><td>keywords</td><td>0</td><td>Не ограничен</td><td></td></tr><tr><td>optional-field</td><td>0</td><td>Не ограничен</td><td></td></tr></table><p>Точная интерпретация каждого поля рассмотрена в последующих параграфах.</p><h4 id="p3.6.1">3.6.1. Поле даты создания</h4><p>Поле даты создания состоит из имени поля «Date», за которым следуют значения даты и времени.</p><pre>orig-date       =   "Date:" date-time CRLF</pre><p>Поле указывает дату и время, когда отправитель, указанный в сообщении, завершил подготовку сообщения к передаче системе доставки. Например, это может быть момент нажатия пользователем кнопки «send» или «submit» в почтовой программе. В любом случае, это поле не предназначено для указания времени реальной передачи сообщения, а содержит значение времени, когда человек или другой создатель сообщения завершил подготовку сообщения к передаче (например, пользователь портативного компьютера, не подключенного к сети, мог просто поместить сообщение в очередь для доставки; поле даты создания предназначено для хранения даты и времени в момент постановки письма в очередь, а не момента подключения пользователя к сети).</p><h4 id="p3.6.2">3.6.2. Поля источника</h4><p>В число полей источника сообщения входят from и sender (когда применимр), а также опционально — reply-to. Поле from содержит имя «From» и разделенный запятыми список из одного или нескольких имен почтовых ящиков. Эсли это поле содержит более одного адреса почтового ящика в списке, в сообщение должно включаться поле «Sender» с указанием одного почтового ящика. Дополнительно может также включаться поле «Reply-To», содержащее список разделенных запятыми почтовых ящиков (не менее одного).</p><pre>from            =   "From:" mailbox-list CRLF

sender          =   "Sender:" mailbox CRLF

reply-to        =   "Reply-To:" address-list CRLF</pre><p>Поле источника показывает почтовый ящик(и) источника сообщения. Поле «From:» задает автора (авторов) сообщения, т. е., почтовый ящик(и) человека или системы, ответственных за создание данного сообщения. Поле «Sender:» указывает почтовый ящик агента, ответственного за реальную передачу сообщения. Например, если секретарь отправил письмо от имени своего руководителя, почтовый ящик секретаря будет указан в поле «Sender:», а адрес действительного автора сообщения — в поле «From:». Если источник сообщения может быть задан единственным почтовым ящиком (автор и отправитель совпадают), поле «Sender:» использовать не следует. В остальных случаях это поле следует включать в заголовок.</p><p>Поля источника также обеспечивают информацию, требуемую для ответа на сообщение. При наличии поля «Reply-To:» оно указывает адрес(а), по которому отправитель сообщения предлагает направлять ответ. В отсутствие поля «Reply-To:» ответ следует по умолчанию отправлять по адресу (адресам), указанному в поле «From:», если автором ответа явно не указан иной адрес.</p><p>В любом случае в поле «From:» не следует указывать адрес, не имеющий отношения к автору письма. Формирование адресов для отправки ответов на сообщения дополнительно рассматривается в параграфе 3.6.3.</p><h4 id="p3.6.3">3.6.3. Поля адресов получателей</h4><p>К полям получателей относятся три однотипных поля, каждое из которых содержит имя («To», «Cc» или «Bcc») и список из одного или множества разделенных запятыми адресов (почтовых ящиков или групп).</p><pre>to              =   "To:" address-list CRLF

cc              =   "Cc:" address-list CRLF

bcc             =   "Bcc:" [address-list / CFWS] CRLF</pre><p>Эти поля задают получателей сообщения. Каждое из полей может содержать один или множество адресов, идентифицирующих получателей сообщения. Различие между полями заключается только в способе их использования.</p><p>Поле «To:» содержит адрес(а) основного полячателя (получателей) сообщения.</p><p>Поле «Cc:» (от «Carbon Copy» — копия по аналогии с печатью под копирку на пишущей машинке) содержит адреса других лиц, которым направляется это сообщение, хотя содержимое сообщения может быть не адресовано им напрямую.</p><p>Поле «Bcc:» (от «Blind Carbon Copy» — «слепая копия» по аналогии с последним экземпляром при печати под копирку) содержит адреса получателей, которые не будут показаны другим получателям этого сообщения. Существует три варианта использования поля «Bcc:». В первом случае, когда сообщение с полем «Bcc:» готовится к отправке, строка «Bcc:» удаляется из него, хотя все адресаты (включая указанных в поле «Bcc:») получают копию этого письма. Во втором варианте получатели, указанные в полях «To:» и «Cc:», получат сообщение с удаленной строкой «Bcc:», но адресаты, указанные в поле «Bcc:» получат копию письма с сохраненной строкой «Bcc:» (при указании в поле «Bcc:» множества адресатов некоторые реализации на самом деле шлют каждому адресату из поля «Bcc:» отдельную копию письма, содержащую в этом поле только адрес данного получателя). И, наконец, когда поле «Bcc:» не содержит адресов, это поле может включаться во все копии сообщения для адресатов, заданных другими полями. Выбор конкретного варианта использования поля «Bcc:» определяется реализацией, но при этом следует принимать во внимание информацию, приведенную ниже в разделе «Вопросы безопасности».</p><p>Когда сообщение является ответом на другое письмо, почтовые ящики авторов исходного письма (значение поля «From:») или почтовые ящики, указанные в поле «Reply-To:» (если оно есть), могут появляться в поле «To:» ответного письма, поскольку эти адресаты являются явными отправителями исходного письма. Если сообщение передается в ответ на письмо, имеющее поля получателей, зачастую бывает полезно отправить копию ответа всем получателям сообщения в дополнение к отправке письма автору. При создании такого отклика адреса из полей «To:» и «Cc:» исходного сообщения могут появляться в поле «Cc:» ответного письма, поскольку эти адресаты были открытоо указаны в числе получателей копии исходного письма. Если в исходном письме присутствует поле «Bcc:», адреса из этого поля могут появляться в поле «Bcc:» ответа на письмо, но их не следует включать в поле «To:» или «Cc:».</p><p class="note">Примечание. Некоторые почтовые программы поддерживают команды автоматического ответа, при котором адреса получателей исходного письма включаются в число адресов получателей ответа. Поведение таких команд зависит от реализации и выходит за пределы настоящего документа. В частности, вопрос включения адресов получателей исходного письма при наличии в нем поля «Reply-To:» здесь не рассматривается.</p><h4 id="p3.6.4">3.6.4. Поля идентификации</h4><p>Хотя в таблице параграфа 3.6 поле «Message-ID:» указано, как необязательное, это поле следует включать в каждое сообщение. Более того, в ответные сообщения следует включать поля «In-Reply-To:» и «References:» в соответствии с приведенным ниже описанием.</p><p>Поле «Message-ID:» содержит один уникальный идентификатор сообщения. Каждое из полей «References:» и «In-Reply-To:» содержит один или множество уникальных идентификаторов сообщений, опционально разделенных символами CFWS.</p><p>Синтаксис идентификатора сообщения (msg-id) является ограниченной версией конструкции addr-spec, заключенной в угловые скобки <code>&lt;</code> и <code>&gt;</code>. В отличие от addr-spec, этот синтаксис разрешает форму dot-atom-text слева от символа @ и не имеет сиволов CFWS где-либо внутри идентификатора.</p><p class="note">Примечание. Как и в случае addr-spec, для правой части msg-id (после символа @) @) @) @) дается либеральный синтаксис. Однако ниже в этом параграфе сказано, что рекомендуется использовать справа от знака @ доменное имя. Как и прежде, синтаксис доменного имени задается и используется в других протоколах (например, [RFC1034], [RFC1035], [RFC1123], [RFC5321]). Следовательно, на реализации возлагается вопрос соответствия адресов контексту, в котором они используются.</p><pre>message-id      =   "Message-ID:" msg-id CRLF

in-reply-to     =   "In-Reply-To:" 1*msg-id CRLF

references      =   "References:" 1*msg-id CRLF

msg-id          =   [CFWS] "&lt;" id-left "@" id-right "&gt;" [CFWS]

id-left         =   dot-atom-text / obs-id-left

id-right        =   dot-atom-text / no-fold-literal / obs-id-right

no-fold-literal =   "[" *dtext "]"</pre><p>Поле «Message-ID:» обеспечивает уникальный идентификатор сообщения, который указывает на конкретный вариант конкретного письма. Уникальность идентификатора гарантируется хостом, создающим сообщение (см. ниже). Этот идентификатор предназначен для машинной обработки и не имеет большого смысла для человека. Идентификатор сообщения относится только к одному варианту конкретного письма — для следующего экземпляра сообщения будет создан другой идентификатор.</p><p class="note">Примечание. Существует множество ситуаций, когда сообщения «изменяются», но эти изменения не порождают нового экземпляра данного сообщения и, следовательно, сообщение не получает нового идентификатора. Например, когда сообщения вводятся в транспортную систему, в начало сообщения зачастую добавляются дополнительные поля заголовков, такие, как поля трассировки (параграф 3.6.7) и поля пересылки (параграф 3.6.6). Добавление таких полей в заголовки не меняет сообщения, как такового, и, следовательно, значение «Message-ID:» сохраняется. Во всех случаях содержимое, которое желает передать отправитель (то же самое сообщение или другое), а не какое-либо синтаксическое отличие, которое появляется (или не появляется) в сообщении, определяет сохранение или изменение поля «Message-ID:».</p><p>Поля «In-Reply-To:» и «References:» используются при создании ответных сообщений. Они содержат идентификатор исходного сообщения и идентификаторы других сообщений (например, в случае ответа на письмо, которое само является ответом на другое письмо). Поле «In-Reply-To:» может использоваться для идентификации сообщения (сообщений), на которое отвечает данное сообщение, тогда как поле «References:» может служить для идентификации «ветви» разговора.</p><p>При создании ответа на сообщение поля «In-Reply-To:» и «References:» в ответном письме строятся в соответствии с приведенным ниже описанием.</p><p>Поле «In-Reply-To:» ответного письма будет содержать информацию из поля «Message-ID:» исходного («родительского») сообщения. Если ответ дается на несколько писем сразу, поле «In-Reply-To:» будет содержать информацию из полей «Message-ID:» всех родительских сообщений. Если в родительских сообщениях нет полей «Message-ID:», в ответе не будет содержаться поля «In-Reply-To:».</p><p>Поле «References:» будет включать содержимое поля «References:» из родительского письма (если там это поле присутствует), вслед за которым будет включено родительское поле «Message-ID:» (при его наличии). Если в родительском сообщении нет поля «References:», но имеется поле «In-Reply-To:» с единственным идентификатором, в ответе поле «References:» будет включать содержимое родительского поля «In-Reply-To:», за которым будет следовать содержимое родительского поля «Message-ID:» (при его наличии). Если в родительском сообщении нет полей «References:», «In-Reply-To:» и «Message-ID:», в ответе не будет поля «References:».</p><p>Идентификатор сообщения (msg-id) должен быть уникальным в глобальном масштабе. Эту уникальность должен обеспечивать генератор идентификаторов сообщений. Существует несколько алгоритмов, обеспечивающих решение этой задачи. Поскольку синтаксис msg-id подобен сиснтаксису addr-spec (за исключением запрета на включение строк в кавычках, комментариев и фальцовочных пробелов), хорошим методом является включение в идентификатор доменного имени (или полного адреса IP) хоста, на котором создается идентификатор сообщения, справа от знака @ (доменные имена и адреса IP обычно уникальны) и включение текущего абсолютного значения даты и времени в комбинации с неким другим уникальным в данный момент (возможно последовательным) идентификатором, доступным в системе (например, идентификатором процесса), слева от @. Хотя будут работать и другие алгоритмы, рекомендуется использовать в правой части некий идентификатор домена (имя хоста или нечто иное), чтобы генератор идентификатора сообщения мог гарантировать уникальность левой части идентификатора в масштабе данного домена.</p><p>Семантически угловые скобки не являются частью msg-id; идентификатором является строка символов между скобками.</p><h4 id="p3.6.5">3.6.5. Информационные поля</h4><p>Информационные поля являются необязательными. Поля «Subject:» и «Comments:» являются бесструктурными, как определено в параграфе 2.2.1, и, следовательно, могут содержать текст или пробельные символы для фальцовки. Поле «Keywords:» содержит список из одного или более разделенных запятыми слов или строк в кавычках.</p><pre>subject         =   "Subject:" unstructured CRLF

comments        =   "Comments:" unstructured CRLF

keywords        =   "Keywords:" phrase *("," phrase) CRLF</pre><p>Эти три поля предназначены только для включения понятной человеку информации о сообщении. Поле «Subject:» используется наиболее широко и содержит короткую строку, описывающую тему сообщения. При использовании в ответах это поле может начинаться с префикса «Re: » (сокращение от латинского «in re», означающего «по вопросу ..»), за которым следует содержимое поля «Subject:» исходного письма. В таких случаях следует использовать префикс «Re: » только один раз, поскольку использование другого текста или включение нескольких префиксов может приводить к нежелательным последствиям. Поле «Comments:» содержит произвольную информацию, дополняющую текст в теле письма. Поле «Keywords:» содержит список разделенных запятыми слов и фраз " field contains a comma-separated list of important words and phrases that might be useful for the recipient.</p><h4 id="p3.6.6">3.6.6. Поля пересылки</h4><p>Поля пересылки следует добавлять во все сообщения, которые повторно вводятся пользователем в транспортную систему. Каждый раз, когда это происходит, следует добавлять отдельный набор полей пересылки. Все поля пересылки, соответствующие отдельному факту пересылки, следует группировать. Каждый набор полей пересылки помещается в начало сообщения; т. е., самый свежий набор таких полей появляется в сообщении первым. При добавлении полей пересылки никакие другие поля сообщения не меняются.</p><p>Каждое поле пересылки синтаксически соответствует определенному полю при обычной передаче. Например, поле «Resent-Date:» соответствует полю «Date:», а «Resent-To:» — полю «To:». Во всех таких случаях синтаксис тела полей пересылки идентичен синтаксису соответствующего поля, описанному выше.</p><p>При использовании полей пересылки должны передаваться поля «Resent-From:» и «Resent-Date:». Следует передавать также поле «Resent-Message-ID:». Поле «Resent-Sender:» не следует использовать, если это поле будет идентично полю «Resent-From:».</p><pre>resent-date     =   "Resent-Date:" date-time CRLF

resent-from     =   "Resent-From:" mailbox-list CRLF

resent-sender   =   "Resent-Sender:" mailbox CRLF

resent-to       =   "Resent-To:" address-list CRLF

resent-cc       =   "Resent-Cc:" address-list CRLF

resent-bcc      =   "Resent-Bcc:" [address-list / CFWS] CRLF

resent-msg-id   =   "Resent-Message-ID:" msg-id CRLF</pre><p>Поля пересылки служат для идентификации сообщений, как повторно вводимых пользователем в транспортную систему. Цель использования этих полей заключается в предоставлении конечному адресату сообщения в таком виде, как будто оно было получено непосредственно от исходного отправителя с сохранением всех исходных полей. Каждый набор полей пересылки соответствует одному факту пересылки. Т. е., при многократной пересылке сообщения каждый из таких наборов описывает отдельный факт пересылки. Поля пересылки являются информационными. Эти поля недопустимо использовать в процессах автоматической генерации ответов и других операциях автоматизированной обработки сообщений.</p><p>Поля инициатора пересылки указывают почтовый ящик лиц(а) или систем(ы), переславших это сообщение. Как и для обычных полей инициатора существует две формы — простой вариант «Resent-From:», содержащий почтовый ящик выполняющего пересылку лица, и более сложный вариант, когда одно лицо (идентифицируется полем «Resent-Sender:») пересылает сообщение от имени одного или множества других лиц (идентифицируются полем «Resent-From:»).</p><p>Примечание. При ответе на пересланное сообщение исходные поля «From:», «Reply-To:», «Message-ID:» и др. используются в обычном порядке. Поля пересылки являются только информационными и недопустимо использовать их при ответе на сообщение.</p><p>Поле «Resent-Date:» указывает дату и время диспетчеризации сообщения при его пересылке. Подобно полю «Date:», оно содержит не дату и время реальной отправки сообщения, а дату и время постановки в очередь.</p><p>Функционально поля «Resent-To:», «Resent-Cc:» и «Resent-Bcc:» идентичны полям «To:», «Cc:» и «Bcc:», соответственно, за исключением того, что они указывают получателей пересланного сообщения, а не исходного.</p><p>Поле «Resent-Message-ID:» содержит уникальный идентификатор пересланного сообщения.</p><h4 id="p3.6.7">3.6.7. Поля трассировки</h4><p>Поля трассировки представляют собой группу полей заголовка, включающую опциональное поле «Return-Path:» и одно или множество полей «Received:». Поле заголовка «Return-Path:содержит пару угловых скобок, в которые заключено необязательное значение addr-spec. Поле «Received:» содержит (возможно пустой) список маркеров, за которым следует точка с запятой (;) и значение даты и времени. Каждый маркер должен представлять собой элемент типа word, angle-addr, addr-spec или domain. Спецификации, описывающие использование полей трассировки (такие, как [RFC5321]), могут вносить дополнительные ограничения.</p><pre>trace           =   [return]
                    1*received

return          =   "Return-Path:" path CRLF

path            =   angle-addr / ([CFWS] "&lt;" [CFWS] "&gt;" [CFWS])

received        =   "Received:" *received-token ";" date-time CRLF

received-token  =   word / angle-addr / addr-spec / domain</pre><p>Полное описание использования полей трассировки в почте Internet содержится в [RFC5321]. В данной спецификации трассировочные поля рассматриваются исключительно в качестве информационных и любая формальная интерпретация этих полей выходит за рамки документа.</p><h4 id="p3.6.8">3.6.8. Дополнительные поля</h4><p>В сообщениях могут появляться поля, не рассмотренные в этом документе. Такие поля должны соответствовать синтаксису optional-field. Этот синтаксис включает имя поля, состоящее из печатаемых символов US-ASCII без двоеточий и пробелов (SP), за которым следует двоеточие и произвольный текст, соответствующий синтаксису бесструктурных полей.</p><p>Недопустимо совпадение имен дополнительных полей с именами полей, указанными в данном документе.</p><pre>optional-field  =   field-name ":" unstructured CRLF

field-name      =   1*ftext

ftext           =   %d33-57 /          ; Печатаемые символы US-ASCII,
                    %d59-126           ; за исключением «:».</pre><p>В настоящей спецификации дополнительные поля считаются неинтерпретируемыми.</p><h2 id="p4">4. Устаревший синтаксис</h2><p>В ранних версиях спецификации допускался иной (обычно, более либеральный) синтаксис по сравнению с дозволенным в этой версии. Кроме того, некоторые синтаксические элементы, используемые в почтовых сообщениях Internet, никогда не были документированы. Хотя генерация таких синтаксических форм недопустима в соответствии с разделом 3, они должны восприниматься и разбираться соответствующим спецификации получателем. В этом разделе документированы многие элементы такого типа. Использование грамматики раздела 3 с добавлением содержащихся в данном разделе определений, создает грамматику для использования при интерпретации сообщений.</p><p class="note">Note: В этом разделе рассматриваются лишь те синтаксические формы, которые любая реализация должна подобающим образом интерпретировать. Однако существуют сообщения Internet, которые не соответствуют спецификации даже с учетом приведенного в этом разделе дополнительного синтаксиса. Отсутствие той или иной формы в данном документе отнюдь не означает, что она предназначена для нарушения работы компьютерной программы, а некорректный формат не обязательно ведет к потере данных в любой реализации. Устойчивость реализации к ошибкам обеспечивается самой реализацией.</p><p>Важное различие между устаревшим (интерпретация) и современным (генерация) синтаксисом заключается в том, что структурированные поля заголовков (т. е., текст между двоеточием и завершающей строку последовательностью CRLF) могут содержать пробелы (включая фальцовочные) и комментарии между любыми лексемами. Это позволяет создавать множество сложных форм, разбор которых может оказаться затруднительным для некоторых реализаций.</p><p>Другим ключевым различием между устаревшим и современным синтаксисом является правило, приведенное в параграфе 3.2.2 и запрещающее включение фальцовочных символов в строки, содержащие только пробелы в комментарии (см. обсуждение фальцовочных пробелов в параграфе 4.2).</p><p>В этом разделе также рассматриваются некоторые символы, которые раньше разрешалось использовать в сообщениях. Символ NUL (код ASCII - 0) считался разрешенным, но сейчас к таковым не относится. Аналогично, управляющие символы US-ASCII, отличные от CR, LF, SP и HTAB (коды ASCII от 1 до 8, 11, 12, 14 - 31 и 127) разрешалось использовать в полях заголовков. Символы CR и LF разрешалось использовать в сообщениях не только в форме последовательности CRLF; такое использование также рассматривается здесь.</p><p>Остальные различия в синтаксисе и семантике рассматриваются в соответствующих подпараграфах.</p><h3 id="p4.1">4.1. Прочие устаревшие маркеры</h3><p>Описанные здесь синтаксические элементы используются в устаревшем или основном синтаксисе. Отдельные символы CR, LF и NUL добавлены в obs-qp, obs-body и obs-unstruct. Управляющие символы US-ASCII добавлены в obs-qp, obs-unstruct, obs-ctext и obs-qtext. Символ точки (.) добавлен в obs-phrase. Поддерживается лексема obs-phrase-list для (возможно пустых) списков разделенных запятыми фраз, которые могут включать «пустые» элементы. Т. е., в таком списке могут быть две и более запятых, между которыми не содержится ничего; возможны также запятые в начале и в конце списка.</p><pre>obs-NO-WS-CTL   =   %d1-8 /            ; Управляющие символы US-ASCII,
                    %d11 /             ; не включая символов
                    %d12 /             ; возврата картеки,
                    %d14-31 /          ; перевода строки и
                    %d127              ; пробельных символов

obs-ctext       =   obs-NO-WS-CTL

obs-qtext       =   obs-NO-WS-CTL

obs-utext       =   %d0 / obs-NO-WS-CTL / VCHAR

obs-qp          =   "\" (%d0 / obs-NO-WS-CTL / LF / CR)

obs-body        =   *((*LF *CR *((%d0 / text) *LF *CR)) / CRLF)

obs-unstruct    =   *((*LF *CR *(obs-utext *LF *CR)) / FWS)

obs-phrase      =   word *(word / "." / CFWS)

obs-phrase-list =   [phrase / CFWS] *("," [phrase / CFWS])</pre><p>Отдельные символы CR и LF, появляющиеся в сообщениях, могут иметь двоякий смысл. Во многих случаях одиночные символы CR или LF некорректно используются вместо CRLF для индикации завершения строк. В остальных случаях одиночные символы CR и LF просто используются в качестве управляющих символов US-ASCII в традиционном их смысле.</p><h3 id="p4.2">4.2. Устаревшие пробелы для фальцовки</h3><p>В устаревшем синтаксисе можно включать любое количество фальцовочных пробелов в тех случаях, когда разрешено правило obs-FWS. Это позволяет включить в строку две фальцовки подряд и, следовательно, делает возможными строки в заголовках полей, содержащие только пробельные символы.</p><pre>obs-FWS         =   1*WSP *(CRLF 1*WSP)</pre><h3 id="p4.3">4.3. Устаревшие форматы даты и времени</h3><p>Устаревший сиснтаксис для полей даты допускает использование 2 цифр для указания года, а также разрешает буквенные обозначения часовых поясов, которые использовались в ранних версиях спецификации. Этот синтаксис также позволяет включение комментариев и фальцовочных пробелов между большинством лексем.</p><pre>obs-day-of-week =   [CFWS] day-name [CFWS]

obs-day         =   [CFWS] 1*2DIGIT [CFWS]

obs-year        =   [CFWS] 2*DIGIT [CFWS]

obs-hour        =   [CFWS] 2DIGIT [CFWS]

obs-minute      =   [CFWS] 2DIGIT [CFWS]

obs-second      =   [CFWS] 2DIGIT [CFWS]

obs-zone        =   "UT" / "GMT" /     ; Смещение от UT для Северной Америки
                    "EST" / "EDT" /    ; восток:  - 5/ - 4
                    "CST" / "CDT" /    ; центр:  - 6/ - 5
                    "MST" / "MDT" /    ; горы: - 7/ - 6
                    "PST" / "PDT" /    ; тихоокеанское побережье:  - 8/ - 7
                                       ;
                    %d65-73 /          ; Военные часовые пояса — от A
                    %d75-90 /          ; до I и от K
                    %d97-105 /         ; до Z,
                    %d107-122          ; в верхнем и нижнем регистре</pre><p>При использовании 2 или трех цифр в поле года интерпретация выполняется следующим образом — если 2-значное обозначение года лежит в диапазоне от 00 до 49, к значению прибавляется 2000, т. е., год принимает значение от 2000 до 2049; если 2-значное обозначение года лежит в диапазоне от 50 до 99, к значению прибавляется 1900.</p><p>У устаревших часовых поясах идентификаторы «UT» и «GMT» указывают на «универсальное время» и «время по Гринвичу», соответственно; оба значения семантически эквивалентны «+0000».</p><p>Оставшиеся три символа часового пояса являются обозначениями часовых поясов США. Первая буква («E», «C», «M» или «P») означает «Eastern» (восточный), «Central» (центральный), «Mountain» (горный) и «Pacific» (тихоокеанский). Вторая буква может быть «S» (Standard — стандартное время) или «D» (Daylight Savings — летнее время).</p><p>Ниже приводится интерпретация используемых значений.</p><ul><li>EDT семантически эквивалентно -0400</li><li>EST семантически эквивалентно -0500</li><li>CDT семантически эквивалентно -0500</li><li>CST семантически эквивалентно -0600</li><li>MDT семантически эквивалентно -0600</li><li>MST семантически эквивалентно -0700</li><li>PDT семантически эквивалентно -0700</li><li>PST семантически эквивалентно -0800</li></ul><p>Один символ военного часового пояса был определен нестандартным способом в [RFC0822] и, следовательно, его значение непредсказуемо. Исходные определения военных часовых поясов от «A» до «I» эквивалентны поясам от «+0100» до «+0900», соответственно; «K», «L» и «M» эквивалентны «+1000», «+1100» и «+1200», соответственно; «N» — «Y» эквивалентны поясам от «-0100» до «-1200», соответственно; «Z» эквивалентно «+0000». Однако в результате ошибки в [RFC0822] все эти обозначения следует трактовать, как эквивалентные «-0000» если явно не задано иное их толкование.</p><p>В почтовых сообщениях Internet применяются и другие многосимвольные (обычно от 3 до 5 букв) обозначения часовых поясов. Все обозначения, смысл которых непонятен, следует трактовать, как эквивелент «-0000» если явно не указано иное их толкование.</p><h3 id="p4.4">4.4. Устаревшая адресация</h3><p>В адресации имеется четыре основных различия. Во-первых, в адресе почтового ящика разрешалось использовать перед addr-spec маршрутную часть, заключенную в угловые скобки. Маршрут является просто списком разделенных запятыми доменных имен, каждое из которых имеет префикс «@»; для завершения списка используется двоеточие (:). Во-вторых, разрешалось включать символы CFWS между разделенными точками элементами локальной части и домена (т. е., лексема dot-atom не использовалась). Кроме того, в local-part можно было в дополнение к атомам включать строки в кавычках. В-третьих, разрешалось включать в списки почтовых ящиков (mailbox-list) и списки адресов (address-list) пустые (null) элементы. Т. е., в списке могли следовать две или более запятых подряд, а также разрешалось присутствие запятых в начале и в конце списков. В-четвертых, разрешалось использовать управляющие символы US-ASCII и пары с квотированием в доменных литералах.</p><pre>obs-angle-addr  =   [CFWS] "&lt;" obs-route addr-spec "&gt;" [CFWS]

obs-route       =   obs-domain-list ":"

obs-domain-list =   *(CFWS / ",") "@" domain
                    *("," [CFWS] ["@" domain])

obs-mbox-list   =   *([CFWS] ",") mailbox *("," [mailbox / CFWS])

obs-addr-list   =   *([CFWS] ",") address *("," [address / CFWS])

obs-group-list  =   1*([CFWS] ",") [CFWS]

obs-local-part  =   word *("." word)

obs-domain      =   atom *("." atom)

obs-dtext       =   obs-NO-WS-CTL / quoted-pair</pre><p>При интерпретации адресов маршрутную часть следует игнорировать.</p><h3 id="p4.5">4.5. Устаревшие поля заголовков</h3><p>Синтаксически, основным различием является то, что устаревший синтаксис полей разрешал многократное включение любых полей в произвольном порядке. Кроме того, устаревший синтаксис разрешает включать любое количество пробелов перед двоеточием в конце имени поля.</p><pre>obs-fields      =   *(obs-return /
                    obs-received /
                    obs-orig-date /
                    obs-from /
                    obs-sender /
                    obs-reply-to /
                    obs-to /
                    obs-cc /
                    obs-bcc /
                    obs-message-id /
                    obs-in-reply-to /
                    obs-references /
                    obs-subject /
                    obs-comments /
                    obs-keywords /
                    obs-resent-date /
                    obs-resent-from /
                    obs-resent-send /
                    obs-resent-rply /
                    obs-resent-to /
                    obs-resent-cc /
                    obs-resent-bcc /
                    obs-resent-mid /
                    obs-optional)</pre><p>За исключением поля адреса получателя (см. параграф 4.5.3) интерпретация множественного вхождения полей не специфицирована. Также нет спецификации для интерпретации полей трассировки и пересылки, которые не располагаются в блоке, предшествующем сообщению. Если в следующих подпараграфах явно не указано иное, интерпретация таких полей происходит идентично интерпретации подобных полей современного синтаксиса, описанных в разделе 3.</p><h4 id="p4.5.1">4.5.1. Устаревшее поле даты создания</h4><pre>obs-orig-date   =   "Date" *WSP ":" date-time CRLF</pre><h4 id="p4.5.2">4.5.2. Устаревшие поля отправителя</h4><pre>obs-from        =   "From" *WSP ":" mailbox-list CRLF

obs-sender      =   "Sender" *WSP ":" mailbox CRLF

obs-reply-to    =   "Reply-To" *WSP ":" address-list CRLF</pre><h4 id="p4.5.3">4.5.3. Устаревшие поля адресов получателей</h4><pre>obs-to          =   "To" *WSP ":" address-list CRLF

obs-cc          =   "Cc" *WSP ":" address-list CRLF

obs-bcc         =   "Bcc" *WSP ":"
                 (address-list / (*([CFWS] ",") [CFWS])) CRLF</pre><p>При наличии в сообщении множества полей с адресом получателя их следует трактовать, как объединение адресного списка из первого поля с адресными списками из последующих полей путем добавления запятых и конкатенации строк.</p><h4 id="p4.5.4">4.5.4. Устаревшие поля идентификации</h4><p>Устаревшие поля «In-Reply-To:» и «References:» отличаются от современного синтаксиса тем, что в них допускается включение фраз (слова или строки в кавычках). Устаревшие формы ревой и правой сторон msg-id разрешают промежуточные CFWS, что делает эти части синтаксически эквивалентными local-part и domain, соответственно.</p><pre>obs-message-id  =   "Message-ID" *WSP ":" msg-id CRLF

obs-in-reply-to =   "In-Reply-To" *WSP ":" *(phrase / msg-id) CRLF

obs-references  =   "References" *WSP ":" *(phrase / msg-id) CRLF

obs-id-left     =   local-part

obs-id-right    =   domain</pre><p>При интерпретации фразы в полях «In-Reply-To:» и «References:» игнорируются.</p><p>Семантически, ни один из дополнительных символов CFWS в local-part и domain не является частью obs-id-left и obs-id-right, соответственно.</p><h4 id="p4.5.5">4.5.5. Устаревшие информационные поля</h4><pre>obs-subject     =   "Subject" *WSP ":" unstructured CRLF

obs-comments    =   "Comments" *WSP ":" unstructured CRLF

obs-keywords    =   "Keywords" *WSP ":" obs-phrase-list CRLF</pre><h4 id="p4.5.6">4.5.6. Устаревшие поля пересылки</h4><p>В устаревшем синтаксисе имеется поле «Resent-Reply-To:», которое состоит из имени поля, необязательных комментариев и фальцовочных пробелов, двоеточия и списка разделенных запятыми адресов.</p><pre>obs-resent-from =   "Resent-From" *WSP ":" mailbox-list CRLF

obs-resent-send =   "Resent-Sender" *WSP ":" mailbox CRLF

obs-resent-date =   "Resent-Date" *WSP ":" date-time CRLF

obs-resent-to   =   "Resent-To" *WSP ":" address-list CRLF

obs-resent-cc   =   "Resent-Cc" *WSP ":" address-list CRLF

obs-resent-bcc  =   "Resent-Bcc" *WSP ":"
                    (address-list / (*([CFWS] ",") [CFWS])) CRLF

obs-resent-mid  =   "Resent-Message-ID" *WSP ":" msg-id CRLF

obs-resent-rply =   "Resent-Reply-To" *WSP ":" address-list CRLF</pre><p>Как и остальные поля пересылки, поле «Resent-Reply-To:» трактуется исключительно, как информационное.</p><h4 id="p4.5.7">4.5.7. Устаревшие поля трассировки</h4><p>Поля obs-return и obs-received приведены здесь, как шаблоны определений, идентичные return и received в разделе 3. Полный синтаксис описан в [RFC5321].</p><pre>obs-return      =   "Return-Path" *WSP ":" path CRLF

obs-received    =   "Received" *WSP ":" *received-token CRLF</pre><h4 id="p4.5.8">4.5.8. Устаревшие дополнительные поля</h4><pre>obs-optional    =   field-name *WSP ":" unstructured CRLF</pre><h2 id="p5">5. Вопросы безопасности</h2><p>Требуются определенные меры предосторожности при отображении сообщений на терминале или в программе эмуляции терминала. Многофункциональные терминалы могут реагировать на escape-последовательности и другие комбинации управляющих символов US-ASCII, что может вызывать неожиданные эффекты. В число таких эффектов может входить изменение клавиатурной раскладки и другие эффекты, способные приводить к нарушению работы и даже к повреждению данных. Управляющие символы могут вызывать (иногда программируемо) генерацию ответов на сообщения, что позволяет вводить команды от имени пользователя. Возможно также воздействие на подключенные к терминалу устройства (например, принтеры). Программы просмотра сообщений могут по своему усмотрению удалить опасные escape-последовательности из сообщения перед его выводом. Однако некоторые escape-последовательности могут быть нужны в сообщениях (см. [ISO.2022.1994], [RFC2045], [RFC2046], [RFC2047], [RFC2049], [RFC4288], [RFC4289]) и поэтому не следует удалять escape-последовательности без разбора.</p><p>Передача отличных от текста объектов в сообщениях может приводить к возникновению дополнительных опасностей. Рассмотрению таких вопросов посвящены документы [RFC2045], [RFC2046], [RFC2047], [RFC2049], [RFC4288] и [RFC4289].</p><p>Многие реализации используют поле «Bcc:» (последний экземпляр), описанное в параграфе 3.6.3, для доставки сообщений некоторым получателям без ведома других адресатов этого сообщения. Некорректная обработка полей «Bcc:» может привоодить к утечке конфиденциальной информации, что, в свою очередь, может снижать уровень безопасности за счет распространения информации о существовании определенных почтовых адресов. Например, при использовании первого метода, описанного в параграфе 3.6.3, когда строка «Bcc:» удаляется из сообщения, скрытые получатели не имеют явного указания на то, что они были скрыты от других адресатов (за исключением того факта, что их адреса отсутствуют в заголовке сообщения). По этой причине кто-либо из скрытых получателей сообщения может отправить свой ответ всем показанным в заголовке получателям и непреднамеренно показать, что часть адресатов сообщения была скрыта. При использовании второго метода скрытые адресаты указываются в поле «Bcc:» отдельной копии сообщения. Если поле «Bcc:» содержит все скрытые адреса, получатели узнают о других скрытых адресатах. Даже при создании отдельного поля «Bcc:» для каждого скрытого адресата, реализациям следует с осторожностью относиться к обработке ответов на такие сообщения, как указано в параграфе 3.6.3, во избежание непреднамеренного распространения информации о скрытых получателях сообщения другим адресатам.</p><h2 id="p6">6. Согласование с IANA</h2><p>Этот документ обновляет регистрации, перечисленные в [RFC4021], которые относятся к определениям из [RFC2822]. Агентство IANA обновило реестр Permanent Message Header Field Repository, включив в него в соответствии с [RFC3864] перечисленные ниже поля заголовков.</p><table class="nobrd"><tr><td>Имя поля:</td><td>Date</td></tr><tr><td>Применимый протокол:</td><td>Mail</td></tr><tr><td>Состояние:</td><td>стандарт</td></tr><tr><td>Автор/контроль изменений:</td><td>IETF</td></tr><tr><td>Спецификация:</td><td>Данный документ (параграф 3.6.1)</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>Имя поля:</td><td>From</td></tr><tr><td>Применимый протокол:</td><td>Mail</td></tr><tr><td>Состояние:</td><td>стандарт</td></tr><tr><td>Автор/контроль изменений:</td><td>IETF</td></tr><tr><td>Спецификация:</td><td>Данный документ (параграф 3.6.2)</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>Имя поля:</td><td>Sender</td></tr><tr><td>Применимый протокол:</td><td>Mail</td></tr><tr><td>Состояние:</td><td>стандарт</td></tr><tr><td>Автор/контроль изменений:</td><td>IETF</td></tr><tr><td>Спецификация:</td><td>Данный документ (параграф 3.6.2)</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>Имя поля:</td><td>Reply-To</td></tr><tr><td>Применимый протокол:</td><td>Mail</td></tr><tr><td>Состояние:</td><td>стандарт</td></tr><tr><td>Автор/контроль изменений:</td><td>IETF</td></tr><tr><td>Спецификация:</td><td>Данный документ (параграф 3.6.2)</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>Имя поля:</td><td>To</td></tr><tr><td>Применимый протокол:</td><td>Mail</td></tr><tr><td>Состояние:</td><td>стандарт</td></tr><tr><td>Автор/контроль изменений:</td><td>IETF</td></tr><tr><td>Спецификация:</td><td>Данный документ (параграф 3.6.3)</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>Имя поля:</td><td>Cc</td></tr><tr><td>Применимый протокол:</td><td>Mail</td></tr><tr><td>Состояние:</td><td>стандарт</td></tr><tr><td>Автор/контроль изменений:</td><td>IETF</td></tr><tr><td>Спецификация:</td><td>Данный документ (параграф 3.6.3)</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>Имя поля:</td><td>Bcc</td></tr><tr><td>Применимый протокол:</td><td>Mail</td></tr><tr><td>Состояние:</td><td>стандарт</td></tr><tr><td>Автор/контроль изменений:</td><td>IETF</td></tr><tr><td>Спецификация:</td><td>Данный документ (параграф 3.6.3)</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>Имя поля:</td><td>Message-ID</td></tr><tr><td>Применимый протокол:</td><td>Mail</td></tr><tr><td>Состояние:</td><td>стандарт</td></tr><tr><td>Автор/контроль изменений:</td><td>IETF</td></tr><tr><td>Спецификация:</td><td>Данный документ (параграф 3.6.4)</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>Имя поля:</td><td>In-Reply-To</td></tr><tr><td>Применимый протокол:</td><td>Mail</td></tr><tr><td>Состояние:</td><td>стандарт</td></tr><tr><td>Автор/контроль изменений:</td><td>IETF</td></tr><tr><td>Спецификация:</td><td>Данный документ (параграф 3.6.4)</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>Имя поля:</td><td>References</td></tr><tr><td>Применимый протокол:</td><td>Mail</td></tr><tr><td>Состояние:</td><td>стандарт</td></tr><tr><td>Автор/контроль изменений:</td><td>IETF</td></tr><tr><td>Спецификация:</td><td>Данный документ (параграф 3.6.4)</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>Имя поля:</td><td>Subject</td></tr><tr><td>Применимый протокол:</td><td>Mail</td></tr><tr><td>Состояние:</td><td>стандарт</td></tr><tr><td>Автор/контроль изменений:</td><td>IETF</td></tr><tr><td>Спецификация:</td><td>Данный документ (параграф 3.6.5)</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>Имя поля:</td><td>Comments</td></tr><tr><td>Применимый протокол:</td><td>Mail</td></tr><tr><td>Состояние:</td><td>стандарт</td></tr><tr><td>Автор/контроль изменений:</td><td>IETF</td></tr><tr><td>Спецификация:</td><td>Данный документ (параграф 3.6.5)</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>Имя поля:</td><td>Keywords</td></tr><tr><td>Применимый протокол:</td><td>Mail</td></tr><tr><td>Состояние:</td><td>стандарт</td></tr><tr><td>Автор/контроль изменений:</td><td>IETF</td></tr><tr><td>Спецификация:</td><td>Данный документ (параграф 3.6.5)</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>Имя поля:</td><td>Resent-Date</td></tr><tr><td>Применимый протокол:</td><td>Mail</td></tr><tr><td>Состояние:</td><td>стандарт</td></tr><tr><td>Автор/контроль изменений:</td><td>IETF</td></tr><tr><td>Спецификация:</td><td>Данный документ (параграф 3.6.6)</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>Имя поля:</td><td>Resent-From</td></tr><tr><td>Применимый протокол:</td><td>Mail</td></tr><tr><td>Состояние:</td><td>стандарт</td></tr><tr><td>Автор/контроль изменений:</td><td>IETF</td></tr><tr><td>Спецификация:</td><td>Данный документ (параграф 3.6.6)</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>Имя поля:</td><td>Resent-Sender</td></tr><tr><td>Применимый протокол:</td><td>Mail</td></tr><tr><td>Состояние:</td><td>стандарт</td></tr><tr><td>Автор/контроль изменений:</td><td>IETF</td></tr><tr><td>Спецификация:</td><td>Данный документ (параграф 3.6.6)</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>Имя поля:</td><td>Resent-To</td></tr><tr><td>Применимый протокол:</td><td>Mail</td></tr><tr><td>Состояние:</td><td>стандарт</td></tr><tr><td>Автор/контроль изменений:</td><td>IETF</td></tr><tr><td>Спецификация:</td><td>Данный документ (параграф 3.6.6)</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>Имя поля:</td><td>Resent-Cc</td></tr><tr><td>Применимый протокол:</td><td>Mail</td></tr><tr><td>Состояние:</td><td>стандарт</td></tr><tr><td>Автор/контроль изменений:</td><td>IETF</td></tr><tr><td>Спецификация:</td><td>Данный документ (параграф 3.6.6)</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>Имя поля:</td><td>Resent-Bcc</td></tr><tr><td>Применимый протокол:</td><td>Mail</td></tr><tr><td>Состояние:</td><td>стандарт</td></tr><tr><td>Автор/контроль изменений:</td><td>IETF</td></tr><tr><td>Спецификация:</td><td>Данный документ (параграф 3.6.6)</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>Имя поля:</td><td>Resent-Reply-To</td></tr><tr><td>Применимый протокол:</td><td>Mail</td></tr><tr><td>Состояние:</td><td>устарел</td></tr><tr><td>Автор/контроль изменений:</td><td>IETF</td></tr><tr><td>Спецификация:</td><td>Данный документ (параграф 4.5.6)</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>Имя поля:</td><td>Resent-Message-ID</td></tr><tr><td>Применимый протокол:</td><td>Mail</td></tr><tr><td>Состояние:</td><td>стандарт</td></tr><tr><td>Автор/контроль изменений:</td><td>IETF</td></tr><tr><td>Спецификация:</td><td>Данный документ (параграф 3.6.6)</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>Имя поля:</td><td>Return-Path</td></tr><tr><td>Применимый протокол:</td><td>Mail</td></tr><tr><td>Состояние:</td><td>стандарт</td></tr><tr><td>Автор/контроль изменений:</td><td>IETF</td></tr><tr><td>Спецификация:</td><td>Данный документ (параграф 3.6.7)</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td>Имя поля:</td><td>Received</td></tr><tr><td>Применимый протокол:</td><td>Mail</td></tr><tr><td>Состояние:</td><td>стандарт</td></tr><tr><td>Автор/контроль изменений:</td><td>IETF</td></tr><tr><td>Спецификация:</td><td>Данный документ (параграф 3.6.7)Дополнительная информация: [RFC5321]</td></tr></table><h2 id="p.appendix.a">Приложение A. Примеры сообщений</h2><p>В этом разделе представлены различные примеры сообщений. Примеры предназначены для оказания помощи разработчикам при реализации данной спецификации, но их не следует воспринимать как нормативы. Хотя примеры в этом разделе подобраны аккуратно, при возникновении противоречий между примером и текстом раздела 3 или 4 данного документа, предпочтение должно отдаваться спецификации, а не примеру.</p><p>Примеры сообщений отделены от текста строками «----», которые не являются частью сообщений.</p><h3 id="p.appendix.a1">Приложение A.1. Примеры адресации</h3><p>В этом параграфе приведены примеры сообщений, которыми могут обмениваться два индивидуальных адресата.</p><h4 id="p.appendix.a1.1">Приложение A.1.1. Сообщение от одного лица другому с простой адресацией</h4><p>Этот пример можно назвать каноническим сообщением. Письмо имеет одного автора (John Doe), одного получателя (Mary Smith), тему, дату, идентификатор сообщения и текст в теле письма.</p><pre>----
From: John Doe &lt;jdoe@machine.example&gt;
To: Mary Smith &lt;mary@example.net&gt;
Subject: Saying Hello
Date: Fri, 21 Nov 1997 09:55:06 -0600
Message-ID: &lt;1234@local.machine.example&gt;

This is a message just to say hello.
So, "Hello".
----</pre><p>Если у John есть секретарь Michael, который на самом деле отправляет сообщение, автором которого является по-прежнему John и ответы на письмо должны направляться секретарю, следует использовать поле sender:</p><pre>----
From: John Doe &lt;jdoe@machine.example&gt;
Sender: Michael Jones &lt;mjones@machine.example&gt;
To: Mary Smith &lt;mary@example.net&gt;
Subject: Saying Hello
Date: Fri, 21 Nov 1997 09:55:06 -0600
Message-ID: &lt;1234@local.machine.example&gt;

This is a message just to say hello.
So, "Hello".
----</pre><h4 id="p.appendix.a1.2">Приложение A.1.2. Различные типы почтовых ящиков</h4><p>Это сообщение содержит множество адресов в полях получателей и использует иной формат адресов.</p><pre>----
From: &quot;Joe Q. Public&quot; &lt;john.q.public@example.com&gt;
To: Mary Smith &lt;mary@x.test&gt;, jdoe@example.org, Who? &lt;one@y.test&gt;
Cc: &lt;boss@nil.test&gt;, &quot;Giant; \&quot;Big\&quot; Box&quot; &lt;sysservices@example.net&gt;
Date: Tue, 1 Jul 2003 10:52:37 +0200
Message-ID: &lt;5678.21-Nov-1997@example.com&gt;

Hi everyone.
----</pre><p>Отметим, что отображаемые имена Joe Q. Public и Giant; "Big" Box требуется заключать в двойные кавычки, поскольку первое имя включает точку, а во втором содержится точка с запятой и символы двойных кавычек (в форме пар с квотированием). Отображаемое имя Who?, напротив, может использоваться без кавычек, поскольку в атомах допускается использование вопросительного знака. Отметим также, что в адресах jdoe@example.org и boss@nil.test не указаны связанные с ними отображаемые имена, а для адреса jdoe@example.org используется упрощенная форма без угловых скобок.</p><h4 id="p.appendix.a1.3">Приложение A.1.3. Групповые адреса</h4><pre>----
From: Pete &lt;pete@silly.example&gt;
To: A Group:Ed Jones &lt;c@a.test&gt;,joe@where.test,John &lt;jdoe@one.test&gt;;
Cc: Undisclosed recipients:;
Date: Thu, 13 Feb 1969 23:32:54 -0330
Message-ID: &lt;testabcd.1234@silly.example&gt;

Testing.
----</pre><p>В этом примере поле «To:» включает группу «A Group», в состав которой входят 3 адреса, а в поле «Cc:» указана пустая группы получателей Undisclosed recipients (нераскрытые получатели).</p><h3 id="p.appendix.a2">Приложение A.2. Ответные сообщения</h3><p>Следующая группа из трех примеров показывает поток обмена сообщениями между John и Mary. Сначала John отправляет сообщение Mary, на которое Mary отвечает и John в ответ отправляет письмо Mary.</p><p>Отметим специально поля «Message-ID:», «References:» и «In-Reply-To:» в каждом сообщении.</p><pre>----
From: John Doe &lt;jdoe@machine.example&gt;
To: Mary Smith &lt;mary@example.net&gt;
Subject: Saying Hello
Date: Fri, 21 Nov 1997 09:55:06 -0600
Message-ID: &lt;1234@local.machine.example&gt;

This is a message just to say hello.
So, "Hello".
----</pre><p>При отправке ответов поле Subject зачастую сохраняется с добавлением префикса «Re: », как описано в параграфе 3.6.5.</p><pre>----
From: Mary Smith &lt;mary@example.net&gt;
To: John Doe &lt;jdoe@machine.example&gt;
Reply-To: &quot;Mary Smith: Personal Account&quot; &lt;smith@home.example&gt;
Subject: Re: Saying Hello
Date: Fri, 21 Nov 1997 10:01:10 -0600
Message-ID: &lt;3456@example.net&gt;
In-Reply-To: &lt;1234@local.machine.example&gt;
References: &lt;1234@local.machine.example&gt;

This is a reply to your hello.
----</pre><p>Отметим поле «Reply-To:» в приведенном выше сообщении. Когда John отвечает на приведенное выше письмо Mary, ответ следует направлять по адресу из поля «Reply-To:», а не по адресу из поля «From:».</p><pre>----
To: &quot;Mary Smith: Personal Account&quot; &lt;smith@home.example&gt;
From: John Doe &lt;jdoe@machine.example&gt;
Subject: Re: Saying Hello
Date: Fri, 21 Nov 1997 11:00:00 -0600
Message-ID: &lt;abcd.1234@local.machine.test&gt;
In-Reply-To: &lt;3456@example.net&gt;
References: &lt;1234@local.machine.example&gt; &lt;3456@example.net&gt;

This is a reply to your reply.
----</pre><h3 id="p.appendix.a3">Приложение A.3. Пересылка сообщений</h3><p>Начнем с сообщения, которое будет использоваться в качестве примера несколько раз:</p><pre>----
From: John Doe &lt;jdoe@machine.example&gt;
To: Mary Smith &lt;mary@example.net&gt;
Subject: Saying Hello
Date: Fri, 21 Nov 1997 09:55:06 -0600
Message-ID: &lt;1234@local.machine.example&gt;

This is a message just to say hello.
So, "Hello".
----</pre><p>Mary, получив это сообщение, хочет отправить копию Jane так, что (a) сообщение выглядит, как отправленное John; (b) если Jane ответит на это сообщение, ответ должен быть отправлен John; (c) вся исходная информация, включая дату письма, изначално посланного Mary, идентификатор сообщения и исходный адрес сохраняется. В этом случае в начало сообщения добавляются поля пересылки:</p><pre>----
Resent-From: Mary Smith &lt;mary@example.net&gt;
Resent-To: Jane Brown &lt;j-brown@other.example&gt;
Resent-Date: Mon, 24 Nov 1997 14:22:01 -0800
Resent-Message-ID: &lt;78910@example.net&gt;
From: John Doe &lt;jdoe@machine.example&gt;
To: Mary Smith &lt;mary@example.net&gt;
Subject: Saying Hello
Date: Fri, 21 Nov 1997 09:55:06 -0600
Message-ID: &lt;1234@local.machine.example&gt;

This is a message just to say hello.
So, "Hello".
----</pre><p>Если Jane, в свою очередь, решит переслать сообщение еще кому-либо, она будет добавлять свои поля пересылки перед сообщением, показанным выше (для краткости этот вариант примера опущен).</p><h3 id="p.appendix.a4">Приложение A.4. Сообщения с полями трассировки</h3><p>При пересылке сообщения через транспортную систему, как описано в [RFC5321], в начало сообщения добавляются трассировочные поля. Ниже приведен пример, показывающий, как могут выглядеть эти поля. Отметим, что первая строка «Received:» оказалась слишком длинной и в нее включены фальцовочные пробелы.</p><pre>----
Received: from x.y.test
   by example.net
   via TCP
   with ESMTP
   id ABC12345
   for &lt;mary@example.net&gt;;  21 Nov 1997 10:05:43 -0600
Received: from node.example by x.y.test; 21 Nov 1997 10:01:22 -0600
From: John Doe &lt;jdoe@node.example&gt;
To: Mary Smith &lt;mary@example.net&gt;
Subject: Saying Hello
Date: Fri, 21 Nov 1997 09:55:06 -0600
Message-ID: &lt;1234@local.node.example&gt;

This is a message just to say hello.
So, "Hello".
----</pre><h3 id="p.appendix.a5">Приложение A.5. Пробелы, комментарии и другие странности</h3><p>Пробеля, включая фальцовочные, и комментарии могут вставляться между разными элементами поля. Возьмем пример из параграфа A.1.3 и добавим в него пробелы и комментарии в полях заголовка.</p><pre>----
From: Pete(A nice \) chap) &lt;pete(his account)@silly.test(his host)&gt;
To:A Group(Some people)
     :Chris Jones &lt;c@(Chris's host.)public.example&gt;,
         joe@example.org,
  John &lt;jdoe@one.test&gt; (my dear friend); (the end of the group)
Cc:(Empty list)(start)Hidden recipients  :(nobody(that I know))  ;
Date: Thu,
      13
        Feb
          1969
      23:32
               -0330 (Newfoundland Time)
Message-ID:              &lt;testabcd.1234@silly.test&gt;

Testing.
----</pre><p>Приведенный пример выглядит странновато, но является совершенно допустимым. Отметим специально (1) комментарий в поле «From:» (включая скобку в паре с квотированием); (2) отсутствие пробела после двоеточия в поле «To:», а также комментарий и фальцовочные пробелы после имени группы, специальный символ (.) в комментарии поля с адресом Chris Jones и фальцовочные пробелы перед и после «joe@example.org,»; (3) множество вложенных комментариев в поле «Cc:», а также комментарий, следующий непосредственно за двоеточием после «Cc»; (4) фальцовочный пробел (но не комментарии, за исключением комментария в конце поля даты), а также отсутствие значения секунд; (5) пробелы после (но не внутри) идентификатора в поле «Message-ID:».</p><h3 id="p.appendix.a6">Приложение A.6. Устаревшие формы</h3><p>Здесь приведены примеры устаревших синтаксических элементов (которые недопустимо создавать), описанных в разделе 4 данного документа.</p><h4 id="p.appendix.a6.1">Приложение A.6.1. Устаревшая адресация</h4><p>Отметим в приведенном ниже примере отсутствие кавычек вокруг Joe Q. Public, маршрут в адресе Mary Smith, две запятых в поле «To:» и пробелы рябом с точкой в адресе jdoe.</p><pre>----
From: Joe Q. Public &lt;john.q.public@example.com&gt;
To: Mary Smith &lt;@node.test:mary@example.net&gt;, , jdoe@test  . example
Date: Tue, 1 Jul 2003 10:52:37 +0200
Message-ID: &lt;5678.21-Nov-1997@example.com&gt;

Hi everyone.
----</pre><h4 id="p.appendix.a6.2">Приложение A.6.2. Устаревшие даты</h4><p>В приведенном ниже сообщении используется устаревший формат даты, включая символьное представление часового пояса и 2-значное обозначение года. Отметим, что отсутствие дня недели не является спецификой устаревшего синтаксиса — это поле является опциональным и в современном синтаксисе.</p><pre>----
From: John Doe &lt;jdoe@machine.example&gt;
To: Mary Smith &lt;mary@example.net&gt;
Subject: Saying Hello
Date: 21 Nov 97 09:55:06 GMT
Message-ID: &lt;1234@local.machine.example&gt;

This is a message just to say hello.
So, "Hello".
----</pre><h4 id="p.appendix.a6.3">Приложение A.6.3. Устаревшие пробелы и комментарии</h4><p>Наличие пробелов и комментариев в устаревшем синтаксисе разрешается в большем числе мест, нежели позволяет современный синтаксис. Однако фальцовочные строки, содержащие только пробелы, по прежнему допускаются.</p><pre>----
From  : John Doe &lt;jdoe@machine(comment).  example&gt;
To    : Mary Smith
__
          &lt;mary@example.net&gt;
Subject     : Saying Hello
Date  : Fri, 21 Nov 1997 09(comment):   55  :  06 -0600
Message-ID  : &lt;1234   @   local(blah)  .machine .example&gt;

This is a message just to say hello.
So, "Hello".
----</pre><p>Особо отметим вторую строку поля «To:», начинающуюся с двух пробельных символов. (отметим, «__» представляет пробелы). Следовательно, это является рассматриваемой частью фальцовки, как описано в параграфе 4.2. Комментарии и пробелы в адресах, датах и идентификаторах сообщений являются частью устаревшего синтаксиса.</p><h2 id="p.appendix.b">Приложение B. Отличия от ранних спецификаций</h2><p>В этом приложении приведен список отличий формата сообщений Internet (IMF) от более ранних спецификаций, в частности [RFC0822], [RFC1123] и [RFC2822]. Элементы, отмеченные в списке звездочкой (*), относятся к описанным в разделе 4 данного документа устаревшим элементам, и в настоящее время они не должны создаваться.</p><p>Ниже перечислены изменения [RFC0822] и [RFC1123], внесенные в [RFC2822] и сохраненные здесь:</p><ol><li>Допускается использование точки в устаревшей форме фраз.</li><li>Описание ABNF исключено из документа (в настоящее время оно содержится в [RFC5234]).</li><li>В поле года разрешается использовать 4 и более цифр.</li><li>Порядок полей заголовка (и отсутствие такового) указан явно.</li><li>Удалено шифрованное поле заголовка.</li><li>Явно разрешено обозначение часового пояса «-0000» и описано его значение.</li><li>Не разрешается использовать фальцовочные пробелы между любыми лексемами.</li><li>Снято требование относительно получателей.</li><li>Заново определены понятия пересылки (forwarding и resending).</li><li>Расширенные поля заголовка больше не вызываются специфически.</li><li>Отменено использование символа ASCII 0 (null).*</li><li>Строки продолжения фальцовки не могут содержать только пробелы.*</li><li>Не разрешается произвольная вставка комментариев в даты.*</li><li>Не разрешаются символьные обозначения часовых поясов.*</li><li>Не разрешается двухзначное представление года.*</li><li>Трехзначное представление года интерпретируется, но не должно использоваться.*</li><li>Не разрешается включать маршруты в адреса.*</li><li>Не разрешается использовать CFWS в локальной и доменной части адреса.*</li><li>Не разрешается использование пустых элементов в списках адресов.*</li><li>Не разрешается использование фальцовочных пробелов между именем поля и двоеточием.*</li><li>Не разрешается использование комментариев между именем поля и двоеточием.</li><li>Более жестко задан синтаксис in-reply-to и references.*</li><li>Не разрешается использование CFWS в msg-id.*</li><li>Семантика полей resent отнесена исключительно к информационной.</li><li>Не разрешается использовать Resent-Reply-To.*</li><li>Не разрешается повторение полей (за исключением resent и received).*</li><li>Не разрешается использование символов CR и LF по-отдельности.*</li><li>Задано ограничение на размер строк.</li><li>Разъяснено назначение поля Bcc.</li></ol><p>Далее перечислены отличия настоящего документа от [RFC2822].</p><ol><li>Исправлены найденные опечатки и приведены разъяснения.</li><li>Термин «стандарт» применительно к данному документу заменен на «документ» или «спецификация».</li><li>Разделены понятия «поле заголовка» (header field) и «раздел заголовков» (header section).</li><li>Удалено NO-WS-CTL из ctext, qtext, dtext и бесструктурных полей.*</li><li>Исправлено обсуждение специальных символов (specials) в параграфе «Atom». Текст перенесен в параграф «3.5. Общий синтаксис сообщений».</li><li>Упрощен синтаксис CFWS.</li><li>Исправлен синтаксис бесструктурных полей.</li><li>Изменен синтаксис полей даты и времени в части пробелов в устаревшем синтаксисе дат.</li><li>Удалены пары с квотированием из доменных литералов и идентификаторов сообщений.*</li><li>Разъяснены ограничения других спецификаций для синтаксиса доменных имен.</li><li>Упрощен синтаксис «Bcc:» и «Resent-Bcc:».</li><li>Разрешено включение дополнительного поля в трассировачную информацию.</li><li>Удалено no-fold-quote из msg-id. Разъяснены синтаксические ограничения.</li><li>Обобщен синтаксис «Received:» для исправления ошибок и удаления определения из данного документа.</li><li>Упрощено obs-qp. Исправлено и обобщено obs-utext (появляется не только в устаревшем синтаксисе). Удалены obs-text и obs-char, добавлено obs-body.</li><li>Исправлен устаревший синтаксис дат, чтобы разрешить больше (или меньше) комментариев и пробелов.</li><li>Исправлен синтаксис всех устаревших списков (obs-domain-list, obs-mbox-list, obs-addr-list, obs-phrase-list и вновь добавленный obs-group-list).</li><li>Исправлен синтаксис obs-reply-to.</li><li>Исправлены obs-bcc и obs-resent-bcc, чтобы разрешить пустые списки.</li><li>Удалено obs-path.</li></ol><h2 id="p.appendix.c">Приложение C. Благодарности</h2><p>В создании этого документа участвовало множество людей. В их число входят участники рабочей группы Detailed Revision and Update of Messaging standards (DRUMS) под эгидой IETF, председатель DRUMS, руководители направления (Area Directors) IETF и все, кто просто присылал свои комментарии по электронной почте. Редактор документа выражает всем этим людям глубокую благодарность и искреннюю признательность. Ниже приведен список всех людей, которые присылали по электронной почте свои комментарии к данному документу и [RFC2822].</p><table class="nobrd"><tr><td>Matti Aarnio</td><td>Tanaka Akira</td><td>Russ Allbery</td></tr><tr><td>Eric Allman</td><td>Harald Alvestrand</td><td>Ran Atkinson</td></tr><tr><td>Jos Backus</td><td>Bruce Balden</td><td>Dave Barr</td></tr><tr><td>Alan Barrett</td><td>John Beck</td><td>J Robert von Behren</td></tr><tr><td>Jos den Bekker</td><td>D J Bernstein</td><td>James Berriman</td></tr><tr><td>Oliver Block</td><td>Norbert Bollow</td><td>Raj Bose</td></tr><tr><td>Antony Bowesman</td><td>Scott Bradner</td><td>Randy Bush</td></tr><tr><td>Tom Byrer</td><td>Bruce Campbell</td><td>Larry Campbell</td></tr><tr><td>W J Carpenter</td><td>Michael Chapman</td><td>Richard Clayton</td></tr><tr><td>Maurizio Codogno</td><td>Jim Conklin</td><td>R Kelley Cook</td></tr><tr><td>Nathan Coulter</td><td>Steve Coya</td><td>Mark Crispin</td></tr><tr><td>Dave Crocker</td><td>Matt Curtin</td><td>Michael D'Errico</td></tr><tr><td>Cyrus Daboo</td><td>Michael D Dean</td><td>Jutta Degener</td></tr><tr><td>Mark Delany</td><td>Steve Dorner</td><td>Harold A Driscoll</td></tr><tr><td>Michael Elkins</td><td>Frank Ellerman</td><td>Robert Elz</td></tr><tr><td>Johnny Eriksson</td><td>Erik E Fair</td><td>Roger Fajman</td></tr><tr><td>Patrik Faeltstroem</td><td>Claus Andre Faerber</td><td>Barry Finkel</td></tr><tr><td>Erik Forsberg</td><td>Chuck Foster</td><td>Paul Fox</td></tr><tr><td>Klaus M Frank</td><td>Ned Freed</td><td>Jochen Friedrich</td></tr><tr><td>Randall C Gellens</td><td>Sukvinder Singh Gill</td><td>Tim Goodwin</td></tr><tr><td>Philip Guenther</td><td>Arnt Gulbrandsen</td><td>Eric A Hall</td></tr><tr><td>Tony Hansen</td><td>John Hawkinson</td><td>Philip Hazel</td></tr><tr><td>Kai Henningsen</td><td>Robert Herriot</td><td>Paul Hethmon</td></tr><tr><td>Jim Hill</td><td>Alfred Hoenes</td><td>Paul E Hoffman</td></tr><tr><td>Steve Hole</td><td>Kari Hurtta</td><td>Marco S Hyman</td></tr><tr><td>Ofer Inbar</td><td>Olle Jarnefors</td><td>Kevin Johnson</td></tr><tr><td>Sudish Joseph</td><td>Maynard Kang</td><td>Prabhat Keni</td></tr><tr><td>John C Klensin</td><td>Graham Klyne</td><td>Brad Knowles</td></tr><tr><td>Shuhei Kobayashi</td><td>Peter Koch</td><td>Dan Kohn</td></tr><tr><td>Christian Kuhtz</td><td>Anand Kumria</td><td>Steen Larsen</td></tr><tr><td>Eliot Lear</td><td>Barry Leiba</td><td>Jay Levitt</td></tr><tr><td>Bruce Lilly</td><td>Lars-Johan Liman</td><td>Charles Lindsey</td></tr><tr><td>Pete Loshin</td><td>Simon Lyall</td><td>Bill Manning</td></tr><tr><td>John Martin</td><td>Mark Martinec</td><td>Larry Masinter</td></tr><tr><td>Denis McKeon</td><td>William P McQuillan</td><td>Alexey Melnikov</td></tr><tr><td>Perry E Metzger</td><td>Steven Miller</td><td>S Moonesamy</td></tr><tr><td>Keith Moore</td><td>John Gardiner Myers</td><td>Chris Newman</td></tr><tr><td>John W Noerenberg</td><td>Eric Norman</td><td>Mike O'Dell</td></tr><tr><td>Larry Osterman</td><td>Paul Overell</td><td>Jacob Palme</td></tr><tr><td>Michael A Patton</td><td>Uzi Paz</td><td>Michael A Quinlan</td></tr><tr><td>Robert Rapplean</td><td>Eric S Raymond</td><td>Sam Roberts</td></tr><tr><td>Hugh Sasse</td><td>Bart Schaefer</td><td>Tom Scola</td></tr><tr><td>Wolfgang Segmuller</td><td>Nick Shelness</td><td>John Stanley</td></tr><tr><td>Einar Stefferud</td><td>Jeff Stephenson</td><td>Bernard Stern</td></tr><tr><td>Peter Sylvester</td><td>Mark Symons</td><td>Eric Thomas</td></tr><tr><td>Lee Thompson</td><td>Karel De Vriendt</td><td>Matthew Wall</td></tr><tr><td>Rolf Weber</td><td>Brent B Welch</td><td>Dan Wing</td></tr><tr><td>Jack De Winter</td><td>Gregory J Woodhouse</td><td>Greg A Woods</td></tr><tr><td>Kazu Yamamoto</td><td>Alain Zahm</td><td>Jamie Zawinski</td></tr><tr><td>Timothy S Zurcher</td><td></td><td></td></tr></table><h2 id="p7">7. Литература</h2><h3 id="p7.1">7.1. Нормативные документы</h3><table itemprop="references"><tr><td>[ANSI.X3-4.1986]</td><td>American National Standards Institute, «Coded Character Set — 7-bit American Standard Code for Information Interchange», ANSI X3.4, 1986.</td></tr><tr><td>[RFC1034]</td><td>Mockapetris, P., «Domain names — concepts and facilities», STD 13, RFC 1034, Ноябрь 1987.</td></tr><tr><td>[RFC1035]</td><td>Mockapetris, P., «Domain names — implementation and specification», STD 13, RFC 1035, Ноябрь 1987.</td></tr><tr><td>[RFC1123]</td><td>Braden, R., <a href="../1123.rfc" title="RFC 1123 - Требования к хостам Internet - Прикладные и служебные протоколы">«Требования к хостам Internet - Прикладные и служебные протоколы», RFC 1123</a>, STD 3, Октябрь 1989</td></tr><tr><td>[RFC2119]</td><td>Bradner, S., «Key words for use in RFCs to Indicate Requirement Levels», BCP 14, RFC 2119, Март 1997.</td></tr><tr><td>[RFC5234]</td><td>Crocker, D. и P. Overell, <a href="../5234.rfc" title="RFC 5234 - Расширенная спецификация синтаксиса Бэкуса-Наура (ABNF)">«Расширенная спецификация синтаксиса Бэкуса-Наура (ABNF)», RFC 5234</a>, STD 68, Январь 2008</td></tr></table><h3 id="p7.2">7.2. Дополнительные ссылки</h3><table itemprop="references"><tr><td>[RFC0822]</td><td>Crocker, D., «Standard for the format of ARPA Internet text messages», STD 11, RFC 822, Август 1982.</td></tr><tr><td>[RFC1305]</td><td>Mills, D., «Network Time Protocol (Version 3) Specification, Implementation», RFC 1305, Март 1992.</td></tr><tr><td>[ISO.2022.1994]</td><td>International Organization for Standardization, «Information technology — Character code structure and extension techniques», ISO Standard 2022, 1994.</td></tr><tr><td>[RFC2045]</td><td>Freed, N. и N. Borenstein, «Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies», RFC 2045, Ноябрь 1996.</td></tr><tr><td>[RFC2046]</td><td>Freed, N. и N. Borenstein, «Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types», RFC 2046, Ноябрь 1996.</td></tr><tr><td>[RFC2047]</td><td>Moore, K., «MIME (Multipurpose Internet Mail Extensions) Part Three: Message Header Extensions for Non-ASCII Text», RFC 2047, Ноябрь 1996.</td></tr><tr><td>[RFC2049]</td><td>Freed, N. и N. Borenstein, «Multipurpose Internet Mail Extensions (MIME) Part Five: Conformance Criteria and Examples», RFC 2049, Ноябрь 1996.</td></tr><tr><td>[RFC2822]</td><td>Resnick, P., «Internet Message Format», RFC 2822, Апрель 2001.</td></tr><tr><td>[RFC3864]</td><td>Klyne, G., Nottingham, M., and J. Mogul, «Registration Procedures for Message Header Fields», BCP 90, RFC 3864, Сентябрь 2004.</td></tr><tr><td>[RFC4021]</td><td>Klyne, G. и J. Palme, «Registration of Mail and MIME Header Fields», RFC 4021, Март 2005.</td></tr><tr><td>[RFC4288]</td><td>Freed, N. и J. Klensin, «Media Type Specifications and Registration Procedures», BCP 13, RFC 4288, Декабрь 2005.</td></tr><tr><td>[RFC4289]</td><td>Freed, N. и J. Klensin, «Multipurpose Internet Mail Extensions (MIME) Part Four: Registration Procedures», BCP 13, RFC 4289, Декабрь 2005.</td></tr><tr><td>[RFC5321]</td><td>Klensin, J., <a href="../5321.rfc" title="RFC 5321 - Простой протокол передачи электронной почты (SMTP)">«Протокол SMTP», RFC 5321</a>, Октябрь 2008.</td></tr></table><h2>Адрес автора</h2><p>Peter W. Resnick (редактор)<br />Qualcomm Incorporated<br />5775 Morehouse Drive<br />San Diego, CA 92121-1714 US<br />Phone: +1 858 651 4478<br />URI: http://www.qualcomm.com/~presnick/<br />EMail: <bdo dir="rtl">&#109;&#111;&#99;&#46;&#109;&#109;&#111;&#99;&#108;&#97;&#117;&#113;&#64;&#107;&#99;&#105;&#110;&#115;&#101;&#114;&#112;</bdo></p></div></div><div id="disqus_thread"></div><script type="text/javascript">var disqus_shortname="rfc2",disqus_title="RFC 5322 - Формат сообщений Internet (IMF)",disqus_identifier="5322.rfc",disqus_url="http://rfc2.ru/5322.rfc";(function(){var dsq=document.createElement("script");dsq.type="text/javascript";dsq.async=true;dsq.src = "//"+disqus_shortname+".disqus.com/embed.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(dsq);})();</script><div class="bubble">2007 - 2014 © <a href="../index.html" title="Русские переводы RFC">Русские переводы RFC</a>, IETF, ISOC.</div></div><div id="bottom" style="position:static !important;bottom:auto !important"><div class="bubble"><ul><li><!--723572853672--></li></ul></div></div><!-- Yandex.Metrika counter --><script type="text/javascript">(function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter4680559 = new Ya.Metrika({id:4680559, webvisor:true, clickmap:true, accurateTrackBounce:true, trackHash:true, ut:"noindex"}); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="http://mc.yandex.ru/watch/4680559?ut=noindex" style="position:absolute; left:-9999px;" alt="" /></div></noscript><!-- /Yandex.Metrika counter --></body></html>