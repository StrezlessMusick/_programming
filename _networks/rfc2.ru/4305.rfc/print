<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8" /><link rel="stylesheet" href="../tpl/style.css@f4e332aa" type="text/css" /><link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css' /><style type="text/css">h1,h2,h3,h4{font-family:'Open Sans',sans-serif}</style><link rel="canonical" href="../4305.rfc" /><meta name="Robots" content="noindex, nofollow" /><title>Перевод RFC 4305 — Требования к реализациям криптографических алгоритмов для ESP и AH</title><link rel="alternate" type="application/rss+xml" title="RFC2.ru - Русские Переводы RFC" href="../rss.xml"></head><body><div id="content"><div id="nav"><div class="icon i0"></div> <a href="../index.html" accesskey="`">На Главную</a></div><div id="search" class="ya-site-form ya-site-form_inited_no"><form action="http://yandex.ru/sitesearch" method="get" target="_blank"><input type="hidden" name="searchid" value="2154295"/><input type="hidden" name="l10n" value="ru"/><input type="hidden" name="reqenc" value=""/><input type="hidden" name="submit" value="Найти"/><input type="search" value="" name="text" placeholder="Поиск по RFC2.ru" /></form></div><div itemscope itemtype="http://schema.org/ScholarlyArticle"><meta itemprop="inLanguage" content="ru" /><meta itemprop="editor" content="ru" /><div id="header"><h1><a itemprop="headline" href="../4305.rfc">RFC 4305 — Требования к реализациям криптографических алгоритмов для ESP и AH</a></h1></div><dl class="mute"><dt></dt><dd><div class="icon i1"></div> RFC: 4305</dd><dd><div class="icon i3"></div> Оригинал: <a href="original" target="_blank"><span itemprop="alternativeHeadline">Cryptographic Algorithm Implementation Requirements for Encapsulating Security Payload (ESP) and Authentication Header (AH)</span></a></dd><dd><div class="icon i7"></div> Другие версии: RFC 1826, RFC 1827, RFC 2402, RFC 2406, <strong class="obsoleted_by">RFC 4835</strong></dd><dd><div class="icon i2"></div> Категория: <span itemprop="articleSection">Предложенный стандарт</span></dd><dd><div class="icon i4"></div> Дата публикации: <time itemprop="datePublished" datetime="2005-12-01">Декабрь 2005</time></dd><dd><div class="icon i5"></div> Автор: <span itemprop="author">D. Eastlake 3rd</span></dd><dd><div class="icon i6"></div> Перевод: <span itemprop="editor">Николай Малых</span></dd></dl><div id="text" itemprop="articleBody"><h3>Статус документа</h3><p>Это документ содержит проект стандарта протокола Internet для сообщества Internet и служит приглашением к дискуссии в целях развития и совершенствования протокола. Текущее состояние стандартизации и статус протокола можно узнать из текущей версии документа "Internet Official Protocol Standards" (STD 1). Допускается свободное распространение документа.</p><h3>Тезисы</h3><p>В серии протоколов IPsec используются различные криптографические алгоритмы для защиты передаваемых через сеть данных. Протоколы ESP и AH обеспечивают два механизма защиты данных при передаче через защищенные связи IPsec SA. Для обеспечения интероперабельности разнородных реализаций требуется задать набор обязательных для реализации алгоритмов, чтобы всем реализациям был доступен по крайней мере один алгоритм. В этом документе определен текущий вариант набора обязательных для реализаций ESP и AH алгоритмов, а также указаны алгоритмы, которые следует реализовать, поскольку они могут стать обязательными в будущем.</p><ul class="list"><li>ESP (Encapsulating Security Payload) - и инкапсуляция защищенных данных.</li><li>AH (Authentication Header) - идентификационный заголовок.</li><li>SA (Security Association) - защищенная связь.</li></ul><h2>Оглавление</h2><ul class="map"><li><a href="print#p1">1. Введение</a></li><li><a href="print#p2">2. Обозначения уровня требований</a></li><li><a href="print#p3">3. Выбор алгоритма</a></li><li class="lia"><a href="print#p3.1">3.1. Encapsulating Security Payload</a></li><li class="lib"><a href="print#p3.1">3.1.1. ESP Encryption and Authentication Algorithms</a></li><li class="lib"><a href="print#p3.1.2">3.1.2. ESP Combined Mode Algorithms</a></li><li class="lia"><a href="print#p3.2">3.2. Authentication Header</a></li><li><a href="print#p4">4. Вопросы безопасности</a></li><li><a href="print#p5">5. Благодарности</a></li><li><a href="print#p6">6. Отличия от RFC 2402 и 2406</a></li><li><a href="print#p7">7. Нормативные документы</a></li><li><a href="print#p8">8. Дополнительная литература</a></li></ul><h2 id="p1">1. Введение</h2><p>Протоколы ESP и AH обеспечивают два механизма защиты данных при передаче через защищенные связи IPsec SA [IPsec, ESP, AH]. Для обеспечения интероперабельности разнородных реализаций требуется задать набор обязательных для реализации алгоритмов, чтобы всем реализациям был доступен по крайней мере один алгоритм. В этом документе определен текущий вариант набора обязательных для реализаций ESP и AH алгоритмов, а также указаны алгоритмы, которые следует реализовать, поскольку они могут стать обязательными в будущем.</p><p>По самой природе криптографии пространство новых алгоритмов и существующие алгоритмы подвергаются непрерывным атакам. Алгоритмы, считающиеся достаточно сильными сегодня, могут завтра обнаружить свои уязвимости. С учетом этого выбирать обязательные для реализации алгоритмы следует достаточно консервативно для снижения вероятности быстрой компрометации выбранных алгоритмов. Следует также принимать во внимание вопросы производительности, поскольку многие приложения IPsec будут использоваться в средах, где производительность важна.</p><p>Наконец, следует признать, что обязательные для реализации алгоритмы нужно менять время от времени с учетом происходящих в мире изменений. По этой причине выбор обязательных для реализации алгоритмов не включен в основные спецификации IPsec, ESP и AH. Вместо этого был создан настоящий документ. При смене алгоритмов достаточно будет обновить только один документ.</p><p>В идеальном случае алгоритмам, которые будут внесены в число обязательных для реализации завтра, уже следует присутствовать в большинстве реализация IPsec на момент придания им статуса обязательных. Для облегчения этого мы будем пытаться идентифицировать такие алгоритмы (поскольку они уже известны) в данном документе. Не существует гарантий того, что указанные алгоритмы станут в будущем обязательными, но они могут ими стать. Все извстные алгоритмы являются объектами атак и использование любого из них может быть прекращено в будущем.</p><h2 id="p2">2. Обозначения уровня требований</h2><p>Ключевые слова необходимо (MUST), недопустимо (MUST NOT), требуется (REQUIRED), нужно (SHALL), не следует (SHALL NOT), следует (SHOULD), не нужно (SHOULD NOT), рекомендуется (RECOMMENDED), возможно (MAY), необязательно (OPTIONAL) в данном документе интерпретируются в соответствии с [RFC2119].</p><p>В этом документе определены также дополнительные уровни требований:</p><ul><li>SHOULD+</li><li class="lib">Этот термин обозначает то же, что и SHOULD. Однако, алгоритм, помеченный как SHOULD+, в будущем перейдет в число обязательных (MUST).</li><li>SHOULD-</li><li class="lib">Этот термин обозначает то же, что и SHOULD. Однако, алгоритм, помеченный как SHOULD-, может перейти на уровень разрешенных (MAY) в будущих версиях этого документа.</li><li>MUST-</li><li class="lib">Этот термин обозначает то же, что и MUST. Однако мы предполагаем, что в какой-то момент этот алгоритм перестанет быть обязательным и может перейти на уровень SHOULD или SHOULD-.</li></ul><h2 id="p3">3. Выбор алгоритма</h2><p>Для того, чтобы реализация IPsec была интероперабельной, она должна поддерживать по крайней мере один алгоритм защиты. В этом разделе приведены требования по реализации алгоритмов защиты для соответствующих спецификации реализаций протоколов ESP и AH. Алгоритмы защиты, реальго используемые любой конкретной защищенной связью ESP или AH, определяются механизмом согласования (таким, как IKE1 [RFC2409, IKEv2]) или задаются заранее.</p><p>Естественно, допускается реализация дополнительных (стандартных или фирменных) алгоритмов, не упомянутых в этом документе.</p><h3 id="p3.1">3.1. Протокол ESP</h3><p>Требования в поддержке алгоритмов защиты для соответствующих спецификации реализаций протокола ESP приведены ниже. Определения уровней требований содержатся в разделе 2.</p><table><tr><td>Требования</td><td>Алгоритм шифрования</td></tr><tr><td>MUST — обязательно</td><td>NULL</td></tr><tr><td>MUST- — обязательно, но может утратить статус</td><td>TripleDES-CBC [RFC2451]</td></tr><tr><td>SHOULD+ — следует, но может стать обязательным</td><td>AES-CBC с ключами размером 128 битов [RFC3602]</td></tr><tr><td>SHOULD — следует</td><td>AES-CTR [RFC3686]</td></tr><tr><td>SHOULD NOT — не следует</td><td>DES-CBC [RFC2405]</td></tr></table><table><tr><td>Требования</td><td>Алгоритм идентификации</td></tr><tr><td>MUST — обязательно</td><td>HMAC-SHA1-96 [RFC2404]</td></tr><tr><td>MUST — обязательно</td><td>NULL</td></tr><tr><td>SHOULD+ — следует, но может стать обязательным</td><td>AES-XCBC-MAC-96 [RFC3566]</td></tr><tr><td>MAY — возможно</td><td>HMAC-MD5-96 [RFC2403]</td></tr></table><h4 id="p3.1.2">3.1.2. Комбинированные алгоритмы для ESP</h4><p>Как указано в [ESP], протокол поддерживает использование комбинированных алгоритмов, которые обеспечивают услуги конфиденциальности и идентификации. Поддержка таких алгоритмов требует соответствующего структурирования реализации ESP. Во многих ситуациях комбинированные алгоритмы обеспечивают значительные преимущества в части эффективности и пропускной способности. Хотя в настоящее время не указывается предлагаемых или обязательных к реализации комбинированных алгоритмов, предполагается, что в ближайшем будущем представит интерес алгоритм AES-CCM [CCM], адаптированный в качестве предпочтительного для IEEE 802.11 [802.11i].</p><h3 id="p3.2">3.2. Протокол AH</h3><p>Ниже приведены требования к реализации алгоритмов защиты в соответствующих спецификации реализациях протокола AH. Описания уровней требования приведены в разделе 2. Как вы понимаете, все перечисленные алгоритмы относятся к числу алгоритмов идентификации.</p><table><tr><td>Требования</td><td>Алгоритм идентификации</td></tr><tr><td>MUST — обязательно</td><td>HMAC-SHA1-96 [RFC2404]</td></tr><tr><td>SHOULD+ — следует, но может стать обязательным</td><td>AES-XCBC-MAC-96 [RFC3566]</td></tr><tr><td>MAY — возможно</td><td>HMAC-MD5-96 [RFC2403]</td></tr></table><h2 id="p4">4. Вопросы безопасности</h2><p>Безопасность криптографически защищенных систем зависит от стойкости выбранных криптографических алгоритмов и используемых этими алгоритмами ключей. Кроме того, безопасность зависит также от устройства и администрирования протокола, используемого системой, чтобы используемые пути обхода криптосистемы не оказывали влияния на безопасность системы в целом.</p><p>Этот документ посвящен выбору криптографических алгоритмов для использования с протоколами ESP и AH и, в частности, обязательных для реализации алгоритмов. Алгоритмы, указнные в этой спецификации, как обязательные (MUST) или рекомендуемые (SHOULD), не имеют в данный момент известных фактов взлома и выполненные криптографические исследования позволяют надеяться, что эти алгоритмы останутся безопасными в обозримом будущем. Однако, такое положение дел не обязательно будет всегда. Мы, следовательно, предполагаем появление новых версий этого документа, отражающих накопленный в сфере защиты опыт.</p><h2 id="p5">5. Благодарности</h2><p>Большая часть приведенного здесь текста была заимствована из <a href="../4307.rfc" title="RFC 4307 - Криптографические алгоритмы для использования с IKEv2">RFC 4307, "Cryptographic Algorithms for Use in the Internet Key Exchange Version 2"</a>, автором которого является Jeffrey I. Schiller.</p><h2 id="p6">6. Отличия от RFC 2402 и 2406</h2><p>[RFC2402] и [RFC2406] определяли протоколы IPsec AH и IPsec ESP. Каждый из этих документов содержал требования к криптографическим алгоритмам для соответствующего протокола. В настоящее время эти спецификации заменены документами [AH] и [ESP], которые не содержат требований к реализации криптографических алгоритмов. В настоящем документе указаны такие требования для обоих протоколов — [AH] и [ESP].</p><p>Сравнение требований приведено ниже.</p><table><tr><td>Старое требование</td><td>Старый RFC</td><td>Новое требование</td><td>Алгоритм</td></tr><tr><td>MUST — требуется</td><td>2406</td><td>SHOULD NOT — не следует</td><td>DES-CBC [RFC2405]</td></tr><tr><td>MUST — требуется</td><td>2402, 2406</td><td>MAY — возможно</td><td>HMAC-MD5-96 [RFC2403]</td></tr><tr><td>MUST — требуется</td><td>2402, 2406</td><td>MUST — требуется</td><td>HMAC-SHA1-96 [RFC2404]</td></tr></table><h2 id="p7">7. Нормативные документы</h2><table itemprop="references"><tr><td>[AH]</td><td>S. Kent, <a href="../4302.rfc" title="RFC 4302 — Идентификационный заголовок IP">«Идентификационный заголовок IP», RFC 4302</a>, Декабрь 2005</td></tr><tr><td>[ESP]</td><td>S. Kent, <a href="../4303.rfc" title="RFC 4303 - Инкапсуляция защищенных данных IP (ESP)">«Инкапсуляция защищенных данных IP (ESP)», RFC 4303</a>, Декабрь 2005.</td></tr><tr><td>[IPsec]</td><td>S. Kent, «Security Architecture for the Internet Protocol», RFC 4301, Декабрь 2005.</td></tr><tr><td>[RFC2119]</td><td>S. Bradner, «Key words for use in RFCs to Indicate Requirement Levels», BCP 14, RFC 2119, Март 1997.</td></tr><tr><td>[RFC2403]</td><td>C. Madson and R. Glenn, «The Use of HMAC-MD5-96 within ESP and AH», RFC 2403, Ноябрь 1998.</td></tr><tr><td>[RFC2404]</td><td>C. Madson and R. Glenn, «The Use of HMAC-SHA-1-96 within ESP and AH», RFC 2404, Ноябрь 1998.</td></tr><tr><td>[RFC2405]</td><td>C. Madson and N. Doraswamy, «The ESP DES-CBC Cipher Algorithm With Explicit IV», RFC 2405, Ноябрь 1998.</td></tr><tr><td>[RFC3566]</td><td>S. Frankel and H. Herbert, «The AES-XCBC-MAC-96 Algorithm and Its Use With IPsec», RFC 3566, Сентябрь 2003.</td></tr><tr><td>[RFC3602]</td><td>S. Franke, R. Glenn, S. Kelly, «The AES-CBC Cipher Algorithm and Its Use with IPsec», RFC 3602, Сентябрь 2003.</td></tr><tr><td>[RFC3686]</td><td>R. Housley, «Using Advanced Encryption Standard (AES) Counter Mode With IPsec Encapsulating Security Payload (ESP)», RFC 3686, Январь 2004.</td></tr></table><h2 id="p8">8. Дополнительная литература</h2><table itemprop="references"><tr><td>[802.11i]</td><td>LAN/MAN Specific Requirements Part 11: Wireless Medium Access Control (MAC) and physical layer (PHY) specifications: Medium Access Control (MAC) Security Enhancements, IEEE Std 802.11i, Июнь 2004.</td></tr><tr><td>[JIS]</td><td>J. Schiller, <a href="../4307.rfc" title="RFC 4307 - Криптографические алгоритмы для использования с IKEv2">«Криптографические алгоритмы для использования с IKEv2», RFC 4307</a>, Декабрь 2005.</td></tr><tr><td>[CCM]</td><td>Housley, R., «Using Advanced Encryption Standard (AES) Counter Mode With IPsec Encapsulating Security Payload (ESP)», RFC 3686, Январь 2004.</td></tr><tr><td>[IKEv2]</td><td>C. Kaufman, <a href="../4306.rfc" title="RFC 4306 - Протокол обмена ключами в Internet (IKEv2)">«Протокол IKEv2», RFC 4306</a>, Декабрь 2005.</td></tr><tr><td>[RFC791]</td><td>J. Postel, <a href="../791.rfc" title="RFC 791 — Протокол IP (Internet Protocol)">«Internet Protocol», STD 5, RFC 791</a>, Сентябрь 1981.</td></tr><tr><td>[RFC2402]</td><td>S. Kent and R. Atkinson, «IP Authentication Header», RFC 2402, Ноябрь 1998.</td></tr><tr><td>[RFC2406]</td><td>S Kent and R. Atkinson, «IP Encapsulating Security Payload (ESP)», RFC 2406, Ноябрь 1998.</td></tr><tr><td>[RFC2407]</td><td>D. Piper, «The Internet IP Security Domain of Interpretation for ISAKMP», RFC 2407, Ноябрь 1998.</td></tr><tr><td>[RFC2409]</td><td>D. Harkins and D. Carrel, «The Internet Key Exchange (IKE)», RFC 2409, Ноябрь 1998.</td></tr></table><h2>Адрес автора</h2><p>Donald E. Eastlake 3rd<br />Motorola Laboratories<br />155 Beaver Street<br />Milford, MA 01757 USA<br />Phone: +1-508-786-7554 (w) +1-508-634-2066 (h)<br />EMail: <bdo dir="rtl">&#109;&#111;&#99;&#46;&#97;&#108;&#111;&#114;&#111;&#116;&#111;&#109;&#64;&#101;&#107;&#97;&#108;&#116;&#115;&#97;&#101;&#46;&#100;&#108;&#97;&#110;&#111;&#100;</bdo></p></div></div><div id="disqus_thread"></div><script type="text/javascript">var disqus_shortname="rfc2",disqus_title="RFC 4305 - Требования к реализациям криптографических алгоритмов для ESP и AH",disqus_identifier="4305.rfc",disqus_url="http://rfc2.ru/4305.rfc";(function(){var dsq=document.createElement("script");dsq.type="text/javascript";dsq.async=true;dsq.src = "//"+disqus_shortname+".disqus.com/embed.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(dsq);})();</script><div class="bubble">2007 - 2014 © <a href="../index.html" title="Русские переводы RFC">Русские переводы RFC</a>, IETF, ISOC.</div></div><div id="bottom" style="position:static !important;bottom:auto !important"><div class="bubble"><ul><li><!--723572853672--></li></ul></div></div><!-- Yandex.Metrika counter --><script type="text/javascript">(function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter4680559 = new Ya.Metrika({id:4680559, webvisor:true, clickmap:true, accurateTrackBounce:true, trackHash:true, ut:"noindex"}); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="http://mc.yandex.ru/watch/4680559?ut=noindex" style="position:absolute; left:-9999px;" alt="" /></div></noscript><!-- /Yandex.Metrika counter --></body></html>