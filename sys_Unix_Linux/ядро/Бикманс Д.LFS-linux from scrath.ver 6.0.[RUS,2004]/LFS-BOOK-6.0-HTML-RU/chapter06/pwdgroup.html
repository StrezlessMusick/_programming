<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content=
    "application/xhtml+xml; charset=koi8-r" />
    <title>
      6.7.&nbsp;Создание файлов passwd, group и log
    </title>
    <link rel="stylesheet" href="../stylesheets/lfs.css" type="text/css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.65.1" />
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
  </head>
  <body id="lfs" class="6.0">
    <div class="navheader">
      <div class="headertitles">
        <h4>
          Linux From Scratch - Версия 6.0
        </h4>
        <h3>
          Глава&nbsp;6.&nbsp;Установка основных системных программ
        </h3>
      </div>
      <ul class="headerlinks">
        <li class="prev">
          <a accesskey="p" href="createfiles.html" title=
          "Creating Essential Symlinks">Назад</a>
          <p>
            Создание необходимых ссылок
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="devices.html" title=
          "Populating /dev">Далее</a>
          <p>
            Заполнение /dev
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="chapter06.html" title=
          "Глава&nbsp;6.&nbsp;Установка основных системных программ">Наверх</a>.
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Linux From Scratch - Версия 6.0">В начало</a>
        </li>
      </ul>
    </div>
    <div class="sect1" lang="en" xml:lang="en">
      <div class="titlepage">
        <h1 class="sect1">
          6.7. Создание файлов passwd, group и log
        </h1>
      </div>
      <p>
        Для возможности регистрации в качестве пользователя <span class=
	"emphasis"><em>root</em></span> и для распознавания имени
        &ldquo;<span class="quote">root</span>&rdquo;
        нам необходимо создать соответствующие элементы в файлах
	<tt class="filename">/etc/passwd</tt> и
        <tt class="filename">/etc/group</tt>.
      </p>
      <p>
        Создадим файл <tt class="filename">/etc/passwd</tt> запуском команды:
      </p>
      <pre class="userinput">
<kbd class="command">cat &gt; /etc/passwd &lt;&lt; "EOF"
<tt class="literal">root:x:0:0:root:/root:/bin/bash</tt>
EOF</kbd>
</pre>
      <p>
        Пароль пользователя <span class="emphasis"><em>root</em></span>
        (символ &ldquo;<span class="quote">x</span>&rdquo; заменяет его здесь)
	будет определен позднее.
      </p>
      <p>
        Создадим файл <tt class="filename">/etc/group</tt> запуском следующей команды:
      </p>
      <pre class="userinput">
<kbd class="command">cat &gt; /etc/group &lt;&lt; "EOF"
<tt class="literal">root:x:0:
bin:x:1:
sys:x:2:
kmem:x:3:
tty:x:4:
tape:x:5:
daemon:x:6:
floppy:x:7:
disk:x:8:
lp:x:9:
dialout:x:10:
audio:x:11:
video:x:12:
utmp:x:13:
usb:x:14:</tt>
EOF</kbd>
</pre>
      <p>
        Созданные группы не являются частью какого-то стандарта&mdash;
        эти группы будут использоваться при конфигурации Udev в следующей главе.
        База стандарта Linux (LSB, доступна на <a href=
        "http://www.linuxbase.org"><i>http://www.linuxbase.org</i></a>)
        рекомендует, чтобы после группы &ldquo;<span class=
        "quote">root</span>&rdquo; с ID группы (GID) 0 находилась группа
        &ldquo;<span class="quote">bin</span>&rdquo; с GID, равным 1.
        Все другие имена групп и их GID могут свободно выбираться пользователем,
	но некоторые пакеты зависят от имени группы, хоть и не зависят от номера GID.
      </p>
      <p>
        Для удаления приглашеня с текстом &ldquo;<span class="quote">I have no
        name!</span>&rdquo; запустим новый shell. После того, как полная Glibc
        была установлена в <a href="../chapter05/chapter05.html">Главе 5</a> и файлы
        <tt class="filename">/etc/passwd</tt> и <tt class=
        "filename">/etc/group</tt> были созданы, имя пользователя и имя группы
        теперь будут работать.
      </p>
      <pre class="userinput">
<kbd class="command">exec /tools/bin/bash --login +h</kbd>
</pre>
      <p>
        Замечание по использованию параметра <i class="parameter"><tt>+h</tt></i>.
        Это скажет <span><b class="command">bash</b></span> не использовать внутренний
	кеш путей. Без этого <span><b class="command">bash</b></span>
        будет запоминать пути к исполненым бинарникам. Поскольку мы собираемся
	использовать вновь скомпилированые пакеты по мере их установки,
	мы должны отключить эту функцию в этой главе.
      </p>
      <p>
        Программы <span><b class="command">login</b></span>, <span><b class=
        "command">agetty</b></span> и <span><b class=
        "command">init</b></span> (и другие) используют некоторые лог-файлы
        для записи информации, например кто был зарегистрирован в системе
        и когда. Хотя эти программы не будут записывать в лог-файлы если они
        пока отсутствуют. Проинициализируем лог-файлы и дадим им правильные права:
      </p>
      <pre class="userinput">
<kbd class="command">touch /var/run/utmp /var/log/{btmp,lastlog,wtmp}
chgrp utmp /var/run/utmp /var/log/lastlog
chmod 664 /var/run/utmp /var/log/lastlog</kbd>
</pre>
      <p>
        Файл <tt class="filename">/var/run/utmp</tt> записывает пользователей,
        которые уже зарегистрировались. 
      </p>
      <p>
	Файл <tt class="filename">/var/log/wtmp</tt> записывает все входы
        в систему и выходы из системы. 
      </p>
      <p>
	Файл <tt class="filename">/var/log/lastlog</tt> записывает, когда каждый
        пользователь последний раз регистрировался в системе. 
      </p>
      <p>
	Файл <tt class="filename">/var/log/btmp</tt> записывает неправильые регистрации.
      </p>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="createfiles.html" title=
          "Creating Essential Symlinks">Назад</a>
          <p>
            Создание необходимых ссылок
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="devices.html" title=
          "Populating /dev">Далее</a>
          <p>
            Заполнение /dev
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="chapter06.html" title=
          "Глава&nbsp;6.&nbsp;Установка основных системных программ">Наверх</a>.
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Linux From Scratch - Версия 6.0">В начало</a>.
        </li>
      </ul>
    </div>
  </body>
</html>
