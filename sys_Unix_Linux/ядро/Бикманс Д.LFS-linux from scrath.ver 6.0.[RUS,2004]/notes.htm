<HTML><HEAD> 
<TITLE>LFS - RU</TITLE> 
<META content="text/html; charset=windows-1251" http-equiv=Content-Type> 
<BODY> 
<CENTER><table width=640><TBODY><tr align=center><td>
<H1>LFS - RU</H1> 
<PRE><CENTER><H4><HR>[<a href= 
"./index.htm">Введение</a>][<a href= 
"./vibor.htm">Мой выбор</a>][<a href= 
"./notes.htm">Заметки</a>][<a href= 
"./scripts.htm">О скриптах</a>][<a href= 
"./files.htm">Файлы</a>][<a href= 
"./faq.htm">ЧаВо</a>][<a href= 
"./changelog.htm">ChangeLog</a>][<a href= 
"./links.htm">Ссылки</a>]<HR></H4><H2>Небольшие заметки</H2></CENTER> 
</td></tr></TBODY></table></CENTER></PRE>

<CENTER><table width=640><TBODY><tr align=left><td>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Теперь о некоторых тонкостях, с которыми я столкнулся
в своих экспериментах. 
</p> 
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Главное отличие между предыдущей версией LFS (5.0)
и текущей (6.0) заключается в переходе на ядро ветки 2.6. При этом
рекомендуется устанавливать дополнительно и linux-libc-headers. Сначала я
следовал рекомендации, но оказалось, что при сборке некоторых пакетов
появляется сообщение об ошибке в заголовочном файле (из linux-libc-headers).
При просмотре этого файла оказывалось, что эта ошибка и прописана в этом файле.<br>
Например файл /usr/include/linux/config.h содержит следующий текст:</p>
<h5><em>#error "Compilation aborted. Please read the FAQ for linux-libc-headers package."<br> 
#error "(can be found at http://ep09.pld-linux.org/~mmazur/linux-libc-headers/doc/)"</em></h5>
<p>
который и выводится в тексте ошибки. 
</p> 
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Я попытался поступить так же, как и в LFS-5.0 с
ядром 2.4 - взять заголовочные файлы из самого ядра. Сборка проходила
нормально. Но когда дело дошло до сборки alsa-lib появились другие ошибки,
которых не было при использовании linux-libc-headers. Эти проблемы оказались
связанными только с одним подкаталогом - /usr/include/linux/byteorder. Тогда
я взял все linux-headers из ядра, а /usr/include/linux/byteorder из
linux-libc-headers. Иногда для некоторых пакетов требовалось создавать файл
/usr/include/linux/autoconf.h с последующим его удалением, поэтому я
закоментировал ссылку на autoconf.h в единственном месте, где она была -
/usr/include/linux/config.h. Теперь ВСЕ пакеты собирались без проблем,
включая и alsa. 
</p> 
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Еще один нюанс. Я собирал readline-5.0, подняв его
версию из readline-3.0 при помощи родного патча. Также имеется и LFS-овский
патч readline-3.0-fixes-1. Но он накладывался у меня не полностью - не
пропатчивается файл vi_mode.c. Оказалось, что он не полностью соответствует
патчу. Пришлось подправить и патч. Если у кого-то еще такая ситуация, то в
<a href="./files.htm">Файлах</a> я выложил измененный патч. Кроме того, я
заметил глюки при пролистывании истории команд клавишами "Вверх" и "Вниз".
Оказалось, что это связано именно с readline. Перекомпилировав Bash с его
собственной встроенной readline я убрал эту проблему. В конце я отказался и
от readline.
</p> 
<p>
&nbsp;&nbsp;&nbsp;&nbsp;При сборке ядра и иксов я использовал уже имеющиеся
у меня от предыдущих экспериментов файлы конфигов. Выкладываю в <a href= 
"./files.htm">Файлах</a> в качестве примеров. Иксы я собирал без шрифтов -
так быстрее, а нужные шрифты у меня уже были. Я их когда-то взял из АСП или
из Альт-линукса. Ну и TTF шрифты из винды.
</p> 
<p>
&nbsp;&nbsp;&nbsp;&nbsp;При сборке статической системы я сейчас не использую
пользователя "lfs". Поскольку сами скрипты мной уже неоднократно проверены, я
все необходимые для сборки статической системы переменные окружения внес в
начало скрипта build-static с последующим восстановлением предыдущих значений.
Это позволяет не вводить дополнительного пользователя.
</p> 
</td></tr></TBODY></table></CENTER>
<CENTER><table width=640><TBODY><tr align=center><td>
<PRE><CENTER><H4><HR>[<a href= 
"./index.htm">Введение</a>][<a href= 
"./vibor.htm">Мой выбор</a>][<a href= 
"./notes.htm">Заметки</a>][<a href= 
"./scripts.htm">О скриптах</a>][<a href= 
"./files.htm">Файлы</a>][<a href= 
"./faq.htm">ЧаВо</a>][<a href= 
"./changelog.htm">ChangeLog</a>][<a href= 
"./links.htm">Ссылки</a>]<HR></H4></CENTER></PRE>
</td></tr></TBODY></table></CENTER>
</BODY></HTML> 
