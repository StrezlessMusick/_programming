<HTML><HEAD> 
<TITLE>LFS - RU</TITLE> 
<META content="text/html; charset=windows-1251" http-equiv=Content-Type> 
<BODY> 
<CENTER><table width=640><TBODY><tr align=center><td>
<H1>LFS - RU</H1> 
<PRE><CENTER><H4><HR>[<a href= 
"./index.htm">Введение</a>][<a href= 
"./vibor.htm">Мой выбор</a>][<a href= 
"./notes.htm">Заметки</a>][<a href= 
"./scripts.htm">О скриптах</a>][<a href= 
"./files.htm">Файлы</a>][<a href= 
"./faq.htm">ЧаВо</a>][<a href= 
"./changelog.htm">ChangeLog</a>][<a href= 
"./links.htm">Ссылки</a>]<HR></H4><H2>О скриптах</H2></CENTER>
</td></tr></TBODY></table></CENTER></PRE>
<CENTER><table width=640><TBODY><tr align=left><td>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Свои скрипты я получил при сборке LFS-системы, записывая все
свои действия в файл.
</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Теперь более подробно о том, что и где располагается в моем случае. 
</p>
<ol>
    <li>Загружаюсь я с hdc3 - на нем находится базовая система.</li>
    <li>На hdc2 в fat32 находятся исходники. Я их записывал сюда на работе под 
        виндой и приносил домой. На работе у нас выделенка.</li>
    <li>На hda7 создаю ФС под новую систему. Я использовал ext2. Она же $LFS.</li>
    <li>На hda8 - /home - осталась от предыдущего Линукса.</li>
    <li>На hda9 - swap - остался от предыдущего Линукса.</li>
</ol>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;К этим разделам и происходит обращение при сборке в моих скриптах. 
</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Раздел для новой системы у меня уже есть -  hda7.
Создал в нем файловую систему и под root-ом каталоги $LFS/tools и
$LFS/src/scripts. Скрипт build-static, запущенный под root, установит
нужное окружение для сборки сам. После завершения сборки статической системы
и входа в нее в chroot-окружении у нас еще нет никаких пользователей. После
создания первых учетных записей у нас появится root, а он везде имеет GID 0
и его UID тоже 0. Т.е. имеющиеся каталоги и файлы в них в новом 
chroot-окружении будут принадлежать тоже root-у и все корректно и не надо менять
владельца.
</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Свои скрипты поместил в $LFS/src/scripts. Далее как по
LFS-book - создаем симлинк на каталог $LFS/tools из нового раздела в корне нашей
текущей системы. А теперь не набираем все руками, а запускаем скрипт
build-static в каталоге $LFS/src/scripts. Если Вы будете использовать те же
версии пакетов, что использовал я - то все пройдет нормально и Вы получите
статически собранную LFS-систему в каталоге $LFS/tools. На моем железе этот
процесс занял 1 час 45 минут. Необходимо проверить также и соответствие
расширений файлов исходников у себя с прописанными в скриптах - они могут быть
tar.gz или tar.bz2. У меня в скриптах нет проверки на этот счет. 
</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;После завершения этой части работы запускаем скрипт
chrootlfs. Попадаем в корень будущей системы. Переходим в каталог /src/scripts
и запускаем скрипт ./11, который создаст дерево каталогов и файлы /etc/passwd
и /etc/group. Набираем в командной строке: 
</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;exec /tools/bin/bash --login +h 
</p>
<p>
и приступаем к основному процессу - сборке основной, динамически слинкованной 
системы, для чего запускаем скрипт ./build-din. Опять ждем завершения процесса. 
У меня это заняло те же 1 час 45 минут, хотя набор пакетов значительно больше. 
После удачного завершения процесса набираем lilo (я ставил его) и можно
перегружаться. Перед запуском lilo можно на всякий случай сохранить MBR диска,
на который производим установку. В скрипте этот пункт есть, но закоментирован -
я уже имею копию MBR. В меню загрузки выбираем нашу новую систему и проверяем
результат. На этом этапе могут появиться ошибки запуска некоторых сервисов -
пока игнорируем. После появления запроса вводим root и жмем Enter - мы в новой
системе. Если Вы тоже устанавливали МС, то запускаем его и смотрим на результат
работы. Теперь можно удалить каталоги /tools и /src/static с остатками
статической системы.
</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Для сборки BLFS-части запускаем скрипт
/src/scripts/build-blfs, предварительно внеся в него нужные изменения. 
</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;Вносить изменения на много проще, чем писать все с нуля. 
</p>
</td></tr></TBODY></table></CENTER>
<CENTER><table width=640><TBODY><tr align=center><td>
<PRE><CENTER><H4><HR>[<a href= 
"./index.htm">Введение</a>][<a href= 
"./vibor.htm">Мой выбор</a>][<a href= 
"./notes.htm">Заметки</a>][<a href= 
"./scripts.htm">О скриптах</a>][<a href= 
"./files.htm">Файлы</a>][<a href= 
"./faq.htm">ЧаВо</a>][<a href= 
"./changelog.htm">ChangeLog</a>][<a href= 
"./links.htm">Ссылки</a>]<HR></H4></CENTER></PRE>
</td></tr></TBODY></table></CENTER>
</BODY></HTML> 
