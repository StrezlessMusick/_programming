<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8" /><link rel="stylesheet" href="../tpl/style.css@f4e332aa" type="text/css" /><link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css' /><style type="text/css">h1,h2,h3,h4{font-family:'Open Sans',sans-serif}</style><link rel="canonical" href="../4760.rfc" /><meta name="Robots" content="noindex, nofollow" /><title>Перевод RFC 4760 — Многопротокольные расширения для BGP-4</title><link rel="alternate" type="application/rss+xml" title="RFC2.ru - Русские Переводы RFC" href="../rss.xml"></head><body><div id="content"><div id="nav"><div class="icon i0"></div> <a href="../index.html" accesskey="`">На Главную</a></div><div id="search" class="ya-site-form ya-site-form_inited_no"><form action="http://yandex.ru/sitesearch" method="get" target="_blank"><input type="hidden" name="searchid" value="2154295"/><input type="hidden" name="l10n" value="ru"/><input type="hidden" name="reqenc" value=""/><input type="hidden" name="submit" value="Найти"/><input type="search" value="" name="text" placeholder="Поиск по RFC2.ru" /></form></div><div itemscope itemtype="http://schema.org/ScholarlyArticle"><meta itemprop="inLanguage" content="ru" /><meta itemprop="editor" content="ru" /><div id="header"><h1><a itemprop="headline" href="../4760.rfc">RFC 4760 — Многопротокольные расширения для BGP-4</a></h1></div><dl class="mute"><dt></dt><dd><div class="icon i1"></div> RFC: 4760</dd><dd><div class="icon i3"></div> Оригинал: <a href="original" target="_blank" rel="nofollow"><span itemprop="alternativeHeadline">Multiprotocol Extensions for BGP-4</span></a></dd><dd><div class="icon i7"></div> Предыдущие версии: RFC 2283, RFC 2858</dd><dd><div class="icon i2"></div> Категория: <span itemprop="articleSection">Проект стандарта</span></dd><dd><div class="icon i4"></div> Дата публикации: <time itemprop="datePublished" datetime="2007-01-01">Январь 2007</time></dd><dd><div class="icon i5"></div> Авторы: <span itemprop="author">Tony Bates</span>, <span itemprop="author">Ravi Chandra</span>, <span itemprop="author">Dave Katz</span>, <span itemprop="author">Yakov Rekhter</span></dd><dd><div class="icon i6"></div> Перевод: <span itemprop="editor">Николай Малых</span></dd></dl><div id="text" itemprop="articleBody"><h3>Статус документа</h3><p>В этом документе содержится спецификация протокола, предложенного сообществу Internet. Документ служит приглашением к дискуссии в целях развития и совершенствования протокола. Текущее состояние стандартизации протокола вы можете узнать из документа "Internet Official Protocol Standards" (STD 1). Документ может распространяться без ограничений.</p><h3>Тезисы</h3><p>В этом документе определяется расширение протокола BGP-4, позволяющее передавать информацию для различных протоколов сетевого уровня (например, IPv6, IPX, L3VPN и т. п.). Расширение обеспечивает обратную совместимость — маршрутизаторы, поддерживающие это расширение, смогут нормально работать с маршрутизаторами, которые его не поддерживают.</p><h2>1. Введение</h2><p>Только три компоненты информации, передаваемой с помощью BGP-4 [BGP-4], непосредственно связаны с IPv4: (a) атрибут NEXT_HOP (указывается адресом IPv4), (b) AGGREGATOR (содержит адрес IPv4) и (c) NLRI (выражается префиксом адреса IPv4). В этом документе предполагается, что любой узел BGP (включая те, которые поддерживают описанное здесь расширение) имеет адрес IPv4 (который будет вместе с другими параметрами использоваться в атрибуте AGGREGATOR). Следовательно, для того, чтобы BGP-4 поддерживал маршрутизацию для множества протоколов сетевого уровня, в BGP-4 требуется добавить только два элемента: (a) возможность связывания отдельного протокола сетевого уровня с информацией о следующем интервале (next hop) и (b) возможность связывания протокола сетевого уровня с NLRI. Для идентификации протоколов сетевого уровня данный документ использует значение Address Family (семейство адресов), определенное в [IANA-AF], и Subsequent Address Family (описано в этом документе).</p><p>Легко увидеть, что информация о следующем интервале (значение атрибута NEXT_HOP) имеет смысл (и необходима) только в комбинации с анонсами доступных адресатов — в комбинации же с анонсами недоступных адресатов (отзыв маршрутов) информация о следующем интервале не имеет смысла. Это позволяет предположить, что анонсирование доступных адресатов следует объединять с анонсированием следующего интервала, который будет использоваться для этих адресатов, и анонсирование доступных адресатов следует отделить от анонсирования недоступных адресатов.</p><p>Для обеспечения совместимости с предыдущими спецификациями и упрощения перехода к поддержке многопротокольного расширения в BGP-4 в данном документе используются два новых атрибута — MP_REACH_NLRI и MP_UNREACH_NLRI. Первый атрибут (MP_REACH_NLRI) используется для передачи набора доступных адресов с информацией о следующем интервале, который будет использоваться для пересылки по этим адресам. Второй атрибут (MP_UNREACH_NLRI) служит для передачи наборов недоступных адресатов. Оба эти атрибута являются необязательными и нетранзитивными. Таким образом, узел BGP, не поддерживающий многопротокольное расширение, просто будет игнорировать содержащуюся в этих атрибутах информацию и не станет передавать ее другим узлам BGP.</p><h2>2. Описание требований</h2><p>Ключевые слова необходимо (MUST), недопустимо (MUST NOT), требуется (REQUIRED), нужно (SHALL), не нужно (SHALL NOT), следует (SHOULD), не следует (SHOULD NOT), рекомендуется (RECOMMENDED), возможно (MAY), необязательно (OPTIONAL) в данном документе интерпретируются в соответствии с RFC 2119 [RFC2119].</p><h2>3. MP_REACH_NLRI (тип 14)</h2><p>Этот необязательный и нетранзитивный атрибут может использоваться с двумя целями:</p><ul class="lat"><li>анонсирование партнеру возможного маршрута;</li><li>обеспечение маршрутизатору возможности анонсирования адреса сетевого уровня маршрутизатора, который следует использовать как следующий интервал (next hop) на пути к адресату, указанному в поле NLRI атрибута MP_NLRI.</li></ul><p>Формат представления атрибута показан на рисунке:</p><pre>+---------------------------------------------------------+
| Address Family Identifier (2 octets)                    |
+---------------------------------------------------------+
| Subsequent Address Family Identifier (1 octet)          |
+---------------------------------------------------------+
| Length of Next Hop Network Address (1 octet)            |
+---------------------------------------------------------+
| Network Address of Next Hop (variable)                  |
+---------------------------------------------------------+
| Reserved (1 octet)                                      |
+---------------------------------------------------------+
| Network Layer Reachability Information (variable)       |
+---------------------------------------------------------+</pre><p>Назначение полей описано ниже:</p><ul><li class="b">Address Family Identifier (AFI) — идентификатор семейства адресов</li><li class="lib"><p>Это поле в комбинации с полем Subsequent Address Family Identifier идентифицирует набор протоколов сетевого уровня, к которым должен относится адрес, передаваемый в поле Next Hop, способ представления адреса следующего интервала и семантику последующих данных NLRI. Если значение Next Hop разрешено для нескольких протоколов сетевого уровня, представление Next Hop должно обеспечивать способ определения протокола сетевого уровня.</p><p>Определенные к настоящему времени значения поля AFI заданы в реестре IANA Address Family Numbers [IANA-AF].</p></li><li class="b">Subsequent Address Family Identifier (SAFI) — дополнительный идентификатор семейства адресов</li><li class="lib">Это поле в комбинации с полем AFI идентифицирует набор протоколов сетевого уровня, к которым должен относится адрес, передаваемый в поле Next Hop, способ представления адреса следующего интервала и семантику последующих данных NLRI. Если значение Next Hop разрешено для нескольких протоколов сетевого уровня, представление Next Hop должно обеспечивать способ определения протокола сетевого уровня.</li><li class="b">Length of Next Hop Network Address — размер адреса следующего интервала</li><li class="lib">1-октетное поле, указывающее размер поля Network Address of Next Hop в октетах.</li><li class="b">Network Address of Next Hop — сетевой адрес для следующего интервала</li><li class="lib">Поле переменной длины, содержащее адрес сетевого уровня для следующего маршрутизатора на пути к получателю. Протокол сетевого уровня, связанный с сетевым адресом следующего интервала, идентифицируется комбинацией значений полей &lt;AFI, SAFI&gt; в данном атрибуте.</li><li class="b">Резерв</li><li class="lib">Это 1-октетное поле должно устанавливаться в 0, а при получении значение поля следует игнорировать.</li><li class="b">Network Layer Reachability Information (NLRI) — информация о доступности на сетевом уровне</li><li class="lib"><p>Поле переменной длины, содержащее список NLRI для возможных маршрутов, которые будут анонсироваться этим атрибутом. Семантика NLRI определяется комбинацией значений &lt;AFI, SAFI&gt; в данном атрибуте.</p><p>Если поле Subsequent Address Family Identifier содержит одно из значений, определенных в данном документе, каждое значение NLRI кодируется в соответствии с параграфом 5. Представление NLRI данного документа.</p></li></ul><p>Информация о следующем интервале (next hop), передаваемая в атрибуте пути MP_REACH_NLRI, определяет адрес сетевого уровня маршрутизатора, который следует использовать в качестве следующего этапа пересылки адресатам, указанным в атрибуте MP_NLRI сообщения UPDATE.</p><p>Правила для информации о следующем интервале совпадают с правилами для информации, передаваемой в атрибуте BGP NEXT_HOP (см. параграф 5.1.3 документа [BGP-4]).</p><p>Сообщение UPDATE, содержащее MP_REACH_NLRI, должно также включать атрибуты ORIGIN и AS_PATH (как для EBGP, так и для IBGP). Более того, в обменах IBGP такие сообщения должны также включать атрибут LOCAL_PREF.</p><p>В сообщения UPDATE, не содержащие NLRI, кроме значения в атрибуте MP_REACH_NLRI, не следует включать атрибут NEXT_HOP. Если такое сообщение содержит атрибут NEXT_HOP, получившему это сообщение узлу BGP следует игнорировать данный атрибут.</p><p>В сообщение UPDATE не следует включать один префикс (одну пару &lt;AFI, SAFI&gt;) более одного раза для полей WITHDRAWN ROUTES, NLRI, MP_REACH_NLRI и MP_UNREACH_NLRI. Обработка сообщений UPDATE с дубликатами префиксов не определена.</p><h2>4. MP_UNREACH_NLRI (тип 15)</h2><p>Этот дополнительный нетранзитивный атрибут может использоваться для отзыва невозможных маршрутов.</p><p>Формат атрибута показан на рисунке:</p><pre>+---------------------------------------------------------+
| Address Family Identifier (2 octets)                    |
+---------------------------------------------------------+
| Subsequent Address Family Identifier (1 octet)          |
+---------------------------------------------------------+
| Withdrawn Routes (variable)                             |
+---------------------------------------------------------+</pre><p>Назначение полей атрибута описано ниже:</p><ul><li class="b">Address Family Identifier (AFI) — идентификатор семейства адресов</li><li class="lib"><p>Это поле в комбинации с полем Subsequent Address Family Identifier идентифицирует набор протоколов сетевого уровня, к которым должен относится адрес, передаваемый в поле Next Hop, способ представления адреса следующего интервала и семантику последующих данных NLRI. Если значение Next Hop разрешено для нескольких протоколов сетевого уровня, представление Next Hop должно обеспечивать способ определения протокола сетевого уровня.</p><p>Определенные к настоящему времени значения поля AFI заданы в реестре IANA Address Family Numbers [IANA-AF].</p></li><li class="b">Subsequent Address Family Identifier (SAFI) — дополнительный идентификатор семейства адресов</li><li class="lib">Это поле в комбинации с полем AFI идентифицирует набор протоколов сетевого уровня, к которым должен относится адрес, передаваемый в поле Next Hop, способ представления адреса следующего интервала и семантику последующих данных NLRI. Если значение Next Hop разрешено для нескольких протоколов сетевого уровня, представление Next Hop должно обеспечивать способ определения протокола сетевого уровня.</li><li class="b">Withdrawn Routes NLRI — отзываемые маршруты</li><li class="lib"><p>Поле переменной длины, содержащее значения NLRI для отзываемых маршрутов. Семантика NLRI определяется комбинацией значений &lt;AFI, SAFI&gt; в атрибуте.</p><p>При установке в поле Subsequent Address Family Identifier одного из определенных в данном документе значений, каждое поле NLRI кодируется в соответствии с параграфом 5. Представление NLRI.</p></li></ul><p>Сообщение UPDATE, содержащее MP_UNREACH_NLRI, может не включать других атрибутов пути.</p><h2>5. Представление NLRI</h2><p>Информация о доступности на сетевом уровне (NLRI) представляется в форме одной или множества пар &lt;length, prefix&gt;, показанных на рисунке:</p><pre>+---------------------------+
|   Length (1 octet)        |
+---------------------------+
|   Prefix (variable)       |
+---------------------------+</pre><p>Назначение каждого поля пар описано ниже:</p><ul class="lat"><li><p class="b">Length — размер</p><p class="lia">Поле Length указывает размер адресного префикса в битах. Нулевой размер показывает, что префикс соответствует всем (как указано для данного семейства) адресам (т. е., сам префикс содержит 0 октетов).</p></li><li><p class="b">Prefix — префикс</p><p class="lia">Поле Prefix включает префикс адреса, за которым следуют нулевые биты заполнения для выравнивания поля по границе октета. Отметим, что нулевые биты заполнения не принимаются во внимание.</p></li></ul><h2>6. Дополнительный идентификатор семейства адресов</h2><p>Этот документ определяет следующие значения поля Subsequent Address Family Identifier для атрибутов MP_REACH_NLRI и MP_UNREACH_NLRI:</p><ul><li>1 — NLRI используется для unicast-пересылки (по конкретному адресу);</li><li>2 — NLRI используется для групповой пересылки.</li></ul><p>Реализация может поддерживать все или часть определенных в этом документе значений SAFI или не поддерживать их совсем.</p><h2>7. Обработка ошибок</h2><p>Если узел BGP получает от соседа сообщение UPDATE с атрибутом MP_REACH_NLRI или MP_UNREACH_NLRI и видит, что атрибут указан некорректно, он должен удалить все маршруты BGP, полученные от данного соседа, в которых значения AFI/SAFI совпадают с одним из содержащихся в некорректном атрибуте MP_REACH_NLRI или MP_UNREACH_NLRI. До завершения сеанса BGP, в котором получено сообщение UPDATE, узлу следует игнорировать все последующие маршруты с AFI/SAFI, принятыми в этой сессии.</p><p>В дополнение к сказанному узел может прервать сеанс BGP, в котором было получено сообщение UPDATE. Сессию следует прерывать с помощью сообщения NOTIFICATION, содержащего код/субкод ошибки Update Message Error/Optional Attribute Error.</p><h2>8. Использование анонсирования возможностей BGP</h2><p>Узлу BGP, использующему описанное здесь расширение, следует применять процедуры анонсирования возможностей (Capability Advertisement) [BGP-CAP] для определения возможности использования данного расширения при работе с тем или иным партнером.</p><p>Для полей дополнительного параметра Capabilities следует установить приведенные здесь значения. Поле Capability Code должно содержать значение 1 (указывает на Multiprotocol Extensions). Поле Capability Length должно иметь значение 4.</p><p>Формат поля Capability Value показан на рисунке:</p><pre>0       7      15      23      31
+-------+-------+-------+-------+
|      AFI      | Res.  | SAFI  |
+-------+-------+-------+-------+</pre><p>Компоненты этого поля описаны ниже:</p><ul><li class="b">AFI</li><li class="lia">Идентификатор семейства адресов (16 битов), представляемый так же, как для Multiprotocol Extensions;</li><li class="b">Res.</li><li class="lia">Резервное поле (8 битов); отправителю следует устанавливать для этого поля значение 0, а получателю — игнорировать его;</li><li class="b">SAFI</li><li class="lia">Дополнительный идентификатор семейства адресов (8 битов), представляемый так же, как для Multiprotocol Extensions.</li></ul><p>Узел, поддерживающий множество пар &lt;AFI, SAFI&gt;, включает их как множество возможностей в дополнительный параметр Capabilities.</p><p>Чтобы организовать двухсторонний обмен маршрутной информацией для той или иной пары &lt;AFI, SAFI&gt; между двумя узлами BGP, каждый из этих узлов должен анонсировать партнеру (с помощью механизма Capability Advertisement) возможность поддержки маршрутов для соответствующей пары &lt;AFI, SAFI&gt;.</p><h2>9. Согласование с IANA</h2><p>Как указано выше, атрибуты MPL_REACH_NLRI и MP_UNREACH_NLRI содержат поле дополнительного идентификатора семейства адресов (SAFI). Пространство имен SAFI определено в данном документе. IANA поддерживает и регистрирует значения SAFI, как описано ниже.</p><ul class="dot"><li>значения 1 и 2 выделены в настоящем документе;</li><li>значение 3 является резервным; оно было выделено в RFC 2858 для целей, не получивших распространения, поэтому данный документ отменяет это выделение;</li><li>значения от 5 до 63 выделяются IANA с использованием процедуры стандартизации (Standards Action), определенной в [RFC2434], или процедуры предварительного распределения (Early IANA Allocation), определенной в [RFC4020];</li><li>SAFI из диапазона 67 - 127 распределяются IANA в порядке поступления запросов (процедура "First Come First Served"), как описано в RFC 2434;</li><li>значения 0 и 255 являются резервными;</li><li>значения от 128 до 240 являются часть выделенного ранее блока для приватного использования; на момент принятия данного документа неиспользуемые значения были предоставлены IANA руководителем Routing Area; ; во избежание конфликтов эти значения (130, 131, 135 - 139 и 141 - 240) рассматриваются, как резервные;</li><li>значения от 241 до 254 выделены для приватного использования и не распределяются IANA.</li></ul><h2>10. Сравнение с RFC 2858</h2><p>Этот документ согласует использование информации о следующем интервале с информацией, передаваемой в атрибуте пути BGP NEXT_HOP.</p><p>Из документа удалено определение SAFI 3 и отменено использование SAFI 3.</p><p>В этом документе изменено распределение пространства значений SAFI. В частности, RFC 2858 определял значения SAFI от 128 до 240 для приватного использования. В данном документе распределение этого блока передается IANA и неиспользуемые значения 130, 131, 135 - 139 и 141 - 240 из этого диапазона следует рассматривать в качестве резервных.</p><p>В этом документе поле Number of SNPA переведено в состояние резервного, а последующие поля атрибута MP_REACH_NLRI, связанные с SNPA, удалены.</p><h2>11. Сравнение с RFC 2283</h2><p>Этот документ ограничивает атрибут MP_REACH_NLRI передачей единственного экземпляра &lt;AFI, SAFI, Next Hop Information, ...&gt;.</p><p>Этот документ ограничивает атрибут MP_UNREACH_NLRI передачей единственного экземпляра &lt;AFI, SAFI, ...&gt;.</p><p>Этот документ разъясняет обработку сообщений UPDATE, не содержащих NLRI, кроме значения в атрибуте MP_REACH_NLRI.</p><p>Этот документ разъясняет обработку ошибок при наличии атрибутов MP_REACH_NLRI или MP_UNREACH_NLRI.</p><p>Этот документ содержит спецификацию использования анонсов возможностей BGP вместе с многопротокольными расширениями.</p><p>Этот документ включает раздел 9. Согласование с IANA.</p><h2>12. Вопросы безопасности</h2><p>Данное расширение не оказывает влияния на вопросы безопасности, связанные с протоколом BGP.</p><h2>13. Благодарности</h2><p>Авторы благодарят членов рабочей группы IDR за обзор и комментарии к документу.</p><h2>14. Нормативные документы</h2><table itemprop="references"><tr><td>[BGP-CAP]</td><td>Chandra, R. и J. Scudder, «Capabilities Advertisement with BGP-4», RFC 3392, Ноябрь 2002.</td></tr><tr><td>[BGP-4]</td><td>Rekhter, Y., Li, T., и S. Hares, <a href="../4271.rfc" title="RFC 4271 - Протокол BGP-4">«Протокол BGP-4», RFC 4271</a>, Январь 2006</td></tr><tr><td>[IANA-AF]</td><td>«Address Family Numbers», Reachable from http://www.iana.org/numbers.html</td></tr><tr><td>[RFC2119]</td><td>Bradner, S., «Key words for use in RFCs to Indicate Requirement Levels», BCP 14, RFC 2119, Март 1997.</td></tr><tr><td>[RFC2434]</td><td>Narten, T. и H. Alvestrand, «Guidelines for Writing an IANA Considerations Section in RFCs», BCP 26, RFC 2434, October 1998.</td></tr><tr><td>[RFC4020]</td><td>Kompella, K. и A. Zinin, «Early IANA Allocation of Standards Track Code Points», BCP 100, RFC 4020, Февраль 2005.</td></tr></table><h2>Адреса авторов</h2><p>Tony Bates<br />Cisco Systems, Inc.<br />EMail: <bdo dir="rtl">&#109;&#111;&#99;&#46;&#111;&#99;&#115;&#105;&#99;&#64;&#115;&#101;&#116;&#97;&#98;&#116;</bdo></p><p>Ravi Chandra<br />Sonoa Systems<br />EMail: <bdo dir="rtl">&#109;&#111;&#99;&#46;&#115;&#109;&#101;&#116;&#115;&#121;&#115;&#97;&#111;&#110;&#111;&#115;&#64;&#97;&#114;&#100;&#110;&#97;&#104;&#99;&#114;</bdo></p><p>Dave Katz<br />Juniper Networks, Inc.<br />EMail: <bdo dir="rtl">&#116;&#101;&#110;&#46;&#114;&#101;&#112;&#105;&#110;&#117;&#106;&#64;&#122;&#116;&#97;&#107;&#100;</bdo></p><p>Yakov Rekhter<br />Juniper Networks, Inc.<br />EMail: <bdo dir="rtl">&#116;&#101;&#110;&#46;&#114;&#101;&#112;&#105;&#110;&#117;&#106;&#64;&#118;&#111;&#107;&#97;&#121;</bdo></p></div></div><div id="disqus_thread"></div><script type="text/javascript">var disqus_shortname="rfc2",disqus_title="RFC 4760 - Многопротокольные расширения для BGP-4",disqus_identifier="4760.rfc",disqus_url="http://rfc2.ru/4760.rfc";(function(){var dsq=document.createElement("script");dsq.type="text/javascript";dsq.async=true;dsq.src = "//"+disqus_shortname+".disqus.com/embed.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(dsq);})();</script><div class="bubble">2007 - 2014 © <a href="../index.html" title="Русские переводы RFC">Русские переводы RFC</a>, IETF, ISOC.</div></div><div id="bottom" style="position:static !important;bottom:auto !important"><div class="bubble"><ul><li><!--723572853672--></li></ul></div></div><!-- Yandex.Metrika counter --><script type="text/javascript">(function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter4680559 = new Ya.Metrika({id:4680559, webvisor:true, clickmap:true, accurateTrackBounce:true, trackHash:true, ut:"noindex"}); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="http://mc.yandex.ru/watch/4680559?ut=noindex" style="position:absolute; left:-9999px;" alt="" /></div></noscript><!-- /Yandex.Metrika counter --></body></html>