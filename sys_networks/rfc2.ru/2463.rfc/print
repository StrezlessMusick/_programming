<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8" /><link rel="stylesheet" href="../tpl/style.css@f4e332aa" type="text/css" /><link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css' /><style type="text/css">h1,h2,h3,h4{font-family:'Open Sans',sans-serif}</style><link rel="canonical" href="../2463.rfc" /><meta name="Robots" content="noindex, nofollow" /><title>Перевод RFC 2463 — Протокол передачи управляющих сообщений (ICMPv6) для 6-ой версии IP-протокола (IPv6)</title><link rel="alternate" type="application/rss+xml" title="RFC2.ru - Русские Переводы RFC" href="../rss.xml"></head><body><div id="content"><div id="nav"><div class="icon i0"></div> <a href="../index.html" accesskey="`">На Главную</a></div><div id="search" class="ya-site-form ya-site-form_inited_no"><form action="http://yandex.ru/sitesearch" method="get" target="_blank"><input type="hidden" name="searchid" value="2154295"/><input type="hidden" name="l10n" value="ru"/><input type="hidden" name="reqenc" value=""/><input type="hidden" name="submit" value="Найти"/><input type="search" value="" name="text" placeholder="Поиск по RFC2.ru" /></form></div><div itemscope itemtype="http://schema.org/ScholarlyArticle"><meta itemprop="inLanguage" content="ru" /><meta itemprop="editor" content="ru" /><div id="header"><h1><a itemprop="headline" href="../2463.rfc">RFC 2463 — Протокол передачи управляющих сообщений (ICMPv6) для 6-ой версии IP-протокола (IPv6)</a></h1></div><dl class="mute"><dt></dt><dd><div class="icon i1"></div> RFC: 2463</dd><dd><div class="icon i3"></div> Оригинал: <a href="original" target="_blank"><span itemprop="alternativeHeadline">Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification</span></a></dd><dd><div class="icon i7"></div> Другие версии: RFC 1885, <strong class="obsoleted_by">RFC 4443</strong></dd><dd><div class="icon i2"></div> Категория: <span itemprop="articleSection">Проект стандарта</span></dd><dd><div class="icon i4"></div> Дата публикации: <time itemprop="datePublished" datetime="1998-12-02">Декабрь 1998</time></dd><dd><div class="icon i5"></div> Авторы: <span itemprop="author">A. Conta</span>, <span itemprop="author">S. Deering</span></dd><dd><div class="icon i6"></div> Перевод: <span itemprop="editor">Мельников Дмитрий Анатольевич</span></dd></dl><div id="text" itemprop="articleBody"><h2>Оглавление</h2><ul class="map"><li><a href="print#p1">1. Предисловие</a></li><li><a href="print#p2">2. Общие положения</a></li><li class="lia"><a href="print#p2.1">2.1. Общий формат сообщений</a></li><li class="lia"><a href="print#p2.2">2.2. Определение адреса источника сообщения</a></li><li class="lia"><a href="print#p2.3">2.3. Вычисление проверочной суммы сообщения</a></li><li class="lia"><a href="print#p2.4">2.4. Правила обработки сообщений</a></li><li><a href="print#p3">3. ICMPv6-сообщения об ошибках</a></li><li class="lia"><a href="print#p3.1">3.1. Сообщение «Узел назначения не достижим»</a></li><li class="lia"><a href="print#p3.2">3.2. Сообщение «Размер IP-пакета слишком большой»</a></li><li class="lia"><a href="print#p3.3">3.3. Сообщение «Превышение времени»</a></li><li class="lia"><a href="print#p3.4">3.4. Сообщение «Параметрическая проблема»</a></li><li><a href="print#p4">4. Информационные ICMPv6-сообщения</a></li><li class="lia"><a href="print#p4.1">4.1. Сообщение «Эхо-пакет – запрос»</a></li><li class="lia"><a href="print#p4.2">4.2. Сообщение «Эхо-пакет – ответ»</a></li><li><a href="print#p5">5. Вопросы безопасности</a></li><li><a href="print#p6">6. Аутентификация и шифрование ICMPv6-сообщений</a></li></ul><h2 id="p1">1. Предисловие</h2><p>Этот стандарт определяет протокол передачи управляющих сообщений (ICMP) для шестой версии IP-адресации (IPv6). ICMPv6 имеет собственное обозначение в поле «Следующий заголовок» в IP-заголовке IPv6: 58.</p><p>В этом стандарте представлена только логическая характеристика ICMPv6 и кратное описание порядка применения ICMPv6-сообщений.</p><h2 id="p2">2. Общие положения</h2><p>ICMPv6 используется в составе программном обеспечении IPv6-узлов в целях передачи сообщений, уведомляющих об ошибках, которые были обнаружены при обработке IP-сообщений (IP-пакетов), а также для реализации других технологических функций (например, диагностических «ping»). Программный ICMPv6-модуль является составной частью IPv6-модуля и должен обязательно присутствовать в каждом IPv6-узле.</p><h3 id="p2.1">2.1. Общий формат сообщений</h3><p>ICMPv6-сообщения можно разделить на два класса:</p><ol class="lia"><li>сообщения об ошибках;</li><li>информационные сообщения.</li></ol><p>Сообщения об ошибках отличаются тем, что в поле «Тип сообщения» старший бит имеет нулевое значение. Таким образом, сообщения об ошибках могут иметь в поле «Тип сообщения» значения 0…127, а информационные — 128…255.</p><p>В данном стандарте представлены следующие ICMPv6-сообщения:</p><ul class="list"><li><p class="b">Сообщения об ошибках:</p><ul class="circle lia"><li>«1» — узел назначения не достижим;</li><li>«2» — размер IP-пакета слишком большой;</li><li>«3» — превышение времени;</li><li><p>«4» — параметрическая проблема;</p></li></ul></li><li><p class="b">Информационные сообщения:</p><ul class="circle lia"><li>«128» — запрашивающий эхо-пакет;</li><li>«129» — ответный эхо-пакет.</li></ul></li></ul><p>Каждому ICMPv6-сообщению предшествует IPv6-заголовок и может быть один или несколько (или не быть вообще) IPv6-заголовков расширения. ICMPv6-заголовок идентифицируется значением «58» в поле «Следующий заголовок» заголовка, который непосредственно предшествует ICMPv6-заголовку.</p><p class="note">Замечание. Это значение отличается от того, которое используется в стандарте ICMPv4.</p><p>На рис.1 представлен общий формат ICMPv6-сообщений.</p><div class="pic"><table class="fig"><tr><td>0<br>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>1<br>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>2<br>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>3<br>0</td><td>1</td></tr><tr><td colspan="8">«Тип ICMPv6-сообщения»</td><td colspan="8">«Тип кодирования»</td><td colspan="16">«Проверочная сумма»</td></tr><tr class="fig1"><td colspan="32">&nbsp;</td></tr><tr class="fig2"><td colspan="32">«Тело ICMPv6-сообщения»</td></tr><tr class="fig3"><td colspan="32">&nbsp;</td></tr></table><p>Рис.1. Общий формат ICMPv6-сообщений</p></div><p>Поле «Тип ICMPv6-сообщения» указывает на тип ICMPv6-сообщения. Значение, содержащееся в этом поле, определяет формат следующих за этим полем данных.</p><p>Поле «Тип кодирования» зависит от типа ICMPv6-сообщения. Оно предназначено для создания дополнительного уровня структуры сообщения.</p><p>Поле «Проверочная сумма» используется для обнаружения искаженных данных в ICMPv6-сообщении и некоторых частях IPv6-заголовка.</p><h3 id="p2.2">2.2. Определение адреса источника сообщения</h3><p>IP-узел, который передает ICMPv6-сообщение, должен определить IPv6-адреса источника и получателя сообщения и разместить их в IPv6-заголовке и только потом рассчитывать контрольную сумму. Если IP-узел имеет более одного адреса, то тогда он должен выбрать адрес источника сообщения следующим образом:</p><ol class="lat lia"><li><p>Если сообщение является ответом на сообщение, которое было принято этим IP-узлом и содержало один из его уникальных адресов, то тогда адрес источника в ответе должен быть таким, который был указан в принятом сообщении (адрес получателя).</p></li><li><p>Если сообщение является ответом на сообщение, которое было принято этим IP-узлом и содержало широковещательный или групповой адрес (причем данный IP-узел входит в это объединение узлов с таким адресом), то тогда адрес источника в ответе должен быть уникальным адресом того интерфейса, на который поступил IP-пакет с широковещательным или групповым адресом.</p></li><li><p>Если сообщение является ответом на сообщение, которое было передано по адресу, который не принадлежит данному IP-узлу (но было им получено), то тогда целесообразно, чтобы адрес источника был уникальным адресом этого IP-узла, который используется последним для диагностирования ошибок (то есть, наиболее приемлем для диагностирования ошибок). Например, если сообщение является ответом на IP-пакет, подлежащий дальнейшей ретрансляции, но которая не может быть успешно осуществлена, то тогда адрес источника в ответе должен быть уникальным адресом того интерфейса, на который поступил этот «бракованный» IP-пакет.</p></li><li><p>Во всех других случаях должна быть проверена маршрутная таблица этого IP-узла с целью определения интерфейса, который будет использоваться для передачи сообщения по указанному адресу назначения. После такой проверки в качестве адреса источника сообщения должен быть указан адрес, принадлежащий интерфейсу, который будет использоваться для передачи сообщения.</p></li></ol><h3 id="p2.3">2.3. Вычисление проверочной суммы сообщения</h3><p>Проверочная сумма вычисляется по битовой последовательности, включающей все ICMPv6-сообщение, начинающееся с поля «Тип ICMPv6-сообщения», и предварительно добавленный «псевдозаголовок», состоящий из отдельных полей IPv6-заголовка. «Псевдозаголовок» также содержит поле «Следующий заголовок» со значением «58».</p><p class="note">Замечание. Включение «псевдозаголовка» в последовательность для вычисления проверочной суммы ICMPv6-сообщения является новшеством по сравнению с IPv4-стандартом.</p><p>Перед вычислением проверочной суммы само поле «Проверочная сумма» заполняется нулями.</p><h3 id="p2.4">2.4. Правила обработки сообщений</h3><p>Прикладные программные ICMPv6-модули должны выполнять следующие требования при обработке ICMPv6-сообщений (<a href="../1122.rfc" title="RFC 1122 - Требования к хостам Internet - Коммуникационные уровни">RFC 1122</a>):</p><ol class="lat lia"><li><p>Если принято ICMPv6-сообщение об ошибке неизвестного типа, то тогда необходимо его передать на более высокий уровень Internet-архитектуры.</p></li><li><p>Если принято информационное ICMPv6-сообщение неизвестного типа, то тогда необходимо его «молча» уничтожить.</p></li><li><p>Каждое ICMPv6-сообщение об ошибке (тип сообщения &lt;128) содержит такую часть «бракованного» IPv6-пакета (пакета, содержащего ошибку), которая не превышает максимальный допустимый размер передаваемого IPv6-пакета.</p></li><li><p>В тех случаях, когда от протокола сетевого уровня (IP-уровня) требуется доставка ICMPv6-сообщения об ошибке на более высокий уровень для его обработки, то тогда тип протокола более высокого уровня «извлекается» из оригинального пакета (включенного в тело ICMPv6-сообщения об ошибке) и используется для выбора необходимого процесса более высокого уровня для устранения ошибки. Если оригинальный пакет имеет большое число заголовков расширения, то тогда возможна ситуация, при которой в ICMPv6-сообщении не будет представлен протокол более высокого уровня, вследствие сокращения размера оригинального пакета с целью недопущения превышения максимального разрешенного размера передаваемого IPv6-пакета. В таком случае, сообщение об ошибке незамедлительно уничтожается после какой-либо обработки на IP-уровне.</p></li><li><p>Не допускается передача ICMPv6-сообщения об ошибке в результате приема:</p><ol class="lia"><li><p>ICMPv6-сообщения об ошибке;</p></li><li><p>IPv6-пакета с групповым адресом (тогда существуют два исключения из этих правил:</p><ul class="circle lia"><li><p>сообщение о слишком большом пакете позволяет определить маршрут передачи IPv6-пакета с групповым адресом;</p></li><li><p>сообщение о параметрической проблеме, значение «2» в поле «Тип кодирования» указывает на не известный тип дополнительной IPv6-функции, поле которой («Тип дополнительной функции») содержит два старших бита «10»);</p></li></ul></li><li><p>Пакета, который был передан с групповым адресом, но в интересах протокола канального уровня (порядок действий определен в п.5.2).</p></li><li><p>Пакета, который был передан с широковещательным адресом, но в интересах протокола канального уровня (порядок действий определен в п.5.2).</p></li><li><p>Пакета, содержащего адрес источника, который не однозначно определяет IP-узел, передавший сообщение (например, неопределенный IPv6-адрес, групповой IPv6-адрес или адрес, известный отправителю ICMPv6-сообщения, но являющийся произвольным IPv6-адресом.</p></li></ol></li><li><p>В заключении, с целью ограничения затрат (связанных с использованием пропускной способности системы и доставкой данных) на передачу ICMPv6-сообщений об ошибках IP-узел должен ограничивать частоту их трансляции. Такая ситуация может возникнуть в том случае, когда источник, передающий последовательность ошибочных пакетов, не обращает внимание на ответные ICMPv6-сообщения об ошибках. Существует несколько способов реализации функции ограничения частоты трансляции, например:</p><ol class="lia"><li><p>Применение таймера (счетчика времени). Например, ограничение частоты передачи сообщений об ошибках для конкретного источника или для любого источника путем установления жесткого временного интервала, по прошествии которого разрешается передавать сообщение об ошибках (через «Т» миллисекунд);</p></li><li><p>Применение ограничения пропускной способности. Например, ограничение частоты передачи сообщений об ошибках через конкретный интерфейс путем закрепления жестко установленного процента пропускной способности интерфейса («F» процентов) за передачей таких сообщений.</p></li></ol><p>Параметры ограничения (например, «Т» и «F» из приведенных выше примеров) должны быть обязательно установлены в каждом IP-узле, причем должен быть предусмотрен «режим по умолчанию» (например, «Т=1сек», «нет=0сек» или «F=2%», «нет=0%»).</p></li></ol><h2 id="p3">3. ICMPv6-сообщения об ошибках</h2><h3 id="p3.1">3.1. Сообщение «Узел назначения не достижим»</h3><p>На рис.2 представлен формат сообщения «Узел назначения не достижим».</p><div class="pic"><table class="fig"><tr><td>0<br>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>1<br>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>2<br>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>3<br>0</td><td>1</td></tr><tr><td colspan="8">«Тип ICMPv6-сообщения»</td><td colspan="8">«Тип кодирования»</td><td colspan="16">«Проверочная сумма»</td></tr><tr><td colspan="32">«Не используется»</td></tr><tr class="fig0 fig1"><td colspan="32">В этом субполе размещается принятое ошибочное сообщение (либо его часть).</td></tr><tr class="fig0 fig2"><td colspan="32">При этом суммарный размер данного ICMPv6-сообщения не должен превышать</td></tr><tr class="fig0 fig3"><td colspan="32">максимальный разрешенный размер IPv6-пакета.</td></tr></table><p>Рис.2. Формат ICMPv6-сообщения «Узел назначения не достижим»</p></div><ul class="list"><li><p>Поле «Адрес получателя» IPv6-заголовка пакета:</p><p class="lia">Он копируется из поля «Адрес отправителя» IPv6-заголовка принятого ошибочного пакета.</p></li><li><p>Поле «Тип ICMPv6-сообщения» ICMPv6-сообщения:</p><p class="lia">Это поле содержит значение «1».</p></li><li><p>Поле «Тип кодирования» ICMPv6-сообщения:</p><p class="lia">Это поле может содержать следующие значения:</p><ul class="circle lia"><li>«0» — маршрут для этого адреса получателя не известен;</li><li>«1» — связь с этим адресатом административно запрещена;</li><li>«2» — это значение не определено;</li><li>«3» — адрес назначения не достижим;</li><li>«4» — порт назначения не достижим.</li></ul></li><li><p>Поле «Не используется» ICMPv6-сообщения:</p><p class="lia">Это поле не используется при всех значениях поля «Тип кодирования». Оно должно заполняться нулями отправителем и игнорироваться получателем.</p></li></ul><p class="b">Применение ICMPv6-сообщения «Узел назначения не достижим»:</p><p>Целесообразно, чтобы это сообщение формировалось маршрутизатором или программным IPv6-модулем, реализующим протокол сетевого уровня и размещенным в оригинальном IP-узле. Данное сообщение направляется в ответ на принятый пакет, который не может быть доставлен по указанному в нем адресу получателя по каким-либо причинам отличным от состояния перегрузки. (ICMPv6-сообщение не должно формироваться, если пакет был уничтожен вследствие состояния перегрузки.)</p><p>Если причиной отказа от дальнейшей ретрансляции пакета является отсутствие адреса получателя в таблице маршрутизации передающего IP-узла, то тогда в поле «Тип кодирования» устанавливается значение «0».</p><p class="note">Замечание. Такую ошибку могут обнаружить только те IP-узлы, которые не содержат в своих маршрутных таблицах «маршрута по умолчанию».</p><p>Если причиной отказа от дальнейшей ретрансляции пакета является административный запрет (например, сетевой фильтр), то тогда в поле «Тип кодирования» устанавливается значение «1».</p><p>Если существует какая-либо другая причина для отказа от дальнейшей ретрансляции пакета (например, невозможность отображения IPv6-адреса получателя в соответствующий канальный адрес или определенного рода канально-ориентированная проблема), то тогда в поле «Тип кодирования» устанавливается значение «3».</p><p>Целесообразно, чтобы IP-узел-получатель передавал ответное ICMPv6-сообщение «Узел назначения не достижим» со значением «4» в поле «Тип кодирования», если он получил пакет, для которого протокол транспортного уровня (например, UDP) не обнаружен, или если такой транспортный протокол не имеет других средств для информирования передающей стороны.</p><p class="b">Уведомление протокола вышележащего уровня:</p><p>IP-узел, который получил ICMPv6-сообщение «Узел назначения не достижим», должен уведомить протокольный процесс вышележащего уровня.</p><h3 id="p3.2">3.2. Сообщение «Размер IP-пакета слишком большой»</h3><p>На рис.3 представлен формат сообщения «Размер IP-пакета слишком большой».</p><div class="pic"><table class="fig"><tr><td>0<br>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>1<br>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>2<br>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>3<br>0</td><td>1</td></tr><tr><td colspan="8">«Тип ICMPv6-сообщения»</td><td colspan="8">«Тип кодирования»</td><td colspan="16">«Проверочная сумма»</td></tr><tr><td colspan="32">«Максимальный разрешенный размер IP-пакета для передачи»</td></tr><tr class="fig0 fig1"><td colspan="32">В этом субполе размещается принятое ошибочное сообщение (либо его часть).</td></tr><tr class="fig0 fig2"><td colspan="32">При этом суммарный размер данного ICMPv6-сообщения не должен превышать</td></tr><tr class="fig0 fig3"><td colspan="32">максимальный разрешенный размер IPv6-пакета.</td></tr></table><p>Рис.3. Формат ICMPv6-сообщения «Размер IP-пакета слишком большой»</p></div><ul class="list"><li><p>Поле «Адрес получателя» IPv6-заголовка пакета:</p><p class="lia">Он копируется из поля «Адрес отправителя» IPv6-заголовка принятого ошибочного пакета.</p></li><li><p>Поле «Тип ICMPv6-сообщения» ICMPv6-сообщения:</p><p class="lia">Это поле содержит значение «2».</p></li><li><p>Поле «Тип кодирования» ICMPv6-сообщения:</p><p class="lia">Это поле содержит значение «0», которое устанавливает отправитель, а само поле игнорируется получателем.</p></li><li><p>Поле «Максимальный разрешенный размер IP-пакета для передачи» ICMPv6-сообщения:</p><p class="lia">В этом поле содержится значение максимального разрешенного размера IP-пакета для передачи через следующий ретрансляционный интервал.</p></li></ul><p class="b">Применение ICMPv6-сообщения «Размер IP-пакета слишком большой»:</p><p>Это сообщение должно передаваться маршрутизатором в ответ на принятый IP-пакет, который имеет размер, превышающий максимальный разрешенный (для входного интерфейса конкретного канала связи) и поэтому не может ретранслироваться дальше. Информация в этом сообщении используется в процедуре определения маршрута, по которому можно передать IP-пакет наибольшего размера («Path MTU Discovery»).</p><p>Передача ICMPv6-сообщения «Размер IP-пакета слишком большой» разрешена в одном из случаев, при которых передача этого сообщения запрещена. Таким событием (исключением из правил) является ответ на принятый IP-пакет, содержащий групповой ICMPv6-адрес назначения или групповой/широковещательный адрес канального уровня.</p><p class="b">Уведомление протокола вышележащего уровня:</p><p>IP-узел, который получил ICMPv6-сообщение «Размер IP-пакета слишком большой», должен передать его протокольному процессу вышележащего уровня.</p><h3 id="p3.3">3.3. Сообщение «Превышение времени»</h3><p>На рис.4 представлен формат сообщения «Превышение времени».</p><div class="pic"><table class="fig"><tr><td>0<br>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>1<br>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>2<br>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>3<br>0</td><td>1</td></tr><tr><td colspan="8">«Тип ICMPv6-сообщения»</td><td colspan="8">«Тип кодирования»</td><td colspan="16">«Проверочная сумма»</td></tr><tr><td colspan="32">«Не используется»</td></tr><tr class="fig0 fig1"><td colspan="32">В этом субполе размещается принятое ошибочное сообщение (либо его часть).</td></tr><tr class="fig0 fig2"><td colspan="32">При этом суммарный размер данного ICMPv6-сообщения не должен превышать</td></tr><tr class="fig0 fig3"><td colspan="32">максимальный разрешенный размер IPv6-пакета.</td></tr></table><p>Рис.4. Формат ICMPv6-сообщения «Превышение времени»</p></div><ul class="list"><li><p>Поле «Адрес получателя» IPv6-заголовка пакета:</p><p class="lia">Он копируется из поля «Адрес отправителя» IPv6-заголовка принятого ошибочного пакета.</p></li><li><p>Поле «Тип ICMPv6-сообщения» ICMPv6-сообщения:</p><p class="lia">Это поле содержит значение «3».</p></li><li><p>Поле «Тип кодирования» ICMPv6-сообщения:</p><p class="lia">Это поле может содержать следующие значения:</p><ul class="circle lia"><li><p>«0» — при доставке IP-пакета превышено разрешенное число ретрансляционных участков;</p></li><li><p>«1» — превышено время повторной сборки фрагментов.</p></li></ul></li><li><p>Поле «Не используется» ICMPv6-сообщения:</p><p class="lia">Это поле не используется при всех значениях поля «Тип кодирования». Оно должно заполняться нулями отправителем и игнорироваться получателем.</p></li></ul><p class="b">Применение ICMPv6-сообщения «Превышение времени»:</p><p>Если маршрутизатор принял IP-пакет, в котором поле IP-заголовка «Максимальное число ретрансляционных участков» содержит значение ноль или сам маршрутизатор «обнуляет» это поле, то тогда он должен уничтожить этот принятый IP-пакет и передать ICMPv6-сообщение «Размер IP-пакета слишком большой» (со значением «0» в поле «Тип кодирования») источнику этого ошибочного IP-пакета. Это означает, что имел место «петлевой маршрут» или максимальное число ретрансляционных участков слишком мало.</p><p class="b">Уведомление протокола вышележащего уровня:</p><p>IP-узел, который получил ICMPv6-сообщение «Превышение времени», должен передать его протокольному процессу вышележащего уровня.</p><h3 id="p3.4">3.4. Сообщение «Параметрическая проблема»</h3><p>На рис.5 представлен формат сообщения «Параметрическая проблема».</p><div class="pic"><table class="fig"><tr><td>0<br>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>1<br>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>2<br>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>3<br>0</td><td>1</td></tr><tr><td colspan="8">«Тип ICMPv6-сообщения»</td><td colspan="8">«Тип кодирования»</td><td colspan="16">«Проверочная сумма»</td></tr><tr><td colspan="32">«Указатель»</td></tr><tr class="fig0 fig1"><td colspan="32">В этом субполе размещается принятое ошибочное сообщение (либо его часть).</td></tr><tr class="fig0 fig2"><td colspan="32">При этом суммарный размер данного ICMPv6-сообщения не должен превышать</td></tr><tr class="fig0 fig3"><td colspan="32">максимальный разрешенный размер IPv6-пакета.</td></tr></table><p>Рис.5. Формат ICMPv6-сообщения «Параметрическая проблема»</p></div><ul class="list"><li><p>Поле «Адрес получателя» IPv6-заголовка пакета:</p><p class="lia">Он копируется из поля «Адрес отправителя» IPv6-заголовка принятого ошибочного пакета.</p></li><li><p>Поле «Тип ICMPv6-сообщения» ICMPv6-сообщения:</p><p class="lia">Это поле содержит значение «4».</p></li><li><p>Поле «Тип кодирования» ICMPv6-сообщения:</p><p class="lia">Это поле может содержать следующие значения:</p><ul class="circle lia"><li><p>«0» — обнаружено ошибочное поле заголовка;</p></li><li><p>«1» — обнаружен неопределенный тип поля «Следующий заголовок»;</p></li><li><p>«2» — обнаружена неопределенная дополнительная IPv6-функция.</p></li></ul></li><li><p>Поле «Указатель» ICMPv6-сообщения:</p><p class="lia">Определяет номер октета внутри ошибочного пакета (место в пакете), где обнаружена ошибка. Указатель будет размещаться в конце ICMPv6-пакета, если ошибка находится за пределами той части сообщения, которая не превышает максимальный разрешенный размер ICMPv6-сообщения об ошибке.</p></li></ul><p class="b">Применение ICMPv6-сообщения «Параметрическая проблема»:</p><p>Если IPv6-узел, обрабатывающий пакет, найдет в нем проблемную ошибку, связанную с корректностью поля в IPv6-заголовке или заголовке расширения, которая не позволяет ему завершить обработку пакета, то тогда узел должен уничтожить принятый ошибочный пакет. Также целесообразно, передать ICMPv6-сообщение «Параметрическая проблема» по адресу источника ошибочного пакета, указав в нем тип и место обнаруженной параметрической проблемы.</p><p>Указатель определяет октет оригинального заголовка пакета, где была вскрыта ошибка. Например, ICMPv6-сообщение «Параметрическая проблема» со значениями «4» в поле «Тип ICMPv6-сообщения», «1» в поле «Тип кодирования» и «40» в поле «Указатель» будет означать, что IPv6-заголовок расширения, следующий за IPv6-заголовком, оригинального пакета содержит неопределенное значение в поле «Следующий заголовок».</p><p class="b">Уведомление протокола вышележащего уровня:</p><p>IP-узел, который получил ICMPv6-сообщение «Параметрическая проблема», должен уведомить протокольный процесс вышележащего уровня.</p><h2 id="p4">4. Информационные ICMPv6-сообщения</h2><h3 id="p4.1">4.1. Сообщение «Эхо-пакет – запрос»</h3><p>На рис.6 представлен формат сообщения «Эхо-пакет – запрос».</p><div class="pic"><table class="fig"><tr><td>0<br>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>1<br>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>2<br>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>3<br>0</td><td>1</td></tr><tr><td colspan="8">«Тип ICMPv6-сообщения»</td><td colspan="8">«Тип кодирования»</td><td colspan="16">«Проверочная сумма»</td></tr><tr><td colspan="16">«Идентификатор»</td><td colspan="16">«Последовательный номер»</td></tr><tr class="fig4"><td colspan="7" class="fig5">«Данные»</td><td colspan="25" class="fig6">…</td></tr></table><p>Рис.6. Формат ICMPv6-сообщения «Эхо-пакет – запрос»</p></div><ul class="list"><li><p>Поле «Адрес получателя» IPv6-заголовка пакета:</p><p class="lia">Любой допустимый IPv6-адрес.</p></li><li><p>Поле «Тип ICMPv6-сообщения» ICMPv6-сообщения:</p><p class="lia">Это поле содержит значение «128».</p></li><li><p>Поле «Тип кодирования» ICMPv6-сообщения:</p><p class="lia">Это поле содержит значение «0».</p></li><li><p>Поле «Идентификатор» ICMPv6-сообщения:</p><p class="lia">Это поле позволяет различать ICMPv6-сообщения «Эхо-пакет – запрос» и «Эхо-пакет – ответ». Это поле может заполняться нулями.</p></li><li><p>Поле «Последовательный номер» ICMPv6-сообщения:</p><p class="lia">Это поле позволяет различать ICMPv6-сообщения «Эхо-пакет – запрос» и «Эхо-пакет – ответ». Это поле может заполняться нулями.</p></li><li><p>Поле «Данные» ICMPv6-сообщения:</p><p class="lia">Это поле содержит произвольные данные (любое число октетов, включая ноль октетов).</p></li></ul><p class="b">Применение ICMPv6-сообщения «Превышение времени»:</p><p>Каждый IPv6-узел должен выполнять функцию ответов на «Эхо-пакеты – запросы» путем передачи «Эхо-пакетов – ответов». Также целесообразно, чтобы IPv6-узлы имели специализированный прикладной интерфейс для передачи «Эхо-пакетов – запросов» и приема «Эхо-пакетов – ответов» (в диагностических целях).</p><p class="b">Уведомление протокола вышележащего уровня:</p><p>IP-узел, который получил ICMPv6-сообщение «Эхо-пакет – запрос», может передать его протокольному процессу вышележащего уровня, осуществляемому обработку таких сообщений.</p><h3 id="p4.2">4.2. Сообщение «Эхо-пакет – ответ»</h3><p>На рис.7 представлен формат сообщения «Эхо-пакет – ответ».</p><div class="pic"><table class="fig"><tr><td>0<br>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>1<br>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>2<br>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>3<br>0</td><td>1</td></tr><tr><td colspan="8">«Тип ICMPv6-сообщения»</td><td colspan="8">«Тип кодирования»</td><td colspan="16">«Проверочная сумма»</td></tr><tr><td colspan="16">«Идентификатор»</td><td colspan="16">«Последовательный номер»</td></tr><tr class="fig4"><td colspan="7" class="fig5">«Данные»</td><td colspan="25" class="fig6">…</td></tr></table><p>Рис.7. Формат ICMPv6-сообщения «Эхо-пакет — ответ»</p></div><ul class="list"><li><p>Поле «Адрес получателя» IPv6-заголовка пакета:</p><p class="lia">Он копируется из поля «Адрес отправителя» IPv6-заголовка принятого пакета «Эхо-пакет – запрос».</p></li><li><p>Поле «Тип ICMPv6-сообщения» ICMPv6-сообщения:</p><p class="lia">Это поле содержит значение «129».</p></li><li><p>Поле «Тип кодирования» ICMPv6-сообщения:</p><p class="lia">Это поле содержит значение «0».</p></li><li><p>Поле «Идентификатор» ICMPv6-сообщения:</p><p class="lia">Это поле копируется из ICMPv6-сообщения «Эхо-пакет – запрос».</p></li><li><p>Поле «Последовательный номер» ICMPv6-сообщения:</p><p class="lia">Это поле копируется из ICMPv6-сообщения «Эхо-пакет – запрос».</p></li><li><p>Поле «Данные» ICMPv6-сообщения:</p><p class="lia">Это поле содержит данные из ICMPv6-сообщения «Эхо-пакет – запрос».</p></li></ul><p class="b">Применение ICMPv6-сообщения «Превышение времени»:</p><p>Каждый IPv6-узел должен выполнять функцию ответов на «Эхо-пакеты – запросы» путем передачи «Эхо-пакетов – ответов». Также целесообразно, чтобы IPv6-узлы имели специализированный прикладной интерфейс для передачи «Эхо-пакетов – запросов» и приема «Эхо-пакетов – ответов» (в диагностических целях). Адрес источника в «Эхо-пакете – ответе», направленном в ответ на «Эхо-пакет – запрос» с уникальным адресом, должен быть таким же как и адрес получателя в принятом «Эхо-пакете – запросе».</p><p>Целесообразно, чтобы «Эхо-пакет – ответ» направлялся в ответ на принятый «Эхо-пакет – запрос», который содержал групповой адрес. В этом случае адрес источника в «Эхо-пакете – ответе» должен быть адрес интерфейса на который поступил «Эхо-пакет – запрос» с групповым адресом (то есть адрес того интерфейса, который «обслуживает» пакеты с групповыми адресами).</p><p>Поле «Данные» в принятом «Эхо-пакете – запросе» должно передаваться полностью и без каких-либо изменений в ответном ICMPv6-сообщении «Эхо-пакет – ответ».</p><p class="b">Уведомление протокола вышележащего уровня:</p><p>IP-узел, который получил ICMPv6-сообщение «Эхо-пакет – ответ», должен передать его протокольному процессу, который был источником «Эхо-пакета – запроса». Оно также может быть передано протокольному процессу, который не был источником «Эхо-пакета – запроса».</p><h2 id="p5">5. Вопросы безопасности</h2><h3 id="p5.1">5.1. Аутентификация и шифрование ICMPv6-сообщений</h3><p>Информационный обмен ICMPv6-сообщениями может быть аутентифицирован с использованием IPsec АН-протокола (заголовка аутентификации). Целесообразно, чтобы IPv6-узел включал АН-заголовок в передаваемые им ICMPv6-сообщения, если защищенное виртуальное соединение (SA) на основе применения АН-протокола имеет такой же адрес назначения как и в ICMPv6-сообщениях. SA могут быть сформированы с помощью «ручной» процедуры настройки или с помощью какого-либо протокола управления SA и обменом ключевой информации.</p><p>Принимаемые в ICMPv6-сообщениях АН-заголовки должны проверяться на предмет их корректности, а те пакеты, которые не прошли данную проверку положительно, должны игнорироваться и уничтожаться.</p><p>Целесообразно, чтобы системный администратор имел возможность настройки IP-узла таким образом, чтобы последний игнорировал любые ICMPv6-сообщения, которые не аутентифицированы с помощью АН-протокола или ESP-протокола. Целесообразно, чтобы такой коммутатор (IP-узел) не обрабатывал сообщения, которые не прошли аутентификацию.</p><p>Более подробно вопросы безопасности рассмотрены в IPsec-стандартах.</p><h3 id="p5.2">5.2. Атаки на ICMP-протокол</h3><p>ICMP-сообщения могут быть объектами самых различных атак:</p><ol class="lia"><li><p>ICMP-сообщения могут быть объектами таких противоправных действий, при которых у получателя таких сообщений создается иллюзия того, что они поступили от истинного (оригинального) источника, а на самом деле, эти сообщения поступили от нарушителя. Защита от таких атак может быть достигнута путем применения механизма аутентификации ICMP-сообщений.</p></li><li><p>ICMP-сообщения могут быть объектами таких противоправных действий, при которых у отправителя таких сообщений создается иллюзия того, что они поступили к истинному (оригинальному) получателю, а на самом деле, эти сообщения поступили по тому адресу, который был необходим нарушителю. Вычисление проверочной суммы является одним из способов защиты от ошибок случайного, а не преднамеренного характера. Защита самой контрольной суммы осуществляется с помощью алгоритмов аутентификации или шифрования ICMP-сообщения.</p></li><li><p>ICMP-сообщения могут быть объектами таких противоправных действий, при которых изменяются отдельные поля сообщений или поля полезной нагрузки. Защита ICMP-сообщения от такого рода действий осуществляется с помощью алгоритмов аутентификации или шифрования.</p></li><li><p>ICMP-сообщения могут использоваться для организации атаки «Отказ в обслуживании» путем передачи один за другим ошибочных IP-пакетов.</p></li></ol><h2 id="p6">6. Ссылки</h2><table itemprop="references"><tr><td>[IPv6]</td><td> S. Deering и R. Hinden, <a href="../2460.rfc" title="RFC 2460 - Спецификация IPv6">«Спецификация IPv6», RFC 2460</a>, Декабрь 1998.</td></tr><tr><td>[IPv6-ADDR]</td><td>Hinden, R. и S. Deering, «IP Version 6 Addressing Architecture», RFC 2373, июль 1998.</td></tr><tr><td>[IPv6-DISC]</td><td>Narten, T., Nordmark, E. и W. Simpson, «Neighbor Discovery for IP Version 6 (IPv6)», RFC 2461, декабрь 1998.</td></tr><tr><td>[RFC-792]</td><td>J. Postel, <a href="../792.rfc" title="RFC 792 - Протокол ICMP">«Протокол ICMP», RFC 792</a>, Сентябрь 1981.</td></tr><tr><td>[RFC-1122]</td><td>Robert Braden, <a href="../1122.rfc" title="RFC 1122 - Требования к хостам Internet - Коммуникационные уровни">«Требования к хостам Internet - Коммуникационные уровни», RFC 1122</a>, Октябрь 1989.</td></tr><tr><td>[PMTU]</td><td>McCann, J., Deering, S. и J. Mogul, «Path MTU Discovery for IP version 6», RFC 1981, август 1996.</td></tr><tr><td>[RFC-2119]</td><td>Scott Bradner, <a href="../2119.rfc" title="RFC 2119 - Ключевые слова для обозначения уровня требований в RFC">«Ключевые слова для обозначения уровня требований в RFC», RFC 2119</a>, Март 1997.</td></tr><tr><td>[IPv6-SA]</td><td>Kent, S. и R. Atkinson, «Security Architecture for the Internet Protocol», RFC 2401, ноябрь 1998.</td></tr><tr><td>[IPv6-Auth]</td><td>Kent, S. и R. Atkinson, «IP Authentication Header», RFC 2402, ноябрь 1998.</td></tr><tr><td>[IPv6-ESP]</td><td>Kent, S. и R. Atkinson, «IP Encapsulating Security Protocol (ESP)», RFC 2406, ноябрь 1998.</td></tr></table><h2>7. Благодарности</h2><p>The document is derived from previous ICMP drafts of the SIPP and IPng working group.</p><p>The IPng working group and particularly Robert Elz, Jim Bound, Bill Simpson, Thomas Narten, Charlie Lynn, Bill Fink, Scott Bradner, Dimitri Haskin, and Bob Hinden (in chronological order) provided extensive review information and feedback.</p></div></div><div id="disqus_thread"></div><script type="text/javascript">var disqus_shortname="rfc2",disqus_title="RFC 2463 - Протокол передачи управляющих сообщений (ICMPv6) для 6-ой версии IP-протокола (IPv6)",disqus_identifier="2463.rfc",disqus_url="http://rfc2.ru/2463.rfc";(function(){var dsq=document.createElement("script");dsq.type="text/javascript";dsq.async=true;dsq.src = "//"+disqus_shortname+".disqus.com/embed.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(dsq);})();</script><div class="bubble">2007 - 2014 © <a href="../index.html" title="Русские переводы RFC">Русские переводы RFC</a>, IETF, ISOC.</div></div><div id="bottom" style="position:static !important;bottom:auto !important"><div class="bubble"><ul><li><!--723572853672--></li></ul></div></div><!-- Yandex.Metrika counter --><script type="text/javascript">(function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter4680559 = new Ya.Metrika({id:4680559, webvisor:true, clickmap:true, accurateTrackBounce:true, trackHash:true, ut:"noindex"}); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="http://mc.yandex.ru/watch/4680559?ut=noindex" style="position:absolute; left:-9999px;" alt="" /></div></noscript><!-- /Yandex.Metrika counter --></body></html>