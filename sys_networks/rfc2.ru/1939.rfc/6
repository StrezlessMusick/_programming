<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8" /><link rel="stylesheet" href="../tpl/style.css@f4e332aa" type="text/css" /><link rel="prev" href="5" /><link rel="next" href="7" /><link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css' /><style type="text/css">h1,h2,h3,h4{font-family:'Open Sans',sans-serif}</style><title>Перевод RFC 1939 — Протокол POP3, стр. 6</title><meta name="author" content="John G. Myers, Marshall T. Rose" /><link rel="alternate" type="application/rss+xml" title="RFC2.ru - Русские Переводы RFC" href="../rss.xml"></head><body><div id="content"><div id="nav"><div class="icon i0"></div> <a href="../index.html" accesskey="`">На Главную</a></div><div id="search" class="ya-site-form ya-site-form_inited_no"><form action="http://yandex.ru/sitesearch" method="get" target="_blank"><input type="hidden" name="searchid" value="2154295"/><input type="hidden" name="l10n" value="ru"/><input type="hidden" name="reqenc" value=""/><input type="hidden" name="submit" value="Найти"/><input type="search" value="" name="text" placeholder="Поиск по RFC2.ru" /></form></div><div itemscope itemtype="http://schema.org/ScholarlyArticle"><meta itemprop="inLanguage" content="ru" /><meta itemprop="editor" content="ru" /><div id="header"><h1><a itemprop="headline" href="../1939.rfc">RFC 1939 — Протокол POP3</a></h1></div><dl class="mute"><dt></dt><dd><div class="icon i1"></div> RFC: 1939</dd><dd><div class="icon i3"></div> Оригинал: <a href="original" target="_blank" rel="nofollow"><span itemprop="alternativeHeadline">Post Office Protocol - Version 3</span></a></dd><dd><div class="icon i7"></div> Предыдущие версии: RFC 1081, RFC 1225, RFC 1460, RFC 1725</dd><dd><div class="icon i2"></div> Категория: <span itemprop="articleSection">Стандарт Интернета</span></dd><dd><div class="icon i4"></div> Дата публикации: <time itemprop="datePublished" datetime="1996-05-01">Май 1996</time></dd><dd><div class="icon i5"></div> Авторы: <span itemprop="author">John G. Myers</span>, <span itemprop="author">Marshall T. Rose</span></dd><dd><div class="icon i6"></div> Перевод: <span itemprop="editor">?</span></dd></dl><div class="pages"><p class="r"> <h2 class="pt"><span class="z">RFC 1939,</span> Страница 6 из 9</h2></p><ul><li><noindex><a href="print" rel="nofollow">Одной Страницей</a></noindex></li><li><a accesskey="1" title="Первая страница" href="../1939.rfc" class="arr">&lArr;</a></li><li><a accesskey="2" title="На страницу назад" href="5"><b>&larr;</b></a></li><li><a href="../1939.rfc">1</a></li><li><a href="2">2</a></li><li><a href="3">3</a></li><li><a href="4">4</a></li><li><a href="5">5</a></li><li class="this"><span>6</span></li><li><a href="7">7</a></li><li><a href="8">8</a></li><li><a href="9">9</a></li><li><a accesskey="3" title="На страницу вперед" href="7">&rarr;</a></li><li><a accesskey="4" title="Последняя страница" href="9">&rArr;</a></li></ul></div><div id="text" itemprop="articleBody"><h2 id="p7">7. Необязательные команды</h2><p>POP3 команды, описанные выше, должны поддерживаться всеми POP3 серверами.</p><p>Дополнительные команды дают клиенту большую свободу в обработке сообщений, сохраняя простоту реализации POP3-сервера.</p><p class="note">Примечание: этот документ поощряет поддержку дополнительных команд, вместо внесений дополнительных сведений в «drop listing» и «scan listing». Короче говоря, философия этого документа — поместить весь интеллект в часть POP3-клиента, а не сервера.</p><p class="b">TOP [сообщение] [количество строк]</p><ul><li>Аргументы:</li><li class="lib"><p>Номер сообщения (обязательный) и неотрицательное число, указывающее на количество строк тела сообщения которое сервер передаст клиенту, аргумент обязательный. Нельзя обращаться к сообщениям, помеченным как удаленные.</p></li><li>Ограничения:</li><li class="lib"><p>Может быть передана только в состоянии TRANSACTION.</p></li><li>Подробности:</li><li class="lib"><p>После положительного ответа, сервер посылает многострочный ответ. После начального +OK, сервер посылает заголовок сообщения, пустую строку и указанное количество строк из тела сообщения.</p><p class="note">Примечание: Если число строк, которые требует клиент, больше числа строк в сообщение, то сервер передает все сообщение полностью.</p></li><li>Возможные ответы:</li><li class="lib"><p>+OK top of message follows<br />-ERR no such message</p></li><li>Примеры:</li><li class="lib"><pre>
C: TOP 1 10
S: +OK
S: &lt;the POP3 server sends the headers of the
   message, a blank line, and the first 10 lines
   of the body of the message&gt;
S: .
   ...
C: TOP 100 3
S: -ERR no such message</pre></li></ul><p class="b">UIDL [сообщение]</p><ul><li>Аргументы:</li><li class="lib"><p>Номер сообщения (необязательный). Нельзя обратиться к сообщению помеченному как удаленное.</p></li><li>Ограничения:</li><li class="lib"><p>Может быть передана только в состоянии TRANSACTION.</p></li><li>Подробности:</li><li class="lib"><p>Если аргумент задан, сервер посылает положительный ответ со строкой содержащей информацию о заданном сообщении. Эта строка называется «unique-id listing».</p><p>Если аргумент не задан, то при положительном ответе сервер посылает многострочный ответ. После индикатора состояния (+OK), и строку содержащую информацию о сообщении.</p><p>Для упрощения синтаксического разбора все сервера должны использовать определенный формат «unique-id listing». «unique-id listing» состоит из номера сообщения и уникального идентификатора разделенные одиночным пробелом. За уникальным идентификатором не должно следовать ни какой дополнительной информации.</p><p>Уникальный идентификатор это произвольная, определяемая сервером, строка, содержащая 1-70 символов в диапазоне от 0x21 до 0x7E, которая однозначно идентифицирует сообщение в пределах почтового ящика. Идентификатор сохраняется на все время сессии. Это постоянство требуется, даже если сеанс закончился не переходя в состояние UPDATE. Сервер не должен многократно использовать идентификатор для данного почтового ящика, пока существует объект использующий его. Сообщения помеченные как удаленные не учитываются.</p></li><li>Возможные ответы:</li><li class="lib"><p>+OK unique-id listing follows<br />-ERR no such message</p></li><li>Примеры:</li><li class="lib"><pre>
C: UIDL
S: +OK
S: 1 whqtswO00WBw418f9t5JxYwZ
S: 2 QhdPYR:00WBw1Ph7x7
S: .
   ...
C: UIDL 2
S: +OK 2 QhdPYR:00WBw1Ph7x7
   ...
C: UIDL 3
S: -ERR no such message, only 2 messages in maildrop</pre></li></ul><p class="b">USER [имя]</p><ul><li>Аргументы:</li><li class="lib"><p>Строка идентификации почтового ящика (обязательный).</p></li><li>Ограничения:</li><li class="lib"><p>Может быть передана только в состоянии AUTHORIZATION после POP3 приветствия или неуспешной команды USER или PASS.</p></li><li>Подробности:</li><li class="lib"><p>To authenticate using the USER and PASS command combination, the client must first issue the USER command. If the POP3 server responds with a positive status indicator («+OK»), then the client may issue either the PASS command to complete the authentication, or the QUIT command to terminate the POP3 session. If the POP3 server responds with a negative status indicator («-ERR») to the USER command, then the client may either issue a new authentication command or may issue the QUIT command.</p><p>The server may return a positive response even though no such mailbox exists. The server may return a negative response if mailbox exists, but does not permit plaintext password authentication.</p></li><li>Возможные ответы:</li><li class="lib"><p>+OK name is a valid mailbox<br />-ERR never heard of mailbox name</p></li><li>Примеры:</li><li class="lib"><pre>C: USER mrose
S: +OK mrose is a real hoopy frood
   ...
C: USER frated
S: -ERR sorry, no mailbox for frated here</pre></li></ul><p class="b">PASS [строка]</p><ul><li>Аргументы:</li><li class="lib"><p>пароль к почтовому ящику (обязательный).</p></li><li>Ограничения:</li><li class="lib"><p>Может быть передана только в состоянии AUTHORIZATION после успешной команды USER.</p></li><li>Подробности:</li><li class="lib"><p>When the client issues the PASS command, the POP3 server uses the argument pair from the USER and PASS commands to determine if the client should be given access to the appropriate maildrop.</p><p>Команда PASS имеет только один аргумент, сервер может трактовать пробел в параметре как часть пароля, вместо разделителя аргументов.</p></li><li>Возможные ответы:</li><li class="lib"><p>+OK maildrop locked and ready<br />-ERR invalid password<br />-ERR unable to lock maildrop</p></li><li>Примеры:</li><li class="lib"><pre>
C: USER mrose
S: +OK mrose is a real hoopy frood
C: PASS secret
S: +OK mrose's maildrop has 2 messages (320 octets)
  ...
C: USER mrose
S: +OK mrose is a real hoopy frood
C: PASS secret
S: -ERR maildrop already locked</pre></li></ul><p class="b">APOP [имя] [digest]</p><ul><li>Аргументы:</li><li class="lib"><p>Строка идентифицирующая почтовый ящик и MD5 digest (шифрованная по алгоритму MD5 строка пароля), оба параметра обязательные.</p></li><li>Ограничения:</li><li class="lib"><p>may only be given in the AUTHORIZATION state after the POP3 greeting or after an unsuccessful USER or PASS command</p></li><li>Подробности:</li><li class="lib"><p>Normally, each POP3 session starts with a USER/PASS exchange.  This results in a server/user-id specific password being sent in the clear on the network.  For intermittent use of POP3, this may not introduce a sizable risk.  However, many POP3 client implementations connect to the POP3 server on a regular basis — to check for new mail.  Further the interval of session initiation may be on the order of five minutes.  Hence, the risk of password capture is greatly enhanced.</p><p>An alternate method of authentication is required which provides for both origin authentication and replay protection, but which does not involve sending a password in the clear over the network.  The APOP command provides this functionality.</p><p>A POP3 server which implements the APOP command will include a timestamp in its banner greeting.  The syntax of the timestamp corresponds to the «msg-id» in [RFC822], and MUST be different each time the POP3 server issues a banner greeting.  For example, on a UNIX implementation in which a separate UNIX process is used for each instance of a POP3 server, the syntax of the timestamp might be:</p><pre>&lt;process-ID.clock@hostname&gt;</pre><p>where «process-ID» is the decimal value of the process's PID, clock is the decimal value of the system clock, and hostname is the fully-qualified domain-name corresponding to the host where the POP3 server is running.</p><p>The POP3 client makes note of this timestamp, and then issues the APOP command.  The «name» parameter has identical semantics to the «name» parameter of the USER command. The «digest» parameter is calculated by applying the MD5 algorithm [<a href="../1321.rfc" title="RFC 1321 - Алгоритм цифровых подписей MD5">RFC1321</a>] to a string consisting of the timestamp (including angle-brackets) followed by a shared secret.  This shared secret is a string known only to the POP3 client and server.  Great care should be taken to prevent unauthorized disclosure of the secret, as knowledge of the secret will allow any entity to successfully masquerade as the named user.  The «digest» parameter itself is a 16-octet value which is sent in hexadecimal format, using lower-case ASCII characters.</p><p>When the POP3 server receives the APOP command, it verifies the digest provided.  If the digest is correct, the POP3 server issues a positive response, and the POP3 session enters the TRANSACTION state.  Otherwise, a negative response is issued and the POP3 session remains in the AUTHORIZATION state.</p><p>Note that as the length of the shared secret increases, so does the difficulty of deriving it.  As such, shared secrets should be long strings (considerably longer than the 8-character example shown below).</p></li><li>Возможные ответы:</li><li class="lib"><p>+OK maildrop locked and ready<br />-ERR permission denied</p></li><li>Примеры:</li><li class="lib"><pre>
S: +OK POP3 server ready &lt;1896.697170952@dbc.mtview.ca.us&gt;
C: APOP mrose c4c9334bac560ecc979e58001b3e22fb
S: +OK maildrop has 1 message (369 octets)

In this example, the shared  secret  is  the  string  «tan-
staaf». Hence, the MD5 algorithm is applied to the string

   &lt;1896.697170952@dbc.mtview.ca.us&gt;tanstaaf

which produces a digest value of

   c4c9334bac560ecc979e58001b3e22fb</pre></li></ul></div></div><noindex><div class="pages"><p class="r"> <b>Страница 6 из 9</b></p><ul><li><noindex><a href="print" rel="nofollow">Одной Страницей</a></noindex></li><li><a title="Первая страница" href="../1939.rfc" class="arr">&lArr;</a></li><li><a title="На страницу назад" href="5"><b>&larr;</b></a></li><li><a href="../1939.rfc">1</a></li><li><a href="2">2</a></li><li><a href="3">3</a></li><li><a href="4">4</a></li><li><a href="5">5</a></li><li class="this"><span>6</span></li><li><a href="7">7</a></li><li><a href="8">8</a></li><li><a href="9">9</a></li><li><a title="На страницу вперед" href="7">&rarr;</a></li><li><a title="Последняя страница" href="9">&rArr;</a></li></ul></div></noindex><div id="disqus_thread"></div><script type="text/javascript">var disqus_shortname="rfc2",disqus_title="RFC 1939 - Протокол POP3",disqus_identifier="1939.rfc",disqus_url="http://rfc2.ru/1939.rfc";(function(){var dsq=document.createElement("script");dsq.type="text/javascript";dsq.async=true;dsq.src = "//"+disqus_shortname+".disqus.com/embed.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(dsq);})();</script><div class="bubble">2007 - 2014 © <a href="../index.html" title="Русские переводы RFC">Русские переводы RFC</a>, IETF, ISOC.</div></div><div id="bottom" style="position:static !important;bottom:auto !important"><div class="bubble"><ul><li><!--723572853672--></li></ul></div></div><!-- Yandex.Metrika counter --><script type="text/javascript">(function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter4680559 = new Ya.Metrika({id:4680559, webvisor:true, clickmap:true, accurateTrackBounce:true, trackHash:true}); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="http://mc.yandex.ru/watch/4680559" style="position:absolute; left:-9999px;" alt="" /></div></noscript><!-- /Yandex.Metrika counter --></body></html>