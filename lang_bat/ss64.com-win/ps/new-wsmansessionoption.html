<!doctype html><html>
<head><meta charset="UTF-8">
<link rel="STYLESHEET" href="../main.css" type="text/css">
<title>New-WSManSessionOption | PowerShell | SS64.com</title>
</head><body><!-- #BeginLibraryItem "/Library/head_ps.lbi" --><div id="tnav"><ul>
<li class="tbtn"><a href="http://ss64.com/"> ( &nbsp;SS64 &nbsp;)</a></li>
<li class="tbtn"><a href="http://ss64.com/ps">PowerShell</a></li>
<li class="tbtn"><a href="syntax.html">Syntax</a></li>
<li><div id="search"><form action="http://www.google.com/search" method="get">
<button tabindex="-1" type="submit" id="q-img"></button>
<input type="text" name="q" id="q" size="27" maxlength="255" onblur="if(this.value=='')this.value='Search…';" onclick="if(this.value=='Search…')this.value='';" value="Search…">
<input type="hidden" name="sitesearch" value="ss64.com/ps/"></form></div></li>
</ul></div><!-- #EndLibraryItem --><h1>New-WSManSessionOption</h1> 
<p>Configure options (session input parameters) for WSMan cmdlets: Connect-WSMan, Invoke-WSManAction, Get-WSManInstance,
Set-WSManInstance.</p>
<pre>Syntax
      New-WSManSessionOption [-NoCompression] [-NoProxy]
         [-ProxyAuthentication] [-ProxyPassword <i>string</i>] [-ProxyUserName <i>string</i>]
            [-SkipCACheck] [-SkipCNCheck] [-SkipRevocation] [-SPNPort <i>int</i>]
               [-Timeout <i>int</i>] [-UnEncrypted] [-UseIEProxyconfig] [-UseProxyAutoDetection]
                  [-UseWinHTTPProxyConfig] [-UTF16] [<i>CommonParameters</i>]
    
Key
   -NoCompression
       Turn off packet compression in the session.
       Compression is enabled by default and the packets sent between the client and server
       are compressed. Compression uses more processor cycles, but it makes transmission faster.
<br>   -NoProxy
       Do not use a proxy server. All host names will be resolved locally.

   -ProxyAuthentication <i>string</i><br>       The authentication method to use at the proxy.
       Possible values are:<br>        <br>         Basic      The user name and password are sent in clear-text.<br>         Digest     A challenge-response scheme that uses a server-specified
                    data string for the challenge.<br>         <u>Negotiate</u>  A challenge-response scheme that negotiates with the server
                    or proxy to determine which scheme to use for authentication.(default)
                    Examples are the Kerberos protocol and NTLM.<br>        <br>   -ProxyPassword <i>string</i>
       A password to to be used for proxy authentication.<br>        <br>   -ProxyUserName <i>string</i>
       A user name to to be used for proxy authentication.<br>        <br>   -SkipCACheck
       Do not validate that the server certificate is signed by a trusted certificate
       authority (CA) when connecting over HTTPS. Use this option only when the remote
       computer is trusted by other means, for example, if the remote computer is part
       of a network that is physically secure and isolated or the remote computer is
       listed as a trusted host in the WS-Management configuration.<br>        <br>   -SkipCNCheck
       Specifies that the certificate common name (CN) of the server does not need to
       match the hostname of the server. This is used only in remote operations using HTTPS.
       This option should only be used for trusted computers.<br>        <br>   -SkipRevocation
       Do not validate the revocation status on the server certificate.<br>        <br>   -SPNPort <i>int</i>
       A port number to append to the connection Service Principal Name <i>SPN</i> 
       of the remote server.  An SPN is used with Kerberos or Negotiate authentication.<br>        <br>   -Timeout <i>int</i>
       The timeout in milliseconds for the WS-Management operation.<br>        <br>   -UnEncrypted
       Do not use encryption when doing remote operations over HTTP. <br>       Note: Unencrypted traffic is not allowed by default and must be enabled in the local configuration.<br>        <br>   -UseIEProxyconfig
       Use the Internet Explorer proxy configuration for the current user.
       This is the default setting.<br>        <br>   -UseProxyAutoDetection
       Force auto-detection of a proxy.<br>        <br>   -UseWinHTTPProxyConfig
       Use the proxy settings configured for WinHTTP.<br>        <br>   -UTF16
       Encode the request in UTF16 format rather than UTF8 format. The default is UTF8 encoding.

   <a href="common.html">CommonParameters</a>:
       -Verbose, -Debug, -ErrorAction, -ErrorVariable, -WarningAction, -WarningVariable,
       -OutBuffer -OutVariable.</pre>
<p>New-WSManSessionOption reduces the number of parameters required by other cmdlets and allows the settings to be stored in a variable and reused. </p>
<p><b>Examples</b></p>
<p>Copy a file from server64 to the local machine using SSL and skipping the CA check: </p>
<p><span class="code">PS C:\&gt;    $skip = New-WSManSessionOption -SkipCACheck<br>
PS C:\&gt; invoke-command -useSSL -SessionOption $skip server64 {get-content -encoding byte -ReadCount 0 &quot;E:\makecert.exe&quot;} | 
set-content -encoding byte C:\Documents\makecert.exe </span></p>
<p class="quote"><i>“In photography, the smallest thing can be a great subject. The little, human detail can become a Leitmotiv” ~ Henri Cartier-Bresson</i></p>
<p><b>Related:</b></p>
<p><a href="connect-wsman.html">Connect-WSMan</a> Connect to the WinRM service on a remote computer<br>
<a href="invoke-wsmanaction.html">Invoke-WSManAction</a> - Invoke an action on a specified object<br>
<a href="get-wsmaninstance.html">Get-WSManInstance</a> Display management information (XML or value)<a href="set-wsmaninstance.html"><br>
Set-WSManInstance</a> - Modify the management information related to a resource</p><!-- #BeginLibraryItem "/Library/foot_ps.lbi" --><p><script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- PowerShell336 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:336px;height:280px"
     data-ad-client="ca-pub-6140977852749469"
     data-ad-slot="6318961509"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<hr>
<div id=bl class="footer"><a href="new-wsmansessionoption.html#"><img src="../images/top.png" width="30" height="22" alt="Back to the Top"></a></div>
<div id=br class="footer, tagline">&copy; Copyright <a href="http://ss64.com/">SS64.com</a> 1999-2014<br>
Some rights reserved</div><!-- #EndLibraryItem --></body>
</html>
