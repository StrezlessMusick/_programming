<!doctype html><html>
<head><meta charset="UTF-8">
<link rel="STYLESHEET" href="../main.css" type="text/css">
<title>Set-ExecutionPolicy | PowerShell | SS64.com</title>
</head><body><!-- #BeginLibraryItem "/Library/head_ps.lbi" --><div id="tnav"><ul>
<li class="tbtn"><a href="http://ss64.com/"> ( &nbsp;SS64 &nbsp;)</a></li>
<li class="tbtn"><a href="http://ss64.com/ps">PowerShell</a></li>
<li class="tbtn"><a href="syntax.html">Syntax</a></li>
<li><div id="search"><form action="http://www.google.com/search" method="get">
<button tabindex="-1" type="submit" id="q-img"></button>
<input type="text" name="q" id="q" size="27" maxlength="255" onblur="if(this.value=='')this.value='Search…';" onclick="if(this.value=='Search…')this.value='';" value="Search…">
<input type="hidden" name="sitesearch" value="ss64.com/ps/"></form></div></li>
</ul></div><!-- #EndLibraryItem --><h1>Set-ExecutionPolicy</h1> 
<p>Change the user preference for the execution policy of the shell.</p>
<pre>Syntax
      Set-ExecutionPolicy [-executionPolicy] <i>Policy</i>
        <b>{ </b>Unrestricted <b>|</b> RemoteSigned <b>|</b> AllSigned <b>|</b> Restricted <b>|</b> Default <b>|</b> Bypass <b>|</b> Undefined<b>}</b>
            [[-Scope] <i>ExecutionPolicyScope</i> ] [-Force]
               [-whatIf] [-confirm] [<a href="common.html"><i>CommonParameters</i></a>]

Key
   -ExecutionPolicy <i>Policy</i>
       A new execution policy for the shell.

       Valid values:
        
       <u>Restricted</u>
       Do not load configuration files or run scripts.
       This is the default.
        
       AllSigned
       Require that all scripts and configuration files be signed
       by a trusted publisher, including scripts that you write on the
       local computer.
        
       RemoteSigned
       Require that all scripts and configuration files downloaded
       from the Internet be signed by a trusted publisher.
        
       Unrestricted
       Load all configuration files and run all scripts.
       If you run an unsigned script that was downloaded from the
       internet, you are prompted for permission before it runs.

       Bypass
       Nothing is blocked and there are no warnings or prompts.<br>        <br>       Undefined
       Remove the currently assigned execution policy from the
       current scope. This parameter will not remove an execution
       policy that is set in a Group Policy scope.

   -Force
       Suppress all prompts.
       By default, Set-ExecutionPolicy displays a warning whenever the
       execution policy is changed.<br>        <br>    -Scope <i>ExecutionPolicyScope</i>
       The scope of the execution policy.<br>        <br>       Valid values:<br>         Process       Affect only the current PowerShell process.<br>         CurrentUser   Affect only the current user.<br>         <u>LocalMachine</u>  Affect all users of the computer.<br>        <br>       To remove an execution policy from a particular scope, set the
       execution policy for that scope to Undefined.

   -WhatIf
       Describe what would happen if you executed the command without actually
       executing the command.
        
   -Confirm
       Prompt for confirmation before executing the command.

   <a href="common.html">CommonParameters</a>:
       -Verbose, -Debug, -ErrorAction, -ErrorVariable, -WarningAction, -WarningVariable,
       -OutBuffer -OutVariable.</pre>
<p>
  <b>Runing unsigned scripts</b></p>
<p>If  the PowerShell execution policy is set to RemoteSigned it is still possible to run unsigned scripts:</p>
<p> Save the script file on your computer, Right-click the file, and click &quot;Properties.&quot; <br>
At the bottom of the dialogue box click &quot;Unblock.&quot;</p>
<p>Alternatively copy the text into a brand new text file and save it with a .ps1 extension. </p>
<p><b>64 bit Machines </b><br>
These will include both the 64 and 32bit version of PowerShell, they each can have different execution policies, so you need to set both.</p>
<p><b>Examples</b></p>
<p>Set the user preference for the shell execution policy to RemoteSigned and then display the effective execution policy. The commands are separated by a semicolon (;)</p>
<p><span class="code">PS C:\&gt; set-executionpolicy remotesigned; get-executionPolicy</span><br>
  <br>
  Get the execution policy from a remote computer, server64 and apply that execution policy to the local computer:</p>
<p class="code">PS C:\&gt; invoke-command -computername Server64 -scriptblock {get-executionpolicy} | set-executionpolicy -force</p>
<p>Set an execution policy of AllSigned for the current user, then the execution policies set in each scope:</p>
<p class="code">PS C:\&gt; set-executionpolicy -scope CurrentUser -executionPolicy AllSigned -force<br>
PS C:\&gt; get-executionpolicy -list</p>
<p>Set an execution policy value of Undefined to effectively remove the execution policy that is set for
the current user scope. As a result, the execution policy that is set in Group Policy or in the LocalMachine (all 
users) scope is effective:</p>
<p class="code">PS C:\&gt; set-executionpolicy -scope CurrentUser -executionPolicy Undefined</p>
<p>If  the execution policy in all scopes is set to Undefined and the Group Policy is not set, the default execution policy, <u>Restricted</u>, is effective for all users of the computer.</p>
<p class="quote"><i>&ldquo;Laughing on the way to your execution is not generally understood by less-advanced life forms, and they call you crazy&rdquo; ~ Richard Bach</i></p>
<p><b>Related:</b><br>
  <br>
<a href="set-authenticodesignature.html">Set-AuthenticodeSignature</a> - Sign a PowerShell script<br>
<a href="get-executionpolicy.html">Get-ExecutionPolicy</a> - Get the execution policy for the shell </p><!-- #BeginLibraryItem "/Library/foot_ps.lbi" --><p><script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- PowerShell336 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:336px;height:280px"
     data-ad-client="ca-pub-6140977852749469"
     data-ad-slot="6318961509"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<hr>
<div id=bl class="footer"><a href="set-executionpolicy.html#"><img src="../images/top.png" width="30" height="22" alt="Back to the Top"></a></div>
<div id=br class="footer, tagline">&copy; Copyright <a href="http://ss64.com/">SS64.com</a> 1999-2014<br>
Some rights reserved</div><!-- #EndLibraryItem --></body>
</html>
