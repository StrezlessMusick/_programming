<html lang="en">
<head>
<title>autom4te Invocation - Autoconf</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="Autoconf">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Using-autom4te.html#Using-autom4te" title="Using autom4te">
<link rel="next" href="Customizing-autom4te.html#Customizing-autom4te" title="Customizing autom4te">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
This manual (24 April 2012) is for GNU Autoconf
(version 2.69),
a package for creating scripts to configure source code packages using
templates and an M4 macro package.

Copyright (C) 1992-1996, 1998-2012 Free Software Foundation,
Inc.

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.3 or any later version published by the Free Software
     Foundation; with no Invariant Sections, no Front-Cover texts, and
     no Back-Cover Texts.  A copy of the license is included in the
     section entitled ``GNU Free Documentation License.''
   -->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="autom4te-Invocation"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="Customizing-autom4te.html#Customizing-autom4te">Customizing autom4te</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Using-autom4te.html#Using-autom4te">Using autom4te</a>
<hr>
</div>

<h4 class="subsection">8.2.1 Invoking <samp><span class="command">autom4te</span></samp></h4>

<p>The command line arguments are modeled after M4's:

<pre class="example">     autom4te <var>options</var> <var>files</var>
</pre>
   <p class="noindent"><a name="index-M4-1249"></a>where the <var>files</var> are directly passed to <samp><span class="command">m4</span></samp>.  By default,
GNU M4 is found during configuration, but the environment
variable
<samp><span class="env">M4</span></samp> can be set to tell <samp><span class="command">autom4te</span></samp> where to look.  In addition
to the regular expansion, it handles the replacement of the quadrigraphs
(see <a href="Quadrigraphs.html#Quadrigraphs">Quadrigraphs</a>), and of &lsquo;<samp><span class="samp">__oline__</span></samp>&rsquo;, the current line in the
output.  It supports an extended syntax for the <var>files</var>:

     <dl>
<dt><samp><var>file</var><span class="file">.m4f</span></samp><dd>This file is an M4 frozen file.  Note that <em>all the previous files
are ignored</em>.  See the option <samp><span class="option">--melt</span></samp> for the rationale.

     <br><dt><samp><var>file</var><span class="file">?</span></samp><dd>If found in the library path, the <var>file</var> is included for expansion,
otherwise it is ignored instead of triggering a failure. 
</dl>

   <pre class="sp">

</pre>

Of course, it supports the Autoconf common subset of options:

     <dl>
<dt><samp><span class="option">--help</span></samp><dt><samp><span class="option">-h</span></samp><dd>Print a summary of the command line options and exit.

     <br><dt><samp><span class="option">--version</span></samp><dt><samp><span class="option">-V</span></samp><dd>Print the version number of Autoconf and exit.

     <br><dt><samp><span class="option">--verbose</span></samp><dt><samp><span class="option">-v</span></samp><dd>Report processing steps.

     <br><dt><samp><span class="option">--debug</span></samp><dt><samp><span class="option">-d</span></samp><dd>Don't remove the temporary files and be even more verbose.

     <br><dt><samp><span class="option">--include=</span><var>dir</var></samp><dt><samp><span class="option">-I </span><var>dir</var></samp><dd>Also look for input files in <var>dir</var>.  Multiple invocations
accumulate.

     <br><dt><samp><span class="option">--output=</span><var>file</var></samp><dt><samp><span class="option">-o </span><var>file</var></samp><dd>Save output (script or trace) to <var>file</var>.  The file <samp><span class="option">-</span></samp> stands
for the standard output. 
</dl>

   <pre class="sp">

</pre>

As an extension of <samp><span class="command">m4</span></samp>, it includes the following options:

     <dl>
<dt><samp><span class="option">--warnings=</span><var>category</var></samp><dt><samp><span class="option">-W </span><var>category</var></samp><dd><a name="index-WARNINGS-1250"></a><!-- FIXME: Point to the M4sugar macros, not Autoconf's. -->
Report the warnings related to <var>category</var> (which can actually be a
comma separated list).  See <a href="Reporting-Messages.html#Reporting-Messages">Reporting Messages</a>, macro
<code>AC_DIAGNOSE</code>, for a comprehensive list of categories.  Special
values include:

          <dl>
<dt>&lsquo;<samp><span class="samp">all</span></samp>&rsquo;<dd>report all the warnings

          <br><dt>&lsquo;<samp><span class="samp">none</span></samp>&rsquo;<dd>report none

          <br><dt>&lsquo;<samp><span class="samp">error</span></samp>&rsquo;<dd>treats warnings as errors

          <br><dt>&lsquo;<samp><span class="samp">no-</span><var>category</var></samp>&rsquo;<dd>disable warnings falling into <var>category</var>
</dl>

     <p>Warnings about &lsquo;<samp><span class="samp">syntax</span></samp>&rsquo; are enabled by default, and the environment
variable <samp><span class="env">WARNINGS</span></samp>, a comma separated list of categories, is
honored.  &lsquo;<samp><span class="samp">autom4te -W </span><var>category</var></samp>&rsquo; actually
behaves as if you had run:

     <pre class="example">          autom4te --warnings=syntax,$WARNINGS,<var>category</var>
</pre>
     <p class="noindent">For example, if you want to disable defaults and <samp><span class="env">WARNINGS</span></samp>
of <samp><span class="command">autom4te</span></samp>, but enable the warnings about obsolete
constructs, you would use <samp><span class="option">-W none,obsolete</span></samp>.

     <p><a name="index-Back-trace-1251"></a><a name="index-Macro-invocation-stack-1252"></a><samp><span class="command">autom4te</span></samp> displays a back trace for errors, but not for
warnings; if you want them, just pass <samp><span class="option">-W error</span></samp>.

     <br><dt><samp><span class="option">--melt</span></samp><dt><samp><span class="option">-M</span></samp><dd>Do not use frozen files.  Any argument <var>file</var><code>.m4f</code> is
replaced by <var>file</var><code>.m4</code>.  This helps tracing the macros which
are executed only when the files are frozen, typically
<code>m4_define</code>.  For instance, running:

     <pre class="example">          autom4te --melt 1.m4 2.m4f 3.m4 4.m4f input.m4
</pre>
     <p class="noindent">is roughly equivalent to running:

     <pre class="example">          m4 1.m4 2.m4 3.m4 4.m4 input.m4
</pre>
     <p class="noindent">while

     <pre class="example">          autom4te 1.m4 2.m4f 3.m4 4.m4f input.m4
</pre>
     <p class="noindent">is equivalent to:

     <pre class="example">          m4 --reload-state=4.m4f input.m4
</pre>
     <br><dt><samp><span class="option">--freeze</span></samp><dt><samp><span class="option">-F</span></samp><dd>Produce a frozen state file.  <samp><span class="command">autom4te</span></samp> freezing is stricter
than M4's: it must produce no warnings, and no output other than empty
lines (a line with white space is <em>not</em> empty) and comments
(starting with &lsquo;<samp><span class="samp">#</span></samp>&rsquo;).  Unlike <samp><span class="command">m4</span></samp>'s similarly-named option,
this option takes no argument:

     <pre class="example">          autom4te 1.m4 2.m4 3.m4 --freeze --output=3.m4f
</pre>
     <p class="noindent">corresponds to

     <pre class="example">          m4 1.m4 2.m4 3.m4 --freeze-state=3.m4f
</pre>
     <br><dt><samp><span class="option">--mode=</span><var>octal-mode</var></samp><dt><samp><span class="option">-m </span><var>octal-mode</var></samp><dd>Set the mode of the non-traces output to <var>octal-mode</var>; by default
&lsquo;<samp><span class="samp">0666</span></samp>&rsquo;. 
</dl>

   <pre class="sp">

</pre>

<a name="index-g_t_0040file_007bautom4te_002ecache_007d-1253"></a>As another additional feature over <samp><span class="command">m4</span></samp>, <samp><span class="command">autom4te</span></samp>
caches its results.  GNU M4 is able to produce a regular
output and traces at the same time.  Traces are heavily used in the
GNU Build System: <samp><span class="command">autoheader</span></samp> uses them to build
<samp><span class="file">config.h.in</span></samp>, <samp><span class="command">autoreconf</span></samp> to determine what
GNU Build System components are used, <samp><span class="command">automake</span></samp> to
&ldquo;parse&rdquo; <samp><span class="file">configure.ac</span></samp> etc.  To avoid recomputation,
traces are cached while performing regular expansion,
and conversely.  This cache is (actually, the caches are) stored in
the directory <samp><span class="file">autom4te.cache</span></samp>.  <em>It can safely be removed</em>
at any moment (especially if for some reason <samp><span class="command">autom4te</span></samp>
considers it trashed).

     <dl>
<dt><samp><span class="option">--cache=</span><var>directory</var></samp><dt><samp><span class="option">-C </span><var>directory</var></samp><dd>Specify the name of the directory where the result should be cached. 
Passing an empty value disables caching.  Be sure to pass a relative
file name, as for the time being, global caches are not supported.

     <br><dt><samp><span class="option">--no-cache</span></samp><dd>Don't cache the results.

     <br><dt><samp><span class="option">--force</span></samp><dt><samp><span class="option">-f</span></samp><dd>If a cache is used, consider it obsolete (but update it anyway). 
</dl>

   <pre class="sp">

</pre>

Because traces are so important to the GNU Build System,
<samp><span class="command">autom4te</span></samp> provides high level tracing features as compared to
M4, and helps exploiting the cache:

     <dl>
<dt><samp><span class="option">--trace=</span><var>macro</var><span class="option">[:</span><var>format</var><span class="option">]</span></samp><dt><samp><span class="option">-t </span><var>macro</var><span class="option">[:</span><var>format</var><span class="option">]</span></samp><dd>Trace the invocations of <var>macro</var> according to the <var>format</var>. 
Multiple <samp><span class="option">--trace</span></samp> arguments can be used to list several macros. 
Multiple <samp><span class="option">--trace</span></samp> arguments for a single macro are not
cumulative; instead, you should just make <var>format</var> as long as
needed.

     <p>The <var>format</var> is a regular string, with newlines if desired, and
several special escape codes.  It defaults to &lsquo;<samp><span class="samp">$f:$l:$n:$%</span></samp>&rsquo;.  It can
use the following special escapes:

          <dl>
<dt>&lsquo;<samp><span class="samp">$$</span></samp>&rsquo;<dd><!-- $$ restore font-lock -->
The character &lsquo;<samp><span class="samp">$</span></samp>&rsquo;.

          <br><dt>&lsquo;<samp><span class="samp">$f</span></samp>&rsquo;<dd>The file name from which <var>macro</var> is called.

          <br><dt>&lsquo;<samp><span class="samp">$l</span></samp>&rsquo;<dd>The line number from which <var>macro</var> is called.

          <br><dt>&lsquo;<samp><span class="samp">$d</span></samp>&rsquo;<dd>The depth of the <var>macro</var> call.  This is an M4 technical detail that
you probably don't want to know about.

          <br><dt>&lsquo;<samp><span class="samp">$n</span></samp>&rsquo;<dd>The name of the <var>macro</var>.

          <br><dt>&lsquo;<samp><span class="samp">$</span><var>num</var></samp>&rsquo;<dd>The <var>num</var>th argument of the call to <var>macro</var>.

          <br><dt>&lsquo;<samp><span class="samp">$@</span></samp>&rsquo;<dt>&lsquo;<samp><span class="samp">$</span><var>sep</var><span class="samp">@</span></samp>&rsquo;<dt>&lsquo;<samp><span class="samp">${</span><var>separator</var><span class="samp">}@</span></samp>&rsquo;<dd>All the arguments passed to <var>macro</var>, separated by the character
<var>sep</var> or the string <var>separator</var> (&lsquo;<samp><span class="samp">,</span></samp>&rsquo; by default).  Each
argument is quoted, i.e., enclosed in a pair of square brackets.

          <br><dt>&lsquo;<samp><span class="samp">$*</span></samp>&rsquo;<dt>&lsquo;<samp><span class="samp">$</span><var>sep</var><span class="samp">*</span></samp>&rsquo;<dt>&lsquo;<samp><span class="samp">${</span><var>separator</var><span class="samp">}*</span></samp>&rsquo;<dd>As above, but the arguments are not quoted.

          <br><dt>&lsquo;<samp><span class="samp">$%</span></samp>&rsquo;<dt>&lsquo;<samp><span class="samp">$</span><var>sep</var><span class="samp">%</span></samp>&rsquo;<dt>&lsquo;<samp><span class="samp">${</span><var>separator</var><span class="samp">}%</span></samp>&rsquo;<dd>As above, but the arguments are not quoted, all new line characters in
the arguments are smashed, and the default separator is &lsquo;<samp><span class="samp">:</span></samp>&rsquo;.

          <p>The escape &lsquo;<samp><span class="samp">$%</span></samp>&rsquo; produces single-line trace outputs (unless you put
newlines in the &lsquo;<samp><span class="samp">separator</span></samp>&rsquo;), while &lsquo;<samp><span class="samp">$@</span></samp>&rsquo; and &lsquo;<samp><span class="samp">$*</span></samp>&rsquo; do
not. 
</dl>

     <p>See <a href="autoconf-Invocation.html#autoconf-Invocation">autoconf Invocation</a>, for examples of trace uses.

     <br><dt><samp><span class="option">--preselect=</span><var>macro</var></samp><dt><samp><span class="option">-p </span><var>macro</var></samp><dd>Cache the traces of <var>macro</var>, but do not enable traces.  This is
especially important to save CPU cycles in the future.  For instance,
when invoked, <samp><span class="command">autoconf</span></samp> preselects all the macros that
<samp><span class="command">autoheader</span></samp>, <samp><span class="command">automake</span></samp>, <samp><span class="command">autoreconf</span></samp>, etc.,
trace, so that running <samp><span class="command">m4</span></samp> is not needed to trace them: the
cache suffices.  This results in a huge speed-up. 
</dl>

   <pre class="sp">

</pre>

<a name="index-Autom4te-Library-1254"></a>Finally, <samp><span class="command">autom4te</span></samp> introduces the concept of <dfn>Autom4te
libraries</dfn>.  They consists in a powerful yet extremely simple feature:
sets of combined command line arguments:

     <dl>
<dt><samp><span class="option">--language=</span><var>language</var></samp><dt><samp><span class="option">-l </span><var>language</var></samp><dd>Use the <var>language</var> Autom4te library.  Current languages include:

          <dl>
<dt><code>M4sugar</code><dd>create M4sugar output.

          <br><dt><code>M4sh</code><dd>create M4sh executable shell scripts.

          <br><dt><code>Autotest</code><dd>create Autotest executable test suites.

          <br><dt><code>Autoconf-without-aclocal-m4</code><dd>create Autoconf executable configure scripts without
reading <samp><span class="file">aclocal.m4</span></samp>.

          <br><dt><code>Autoconf</code><dd>create Autoconf executable configure scripts.  This language inherits
all the characteristics of <code>Autoconf-without-aclocal-m4</code> and
additionally reads <samp><span class="file">aclocal.m4</span></samp>. 
</dl>

     <br><dt><samp><span class="option">--prepend-include=</span><var>dir</var></samp><dt><samp><span class="option">-B </span><var>dir</var></samp><dd>Prepend directory <var>dir</var> to the search path.  This is used to include
the language-specific files before any third-party macros.

   </dl>

   <p><a name="index-g_t_0040file_007bautom4te_002ecfg_007d-1255"></a>As an example, if Autoconf is installed in its default location,
<samp><span class="file">/usr/local</span></samp>, the command &lsquo;<samp><span class="samp">autom4te -l m4sugar foo.m4</span></samp>&rsquo; is
strictly equivalent to the command:

<pre class="example">     autom4te --prepend-include /usr/local/share/autoconf \
       m4sugar/m4sugar.m4f --warnings syntax foo.m4
</pre>
   <p class="noindent">Recursive expansion applies here: the command &lsquo;<samp><span class="samp">autom4te -l m4sh foo.m4</span></samp>&rsquo;
is the same as &lsquo;<samp><span class="samp">autom4te --language M4sugar m4sugar/m4sh.m4f
foo.m4</span></samp>&rsquo;, i.e.:

<pre class="example">     autom4te --prepend-include /usr/local/share/autoconf \
       m4sugar/m4sugar.m4f m4sugar/m4sh.m4f --mode 777 foo.m4
</pre>
   <p class="noindent">The definition of the languages is stored in <samp><span class="file">autom4te.cfg</span></samp>.

   </body></html>

