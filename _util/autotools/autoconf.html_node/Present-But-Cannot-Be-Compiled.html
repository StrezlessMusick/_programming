<html lang="en">
<head>
<title>Present But Cannot Be Compiled - Autoconf</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="Autoconf">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="FAQ.html#FAQ" title="FAQ">
<link rel="prev" href="Autom4te-Cache.html#Autom4te-Cache" title="Autom4te Cache">
<link rel="next" href="Expanded-Before-Required.html#Expanded-Before-Required" title="Expanded Before Required">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
This manual (24 April 2012) is for GNU Autoconf
(version 2.69),
a package for creating scripts to configure source code packages using
templates and an M4 macro package.

Copyright (C) 1992-1996, 1998-2012 Free Software Foundation,
Inc.

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.3 or any later version published by the Free Software
     Foundation; with no Invariant Sections, no Front-Cover texts, and
     no Back-Cover Texts.  A copy of the license is included in the
     section entitled ``GNU Free Documentation License.''
   -->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="Present-But-Cannot-Be-Compiled"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="Expanded-Before-Required.html#Expanded-Before-Required">Expanded Before Required</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="Autom4te-Cache.html#Autom4te-Cache">Autom4te Cache</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="FAQ.html#FAQ">FAQ</a>
<hr>
</div>

<h3 class="section">20.7 Header Present But Cannot Be Compiled</h3>

<p>The most important guideline to bear in mind when checking for
features is to mimic as much as possible the intended use. 
Unfortunately, old versions of <code>AC_CHECK_HEADER</code> and
<code>AC_CHECK_HEADERS</code> failed to follow this idea, and called
the preprocessor, instead of the compiler, to check for headers.  As a
result, incompatibilities between headers went unnoticed during
configuration, and maintainers finally had to deal with this issue
elsewhere.

   <p>The transition began with Autoconf 2.56.  As of Autoconf 2.64 both
checks are performed, and <samp><span class="command">configure</span></samp> complains loudly if the
compiler and the preprocessor do not agree.  However, only the compiler
result is considered.

   <p>Consider the following example:

<pre class="smallexample">     $ <kbd>cat number.h</kbd>
     typedef int number;
     $ <kbd>cat pi.h</kbd>
     const number pi = 3;
     $ <kbd>cat configure.ac</kbd>
     AC_INIT([Example], [1.0], [bug-example@example.org])
     AC_CHECK_HEADERS([pi.h])
     $ <kbd>autoconf -Wall</kbd>
     $ <kbd>./configure</kbd>
     checking for gcc... gcc
     checking for C compiler default output file name... a.out
     checking whether the C compiler works... yes
     checking whether we are cross compiling... no
     checking for suffix of executables...
     checking for suffix of object files... o
     checking whether we are using the GNU C compiler... yes
     checking whether gcc accepts -g... yes
     checking for gcc option to accept ISO C89... none needed
     checking how to run the C preprocessor... gcc -E
     checking for grep that handles long lines and -e... grep
     checking for egrep... grep -E
     checking for ANSI C header files... yes
     checking for sys/types.h... yes
     checking for sys/stat.h... yes
     checking for stdlib.h... yes
     checking for string.h... yes
     checking for memory.h... yes
     checking for strings.h... yes
     checking for inttypes.h... yes
     checking for stdint.h... yes
     checking for unistd.h... yes
     checking pi.h usability... no
     checking pi.h presence... yes
     configure: WARNING: pi.h: present but cannot be compiled
     configure: WARNING: pi.h:     check for missing prerequisite headers?
     configure: WARNING: pi.h: see the Autoconf documentation
     configure: WARNING: pi.h:     section "Present But Cannot Be Compiled"
     configure: WARNING: pi.h: proceeding with the compiler's result
     configure: WARNING:     ## -------------------------------------- ##
     configure: WARNING:     ## Report this to bug-example@example.org ##
     configure: WARNING:     ## -------------------------------------- ##
     checking for pi.h... yes
</pre>
   <p class="noindent">The proper way the handle this case is using the fourth argument
(see <a href="Generic-Headers.html#Generic-Headers">Generic Headers</a>):

<pre class="example">     $ <kbd>cat configure.ac</kbd>
     AC_INIT([Example], [1.0], [bug-example@example.org])
     AC_CHECK_HEADERS([number.h pi.h], [], [],
     [[#ifdef HAVE_NUMBER_H
     # include &lt;number.h&gt;
     #endif
     ]])
     $ <kbd>autoconf -Wall</kbd>
     $ <kbd>./configure</kbd>
     checking for gcc... gcc
     checking for C compiler default output... a.out
     checking whether the C compiler works... yes
     checking whether we are cross compiling... no
     checking for suffix of executables...
     checking for suffix of object files... o
     checking whether we are using the GNU C compiler... yes
     checking whether gcc accepts -g... yes
     checking for gcc option to accept ANSI C... none needed
     checking for number.h... yes
     checking for pi.h... yes
</pre>
   <p>See <a href="Particular-Headers.html#Particular-Headers">Particular Headers</a>, for a list of headers with their
prerequisites.

   </body></html>

