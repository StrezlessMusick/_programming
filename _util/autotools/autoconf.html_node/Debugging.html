<html lang="en">
<head>
<title>Debugging - Autoconf</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="Autoconf">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="FAQ.html#FAQ" title="FAQ">
<link rel="prev" href="Expanded-Before-Required.html#Expanded-Before-Required" title="Expanded Before Required">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
This manual (24 April 2012) is for GNU Autoconf
(version 2.69),
a package for creating scripts to configure source code packages using
templates and an M4 macro package.

Copyright (C) 1992-1996, 1998-2012 Free Software Foundation,
Inc.

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.3 or any later version published by the Free Software
     Foundation; with no Invariant Sections, no Front-Cover texts, and
     no Back-Cover Texts.  A copy of the license is included in the
     section entitled ``GNU Free Documentation License.''
   -->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="Debugging"></a>
<p>
Previous:&nbsp;<a rel="previous" accesskey="p" href="Expanded-Before-Required.html#Expanded-Before-Required">Expanded Before Required</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="FAQ.html#FAQ">FAQ</a>
<hr>
</div>

<h3 class="section">20.9 Debugging <samp><span class="command">configure</span></samp> scripts</h3>

<p>While in general, <samp><span class="command">configure</span></samp> scripts generated by Autoconf
strive to be fairly portable to various systems, compilers, shells, and
other tools, it may still be necessary to debug a failing test, broken
script or makefile, or fix or override an incomplete, faulty, or erroneous
test, especially during macro development.  Failures can occur at all levels,
in M4 syntax or semantics, shell script issues, or due to bugs in the
test or the tools invoked by <samp><span class="command">configure</span></samp>.  Together with the
rather arcane error message that <samp><span class="command">m4</span></samp> and <samp><span class="command">make</span></samp> may
produce when their input contains syntax errors, this can make debugging
rather painful.

   <p>Nevertheless, here is a list of hints and strategies that may help:

     <ul>
<li>When <samp><span class="command">autoconf</span></samp> fails, common causes for error include:

          <ul>
<li>mismatched or unbalanced parentheses or braces (see <a href="Balancing-Parentheses.html#Balancing-Parentheses">Balancing Parentheses</a>),

          <li>under- or overquoted macro arguments (see <a href="Autoconf-Language.html#Autoconf-Language">Autoconf Language</a>, see <a href="Quoting-and-Parameters.html#Quoting-and-Parameters">Quoting and Parameters</a>, see <a href="Quotation-and-Nested-Macros.html#Quotation-and-Nested-Macros">Quotation and Nested Macros</a>),

          <li>spaces between macro name and opening parenthesis (see <a href="Autoconf-Language.html#Autoconf-Language">Autoconf Language</a>). 
</ul>

     <p>Typically, it helps to go back to the last working version of the input
and compare the differences for each of these errors.  Another
possibility is to sprinkle pairs of <code>m4_traceon</code> and
<code>m4_traceoff</code> judiciously in the code, either without a parameter
or listing some macro names and watch <samp><span class="command">m4</span></samp> expand its input
verbosely (see <a href="Debugging-via-autom4te.html#Debugging-via-autom4te">Debugging via autom4te</a>).

     <li>Sometimes <samp><span class="command">autoconf</span></samp> succeeds but the generated
<samp><span class="command">configure</span></samp> script has invalid shell syntax.  You can detect this
case by running &lsquo;<samp><span class="samp">bash -n configure</span></samp>&rsquo; or &lsquo;<samp><span class="samp">sh -n configure</span></samp>&rsquo;. 
If this command fails, the same tips apply, as if <samp><span class="command">autoconf</span></samp> had
failed.

     <li>Debugging <samp><span class="command">configure</span></samp> script execution may be done by sprinkling
pairs of <code>set -x</code> and <code>set +x</code> into the shell script before
and after the region that contains a bug.  Running the whole script with
&lsquo;<samp><var>shell</var><span class="samp"> -vx ./configure 2&gt;&amp;1 | tee </span><var>log-file</var></samp>&rsquo; with a decent
<var>shell</var> may work, but produces lots of output.  Here, it can help to
search for markers like &lsquo;<samp><span class="samp">checking for</span></samp>&rsquo; a particular test in the
<var>log-file</var>.

     <li>Alternatively, you might use a shell with debugging capabilities like
<a href="http://bashdb.sourceforge.net/">bashdb</a>.

     <li>When <samp><span class="command">configure</span></samp> tests produce invalid results for your system,
it may be necessary to override them:

          <ul>
<li>For programs, tools or libraries variables, preprocessor, compiler, or
linker flags, it is often sufficient to override them at <samp><span class="command">make</span></samp>
run time with some care (see <a href="Macros-and-Submakes.html#Macros-and-Submakes">Macros and Submakes</a>).  Since this
normally won't cause <samp><span class="command">configure</span></samp> to be run again with these
changed settings, it may fail if the changed variable would have caused
different test results from <samp><span class="command">configure</span></samp>, so this may work only
for simple differences.

          <li>Most tests which produce their result in a substituted variable allow to
override the test by setting the variable on the <samp><span class="command">configure</span></samp>
command line (see <a href="Compilers-and-Options.html#Compilers-and-Options">Compilers and Options</a>, see <a href="Defining-Variables.html#Defining-Variables">Defining Variables</a>,
see <a href="Particular-Systems.html#Particular-Systems">Particular Systems</a>).

          <li>Many tests store their result in a cache variable (see <a href="Caching-Results.html#Caching-Results">Caching Results</a>).  This lets you override them either on the
<samp><span class="command">configure</span></samp> command line as above, or through a primed cache or
site file (see <a href="Cache-Files.html#Cache-Files">Cache Files</a>, see <a href="Site-Defaults.html#Site-Defaults">Site Defaults</a>).  The name of a
cache variable is documented with a test macro or may be inferred from
<a href="Cache-Variable-Names.html#Cache-Variable-Names">Cache Variable Names</a>; the precise semantics of undocumented
variables are often internal details, subject to change. 
</ul>

     <li>Alternatively, <samp><span class="command">configure</span></samp> may produce invalid results because
of uncaught programming errors, in your package or in an upstream
library package.  For example, when <code>AC_CHECK_LIB</code> fails to find a
library with a specified function, always check <samp><span class="file">config.log</span></samp>.  This
will reveal the exact error that produced the failing result: the
library linked by <code>AC_CHECK_LIB</code> probably has a fatal bug. 
</ul>

   <p>Conversely, as macro author, you can make it easier for users of your
macro:

     <ul>
<li>by minimizing dependencies between tests and between test results as far
as possible,

     <li>by using <samp><span class="command">make</span></samp> variables to factorize and allow
override of settings at <samp><span class="command">make</span></samp> run time,

     <li>by honoring the GNU Coding Standards and not overriding flags
reserved for the user except temporarily during <samp><span class="command">configure</span></samp>
tests,

     <li>by not requiring users of your macro to use the cache variables. 
Instead, expose the result of the test via <var>run-if-true</var> and
<var>run-if-false</var> parameters.  If the result is not a boolean,
then provide it through documented shell variables. 
</ul>

<!-- ===================================================== History of Autoconf. -->
   </body></html>

