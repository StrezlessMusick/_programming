<html lang="en">
<head>
<title>Redefined M4 Macros - Autoconf</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="Autoconf">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Programming-in-M4sugar.html#Programming-in-M4sugar" title="Programming in M4sugar">
<link rel="next" href="Diagnostic-Macros.html#Diagnostic-Macros" title="Diagnostic Macros">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
This manual (24 April 2012) is for GNU Autoconf
(version 2.69),
a package for creating scripts to configure source code packages using
templates and an M4 macro package.

Copyright (C) 1992-1996, 1998-2012 Free Software Foundation,
Inc.

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.3 or any later version published by the Free Software
     Foundation; with no Invariant Sections, no Front-Cover texts, and
     no Back-Cover Texts.  A copy of the license is included in the
     section entitled ``GNU Free Documentation License.''
   -->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="Redefined-M4-Macros"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="Diagnostic-Macros.html#Diagnostic-Macros">Diagnostic Macros</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Programming-in-M4sugar.html#Programming-in-M4sugar">Programming in M4sugar</a>
<hr>
</div>

<h4 class="subsection">8.3.1 Redefined M4 Macros</h4>

<p><a name="index-m4_005fbuiltin-1257"></a>
<a name="index-m4_005fchangecom-1258"></a>
<a name="index-m4_005fchangequote-1259"></a>
<a name="index-m4_005fdebugfile-1260"></a>
<a name="index-m4_005fdebugmode-1261"></a>
<a name="index-m4_005fdecr-1262"></a>
<a name="index-m4_005fdefine-1263"></a>
<a name="index-m4_005fdivnum-1264"></a>
<a name="index-m4_005ferrprint-1265"></a>
<a name="index-m4_005fesyscmd-1266"></a>
<a name="index-m4_005feval-1267"></a>
<a name="index-m4_005fformat-1268"></a>
<a name="index-m4_005fifdef-1269"></a>
<a name="index-m4_005fincr-1270"></a>
<a name="index-m4_005findex-1271"></a>
<a name="index-m4_005findir-1272"></a>
<a name="index-m4_005flen-1273"></a>
<a name="index-m4_005fpushdef-1274"></a>
<a name="index-m4_005fshift-1275"></a>
<a name="index-m4_005fsubstr-1276"></a>
<a name="index-m4_005fsyscmd-1277"></a>
<a name="index-m4_005fsysval-1278"></a>
<a name="index-m4_005ftraceoff-1279"></a>
<a name="index-m4_005ftraceon-1280"></a>
<a name="index-m4_005ftranslit-1281"></a>
With a few exceptions, all the M4 native macros are moved in the
&lsquo;<samp><span class="samp">m4_</span></samp>&rsquo; pseudo-namespace, e.g., M4sugar renames <code>define</code> as
<code>m4_define</code> etc.

   <p>The list of macros unchanged from M4, except for their name, is:
     <ul>
<li>m4_builtin
<li>m4_changecom
<li>m4_changequote
<li>m4_debugfile
<li>m4_debugmode
<li>m4_decr
<li>m4_define
<li>m4_divnum
<li>m4_errprint
<li>m4_esyscmd
<li>m4_eval
<li>m4_format
<li>m4_ifdef
<li>m4_incr
<li>m4_index
<li>m4_indir
<li>m4_len
<li>m4_pushdef
<li>m4_shift
<li>m4_substr
<li>m4_syscmd
<li>m4_sysval
<li>m4_traceoff
<li>m4_traceon
<li>m4_translit
</ul>

   <p>Some M4 macros are redefined, and are slightly incompatible with their
native equivalent.

<div class="defun">
&mdash; Macro: <b>__file__</b><var><a name="index-g_t_005f_005ffile_005f_005f-1282"></a></var><br>
&mdash; Macro: <b>__line__</b><var><a name="index-g_t_005f_005fline_005f_005f-1283"></a></var><br>
<blockquote><p><a name="index-g_t_005f_005ffile_005f_005f-1284"></a><a name="index-g_t_005f_005fline_005f_005f-1285"></a>All M4 macros starting with &lsquo;<samp><span class="samp">__</span></samp>&rsquo; retain their original name: for
example, no <code>m4__file__</code> is defined. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>__oline__</b><var><a name="index-g_t_005f_005foline_005f_005f-1286"></a></var><br>
<blockquote><p><a name="index-g_t_005f_005foline_005f_005f-1287"></a>This is not technically a macro, but a feature of Autom4te.  The
sequence <code>__oline__</code> can be used similarly to the other m4sugar
location macros, but rather than expanding to the location of the input
file, it is translated to the line number where it appears in the output
file after all other M4 expansions. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>dnl</b><var><a name="index-dnl-1288"></a></var><br>
<blockquote><p><a name="index-dnl-1289"></a>This macro kept its original name: no <code>m4_dnl</code> is defined. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>m4_bpatsubst</b> (<var>string, regexp, </var><span class="roman">[</span><var>replacement</var><span class="roman">]</span>)<var><a name="index-m4_005fbpatsubst-1290"></a></var><br>
<blockquote><p><a name="index-m4_005fbpatsubst-1291"></a>
This macro corresponds to <code>patsubst</code>.  The name <code>m4_patsubst</code>
is kept for future versions of M4sugar, once GNU M4 2.0 is
released and supports extended regular expression syntax. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>m4_bregexp</b> (<var>string, regexp, </var><span class="roman">[</span><var>replacement</var><span class="roman">]</span>)<var><a name="index-m4_005fbregexp-1292"></a></var><br>
<blockquote><p><a name="index-m4_005fbregexp-1293"></a>
This macro corresponds to <code>regexp</code>.  The name <code>m4_regexp</code>
is kept for future versions of M4sugar, once GNU M4 2.0 is
released and supports extended regular expression syntax. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>m4_copy</b> (<var>source, dest</var>)<var><a name="index-m4_005fcopy-1294"></a></var><br>
&mdash; Macro: <b>m4_copy_force</b> (<var>source, dest</var>)<var><a name="index-m4_005fcopy_005fforce-1295"></a></var><br>
&mdash; Macro: <b>m4_rename</b> (<var>source, dest</var>)<var><a name="index-m4_005frename-1296"></a></var><br>
&mdash; Macro: <b>m4_rename_force</b> (<var>source, dest</var>)<var><a name="index-m4_005frename_005fforce-1297"></a></var><br>
<blockquote><p><a name="index-m4_005fcopy-1298"></a>
<a name="index-m4_005fcopy_005fforce-1299"></a>
<a name="index-m4_005frename-1300"></a>
<a name="index-m4_005frename_005fforce-1301"></a>
These macros aren't directly builtins, but are closely related to
<code>m4_pushdef</code> and <code>m4_defn</code>.  <code>m4_copy</code> and
<code>m4_rename</code> ensure that <var>dest</var> is undefined, while
<code>m4_copy_force</code> and <code>m4_rename_force</code> overwrite any existing
definition.  All four macros then proceed to copy the entire pushdef
stack of definitions of <var>source</var> over to <var>dest</var>.  <code>m4_copy</code>
and <code>m4_copy_force</code> preserve the source (including in the special
case where <var>source</var> is undefined), while <code>m4_rename</code> and
<code>m4_rename_force</code> undefine the original macro name (making it an
error to rename an undefined <var>source</var>).

        <p>Note that attempting to invoke a renamed macro might not work, since the
macro may have a dependence on helper macros accessed via composition of
&lsquo;<samp><span class="samp">$0</span></samp>&rsquo; but that were not also renamed; likewise, other macros may
have a hard-coded dependence on <var>source</var> and could break if
<var>source</var> has been deleted.  On the other hand, it is always safe to
rename a macro to temporarily move it out of the way, then rename it
back later to restore original semantics. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>m4_defn</b> (<var>macro<small class="dots">...</small></var>)<var><a name="index-m4_005fdefn-1302"></a></var><br>
<blockquote><p><a name="index-m4_005fdefn-1303"></a>
This macro fails if <var>macro</var> is not defined, even when using older
versions of M4 that did not warn.  See <code>m4_undefine</code>. 
Unfortunately, in order to support these older versions of M4, there are
some situations involving unbalanced quotes where concatenating multiple
macros together will work in newer M4 but not in m4sugar; use
quadrigraphs to work around this. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>m4_divert</b> (<var>diversion</var>)<var><a name="index-m4_005fdivert-1304"></a></var><br>
<blockquote><p><a name="index-m4_005fdivert-1305"></a>
M4sugar relies heavily on diversions, so rather than behaving as a
primitive, <code>m4_divert</code> behaves like:
     <pre class="example">          m4_divert_pop()m4_divert_push([<var>diversion</var>])
</pre>
        <p class="noindent">See <a href="Diversion-support.html#Diversion-support">Diversion support</a>, for more details about the use of the
diversion stack.  In particular, this implies that <var>diversion</var>
should be a named diversion rather than a raw number.  But be aware that
it is seldom necessary to explicitly change the diversion stack, and
that when done incorrectly, it can lead to syntactically invalid
scripts. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>m4_dumpdef</b> (<var>name<small class="dots">...</small></var>)<var><a name="index-m4_005fdumpdef-1306"></a></var><br>
&mdash; Macro: <b>m4_dumpdefs</b> (<var>name<small class="dots">...</small></var>)<var><a name="index-m4_005fdumpdefs-1307"></a></var><br>
<blockquote><p><a name="index-m4_005fdumpdef-1308"></a>
<a name="index-m4_005fdumpdefs-1309"></a>
<code>m4_dumpdef</code> is like the M4 builtin, except that this version
requires at least one argument, output always goes to standard error
rather than the current debug file, no sorting is done on multiple
arguments, and an error is issued if any
<var>name</var> is undefined.  <code>m4_dumpdefs</code> is a convenience macro that
calls <code>m4_dumpdef</code> for all of the
<code>m4_pushdef</code> stack of definitions, starting with the current, and
silently does nothing if <var>name</var> is undefined.

        <p>Unfortunately, due to a limitation in M4 1.4.x, any macro defined as a
builtin is output as the empty string.  This behavior is rectified by
using M4 1.6 or newer.  However, this behavior difference means that
<code>m4_dumpdef</code> should only be used while developing m4sugar macros,
and never in the final published form of a macro. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>m4_esyscmd_s</b> (<var>command</var>)<var><a name="index-m4_005fesyscmd_005fs-1310"></a></var><br>
<blockquote><p><a name="index-m4_005fesyscmd_005fs-1311"></a>
Like <code>m4_esyscmd</code>, this macro expands to the result of running
<var>command</var> in a shell.  The difference is that any trailing newlines
are removed, so that the output behaves more like shell command
substitution. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>m4_exit</b> (<var>exit-status</var>)<var><a name="index-m4_005fexit-1312"></a></var><br>
<blockquote><p><a name="index-m4_005fexit-1313"></a>
This macro corresponds to <code>m4exit</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>m4_if</b> (<var>comment</var>)<var><a name="index-m4_005fif-1314"></a></var><br>
&mdash; Macro: <b>m4_if</b> (<var>string-1, string-2, equal, </var><span class="roman">[</span><var>not-equal</var><span class="roman">]</span>)<var><a name="index-m4_005fif-1315"></a></var><br>
&mdash; Macro: <b>m4_if</b> (<var>string-1, string-2, equal-1, string-3, string-4, equal-2, <small class="dots">...</small>, </var><span class="roman">[</span><var>not-equal</var><span class="roman">]</span>)<var><a name="index-m4_005fif-1316"></a></var><br>
<blockquote><p><a name="index-m4_005fif-1317"></a>
This macro corresponds to <code>ifelse</code>.  <var>string-1</var> and
<var>string-2</var> are compared literally, so usually one of the two
arguments is passed unquoted.  See <a href="Conditional-constructs.html#Conditional-constructs">Conditional constructs</a>, for more
conditional idioms. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>m4_include</b> (<var>file</var>)<var><a name="index-m4_005finclude-1318"></a></var><br>
&mdash; Macro: <b>m4_sinclude</b> (<var>file</var>)<var><a name="index-m4_005fsinclude-1319"></a></var><br>
<blockquote><p><a name="index-m4_005finclude-1320"></a>
<a name="index-m4_005fsinclude-1321"></a>
Like the M4 builtins, but warn against multiple inclusions of <var>file</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>m4_mkstemp</b> (<var>template</var>)<var><a name="index-m4_005fmkstemp-1322"></a></var><br>
&mdash; Macro: <b>m4_maketemp</b> (<var>template</var>)<var><a name="index-m4_005fmaketemp-1323"></a></var><br>
<blockquote><p><a name="index-m4_005fmaketemp-1324"></a>
<a name="index-m4_005fmkstemp-1325"></a>
Posix requires <code>maketemp</code> to replace the trailing &lsquo;<samp><span class="samp">X</span></samp>&rsquo;
characters in <var>template</var> with the process id, without regards to the
existence of a file by that name, but this a security hole.  When this
was pointed out to the Posix folks, they agreed to invent a new macro
<code>mkstemp</code> that always creates a uniquely named file, but not all
versions of GNU M4 support the new macro.  In M4sugar,
<code>m4_maketemp</code> and <code>m4_mkstemp</code> are synonyms for each other,
and both have the secure semantics regardless of which macro the
underlying M4 provides. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>m4_popdef</b> (<var>macro<small class="dots">...</small></var>)<var><a name="index-m4_005fpopdef-1326"></a></var><br>
<blockquote><p><a name="index-m4_005fpopdef-1327"></a>
This macro fails if <var>macro</var> is not defined, even when using older
versions of M4 that did not warn.  See <code>m4_undefine</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>m4_undefine</b> (<var>macro<small class="dots">...</small></var>)<var><a name="index-m4_005fundefine-1328"></a></var><br>
<blockquote><p><a name="index-m4_005fundefine-1329"></a>
This macro fails if <var>macro</var> is not defined, even when using older
versions of M4 that did not warn.  Use

     <pre class="example">          m4_ifdef([<var>macro</var>], [m4_undefine([<var>macro</var>])])
</pre>
        <p class="noindent">if you are not sure whether <var>macro</var> is defined. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>m4_undivert</b> (<var>diversion<small class="dots">...</small></var>)<var><a name="index-m4_005fundivert-1330"></a></var><br>
<blockquote><p><a name="index-m4_005fundivert-1331"></a>
Unlike the M4 builtin, at least one <var>diversion</var> must be specified. 
Also, since the M4sugar diversion stack prefers named
diversions, the use of <code>m4_undivert</code> to include files is risky. 
See <a href="Diversion-support.html#Diversion-support">Diversion support</a>, for more details about the use of the
diversion stack.  But be aware that it is seldom necessary to explicitly
change the diversion stack, and that when done incorrectly, it can lead
to syntactically invalid scripts. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>m4_wrap</b> (<var>text</var>)<var><a name="index-m4_005fwrap-1332"></a></var><br>
&mdash; Macro: <b>m4_wrap_lifo</b> (<var>text</var>)<var><a name="index-m4_005fwrap_005flifo-1333"></a></var><br>
<blockquote><p><a name="index-m4_005fwrap-1334"></a>
<a name="index-m4_005fwrap_005flifo-1335"></a>
These macros correspond to <code>m4wrap</code>.  Posix requires arguments of
multiple wrap calls to be reprocessed at EOF in the same order
as the original calls (first-in, first-out).  GNU M4 versions
through 1.4.10, however, reprocess them in reverse order (last-in,
first-out).  Both orders are useful, therefore, you can rely on
<code>m4_wrap</code> to provide FIFO semantics and <code>m4_wrap_lifo</code> for
LIFO semantics, regardless of the underlying GNU M4 version.

        <p>Unlike the GNU M4 builtin, these macros only recognize one
argument, and avoid token pasting between consecutive invocations.  On
the other hand, nested calls to <code>m4_wrap</code> from within wrapped text
work just as in the builtin. 
</p></blockquote></div>

   </body></html>

