<html>
<head>
<title>ipfw(8)</title>
<link rel="stylesheet" href="../citforum.css">
<style>

</style>

<meta http-equiv="content-type" content="text/html; charset=Windows-1251">
</head>
<body bgcolor=#FFFFFF link=#006890 vlink=#003860 alink=#800000 text=#000000 topmargin="0" marginheight="0">
<a name=top></a>





<!-- counters -->
<table cellpadding=0 cellspacing=0 border=0>
<tr>
<td><!--TopList COUNTER--><script language="JavaScript"><!--
d=document;js=10;a=';r='+escape(d.referrer)
//--></script><script language="JavaScript1.1"><!--
js=11;a+=';j='+navigator.javaEnabled()
//--></script><script language="JavaScript1.2"><!--
js=12;s=screen;a+=';s='+s.width+'*'+s.height
a+=';d='+(s.colorDepth?s.colorDepth:s.pixelDepth)
//--></script><script language="JavaScript1.3"><!--
js=13//--></script><script language="JavaScript"><!--
d.write('<img src="http://top.list.ru/counter'+
'?id=26978;js='+js+a+'" alt="" height=1 width=1>')
if(js>11)d.write('<'+'!-- ')//--></script><noscript><img
src="http://top.list.ru/counter?js=na;id=26978"
height=1 width=1 alt=""></noscript><script language="JavaScript"><!--
if(js>11)d.write('--'+'>')
//--></script><!--TopList COUNTER--></td>
<td><!--LiveInternet counter--><script language="JavaScript"><!--
document.write('<img src="http://counter.yadro.ru/hit?r'+
escape(document.referrer)+((typeof(screen)=='undefined')?'':
';s'+screen.width+'*'+screen.height+'*'+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+';u'+escape(document.URL)+
';i'+escape('Жж'+document.title)+';'+Math.random()+
'" width=1 height=1 alt="">')//--></script><!--/LiveInternet--></td>
<td><img src="http://counter.rambler.ru/top100.cnt?13078" alt="" width=1 height=1 border=0></td>
</tr></table>
<!-- end of counters -->



<center><table width=990 cellpadding=0 cellspacing=0>
<tr><td>

    <table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr valign=bottom>
  <td align="left"><a href="http://citforum.ru/"><img src="../../../pictures/logos/citlogo8.gif" width=140 height=44 border=0 alt=Logo></a></td>

      <td align="right" width="100%" style="padding-bottom: 10px"><nobr><font size=2><b>Море(!) аналитической информации!</b></font></nobr></td>
    </tr>
    </table>




<center style="margin-top: 3px">
<!--  AdRiver code START. Type:728x90 Site: citforum PZ: 0 BN: 1 -->
<script language="javascript" type="text/javascript"><!--
var RndNum4NoCash = Math.round(Math.random() * 1000000000);
var ar_Tail='unknown'; if (document.referrer) ar_Tail = escape(document.referrer);
document.write(
'<iframe src="http://ad.adriver.ru/cgi-bin/erle.cgi?'
+ 'sid=137295&bn=1&target=blank&bt=36&pz=0&rnd=' + RndNum4NoCash + '&tail256=' + ar_Tail
+ '" frameborder=0 vspace=0 hspace=0 width=728 height=90 marginwidth=0'
+ ' marginheight=0 scrolling=no></iframe>');
//--></script>
<noscript>
<a href="http://ad.adriver.ru/cgi-bin/click.cgi?sid=137295&bn=1&bt=36&pz=0&rnd=1013420086" target=_blank>
<img src="http://ad.adriver.ru/cgi-bin/rle.cgi?sid=137295&bn=1&bt=36&pz=0&rnd=1013420086" alt="-AdRiver-" border=0 width=728 height=90></a>
</noscript>
<!--  AdRiver code END  -->

</center>


</td></tr>
<tr><td>

<table cellpadding=0 cellspacing=0 border=0 width=100% style="padding-top: 3px">
<tr><td>
<table   cellspacing=0 cellpadding=0 border=0 width=100%>
<tr><td bgcolor=#008080><img src="../../../pictures/1x1.gif" width=931 height=1 alt="" border=0></td></tr>
<tr><td bgcolor=#daecd7><img src="../../../pictures/1x1.gif" width=1 height=3 alt="" border=0></td></tr>
<tr><td bgcolor=#008080>

<table cellspacing=1 cellpadding=3 border=0 width=100%>
<tr>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/consulting/">IT-консалтинг</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/SE/">Software Engineering</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/programming/">Программирование</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/database/">СУБД</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/security/">Безопасность</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/internet/">Internet</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/nets/">Сети</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/operating_systems/">Операционные системы</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/hardware/">Hardware</a></font></td>
<!--
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href=/faq/>FAQ (ЧаВО)</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href=/howto/>HOWTO</a></font></td>
--> 
</tr>
</table>

</td></tr>
</table>

</td></tr>
<tr><td>
<table cellpadding=0 cellspacing=0 border=0 width=100% style="padding-top: 3px">
<tr valign=top>

<td width=98% style="padding: 0 5px">


<div class="document">

<div align=right><i>2004 г</i></div>
<h3>ipfw(8)</h3>
<em>
Юрген Анцилевич (Ugen J. S. Antsilevich),
<br>Пол-Хёнинг Камп (Poul-Henning Kamp),
<br>Алекс Нэш (Alex Nash),
<br>Арчи Коббс (Archie Cobbs),
<br>Луиджи Риццо (Luigi Rizzo). 
<br>перевод <a href="mailto:valera@openxs.kiev.ua">В. Кравчук</a>, <a target="_blank" href="http://ln.com.ua/~openxs">OpenXS Initiative</a></em>
<div align="justify">
<h4>НАЗВАНИЕ</h4>
ipfw - межсетевой экран (брандмауэр) IP и программа управления профилем передаваемой
информации
<h4>СИНТАКСИС</h4>
<p>  ipfw [-q] [-p препроцессор [-D макрос[=значение]] [-U макрос]] полное_имя_файла<br>
  ipfw [-f | -q] flush<br>
  ipfw [-q] {zero | resetlog | delete} [число ...]<br>
  ipfw [-s [поле]] [-aftN] {list | show} [число ...]<br>
  ipfw [-q] add [число] тело_правила<br>
  ipfw pipe число config опции_конфигурирования_канала<br>
  ipfw pipe {delete | list | show} [число ...]<br>
  ipfw queue число config опции_конфигурирования_очереди<br>
  ipfw queue {delete | list | show} [число ...] <br>
<h4>ОПИСАНИЕ</h4>
  ipfw - это пользовательский интерфейс для управления брандмауэром ipfirewall(4)
  и формирователем трафика (traffic shaper) dummynet(4) в ОС FreeBSD.</p>
<p>К каждому входящему и исходящему пакету применяются правила ipfw. Если хост
  работает как шлюз (gateway), пакеты, перенаправляемые шлюзом, обрабатываются
  программой ipfw дважды. Если хост работает как мост (bridge), пакеты, перенаправляемые
  мостом, обрабатываются программой ipfw один раз.</p>
<p>Конфигурация брандмауэра задается в виде списка пронумерованных правил, который
  просматривается для каждого пакета пока не будет найдено соответствие - тогда
  выполняется заданное соответствующим правилом действие. В зависимости от действия
  и некоторых установок в системе, пакеты могут возвращаться на брандмауэр для
  обработки правилами, начиная со следующего за сработавшим. Все правила применяются
  ко всем интерфейсам, так что задача написания набора правил с минимально необходимым
  количеством проверок возлагается на системного администратора.</p>
<p>Конфигурация всегда включает стандартное правило (DEFAULT) с номером 65535,
  которое нельзя изменять и которое соответствует любому пакету. С этим стандартным
  правилом может быть связано действие deny или allow, в зависимости от конфигурации
  ядра.</p>
<p>Если набор правил включает одно или несколько правил с опцией keep-state,
  то программа ipfw предполагает работу с сохранением состояния (stateful behaviour),
  т.е. при успешном сопоставлении будет создавать динамические правила, соответствующие
  конкретным параметрам (адресам и портам) сопоставившегося пакета.</p>
<p>Эти динамические правила с ограниченным временем существования проверяются,
  начиная с первого вхождения правила check-state или keep-state, и обычно используются
  для приоткрытия брандмауэра по требованию только для допустимого трафика. Подробнее
  о работе программы ipfw с сохранением состояния см. далее в разделах ФОРМАТ
  ПРАВИЛА и ПРИМЕРЫ.</p>
<p>Со всеми правилами (включая динамические) связано несколько счетчиков: счетчик
  пакетов, счетчик байтов, счетчик журнала (log count) и временная отметка (timestamp),
  хранящая время последнего сопоставления. Счетчики можно выдать или сбросить
  с помощью команд ipfw.</p>
<p>Правила добавляются с помощью команды add; удаляются по одному - с помощью
  команды delete, и все сразу - с помощью команды flush; выдаются, в том числе,
  возможно, со значениями счетчиков, с помощью команд show и list. Наконец, значения
  счетчиков можно сбросить с помощью команд zero и resetlog.</p>
<p>Поддерживаются следующие опции:</p>
<p>-a<br>
  Выдавать значения счетчиков вместе с правилами. См. также описание команды
    show. <br>
</p>
<p>-f<br>
  Не запрашивать подтверждения для команд, которые при неправильном использовании
    могут вызвать проблемы, например, flush. Учтите, что если процесс не связан
    с терминалом, эта опция подразумевается.<br>
</p>
<p>-q<br>
  При добавлении, обнулении, сбросе журнала или списка правил не выдавать информации
    о действиях (эта опция подразумевает опцию -f). Это полезно при настройке
    списка правил с помощью нескольких команд ipfw в сценарии (например, sh /etc/rc.firewall),
    или при обработке файла с несколькими правилами ipfw в сеансе с удаленной
    регистрацией. Если команда flush выполняется в обычном (информативном) режиме
    (в стандартной конфигурации ядра), она выдает сообщение. Поскольку все правила
    сбрасываются, сообщение это не может быть передано сеансу. В результате,
    сеанс с удаленной регистрацией закрывается и остальные правила не обрабатываются.
    Для восстановления придется зарегистрироваться с консоли.<br>
</p>
<p>-t<br>
  При выдаче правиил указывать временную отметку последнего сопоставления.<br>
</p>
<p>-N<br>
  При выдаче пытаться разрешать адреса и имена служб.<br>
</p>
<p>-s [поле]<br>
  При выдаче каналов, сортировать в соотетствии с одним из четырех счетчиков
    (общее/текущее количество пакетов или байтов). <br>
  Для упрощения конфигурирования правила можно помещать в файл, который обрабатывается
  с помощью команды ipfw как показано в первой строке синтаксиса. Необходимо
  указывать полное имя файла. Файл будет читаться построчно и строки применяются
  как аргументы вызова утилиты ipfw.</p>
<p>Можно также указать препроцессор (с помощью конструкции -p препроцессор),
  через который будет пропущен заданный файл. Пригодятся препроцессоры cpp(1)
  и m4(1). Если параметр препроцессор не начинается с косой черты ('/'), выполняется
  обычный поиск с учетом значения переменной среды PATH. Это надо учитывать в
  средах, где не все файловые системы еще смонтированы в момент выполнения команды
  ipfw (например, если они монтируются по NFS). Если была указана опция -p, можно
  также задавать спецификации -D и -U, которые будут передаваться препроцессору.
  Это позволяет создавать гибкие файлы конфигурации (например, включающие зависимости
  от имени локального хоста) и использовать макросы для часто используемых аргументов
  вроде IP-адресов.</p>
<p>Команды ipfw pipe используются для конфигурирования формирователя трафика,
  как описано в разделе КОНФИГУРИРОВАНИЕ ФОРМИРОВАТЕЛЯ ТРАФИКА ниже.</p>
<h4>ФОРМАТ ПРАВИЛ</h4>
<p>  Правила ipfw имеют следующий формат:</p>
<p>[prob вероятность_сопоставления] действие [log [logamount число]] протокол
  from исходный_адрес to целевой_адрес [спецификация_интерфейса] [опции] <br>
  Каждый пакет можно фильтровать на основе следующей, связанной с ним информации:</p>
<p>Интерфейс передачи и приема (по имени или адресу) <br>
  Направление (входящий или исходящий) <br>
  Исходный и целевой IP-адреса (возможно, замаскированные) <br>
  Протокол (TCP, UDP, ICMP и т.п.) <br>
  Исходный и целевой порт (можно указывать списки, диапазоны или маски) <br>
  Флаги TCP <br>
  Флаг IP-фрагмента <br>
  Опции IP <br>
  Типы ICMP <br>
  Идентификатор пользователя/группы для сокета, связанного с пакетом <br>
  Учтите, что фильтровать пакеты на основе исходного IP-адреса или исходного
  порта TCP/UDP небезопасно, поскольку адрес и номер порта легко подделать.</p>
<p>prob вероятность_сопоставления<br>
  Сопоставление происходит только с заданной вероятностью (вещественное число
    в диапазоне от 0 до 1). Эта возможность может пригодиться для различных целей,
    например, для случайной потери пакетов или (при использовании совместно с
    dummynet(4)) для имитации эффекта доставки пакетов в другом порядке из-за
    использования нескольких путей. <br>
</p>
<p>действие:<br>
  allow<br>
  Пропускать пакеты, соответствующие правилу. Дальнейший поиск прекращается.
  У этого действия есть псевдонимы: pass, permit и accept. <br>
</p>
<p>deny<br>
  Отвергать пакеты, соответствующие правилу. Дальнейший поиск прекращается. У
    этого действия есть псевдоним - drop. <br>
</p>
<p>reject<br>
  (Не рекомендуется). Отвергать пакеты, соответствующие этому правилу, и пытаться
    посылать уведомление о недостижимости хоста по протоколу ICMP. Дальнейший
    поиск прекращается. <br>
</p>
<p>unreach код<br>
  Отвергать пакеты, соответствующие этому правилу, и пытаться посылать уведомление
    о недостижимости по протоколу ICMP с указанным кодом, где код - число от
    0 до 255 или один из следующих псевдонимов: net, host, protocol, port, needfrag,
    srcfail, net-unknown, host-unknown, isolated, net-prohib, host-prohib, tosnet,
    toshost, filter-prohib, host-precedence или precedence-cutoff. Дальнейший
    поиск прекращается. <br>
</p>
<p>reset<br>
  Только для TCP-пакетов. Отвергать пакеты, соответствующие этому правилу, и
    попытаться послать уведомление TCP reset (RST). Дальнейший поиск прекращается. <br>
</p>
<p>count<br>
  Обновить счетчики для всех пакетов, соответствующих правилу. Поиск продолжается
    со следующего правила. <br>
</p>
<p>check-state<br>
  Проверяет пакет по динамическому набору правил. Если найдено соответствие,
    дальнейший поиск прекращается, иначе - переходим к следующему правилу. Если
    правило check-state не найдено, динамический набор правил проверяется с первого
    правила keep-state. <br>
</p>
<p>divert порт<br>
  Перенаправляет пакеты, соответствующие правилу, на сокет divert(4), связанный
    с указанным портом. Дальнейший поиск прекращается. <br>
</p>
<p>tee порт<br>
  Посылает копию пакетов, соответствующих правилу, на сокет divert(4), связанный
    с указанным портом. Дальнейший поиск прекращается и исходный пакет принимается
    (см., однако, раздел ОШИБКИ далее). <br>
</p>
<p>fwd ip-адрес[,порт]<br>
  Изменяет следующий переход (next-hop) для соответствующих пакетов, направляя
    их по указанному ip-адресу, который можно задавать либо в виде четверки чисел
    через точку, либо по имени хоста. Если ip-адрес непосредственно не доступен,
    вместо него используется соответствующий маршрут, полученный по локальной
    таблице маршрутизации. Если ip-адрес - локальный, при поступлении в систему
    пакета с удаленного хоста он будет перенаправлен на заданный порт на локальной
    машине, так что локальный адрес сокета остается установленным в соответствии
    с исходным IP-адресом, по которому направлялся пакет. Это действие предназначено
    для использования в прозрачных промежуточных серверах. Если IP-адрес - не
    локальный, дальнейший поиск прекращается; однако, при выходе из канала если
    переменная sysctl(8) net.inet.ip.fw.one_pass не установлена, пакет снова
    передается брандмауэру для проверки, начиная со следующего правила. <br>
</p>
<p>queue номер_очереди<br>
  Передает пакет в &quot;очередь&quot; dummynet(4) (для ограничения пропускной
  способности с помощью WF2Q). <br>
</p>
<p>skipto номер<br>
  Пропускает все последующие правила с номерами меньше указанного. Поиск продолжается
    с первого правила, номер которого равен указанному или больше его. <br>
  log [logamount количество]<br>
  Если ядро было скомпилировано с опцией IPFIREWALL_VERBOSE, то когда пакет соответствует
  правилу с ключевым словом log в журнал с помощью демона syslogd(8) записывается
  сообщение от источника LOG_SECURITY. Примечание: по умолчанию, сообщения добавляются
  в файл /var/log/security (см. syslog.conf(5)). Если ядро было скомпилировано
  с опцией IPFIREWALL_VERBOSE_LIMIT, то по умолчанию журнализация прекратится
  после того, как заданное в этой опции количество пакетов будет получено соответствующим
  правилом в цепочке, и параметр net.inet.ip.fw.verbose_limit будет установлен
  равным указанному количеству. Однако, если используется опция logamount количество,
  именно это количество будет ограничивать записываемые в журнал пакеты, а не
  net.inet.ip.fw.verbose_limit, причем, значение &quot;0&quot; снимает ограничение
  на количество записей в журнал. Затем журнализацию можно включить повторно
  путем сброса ограничения или счетчика пакетов для соответствующей записи. <br>
  Журнализация на консоль и ограничение количества записей в журнал настраивается
  динамически с помощью интерфейса sysctl(8) в базе MIB net.inet.ip.fw.</p>
<p>протокол<br>
  IP-протокол, заданный по номеру или по имени (полный список см. в файле /etc/protocols).
    Ключевые слова ip или all обозначают, что подходит любой протокол. <br>
</p>
<p>исходный_адрес и целевой_адрес:<br>
  any | me | [not] &lt;адрес/маска&gt; [порты] <br>
  Если указать any, правилу будет соответствовать любой IP-адрес.</p>
<p>Если указать me, правилу будет соответствовать любой IP-адрес, сконфигурированный
  на любом из интерфейсов системы. Эта проверка требует достаточно много вычислительных
  ресурсов и ее надо использовать осторожно.</p>
<p>&lt;адрес/маску&gt; можно задавать в следующем виде:</p>
<p>ipno<br>
  IP-адрес в виде четверки чисел через точку, например, 1.2.3.4. Правилу будет
    соответствовать только этот IP-адрес. <br>
  ipno/bits<br>
  IP-адрес в виде четверки чисел через точку плюс размер маски в битах, например,
  1.2.3.4/24. В данном случае соответствовать будут все IP-адреса в диапазоне
  от 1.2.3.0 до 1.2.3.255. <br>
  ipno:mask<br>
  IP-адрес в виде четверки чисел с маской через точку в виде четверки чисел через
  точку, например, 1.2.3.4:255.255.240.0. В данном случае соответствовать будут
  все IP-адреса в диапазоне от 1.2.0.0 до 1.2.15.255. <br>
  Можно потребовать, чтобы правилу соответствовали все адреса, кроме указанных,
  добавив перед адресом модификатор not. Этот модификатор не влияет на выбор
  по номерам портов.</p>
<p>Для протоколов TCP и UDP можно также дополнительно указать порты в виде:</p>
<p>{порт|порт-порт|порт:маска}[,порт[,...]] <br>
  Дефис (-) позволяет задать диапазон портов (включая границы).</p>
<p>Двоеточие (:) позволяет задать порт и маску - пакет считается соответствующим
  правилу, если номер порта в нем соответствует указанному в правиле с точностью
  до битов, установленных в маске.</p>
<p>Вместо числовых значений портов можно указать имена служб (из файла /etc/services).
  Диапазон можно указывать только в качестве первого элемента списка, а длина
  списка портов ограничена значением IP_FW_MAX_PORTS (которое задано в заголовочном
  файле /usr/src/sys/netinet/ip_fw.h). Обратная косая (\) позволяет замаскировать
  дефис (-) в имени службы:</p>
<p>ipfw add count tcp from any ftp\\-data-ftp to any <br>
  Фрагментированные пакеты с ненулевым смещением (т.е. не первый фрагмент) никогда
    не будут соответствовать правилу, в котором задан один или несколько портов.
    Подробнее о сопоставлении фрагментированных пакетов см. в описании опции
    frag.</p>
<p>спецификация_интерфейса<br>
  Можно указывать комбинации следующих спецификаций: <br>
  in<br>
  Соответствует только входящим пакетам.<br>
</p>
<p>out<br>
  Соответствует только исходящим пакетам.<br>
</p>
<p>via ifX<br>
  Пакет должен пройти через интерфейс ifX.<br>
</p>
<p>via if*<br>
  Пакет должен пройти через интерфейс ifX, где X - любой номер устройства.<br>
</p>
<p>via any<br>
  Пакет должен пройти через любой интерфейс. <br>
</p>
<p>via ipno<br>
  Пакет должен пройти через интерфейс с IP-адресом ipno. <br>
  Ключевое слово via приводит к обязательной проверке интерфейса. Если вместо
  via использовано ключевое слово recv или xmit, то проверяется только интерфейс
  получения или интерфейс передачи, соответственно. Задав оба этих ключевых слова,
  можно отбирать пакеты на основе обоих интерфейсов, получения и отправки, например: <br>
  ipfw add 100 deny ip from any to any out recv ed0 xmit ed1 <br>
  Интерфейс recv можно проверять на входящие и исходящие пакеты, а интерфейс
  xmit - только на исходящие пакеты. Поэтому ключевое слово out - обязательно
  (а in - недопустимо), если используется xmit. Указывать via вместе с xmit или
  recv нельзя.</p>
<p>Пакет может не иметь интерфейса получения или передачи: пакеты, поступающие
  с локального хоста, не имеют интерфейса получения, а пакеты, предназначенные
  для локального хоста, не имеют интерфейса передачи.</p>
<p>опции:<br>
  keep-state [метод]<br>
  При сопоставлении брандмауэр создаст динамическое правило, по умолчанию соответствующее
  двунаправленному обмену данными между исходным и целевым IP-адресом/портом
  по тому же самому протоколу. Это правило имеет ограниченное время существования
  (определяемое набором переменных sysctl(8)), и это время изменяется при выявлении
  каждого соответствующего пакета. <br>
  Фактическое поведение можно изменить, задав другой метод.</p>
<p>bridged<br>
  Соответствует только пакетам, прошедшим через мост. Это может пригодиться для
    отбора пакетов многоадресной или широковещательной передачи, которые в противном
    случае будут проходить через брандмауэр дважды: один раз при прохождении
    через мост, а второй - когда пакет попадает в локальный стек. <br>
  Помимо небольшого снижения производительности, это приводит к проблемам при
  использовании каналов, поскольку один и тот же пакет будет учитываться дважды
  при определении пропускной способности (bandwidth), использования очередей
  и при изменении счетчиков.</p>
<p>frag<br>
  Соответствует пакету, являющемуся не первым фрагментом датаграммы. Опцию frag
    нельзя использовать в сочетании с tcpflags или спецификациями порта TCP/UDP. <br>
</p>
<p>ipoptions спецификация<br>
  Соответствует пакету, если его IP-заголовок содержит указанный в спецификации
    список оцпий через запятую. Поддерживаются следующие опции IP: <br>
  ssrr (strict source route), lsrr (loose source route), rr (record packet route)
  и ts (timestamp). Отсутствие определенной опции может обозначаться восклицательным
  знаком (!).</p>
<p>tcpoptions спецификация<br>
  Соответствует пакету, если его TCP-заголовок содержит указанный в спецификации
    список оцпий через запятую. Поддерживаются следующие опции TCP: <br>
  mss (maximum segment size - максимальный размер сегмента), window (tcp window
  advertisement - предлагаемое окно tcp), sack (selective ack - избирательное
  подтверждение), ts (rfc1323 timestamp - временная отметка по стандарту RFC
  1323) и cc (rfc1644 t/tcp connection count - счетчик подключения по стандарту
  RFC 1644). Отсутствие определенной опции может обозначаться восклицательным
  знаком (!).</p>
<p>established<br>
  Только для TCP-пакетов. Соответствует пакетам с установленными битами RST или
    ACK.<br>
</p>
<p>setup<br>
  Только для TCP-пакетов. Соответствует пакетам с установленным битом SYN, но
    со сброшенным битом ACK.<br>
</p>
<p>tcpflags спецификация<br>
  Только для TCP-пакетов. Соответствует пакету, если его TCP-заголовок содержит
    заданный в спецификации список флагов через запятую. Поддерживаются следующие
    флаги TCP: <br>
  fin, syn, rst, psh, ack и urg. Отсутствие определенной опции может обозначаться
  восклицательным знаком (!). Правило, содержащее спецификацию tcpflags, не может
  сопоставиться с фрагментированным пакетом, имеющим ненулевое смещение. Подробнее
  о сопоставлении фрагментированных пакетов см. в описании опции frag.</p>
<p>icmptypes типы<br>
  Только для пакетов ICMP. Соответствует пакету, если его ICMP-тип входит в указанный
    список типов. Список можно задавать как любую комбинацию диапазонов или отдельных
    типов через запятые. Поддерживаются следующие ICMP-типы: <br>
  echo reply (0, эхо-ответ), destination unreachable (3, целевой адрес недоступен),
  source quench (4), redirect (5, перенаправление), echo request (8, эхо-запрос),
  router advertisement (9, представление маршрутизатора), router solicitation
  (10), time-to-live exceeded (11, превышено время существования), IP header
  bad (12, неверный IP-заголовок), timestamp request (13, запрос временной отметки),
  timestamp reply (14, временная отмета в ответ), information request (15, запрос
  информации), information reply (16, ответ на запрос информации), address mask
  request (17, запрос маски адреса) и address mask reply (18, маска адреса в
  ответ).</p>
<p>uid пользователь<br>
  Соответствует всем TCP- или UDP-пакетам, посланным или полученным указанным
    пользователем. Пользователя можно задавать по имени или с помощью числового
    идентификатора. <br>
</p>
<p>gid группа<br>
  Соответствует всем TCP- или UDP-пакетам, посланным или полученным для указанной
    группы. Группу можно задавать по имени или с помощью числового идентификатора. <br>
  КОНФИГУРАЦИЯ ФОРМИРОВАТЕЛЯ ТРАФИКА<br>
  Утилита ipfw также обеспечивает пользовательский интерфейс для формирователя
  трафика dummynet(4). Формирователь работает путем деления пакетов на потоки
  в соответствии с заданной пользователем маской по различным полям заголовка
  IP. Пакеты, принадлежащие к одному потоку, затем передаются двум различным
  объектам - каналу или очереди.</p>
<p>Канал эмулирует связь с заданными пропускной способностью, задержкой при передаче,
  размером очереди и процентом потери пакетов. Пакеты проходят по каналу в соответствии
  с его параметрами.</p>
<p>Очередь - абстракция, используемая для реализации правил WF2Q+. Очередь связывает
  с каждым потоком вес и соответствующий канал. Далее, все потоки, связанные
  с одним и тем же каналом, переключаются с частотой, определяемой каналом в
  соответствии с правилами WF2Q+.</p>
<p>Формат конфигурации канала ipfw следующий:</p>
<p>pipe число config [bw пропускная_способность | устройство] [delay задержка_в_миллисекундах]
  [queue {слоты | размер}] [plr вероятность_потери] [mask спецификатор_маски]
  [buckets размер_хеш-таблицы] [red | gred w_q/min_th/max_th/max_p] </p>
<p>Формат конфигурации очереди ipfw следующий:</p>
<p>queue число config [pipe номер_канала] [weight вес] [queue {слотов | размер}]
  [plr вероятность_потери] [mask спецификатор_маски] [buckets размер_хеш-таблицы]
  [red | gred w_q/min_th/max_th/max_p] </p>
<p>Для канала можно сконфигурировать следующие параметры:</p>
<p>bw пропускная_способность | устройство<br>
  Пропускная способность, измеренная в [K|M]{bit/s|byte/s}. <br>
  Значение 0 (принятое по умолчанию) означает неограниченную пропускную способность.
  Единицу измерения необходимо указывать сразу после числового значения, например:</p>
<p>ipfw pipe 1 config bw 300Kbit/s queue 50KBytes <br>
  Если вместо числового значения указано имя устройства, то скорость передачи
    задается указанным устройством. В настоящее время только устройство tun(4)
    поддерживает такую возможность, для использования совместно с ppp(8). <br>
</p>
<p>delay задержка_в_миллисекундах<br>
  Задержка при передаче, задаваемая в миллисекундах. Значение округляется до
    следующего кратного минимальному временному интервалу системных часов (обычно
    - 10 миллисекунд, но обычно имеет смысл запускать ядра с опцией &quot;options
    HZ=1000&quot;, чтобы можно было задавать время с точностью до 1 миллисекунды
    или менее). Стандартное значение, 0, означает отсутствие задержки. <br>
</p>
<p>queue {слотов | размерKbytes}<br>
  Размер очереди, в слотах или Kбайтах. По умолчанию используется 50 слотов,
    что является типичным размером очереди для устройств Ethernet. Учтите, что
    для низкоскоростных подключений следует использовать очереди небольшого размера
    или при передаче будут возникать существенные задержки пакетов в очереди.
    Так, 50 пакетов ethernet максимального размера (1500 байтов) означает 600
    Кбит, или нахождение в очереди в течение 20 секунд для канала с пропускной
    способностью 30Kbit/s. Эффект может быть еще хуже, если пакеты принимаются
    с интерфейса с намного большим значением MTU, например, с интерфейса закольцовывания
    с его пакетами размером 16 Kбайт. <br>
</p>
<p>plr вероятность_потери<br>
  Вероятность потери пакета. Аргумент вероятность_потери - вещественное число
    от 0 до 1, так что 0 означает отсуствие потерь, а 1 - 100% потерю. Вероятность
    потери внутренне представлена 31 битом. <br>
</p>
<p>mask спецификатор_маски<br>
  Интерфейс dummynet(4) позволяет создавать отдельнЁе очереди для каждого потока.
    Идентификатор потока создается путем маскировки IP-адресов, портов и типов
    протоколов, заданных в конфигурации канала. Пакеты с одинаковым идентфикатором
    после маскировки попадают в одну очередь. Спецификаторы маски строятся как
    комбинации следующих компонентов: dst-ip маска, src-ip маска, dst-port маска,
    src-port маска, proto маска или all, что означает существенность всех битов
    во всех полях. При использовании в конфигурации канала, каждому потоку присваивается
    частота (rate), равная частоте канала. При использовании в конфигурации очереди,
    каждый поток получает вес, равный весу очереди, и все потоки, связанные с
    одним каналом, используют канал пропорционально их весу.<br>
</p>
<p>&nbsp;</p>
<p>buckets размер_хеш-таблицы<br>
  Задает размер хеш-таблицы, используемой для хранения различных очередей. Стандартное
    значение, 64, задается переменной sysctl(8) net.inet.ip.dummynet.hash_size,
    и может быть в диапазоне от 16 до 1024. <br>
</p>
<p>pipe номер_канала<br>
  Связывает очередь с указанным каналом. С одним каналом можно связать несколько
    очередей (обычно, с разными весами), который задает суммарную скорость передачи
    для набора очередей. <br>
</p>
<p>weight вес<br>
  Задает вес, который будет использоваться для потоков, соответствующих данной
    очереди. Вес должен быть в диапазоне 1..100, и имеет стандартное значение
    1. <br>
</p>
<p>red | gred w_q/min_th/max_th/max_p<br>
  Использует алгоритм управления очередью RED. w_q и max_p - вещественные числа
    в диапазоне от 0 до 1 (не включая 0), а min_th и max_th - целые числа, задающие
    пороговые значения для алгоритма управления очередью (пороговые значения
    задаются в байтах, если размер очереди задавался в байтах, и в слотах в противном
    случае). Интерфейс dummynet(4) поддерживается также более умеренную (gentle)
    версию RED (gred). Для управления работой алгоритма RED можно использовать
    три переменных sysctl(8): <br>
  net.inet.ip.dummynet.red_lookup_depth<br>
  задает точность при вычислении средней очереди, когда связь простаивает (стандартное
  значение - 256, должно быть больше нуля)<br>
</p>
<p>net.inet.ip.dummynet.red_avg_pkt_size<br>
  задает ожидаемый средний размер пакета (стандартное значение - 512, должно
    быть больше нуля)<br>
</p>
<p>net.inet.ip.dummynet.red_max_pkt_size<br>
  задает ожидаемый максимальный размер пакета, который используется только когда
    пороговые значения для очереди задаются в байтах (стандартное значение -
    1500, должно быть больше нуля). <br>
  СПИСОК ДЛЯ ПРОВЕРКИ<br>
  При разработке правил надо учитывать следующие существенные моменты:</p>
<p>Помните, что фильтруются как входящие, так и исходящие пакеты. Для большинства
  подключений необходим двунаправленный обмен пакетами. <br>
  Помните о необходимости очень внимательно тестировать набор правил. При этом
  крайне желателен доступ к консоли. Если консоль недоступна, используйте сценарий
  автоматического восстановления типа /usr/share/examples/ipfw/change_rules.sh. <br>
  Не забывайте про интерфейс закольцовывания (loopback interface). <br>
  ПОЛОЖИТЕЛЬНЫЕ МОМЕНТЫ<br>
  Одну разновидность пакетов брандмауэр отвергает всегда - это фрагмент TCP-пакета
  со смещением один. Это допустимый пакет, но используется он с единственной
  целью - для обходя брандмауэров. Если включена регистрация, такие пакеты регистрируются
  как отвергнутые правилом -1. <br>
  При подключении по сети загрузка версии kld(4) утилиты ipfw не так проста,
  как может показаться. Я рекомендую использовать следующую командную строку: <br>
  kldload /modules/ipfw.ko &amp;&amp; \<br>
  ipfw add 32000 allow ip from any to any</p>
<p>В этой же ситуации выполнение команды <br>
  ipfw flush</p>
<p>тоже не поможет. <br>
  Список фильтров ipfw нельзя изменять если уровень защиты системы установлен
    равным 3 или выше (подробнее об уровнях защиты системы см. на странице справочного
    руководства init(8)). <br>
  ПЕРЕНАПРАВЛЕНИЕ ПАКЕТОВ<br>
  Сокет divert(4), связанный с указанным портом, будет получать все пакеты, перенаправленные
  на этот порт. Если с целевым портом не связан ни один сокет или если ядро не
  было скомпилировано с поддержкой сокетов перенаправления, пакеты удаляются.</p>
<p>ПЕРЕМЕННЫЕ SYSCTL<br>
  Набор переменных sysctl(8) управляет поведением брандмауэра. Стандартные значения
    и описания этих переменных представлены далее:</p>
<p>net.inet.ip.fw.debug: 1<br>
  Управляет отладочными сообщениями, которые выдает ipfw.<br>
</p>
<p>net.inet.ip.fw.one_pass: 1<br>
  При установке значения 1 пакет, выходящий из канала dummynet(4) не проходит
    снова через брандмауэр. В противном случае, после выполнения действия канала,
    пакет повторно попадает на брандмауэр и проверяется, начиная со следующего
    правила.<br>
</p>
<p>net.inet.ip.fw.verbose: 1<br>
  Включает выдачу подробных сообщений.<br>
</p>
<p>net.inet.ip.fw.enable: 1<br>
  Включает брандмауэр. При установке значения 0 машина будет работать без брандмауэра,
    даже если он скомпилирован в ядро.<br>
</p>
<p>net.inet.ip.fw.verbose_limit: 0<br>
  Ограничивает количество сообщений, выдаваемых брандмауэром в режиме выдачи
    подробных сообщений. <br>
</p>
<p>net.inet.ip.fw.dyn_buckets: 256<br>
  net.inet.ip.fw.curr_dyn_buckets: 256<br>
  Первоначально сконфигурированный и текущий размер хеш-таблицы, использующейся
  для хранения динамических правил. Значение должно быть степенью 2. Размер таблицы
  можно менять только когда она пуста, так что для изменения размера на ходу,
  вероятно, придется сбросить (flush) и повторно загрузить набор правил.<br>
</p>
<p>net.inet.ip.fw.dyn_count: 3<br>
  Текущее количество динамических правил (доступна только для чтения).<br>
</p>
<p>net.inet.ip.fw.dyn_max: 1000<br>
  Максимальное количество динамических правил. При достижении этого предела нельзяч
    больше добавлять динамические правила, пока прежние не устареют. <br>
</p>
<p>net.inet.ip.fw.dyn_ack_lifetime: 300<br>
  net.inet.ip.fw.dyn_syn_lifetime: 20<br>
  net.inet.ip.fw.dyn_fin_lifetime: 20<br>
  net.inet.ip.fw.dyn_rst_lifetime: 5<br>
  net.inet.ip.fw.dyn_short_lifetime: 30<br>
  Эти переменные задают время существования динамических правил в секундах. При
  перовначальном обмене SYN-пакетами время существования устанавливается небольшим,
  а после получения обоих SYN-пакетов увеличивается, и снова уменьшается в ходе
  обмена завершающими пакетами FIN или RST. <br>
  ПРИМЕРЫ<br>
  Следующая команда добавляет запись, которая отвергает перенаправление текущим
  хостом всех tcp-пакетов от хоста cracker.evil.org на порт telnet хоста wolf.tambov.su:</p>
<p>ipfw add deny tcp from cracker.evil.org to wolf.tambov.su telnet <br>
  Следующая команда запрещает любое подключение из сети взломщиков к моему хосту: <br>
  ipfw add deny ip from 123.45.67.0/24 to my.host.org <br>
  Основной и эффективный способ ограничить доступ (без использования динамических
  правил) - использовать правила следующего типа: <br>
  ipfw add allow tcp from any to any established<br>
  ipfw add allow tcp from net1 portlist1 to net2 portlist2 setup<br>
  ipfw add allow tcp from net3 portlist3 to net3 portlist3 setup<br>
  ...<br>
  ipfw add deny tcp from any to any <br>
  Первому правилу соответствуют обычные пакеты TCP, но ему не соответствует исходный
  пакет SYN, который будет соответствовать правилам setup только для избранных
  пар иходный адрес/целевой адрес. Все остальные пакеты SYN будут отвергаться
  завершающим правилом deny. <br>
  Для защиты сайта от атак шквалом поддельных пакетов TCP, безопаснее использовать
  динамические правила:</p>
<p>ipfw add check-state<br>
  ipfw add deny tcp from any to any established<br>
  ipfw add allow tcp from my-net to any setup keep-state <br>
  Это позволит брандмауэру устанавливать динамические правила только для подключения,
  которое начинается с обычного пакета SYN, поступающего из нашей сети. Динамические
  правила проверяются при обработке первого правила check-state или keep-state.
  Правило check-state обычно надо помещать ближе к началу набора правил, чтобы
  уменьшить объем работы при просмотре набора правил. Но возможны и другие решения. <br>
  УЧТИТЕ: правила, учитывающие состояние, уязвимы для атак на службы (denial-of-service
  attacks) путем забрасывания шквалом SYN-пакетов, что приводит к созданию множества
  динамических правил. Ущерб от таких атак можно частично ограничить путем установки
  соответствующих переменных sysctl(8), которые управляют работой брандмауэра.</p>
<p>Вот хороший пример использования команды list для просмотра учетных записей
  и информации о временных отметках:</p>
<p>ipfw -at list <br>
  или в сокращенном виде, без временных отметок:</p>
<p>ipfw -a list <br>
  Следующее правило перенаправляет все входящие пакеты от 192.168.2.0/24 на порт
    5000:</p>
<p>ipfw divert 5000 ip from 192.168.2.0/24 to any in <br>
  Следующие правила показывают некоторые варианты применения средств ipfw и dummynet(4)
    для имитации и моделирования.</p>
<p>Это правило теряет случайные входящие пакеты с вероятностью 5%:</p>
<p>ipfw add prob 0.05 deny ip from any to any in <br>
  Аналогичного эффекта можно добиться с помощью каналов dummynet:</p>
<p>ipfw add pipe 10 ip from any to any<br>
  ipfw pipe 10 config plr 0.05 <br>
  Можно использовать каналы для искусственного ограничения пропускной способности,
  например, если на машине, работающей как маршрутизатор, необходимо ограничить
  объем данных, передаваемых локальными клиентами в сети 192.168.2.0/24, можно
  задать правила:</p>
<p>ipfw add pipe 1 ip from 192.168.2.0/24 to any out<br>
  ipfw pipe 1 config bw 300Kbit/s queue 50KBytes <br>
  Обратите внимание на использование модификатора out - в результате правило
  не используется дважды. Запомните, что правила ipfw проверяются как для входящих,
  так и для исходящих пакетов.</p>
<p>При необходимости сымитировать двунаправленную связь с ограниченной пропускной
  способностью, это следует делать так:</p>
<p>ipfw add pipe 1 ip from any to any out<br>
  ipfw add pipe 2 ip from any to any in<br>
  ipfw pipe 1 config bw 500Kbit/s queue 100 red 0.002/30/80/0.1 <br>
  Еще одно типичное приминение формирователя трафика связано с добавлением некоторых
  задержек при взаимодействии. Это может повлиять на многие приложения, выполняющие
  много вызовов удаленных процедур, когда время обмена данными (round-trip-time)
  по подключению часто становится намного более существенным ограничением, чем
  пропускная способность:</p>
<p>ipfw add pipe 1 ip from any to any out<br>
  ipfw add pipe 2 ip from any to any in<br>
  ipfw pipe 1 config delay 250ms bw 1Mbit/s<br>
  ipfw pipe 2 config delay 250ms bw 1Mbit/s <br>
  Отдельные очереди для потоков могут пригодиться для различных целей. Например,
  для подсчета объема переданных данных:</p>
<p>ipfw add pipe 1 tcp from any to any<br>
  ipfw add pipe 1 udp from any to any<br>
  ipfw add pipe 1 ip from any to any<br>
  ipfw pipe 1 config mask all <br>
  Представленный выше набор правил создаст очереди (и будет собирать статистическую
  информацию) для всех передаваемых данных. Поскольку каналы не накладывают никаких
  ограничений, в результате будет только собираться статистическая информация.
  Учтите, что необходимы 3 правила, а не только последнее, поскольку когда программа
  ipfw пытается сопоставить IP-пакеты, она не учитвает порты, поэтому нельзя
  будет различить подключения к разным портам.</p>
<p>Более сложный пример связан с ограничением объема исходящих из сети данных
  с ограничениями по отдельным хостам, а не по сетям:</p>
<p>ipfw add pipe 22.06.031 ip from 192.168.2.0/24 to any out<br>
  ipfw add pipe 2 ip from any to 192.168.2.0/24 in<br>
  ipfw pipe 1 config mask src-ip 0x000000ff bw 200Kbit/s queue 20Kbytes<br>
  ipfw pipe 2 config mask dst-ip 0x000000ff bw 200Kbit/s queue 20Kbytes <br>
  ССЫЛКИ<br>
  cpp(1), m4(1), bridge(4), divert(4), dummynet(4), ip(4), ipfirewall(4), protocols(5),
  services(5), init(8), kldload(8), reboot(8), sysctl(8), syslogd(8) <br>
  ОШИБКИ<br>
  Ситаксис складывался исторически и не слишком прозрачен.</p>
<p>ПРЕДУПРЕЖДЕНИЕ!!ПРЕДУПРЕЖДЕНИЕ!!ПРЕДУПРЕЖДЕНИЕ!!</p>
<p>Эта программа может сделать работу с компьютером практически невозможной.
  При первом использовании работать надо за консолью и НЕ делать ничего, что
  вы не понимаете.</p>
<p>При изменении/добавлении записей в цепочки имена служб и протоколов испольбзовать
  нельзя.</p>
<p>Фрагменты входящих пакетов, перенаправленные с помощью divert или tee, повторно
  собираются перед доставкой на соответствующий сокет.</p>
<p>Пакеты, соответствующие правилу tee, не должны приниматься немедленно, а должны
  проходить дальше по списку правил. Эта ошибка может быть исправлена в следующей
  версии.</p>
<p>АВТОРЫ<br>
  Юрген Анцилевич (Ugen J. S. Antsilevich),<br>
  Пол-Хёнинг Камп (Poul-Henning Kamp),<br>
  Алекс Нэш (Alex Nash),<br>
  Арчи Коббс (Archie Cobbs),<br>
  Луиджи Риццо (Luigi Rizzo). <br>
  Функциональный интерфейс (API) основан на коде, написанном Дэниэлем Буле (Daniel
  Boulet) для BSDI.</p>
<p>Работу над формирователем трафика dummynet(4) поддерживала корпорация Akamba
  Corp.</p>
<p>ИСТОРИЯ<br>
  Утилита ipfw впервые появилась в ОС FreeBSD 2.0. Интерфейс dummynet(4) был
    добавлен в FreeBSD 2.2.8. Расширения, связанные с запоминанием состояния,
    появились в ОС FreeBSD 4.0.</p>
<p>FreeBSD 4.4, 16 февраля 2000 года<br>
</p>
</div>
</div>


<center><div style="width:500px; border:1px solid black; text-align: left;">  
  <div id="gfi_slide2" style="display: none;  padding:5px; font-family: 'Open Sans', sans-serif !important; font-size:16px !important; color:black !important;">
	  <a href="http://gfi-software.ru/languard/?utm_source=citforum&utm_medium=banner&utm_campaign=languard" target="_blank" style="text-decoration:none; display:block; color:black !important;">
    <table cellpadding=0 cellspacing=0 width=490><tr><td><img src="http://static.gfi.me.uk/images/thumbs/LANSS-1413629426-7a56c.png" width="183" height="30" alt="GFI LanGuard"></td>
    <td align=right><nobr><b>Код <b style="color:#f90000">CITFORUM</b> для скидки</b></nobr></td>
    </tr>
    <tr><td colspan=2 align=center>Поиск и автоматическое устранение уязвимостей в сети</td></tr>
    <tr><td colspan=2 align=center>Инвентаризация и управление программным обеспечением</td></tr>
    </table>
	  </a>
  </div>
  <div id="gfi_slide1" style="display: block;  padding:5px; font-family: 'Open Sans', sans-serif !important; font-size:16px !important; color:black !important;">
	  <a href="http://gfi-software.ru/mailessentials/?utm_source=citforum&utm_medium=banner&utm_campaign=mailessentials" target="_blank" style="text-decoration:none; display:block; color:black !important;">
    <table cellpadding=0 cellspacing=0 width=490><tr><td><img src="http://static.gfi.me.uk/images/thumbs/ME-1413629452-7a56c.png" width="235" height="30" alt="GFI MailEssentials"></td>
    <td align=right><nobr><b>Код <b style="color:#f90000">CITFORUM</b> для скидки</b></nobr></td>
    </tr>
    <tr><td colspan=2 align=center>Защита от спама и вирусов для почтового сервера №1</td></tr>
    <tr><td colspan=2 align=center>Качество фильтрации выше 99%, без ложных срабатываний</td></tr>
    </table>
	  </a>
  </div>
  <div id="gfi_slide4" style="display: none;  padding:5px; font-family: 'Open Sans', sans-serif !important; font-size:16px !important; color:black !important;">
	  <a href="http://gfi-software.ru/archiver/?utm_source=citforum&utm_medium=banner&utm_campaign=archiver" target="_blank" style="text-decoration:none; display:block; color:black !important;">
    <table cellpadding=0 cellspacing=0 width=490><tr><td><img src="http://static.gfi.me.uk/images/thumbs/AR-1422970393-7a56c.png" width="164" height="30" alt="GFI Archiver"></td>
    <td align=right><nobr><b>Код <b style="color:#f90000">CITFORUM</b> для скидки</b></nobr></td>
    </tr>
    <tr><td colspan=2 align=center>Резервное копирование электронных писем и документов</td></tr>
    <tr><td colspan=2 align=center>Быстрый поиск по архиву, анализ контента, отчетность</td></tr>
    </table>
	  </a>
  </div>
  <div id="gfi_slide3" style="display: none;  padding:5px; font-family: 'Open Sans', sans-serif !important; font-size:16px !important; color:black !important;">
	  <a href="http://gfi-software.ru/webmonitor/?utm_source=citforum&utm_medium=banner&utm_campaign=webmonitor" target="_blank" style="text-decoration:none; display:block; color:black !important;">
    <table cellpadding=0 cellspacing=0 width=490><tr><td><img src="http://static.gfi.me.uk/images/thumbs/WM-1413629470-7a56c.png" width="214" height="30" alt="GFI WebMonitor"></td>
    <td align=right><nobr><b>Код <b style="color:#f90000">CITFORUM</b> для скидки</b></nobr></td>
    </tr>
    <tr><td colspan=2 align=center>Контроль и безопасность доступа сотрудников в веб</td></tr>
    <tr><td colspan=2 align=center>Более 460.000.000 веб-сайтов в базе по категориям</td></tr>
    </table>
	  </a>
  </div>
  <div style="background:#F0F0F0; padding:2px; font-family: 'Open Sans', sans-serif !important; font-size:12px !important; color:black !important; text-align:center;">
    <b>30 дней бесплатно.</b> Техническая поддержка на русском.
  </div>
  <script>
    (function addEvent(element, event, fn) {
      if (element.addEventListener){
        element.addEventListener(event, fn, false);
      }else if (element.attachEvent){
        element.attachEvent('on' + event, fn);
      }
    })(window, 'load', function(){
      window.gfi_slides=4;
      window.gfi_slider=1;
      setInterval(function(){
        for(var i=1; i<=window.gfi_slides; i++){
          document.getElementById("gfi_slide"+i).style.display="none";
        }
        window.gfi_slider++;
        if (window.gfi_slider>window.gfi_slides){
          window.gfi_slider=1
        }
        document.getElementById("gfi_slide"+window.gfi_slider).style.display="block";
      }, 6000)
    });
  </script>
</div>
</center>

<center>


</center>

</td>


<td>

<table cellspacing=0 cellpadding=0 border=0 width="100%" align=right><tr>
<td bgcolor=#008080><img src="../../../pictures/1x1.gif" width=1 height=1 border=0></td>
<td bgcolor=#daecd7><img src="../../../pictures/1x1.gif" width=2 height=1 border=0></td>
<td>

<table cellpadding=0 cellspacing=0 border=0>

<tr><td align="center"><!--  AdRiver code START. Type:240x400 Site: citforum PZ: 0 BN: 1 -->
<script language="javascript" type="text/javascript"><!--
var RndNum4NoCash = Math.round(Math.random() * 1000000000);
var ar_Tail='unknown'; if (document.referrer) ar_Tail = escape(document.referrer);
document.write(
'<iframe src="http://ad.adriver.ru/cgi-bin/erle.cgi?'
+ 'sid=137295&bn=1&target=blank&bt=22&pz=0&rnd=' + RndNum4NoCash + '&tail256=' + ar_Tail
+ '" frameborder=0 vspace=0 hspace=0 width=240 height=400 marginwidth=0'
+ ' marginheight=0 scrolling=no></iframe>');
//--></script>
<noscript>
<a href="http://ad.adriver.ru/cgi-bin/click.cgi?sid=137295&bn=1&bt=22&pz=0&rnd=1132854728" target=_blank>
<img src="http://ad.adriver.ru/cgi-bin/rle.cgi?sid=137295&bn=1&bt=22&pz=0&rnd=1132854728" alt="-AdRiver-" border=0 width=240 height=400></a>
</noscript>

<!--  AdRiver code END  --></td></tr>



<tr><td bgcolor=#008080><img src="../../../pictures/1x1.gif" width=1 height=1 border=0 alt=""></td></tr>
<tr><td bgcolor=#daecd7><img src="../../../pictures/1x1.gif" width=1 height=3 border=0 alt=""></td></tr>
<tr><td bgcolor=#ffffff>
<font size=2>
<p><b>Новости мира IT:</b>
<ul class=column>
<!--<b><a target=_blank href=http://citcity.ru/20070/>4&#x2013;5 декабря пройдёт &#xab;Платформа 2009&#xbb;</a></b>
<hr>-->

<li>06.02 - <a href=http://citforum.ru/news/33352/>В Почте и на портале Mail.Ru заработала двухфакторная аутентификация</a><li>06.02 - <a href=http://citforum.ru/news/33351/>Apple задумалась над созданием поисковой системы</a><li>06.02 - <a href=http://citforum.ru/news/33350/>IBM открыла первый центр предоставления услуг в России</a><li>06.02 - <a href=http://citforum.ru/news/33349/>Платформа Windows RT официально закрыта</a><li>06.02 - <a href=http://citforum.ru/news/33348/>Toshiba выпустила флеш-брелоки с шифрованием и клавиатурой для ввода пароля</a><li>06.02 - <a href=http://citforum.ru/news/33347/>Motorola бьёт рекорды продаж смартфонов после перехода в Lenovo</a><li>06.02 - <a href=http://citforum.ru/news/33346/>Buhel SoundGlasses: беспроводная гарнитура в солнцезащитных очках</a><li>06.02 - <a href=http://citforum.ru/news/33345/>Microsoft приобретет разработчика календарей для iOS и Android</a><li>05.02 - <a href=http://citforum.ru/news/33344/>Проведены первые операции через национальную систему платёжных карт</a><li>05.02 - <a href=http://citforum.ru/news/33343/>Рейтинг Rookies Award определил лучшие открытые проекты, созданные в 2014 году</a><li>05.02 - <a href=http://citforum.ru/news/33342/>OneBoard PRO+: механическая клавиатура со встроенным Android-компьютером</a><li>05.02 - <a href=http://citforum.ru/news/33341/>Проект FreeBSD переходит на новую модель поддержки релизов</a><li>05.02 - <a href=http://citforum.ru/news/33340/>IBM расширила штат инженеров, работающих над техпроцессами тоньше 7 нм</a><li>05.02 - <a href=http://citforum.ru/news/33339/>ARM представила 64-битное ядро Cortex-A72</a><li>05.02 - <a href=http://citforum.ru/news/33338/>Yota Devices заключила мировое соглашение в споре с PocketBook</a><li>05.02 - <a href=http://citforum.ru/news/33337/>На долю LTE-моделей впервые пришлось больше половины продаж смартфонов в России</a><li>04.02 - <a href=http://citforum.ru/news/33336/>Почта Mail.Ru предлагает пользователям убраться в ящике</a><li>04.02 - <a href=http://citforum.ru/news/33335/>Российский образовательный онлайн-проект привлек 2,1 миллиона долларов</a><li>04.02 - <a href=http://citforum.ru/news/33334/>&#xab;Яндекс&#xbb; внедрил двухфакторную аутентификацию</a><li>04.02 - <a href=http://citforum.ru/news/33333/>Sony продала подразделение видеоигр</a>

</ul>
<p><a target=_blank href=http://citforum.ru/news/><b>Архив новостей</b></a>
</font>
<p align=right><a href=http://citforum.ru/news/rss/news.xml><img src="../../../pictures/xml_rss.gif" border=0 width=36 height=14></a>
</td></tr>


<tr><td bgcolor=#008080><img src="../../../pictures/1x1.gif" width=1 height=1 border=0 alt=""></td></tr>
<tr><td bgcolor=#daecd7><img src="../../../pictures/1x1.gif" width=1 height=3 border=0 alt=""></td></tr>
<tr><td bgcolor=#008080><img src="../../../pictures/1x1.gif" width=1 height=1 border=0 alt=""></td></tr>
<tr><td style="padding-left: 5px; min-width: 240px"><p><b>Последние комментарии:</b>	<div class=comments_menu>
		<a href=http://citforum.ru/news/33329/#comments>Минкомсвязь предлагает перенести домены в компании-регистраторы в РФ</a>&nbsp;(12)<br>
		<div class=comments_menu_date>Суббота 07.02, 21:22		</div>
	</div>	<div class=comments_menu>
		<a href=http://citforum.ru/news/33352/#comments>В Почте и на портале Mail.Ru заработала двухфакторная аутентификация</a>&nbsp;(4)<br>
		<div class=comments_menu_date>Суббота 07.02, 09:08		</div>
	</div>	<div class=comments_menu>
		<a href=http://citforum.ru/news/33349/#comments>Платформа Windows RT официально закрыта</a>&nbsp;(4)<br>
		<div class=comments_menu_date>Суббота 07.02, 09:04		</div>
	</div>	<div class=comments_menu>
		<a href=http://citforum.ru/news/33307/#comments>В метро Петербурга запустили систему бесконтактных платежей PayPass</a>&nbsp;(13)<br>
		<div class=comments_menu_date>Суббота 07.02, 09:01		</div>
	</div>	<div class=comments_menu>
		<a href=http://citforum.ru/news/33313/#comments>Ideum Duet: кофейный столик с двумя встроенными компьютерами и двумя ОС</a>&nbsp;(7)<br>
		<div class=comments_menu_date>Пятница 06.02, 21:32		</div>
	</div>	<div class=comments_menu>
		<a href=http://citforum.ru/news/33346/#comments>Buhel SoundGlasses: беспроводная гарнитура в солнцезащитных очках</a>&nbsp;(2)<br>
		<div class=comments_menu_date>Пятница 06.02, 21:25		</div>
	</div>	<div class=comments_menu>
		<a href=http://citforum.ru/news/33347/#comments>Motorola бьёт рекорды продаж смартфонов после перехода в Lenovo</a>&nbsp;(1)<br>
		<div class=comments_menu_date>Пятница 06.02, 09:36		</div>
	</div>	<div class=comments_menu>
		<a href=http://citforum.ru/news/33306/#comments>Прибыль Microsoft упала на 11 %</a>&nbsp;(4)<br>
		<div class=comments_menu_date>Пятница 06.02, 09:20		</div>
	</div>	<div class=comments_menu>
		<a href=http://citforum.ru/news/32977/#comments>Новый &#xab;антипиратский&#xbb; закон вступит в силу 1 мая 2015 года</a>&nbsp;(35)<br>
		<div class=comments_menu_date>Пятница 06.02, 09:16		</div>
	</div>	<div class=comments_menu>
		<a href=http://citforum.ru/news/33328/#comments>МТС создаст отечественный аналог Skype</a>&nbsp;(5)<br>
		<div class=comments_menu_date>Пятница 06.02, 00:18		</div>
	</div></td></tr>

<tr><td bgcolor=#008080><img src="../../../pictures/1x1.gif" width=1 height=1 border=0 alt=""></td></tr>
<tr><td bgcolor=#daecd7><img src="../../../pictures/1x1.gif" width=1 height=3 border=0 alt=""></td></tr>
<tr><td bgcolor=#008080><img src="../../../pictures/1x1.gif" width=1 height=1 border=0 alt=""></td></tr>
<tr><td><div id="cse" style="width: 100%;">Loading</div>
<script src="http://www.google.com/jsapi" type="text/javascript"></script>
<script type="text/javascript"> 
  google.load('search', '1', {language : 'ru'});
  google.setOnLoadCallback(function() {
    var customSearchControl = new google.search.CustomSearchControl('018117224161927867877:xbac02ystjy');
    customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
    customSearchControl.draw('cse');
  }, true);
</script>
<link rel="stylesheet" href="http://www.google.com/cse/style/look/default.css" type="text/css" />
</td></tr>

<tr><td align="center"><!-- Soloway 240x400 code START-->
<script language="javascript" type="text/javascript"><!--
if(typeof(ar_cn)=="undefined") var ar_cn=1;
var ar_Tail=document.referrer ? escape(document.referrer) : 'unknown';
var ar_link="http://ad.adriver.ru/cgi-bin/erle.cgi?sid=126751&bt=49&target=blank&tail256=" + ar_Tail;
document.write('<div style="visibility:hidden;height:0px;"><iframe id="ar_container_'+ar_cn+'" width=1 height=1 marginwidth=0 marginheight=0 scrolling=no frameborder=0><\/iframe><\/div><div id="ad_ph_'+ar_cn+'"><\/div>');
function ar_getDoc(t,n,l){var doc;if(t<100){if(document.all && !window.opera){doc = window.frames['ar_container_'+n].document}
else if(document.getElementById){doc=document.getElementById('ar_container_'+n).contentDocument}
if(!doc){setTimeout('ar_getDoc('+(++t)+','+n+',"'+l+'")', 100)}else {var RndNum4NoCash = Math.round(Math.random() * 1000000000);
doc.write ('<sc'+'ript language="JavaScript" type="text/javascript">var ar_bnum='+n+';<\/sc'+'ript>');
doc.write ('<sc'+'ript language="JavaScript" type="text/javascript" src="'+l+'&rnd='+RndNum4NoCash+'"><\/sc'+'ript>');}}}
(function(num,link){function addEvent(e,t,f){if(e.addEventListener)e.addEventListener(t,f,false);else if(e.attachEvent)e.attachEvent('on'+t,f)}
function removeEvent(e,t,f){if(e.removeEventListener)e.removeEventListener(t,f,false);else if(e.detachEvent)e.detachEvent('on'+t,f)}
var BannerLoader={top:0,height:400,cm:document.compatMode=="CSS1Compat",
scroll:function(){var ch=self.innerHeight||this.cm&&document.documentElement.clientHeight||document.body.clientHeight;
var st=self.pageYOffset||this.cm&&document.documentElement.scrollTop||document.body.scrollTop;
var sh=self.scrollHeight||this.cm&&document.documentElement.scrollHeight||document.body.scrollHeight;
if((st-this.top<=this.height*0.2&&st+ch-this.top>=this.height*0.8)||(sh-this.top<=this.height*0.8&&(sh-st-ch<1||sh<ch))){
removeEvent(window,'scroll',this.sfunc);ar_getDoc(0,num,link)}},
sfunc: function(){BannerLoader.scroll()},init:function(){var t=this,obj=document.getElementById('ad_ph_'+num);
if(obj){while(obj.offsetParent){t.top += obj.offsetTop; obj = obj.offsetParent}
addEvent(window,'scroll',this.sfunc);t.scroll()}}};addEvent(window, 'load', function(){BannerLoader.init()})})(ar_cn++,ar_link);
//--></script>
<!-- Soloway 240x400 code END -->
</td></tr>

<tr><td align="center">
<font size="2"><a class=head href=http://forum.citforum.ru/>Форумы</a>
<a class=head href=http://citforum.ru/gazeta/>Газета</a></font>
</td></tr>
</table>

</td>
<td bgcolor=#daecd7><img src="../../../pictures/1x1.gif" width=2 height=1 border=0></td>
<td bgcolor=#008080><img src="../../../pictures/1x1.gif" width=1 height=1 border=0></td>
</tr></table>

</td>
 <!--no_right-->

</tr>
</table>
</td>

</tr></table>

<p>
<table   cellspacing=0 cellpadding=0 border=0 width=100%>
<tr><td bgcolor=#008080><img src="../../../pictures/1x1.gif" width=931 height=1 alt="" border=0></td></tr>
<tr><td bgcolor=#daecd7><img src="../../../pictures/1x1.gif" width=1 height=3 alt="" border=0></td></tr>
<tr><td bgcolor=#008080>

<table cellspacing=1 cellpadding=3 border=0 width=100%>
<tr>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/consulting/">IT-консалтинг</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/SE/">Software Engineering</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/programming/">Программирование</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/database/">СУБД</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/security/">Безопасность</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/internet/">Internet</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/nets/">Сети</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/operating_systems/">Операционные системы</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/hardware/">Hardware</a></font></td>
<!--
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href=/faq/>FAQ (ЧаВО)</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href=/howto/>HOWTO</a></font></td>
--> 
</tr>
</table>

</td></tr>
</table>

<p>

<table width=100%>
<tr><td>
<a href="http://citforum.ru/about/"><font size=2>Информация для рекламодателей</font></a> 
</td><td><font size=2>PR-акции, размещение рекламы &mdash; <a href="mailto:adv@citforum.ru">adv@citforum.ru</a>,
<br>тел. +7 495 6608306, ICQ 232284597</font>
</td><td align=right><font size=2>Пресс-релизы &mdash; <a href=mailto:pr@citforum.ru>pr@citforum.ru</a></font>
</td></tr></table>


<table cellspacing=0 cellpadding=0 border=0 width="100%"><tr><td><img src="../../../pictures/1x1.gif" width=1 height=5 border=0 alt=""></td></tr>
<tr><td bgcolor=#008080><img src="../../../pictures/1x1.gif" width=1 height=1 border=0 alt=""></td></tr>
<tr><td bgcolor=#daecd7><img src="../../../pictures/1x1.gif" width=1 height=3 border=0 alt=""></td></tr></table>

<table cellspacing=0 cellpadding=4 border=0 width=100%><tr>
<td><font size=2>
<a href=http://www.citforum.ru/feedback.php?page=/operating_systems/manpages/freebsd/IPFW.8.shtml&server=citforum.ru>Послать комментарий</a><br>
<a href="http://citforum.ru/how.shtml">Информация для авторов</a>

</font></td>

<td><a href=http://top100.rambler.ru/cgi-bin/stats_top100.cgi?13078><img src="../../../pictures/logos/banner-88x31-rambler-darkblue2.gif" width=88 height=31 border=0 alt="Rambler's Top100"></a></td>
<td><!--TopList LOGO--><a target=_top href="http://top.list.ru/jump?from=26978"><img src="http://top.list.ru/counter?id=26978;t=54;l=1" border=0 height=31 width=88 alt="TopList"></a><!--TopList LOGO--></td>
<td>
<!--LiveInternet logo--><a href="http://www.liveinternet.ru/click" target=_blank><img
src="http://counter.yadro.ru/logo?12.6" border=0
alt="liveinternet.ru: показано число просмотров за 24 часа, посетителей за 24 часа и за сегодня"
width=88 height=31></a><!--/LiveInternet-->
</td>

<td align=right valign=bottom><FONT SIZE=1 face="Arial, sans-serif">This Web server launched on February 24, 1997<br>
Copyright &copy; 1997-2000 CIT, &copy; 2001-2015 <a href="http://citforum.ru/info.shtml">CIT Forum</a></font></td>
</tr></table>

<table cellspacing=0 cellpadding=0 border=0 width=100%><tr><td bgcolor=#daecd7><img src="../../../pictures/1x1.gif" width=1 height=3 border=0 alt=""></td></tr><tr><td bgcolor=#008080><img src="../../../pictures/1x1.gif" width=1 height=1 border=0 alt=""></td></tr></table>
<table cellspacing=0 cellpadding=0 border=0 width=100%><tr><td align=center><font size=1 face="Arial, sans-serif"><b>Внимание!</b> Любой из материалов, опубликованных на этом сервере, не может быть  воспроизведен в какой бы то ни было форме и какими бы то ни было средствами без письменного разрешения владельцев авторских прав. <a href="http://citforum.ru/copyright.shtml">Подробнее...</a></td></tr></table>


</table></center>


<!-- AdGravity Javascript code START-->
<script language="javascript" type="text/javascript"><!--
var RndNum4NoCash = Math.round(Math.random() * 1000000000);
var ar_Tail='unknown'; if (document.referrer) ar_Tail = escape(document.referrer);
document.write('<sc' + 'ript language="JavaScript" src="http://ad.adriver.ru/cgi-bin/erle.cgi?sid=126751&bt=16&target=blank&tail256="' + ar_Tail + '"></sc' + 'ript>');
//--></script>
<!-- AdGravity Javascript code END -->



</body>
<html>


