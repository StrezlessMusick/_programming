<html>
<head>
<title>vinum(8)</title>
<link rel="stylesheet" href="../citforum.css">
<style>

</style>

<meta http-equiv="content-type" content="text/html; charset=Windows-1251">
</head>
<body bgcolor=#FFFFFF link=#006890 vlink=#003860 alink=#800000 text=#000000 topmargin="0" marginheight="0">
<a name=top></a>





<!-- counters -->
<table cellpadding=0 cellspacing=0 border=0>
<tr>
<td><!--TopList COUNTER--><script language="JavaScript"><!--
d=document;js=10;a=';r='+escape(d.referrer)
//--></script><script language="JavaScript1.1"><!--
js=11;a+=';j='+navigator.javaEnabled()
//--></script><script language="JavaScript1.2"><!--
js=12;s=screen;a+=';s='+s.width+'*'+s.height
a+=';d='+(s.colorDepth?s.colorDepth:s.pixelDepth)
//--></script><script language="JavaScript1.3"><!--
js=13//--></script><script language="JavaScript"><!--
d.write('<img src="http://top.list.ru/counter'+
'?id=26978;js='+js+a+'" alt="" height=1 width=1>')
if(js>11)d.write('<'+'!-- ')//--></script><noscript><img
src="http://top.list.ru/counter?js=na;id=26978"
height=1 width=1 alt=""></noscript><script language="JavaScript"><!--
if(js>11)d.write('--'+'>')
//--></script><!--TopList COUNTER--></td>
<td><!--LiveInternet counter--><script language="JavaScript"><!--
document.write('<img src="http://counter.yadro.ru/hit?r'+
escape(document.referrer)+((typeof(screen)=='undefined')?'':
';s'+screen.width+'*'+screen.height+'*'+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+';u'+escape(document.URL)+
';i'+escape('Жж'+document.title)+';'+Math.random()+
'" width=1 height=1 alt="">')//--></script><!--/LiveInternet--></td>
<td><img src="http://counter.rambler.ru/top100.cnt?13078" alt="" width=1 height=1 border=0></td>
</tr></table>
<!-- end of counters -->



<center><table width=990 cellpadding=0 cellspacing=0>
<tr><td>

    <table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr valign=bottom>
  <td align="left"><a href="http://citforum.ru/"><img src="../../../pictures/logos/citlogo8.gif" width=140 height=44 border=0 alt=Logo></a></td>

      <td align="right" width="100%" style="padding-bottom: 10px"><nobr><font size=2><b>Море(!) аналитической информации!</b></font></nobr></td>
    </tr>
    </table>




<center style="margin-top: 3px">
<!--  AdRiver code START. Type:728x90 Site: citforum PZ: 0 BN: 1 -->
<script language="javascript" type="text/javascript"><!--
var RndNum4NoCash = Math.round(Math.random() * 1000000000);
var ar_Tail='unknown'; if (document.referrer) ar_Tail = escape(document.referrer);
document.write(
'<iframe src="http://ad.adriver.ru/cgi-bin/erle.cgi?'
+ 'sid=137295&bn=1&target=blank&bt=36&pz=0&rnd=' + RndNum4NoCash + '&tail256=' + ar_Tail
+ '" frameborder=0 vspace=0 hspace=0 width=728 height=90 marginwidth=0'
+ ' marginheight=0 scrolling=no></iframe>');
//--></script>
<noscript>
<a href="http://ad.adriver.ru/cgi-bin/click.cgi?sid=137295&bn=1&bt=36&pz=0&rnd=1013420086" target=_blank>
<img src="http://ad.adriver.ru/cgi-bin/rle.cgi?sid=137295&bn=1&bt=36&pz=0&rnd=1013420086" alt="-AdRiver-" border=0 width=728 height=90></a>
</noscript>
<!--  AdRiver code END  -->

</center>


</td></tr>
<tr><td>

<table cellpadding=0 cellspacing=0 border=0 width=100% style="padding-top: 3px">
<tr><td>
<table   cellspacing=0 cellpadding=0 border=0 width=100%>
<tr><td bgcolor=#008080><img src="../../../pictures/1x1.gif" width=931 height=1 alt="" border=0></td></tr>
<tr><td bgcolor=#daecd7><img src="../../../pictures/1x1.gif" width=1 height=3 alt="" border=0></td></tr>
<tr><td bgcolor=#008080>

<table cellspacing=1 cellpadding=3 border=0 width=100%>
<tr>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/consulting/">IT-консалтинг</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/SE/">Software Engineering</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/programming/">Программирование</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/database/">СУБД</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/security/">Безопасность</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/internet/">Internet</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/nets/">Сети</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/operating_systems/">Операционные системы</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/hardware/">Hardware</a></font></td>
<!--
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href=/faq/>FAQ (ЧаВО)</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href=/howto/>HOWTO</a></font></td>
--> 
</tr>
</table>

</td></tr>
</table>

</td></tr>
<tr><td>
<table cellpadding=0 cellspacing=0 border=0 width=100% style="padding-top: 3px">
<tr valign=top>

<td width=98% style="padding: 0 5px">


<div class="document">

<div align=right><i>2004 г</i></div>
<h3>vinum(8)</h3>
<em><a href="mailto:grog@lemis.com">Грег Лихи (Greg Lehey)</a><br>
  перевод <a href="mailto:valera@openxs.kiev.ua">В. Кравчук</a>, <a target="_blank" href="http://ln.com.ua/~openxs">OpenXS Initiative</a></em>
<div align="justify">
  <h4>НАЗВАНИЕ</h4>
  vinum - программа управления диспетчером логических томов (Logical Volume Manager)
  
  <h4>СИНТАКСИС</h4>
  vinum [команда] [-опции] <br>
  <h4>КОМАНДЫ</h4>
  attach сплетение том [rename]<br>
  attach поддиск сплетение [смещение] [rename]<br>
  Подключает сплетение (plex) к тому (volume) или поддиск (subdisk) к сплетению.
</p>
<p>checkparity сплетение [-f] [-v]<br>
  Проверяет блоки четности в сплетении RAID-4 или RAID-5.
</p>
<p>concat [-f] [-n имя] [-v] диски<br>
  Создает конкатенированный том из указанных дисков.
</p>
<p>create [-f] файл_описания<br>
  Создает том как указано в файле описания.
</p>
<p>debug<br>
  Вызывает вход диспетчера томов в режим отладчика ядра.
</p>
<p>debug флаги<br>
  Устанавливает флаги отладки.
</p>
<p>detach [-f] [сплетение | поддиск]<br>
  Отключает сплетение или поддиск от тома или сплетения, к которому он подключен.
</p>
<p>dumpconfig [диск ...]<br>
  Выдает информацию о конфигурации, хранящуюся на указанных дисках или на всех
    дисках в системе, если имена дисков не указаны.
</p>
<p>info [-v] [-V]<br>
  Выдает информацию о состоянии диспетчера томов.
</p>
<p>init [-S размер] [-w] сплетение | поддиск<br>
  Инициализирует нулями содержимое поддиска или всех поддисков сплетения.
</p>
<p>label том<br>
  Создает метку тома.
</p>
<p>l | list [-r] [-s] [-v] [-V] [том | сплетение | поддиск]<br>
  Выдает информацию об указанных объектах.
</p>
<p>ld [-r] [-s] [-v] [-V] [том]<br>
  Выдает информацию о дисках.
</p>
<p>ls [-r] [-s] [-v] [-V] [поддиск]<br>
  Выдает информацию о поддисках.
</p>
<p>lp [-r] [-s] [-v] [-V] [сплетение]<br>
  Выдает информацию о сплетениях.</p>
<p>lv [-r] [-s] [-v] [-V] [том]<br>
  Выдает информацию о томах.</p>
<p>makedev<br>
  Пересоздает файлы устройств в каталоге /dev/vinum.</p>
<p>mirror [-f] [-n имя] [-s] [-v] диски<br>
  Создает зеркальный том из указанных дисков.</p>
<p>move | mv -f диск объект ...<br>
  Переносит объекты на указанный диск.</p>
<p>printconfig [файл]<br>
  Записывает копию текущей конфигурации в файл.</p>
<p>quit<br>
  Завершает работу утилиты vinum в интерактивном режиме. Обычно это происходит
    при вводе символа конца файла (EOF).</p>
<p>read диск ...<br>
  Читает конфигурацию vinum с указанных дисков.</p>
<p>rename [-r] [диск | поддиск | сплетение | том] новое_имя<br>
  Переименовывает указанный объект.</p>
<p>rebuildparity сплетение [-f] [-v] [-V]<br>
  Пересоздает блоки четности сплетения типа RAID-4 или RAID-5.</p>
<p>resetconfig<br>
  Сбрасывает полную конфигурацию vinum.</p>
<p>resetstats [-r] [том | сплетение | поддиск]<br>
  Сбрасывает статистические счетчики для указанных объектов или для всех объектов,
    если ни один не указан.</p>
<p>rm [-f] [-r] том | сплетение | поддиск<br>
  Удаляет объект.</p>
<p>saveconfig<br>
  Сохраняет конфигурацию vinum на диск после сбоев конфигурации.</p>
<p>setdaemon [значение]<br>
  Устанавливает конфигурацию демона.</p>
<p>setstate состояние [том | сплетение | поддиск | диск]<br>
  Устанавливает состояние, не влияя на другие объекты, только в диагностических
    целях.</p>
<p>start<br>
  Читает конфигурацию со всех дисков vinum.</p>
<p>start [-i интервал [-S размер] [-w] том | сплетение | поддиск<br>
  Позволяет системе обращаться к объектам</p>
<p>stop [-f] [том | сплетение | поддиск]<br>
  Прекращает доступ к объектам или останавливает vinum, если параметры не указаны.</p>
<p>stripe [-f] [-n имя] [-v] диски<br>
  Создает том с чередованием из указанных дисков. </p>
  <h4>ОПИСАНИЕ</h4>
  <p>Утилита vinum взаимодействует с компонентом ядра диспетчерра логических томов
  Vinum. Утилита предназначена либо для интерактивного использования, если запущена
  без аргументов командной строки, либо для выполнения одной переданной в командной
  строке команды. В интерактивном режиме утилита vinum сохрраняет хронологию
  выполнения команд.</p>
<h4>ОПЦИИ</h4>
  <p>После команд vinum могут указываться необязательные опции. Любую из следующих
    опций можно указывать для любой команды, но в некоторых случаях опции игнорируются.
    Например, команда stop игнорирует опции -v и -V.</p>
<p>-f<br>
  Опция -f (&quot;force&quot;) отменяет проверки защиты. Эту опцию надо использовать
  крайне осторожно. Эта опция предназначена только для критических случаев. Например,
  команда <br>
  rm -f myvolume <br>
  удаляет том myvolume, даже если он открыт. Любой последующий доступ к этому
  тому почти наверрняка вызовет панику в системе.</p>
<p>-i миллисекунд<br>
  При выполнении команд init и start, ожидать указанное количество миллисекунд
    между копированиями каждого блока. Это уменьшает нагрузку на систему.</p>
<p>-n имя<br>
  Используйте опцию -n для указания имени тома в простых командах конфигурации
    concat, mirror и stripe.</p>
<p>-r<br>
  Опция -r (&quot;recursive&quot;) используется в командах list для выдачи информации
  не только об указанных объектах, но и о входящих в них объектах. Например,
  при указании в команде lv, опция -r позволит также получить информацию о сплетениях
  и поддисках, принадлежащих тому.</p>
<p>-s<br>
  Опция -s (&quot;statistics&quot;) используется в командах list для выдачи статистической
  информации. В команде mirror эта опция используется для указания того, что
  необходимо создавать сплетения с чередованием.</p>
<p>-S размер<br>
  Опция -S задает размер (transfer size) для команд init и start.</p>
<p>-v<br>
  Опция -v (&quot;verbose&quot;) может использоваться для запроса более подробной
  информации.</p>
<p>-V<br>
  Опция -V (&quot;Very verbose&quot;) может использоваться для запроса еще более
  подробной информации, чем выдает опция -v.</p>
<p>-w<br>
  Опция -w (&quot;wait&quot;) требует от утилиты vinum дожидаться завершения
  команд, которые обычно работают в фоновом режиме, например, init. <br>
  <h4>ДЕТАЛЬНОЕ ОПИСАНИЕ КОМАНД</h4>
  Команды vinum выполняют следующие функции:</p>
<p>attach сплетение том [rename]<br>
  attach поддиск сплетение [смещение] [rename]<br>
  Команда vinum attach вставляет указанное сплетение или поддиск в том или сплетение,
  соответственно. В случае поддиска, можно указать смещение в сплетении. Если
  смещение не задано, поддиск будет добавлен в первое подходящее место. После
  подключения сплетения к непустому тому, утилита vinum реинтегрирует сплетение. <br>
  Если указано ключевое слово rename, утилита vinum переименовывает объект (и,
  в случае сплетения, любые входящие в него поддиски) в соответствии со стандартными
  соглашениями по именованию vinum. Для переименования объекта с присвоением
  нестандартного имени испольуйте команду rename.</p>
<p>При подключении поддисков следует учитывать несколько соображений:</p>
<p>Поддиски обычно можно подключать только к конкатенированным сплетениям. <br>
  Если в сплетении RAID-5 с чередованием не хватает поддиска (например, после
    сбоя диска), его следует заменять только поддиском такого же размера. <br>
  Для добавления дополнительных поддисков к спелетению с чередованием или типа
  RAID-5, используйте опцию -f. В результате, даннЁе в сплетении будут повреждены. <br>
  Для конкатенированных сплетений параметр смещение задает смещение в блоках
  от начала сплетения. Для сплетений типа RAID-5 с чередованием он задает смещение
  первого блока поддиска: другими словами, смещение представляет собой числовую
  позицию поддиска, умноженную на размер полосы. Например, в сплетении с размером
  полосы 271 Кбайт первый поддиск будет иметь смещение 0, второй - смещение 271
  Кбайт, третий - 542 Кбайта и т.д. В этом вычислении блоки четности в спллетениях
  типа RAID-5 игнорируются. <br>
  checkparity сплетение [-f] [-v]<br>
  Проверяет блоки четности в указанном сплетении типа RAID-4 или RAID-5. Эта
  операция поддерживает указатель в сплетении, так что проверку, при необходимости,
  можно остановить и затем возобновить с той же позиции. Кроме того, этот указатель
  используется командой rebuildparity, поэтому пересоздание блоков четности нужно
  будет начинать только с места, где выявлена первая проблема четности. Если
  указан флаг -f, команда checkparity начинает проверку с начала сплетения. Если
  указан флаг -v, checkparity выдает отчет о работе процесса.</p>
<p>concat [-f] [-n имя] [-v] диски<br>
  Команда concat предлагает упрощенную альтернативу команде create при счоздании
    томов из одного конкатенированного сплетения. Наибольший фрагмент свободного
    места на каждом диске используется для создания поддисков, составляющих сплетение. <br>
  Обычно команда concat устанавливает для тома и его компонентов произвольные
  имена. Имя состоит из слова &quot;vinum&quot; и небольшого целого числа, например, &quot;vinum3&quot;.
  Можно задать имя для тома явно с помощью опции -n имя. Имена сплетений и поддисков
  строятся стандартно на базе имени соответствующего тома.</p>
<p>Для дисков имена задавать нельзя. Если диски были проинициализированы как
  диски vinum, имя остается. В противном случае, диски получают имена, состоящие
  из слова &quot;vinumdrive&quot; и небольшого целого числа, например, &quot;vinumdrive7&quot;.
  Как и для команды create, опцию -f можно использовать для переопределения ранее
  данного имени. Опция -v используется для получения подробных результатов.</p>
<p>Примеры использования этой команды см. в разделе &quot;<a href="VINUM.8.shtml#pref1">УПРОЩЕННОЕ КОНФИГУРИРОВАНИЕ</a>&quot; ниже.</p>
<p>create [-f] файл_описания<br>
  Команда vinum create используется для создания любого объекта. С учетом достаточно
    сложных взаимосвязей и потенциальных опасностей прри создании объекта vinum,
    в интерактивном интерфейсе эта функция недоступна. Если имя файла не указано,
    команда vinum открывает временный файл в редакторе. Если установлена переменная
    среды EDITOR, утилита vinum запускает указанный в ней редактор. Если же нет,
    запускается стандартный редактор vi. Подробнее о формате файла описания см.
    в разделе &quot;<A href="VINUM.8.shtml#configuration_file">ФАЙЛ КОНФИГУРАЦИИ</A>&quot; ниже. <br>
  Учтите, что функция vinum create - аддитивна: если выполнить ее несколько раз,
  будет создано несколько экземпляров всех неименованных объектов.</p>
<p>Обычно команда create не будет изменять имена существующих дисков vinum, чтобы
  случайно не стереть их. Корректный способ удалить не нужные более диски vinum
  - сбросить конфигурацию с помощью команды resetconfig. В некоторых случаях,
  однако, может потребоваться создать новые данные на дисках vinum, которые не
  удается запустить. В этом случае используйте команду create -f.</p>
<p>debug<br>
  Команда vinum debug без параметров используется для входа в удаленный отладчик
    ядра (remote kernel debugger). Она срабатывает только если vinum собран с
    опцией VINUMDEBUG. Эта опция остановит работу операционной системы, пока
    не завершится работа отладчика ядра. Если установлена удаленная отладка,
    а удаленное подключение к отладчику ядра организовать не получается, для
    выхода из режима отлади придется перезагрузить систему. <br>
</p>
<p>debug флаги<br>
  Устанавливает битовую маску внутренних флагов отладки. Эти флаги могут меняться
    без уведомления по ходу развития продукта; уточните их значения в заголовочном
    файле &lt;sys/dev/vinumvar.h&gt;. Битовая маска строится из следующих значений: <br>
  DEBUG_ADDRESSES (1)<br>
  Показывать информацию буфера в ходе запросов.</p>
<p>DEBUG_RESID (4)<br>
  Перейти в отладчик в complete_rqe().</p>
<p>DEBUG_LASTREQS (8)<br>
  Поддерживать циклический буфер последних запросов.</p>
<p>DEBUG_REVIVECONFLICT (16)<br>
  Выдавать информацию о конфликтах восстановления (revive conflicts).</p>
<p>DEBUG_EOFINFO (32)<br>
  Выдавать информацию о внутреннем состоянии при возврате символа конца файла
    (EOF) со сплетения с чередованием (striped plex).</p>
<p>DEBUG_MEMFREE (64)<br>
  Поддерживать циклический список последних освобожденных подсистемой выделения
    памяти (memory allocator) областей памяти.</p>
<p>DEBUG_REMOTEGDB (256)<br>
  Перейти в удаленный отладчик gdb при выполнении команды debug.</p>
<p>DEBUG_WARNINGS (512)<br>
  Выдавать ряд предупреждений о несущественных проблемах в реализации. <br>
  detach [-f] сплетение<br>
  detach [-f] поддиск<br>
  Команда vinum detach удаляет (отключает) указанное сплетение или поддиск из
  тома или сплетения, к которому он подключен. Если удаление объекта приводит
  к нарушению целостности данных тома, операция не сработает, если только не
  указана опция -f. Если имя объекта строится на базе объекта, в который он входит
  (например, поддиск vol1.p7.s0, подключенный к сплетению vol1.p7), имя будет
  изменено путем добавления префикса &quot;ex-&quot; (например, ex-vol1.p7.s0).
  При необходимости, имя в процессе будет усечено. <br>
  Команда detach не уменьшает количество поддисков в сплетении с чередованием
  или типа RAID-5. Вместо этого поддиск помечается как отсутствующий и может
  быть в дальнейшем заменен с помощью команды attach.</p>
<p>dumpconfig [диск ...]<br>
  Команда vinum dumpconfig выдает информацию о конфигурации, хранящуюся на указанных
    дисках. Если имена дисков не указаны, команда dumpconfig просматривает все
    диски в системе в поисках разделов Vinum, и сбрасывает находящуюся на них
    информацию. Если изменения конфигурации отключены, может оказаться, что эта
    информация не совпадает с выдаваемой командой list. Эта команда используется,
    в основном, для сопровождения и отладки.</p>
<p>info<br>
  Команда vinum info выдает информацию об использовании памяти драйвером vinum.
    Она предназначена, в основном, для отладки. При указании опции -v она будет
    выдавать детальную информацию об используемых областях памяти. <br>
  При указании опции -V команда info выдает информацию о последних (до 64) запросах
  ввода-вывода, обработанных драйвером vinum. Эта информация собирается, только
  если установлен флаг отладки 8. Информация выдается в следующем формате:</p>
<p><code>vinum -&gt; info -V</code><br>
<pre>
Flags: 0x200 1 opens
Total of 38 blocks malloced, total memory: 16460
Maximum allocs: 56, malloc table at 0xf0f72dbc
Time Event Buf Dev Offset Bytes SD SDoff Doffset Goffset
14:40:00.637758 1VS Write 0xf2361f40 91.3 0x10 16384
14:40:00.639280 2LR Write 0xf2361f40 91.3 0x10 16384
14:40:00.639294 3RQ Read 0xf2361f40 4.39 0x104109 8192 19 0 0 0
14:40:00.639455 3RQ Read 0xf2361f40 4.23 0xd2109 8192 17 0 0 0
14:40:00.639529 3RQ Read 0xf2361f40 4.15 0x6e109 8192 16 0 0 0
14:40:00.652978 4DN Read 0xf2361f40 4.39 0x104109 8192 19 0 0 0
14:40:00.667040 4DN Read 0xf2361f40 4.15 0x6e109 8192 16 0 0 0
14:40:00.668556 4DN Read 0xf2361f40 4.23 0xd2109 8192 17 0 0 0
14:40:00.669777 6RP Write 0xf2361f40 4.39 0x104109 8192 19 0 0 0
14:40:00.685547 4DN Write 0xf2361f40 4.39 0x104109 8192 19 0 0 0
11:11:14.975184 Lock 0xc2374210 2 0x1f8001
11:11:15.018400 7VS Write 0xc2374210 0x7c0 32768 10
11:11:15.018456 8LR Write 0xc2374210 13.39 0xcc0c9 32768
11:11:15.046229 Unlock 0xc2374210 2 0x1f8001
</pre>
<p>Поле Buf всегда содержит адрес заголовка пользовательского буфера. Его можно
  использовать для идентификации запроса, связанного с пользовательским запросом,
  хотя это и не на 100% надежно: теоретически, два последовательных запроса могут
  использовать один и тот же заголовок буфера, хотя это и нетипично. Начало запроса
  идентифицируется значениями 1VS или 7VS в поле Event. Первый представленный
  выше пример показывает запросы драйвера, связанные с выполнением запроса пользователя.
  Второй пример - запрос ввода-вывода поддиска с блокировкой.</p>
<p>Поле Event содержит информацию, связанную с последовательностью событий в
  цепочке выполнения запроса (request chain). Цифры от 1 до 6 показывают приблизительную
  последовательность событий, а двухбуквенное сокращение описывает действие:</p>
<p>1VS<br>
  (vinumstrategy) показывает информацию о пользовательском запросе при входе
    в vinumstrategy(). Номер устройства определяет устройство vinum, а смещение
    и длина - это пользовательские параметры. С такой записи всегда начинается
    последовательность выполнения запроса.</p>
<p>2LR<br>
  (launch_requests) показывает пользовательский запрос непосредственно перед
    выполнением низкоуровневых запросов vinum в функции launch_requests(). Параметры
    должны быть такими же, как и в записи 1VS. <br>
  В следующих запросах Dev - номер устройства соответствующего раздела диска,
  Offset - смещение от начала раздела, SD - индекс поддиска в vinum_conf, SDoff
  - смещение от начала поддиска, Doffset - смещение соответствующего запроса
  данных, а Goffset - смещение соответствующего запроса группы, если оно необходимо.</p>
<p>3RQ<br>
  (request) показывает один из, возможно, нескольких низкоуровневых запросов
    vinum, выполненных для удовлетворения запроса верхнего уровня. Эта информация
    также регистрируется в launch_requests().</p>
<p>4DN<br>
  (done) вызывается из complete_rqe(), показывая завершение запроса. Это завершение
    должно соответствовать запросу, инициированному либо на стадии 4DN из функции
    launch_requests(), либо из функции complete_raid5_write() на стадии 5RD или
    6RP.</p>
<p>5RD<br>
  (RAID-5 data) вызывается из функции complete_raid5_write() и представляет данные,
    записанные на полосу данных массива RAID-5 после вычисления четности.</p>
<p>6RP<br>
  (RAID-5 parity) вызывается из функции complete_raid5_write() и представляет
    данные, записанные на полосу четности (parity stripe) массива RAID-5 после
    вычисления четности.</p>
<p>7VS<br>
  Показывает запрос ввода/вывода для поддиска. Эти запросы, обычно, являются
    внутренними для драйвера vinum и используются для операций типа инициализации
    или пересоздания сплетений.</p>
<p>8LR<br>
  Показывает низкоуровневую операцию, сгенерированную для запроса ввода/вывода
    для поддиска.</p>
<p>Lockwait<br>
  Указывает, что процесс ждет блокировки диапазона (range lock). Параметрами
    являются заголовок буфера, соответствующего запросу, номер сплетения и номер
    блока. Из внтуренних соображений номер блока - на единицу больше, чем адрес
    начала полосы.</p>
<p>Lock<br>
  Указывает, что была получена блокировка диапазона. Параметры такие же, как
    и для ожидания блокировки диапазона.</p>
<p>Unlock<br>
  Указывает, что блокировка диапазона была снята. Параметры такие же, как и для
    ожидания блокировки диапазона. <br>
  init [-S размер] [-w] сплетение | поддиск<br>
  Команда vinum init инициализирует поддиск путем записи на него нулей. Можно
  инициализировать все поддиски в сплетении, указав имя сплетения. Это - единственный
  способ гарантировать согласованность данных в сплетении. Эту инициализацию
  необходимо выполнять до начала использования сплетения типа RAID-5. Ее также
  рекомендуется выполнять и для других новых сплетений. Утилита vinum инициализирует
  все поддиски сплетения параллельно. Поскольку это действие может потребовать
  много времени, оно обычно выполняется в фоновом режиме. Если необходимо подождать
  завершения команды, используйте опцию -w (wait). <br>
  Укажите опцию -S, если необходимо записывать блоками нестандартного (отличающегося
  от 16 Кбайт) размера. Утилита vinum выдает сообщение на консоль по завершении
  инициализации.</p>
<p>label том<br>
  Команда label записывает на том метку тома в стиле ufs. Это - простая альтернатива
    соответствующему вызову утилиты disklabel. Ее выполнение необходимо потому,
    что некоторые команды ufs по-прежнему читают диск в поисках метки вместо
    того, чтобы выполнять соответствующий вызов ioctl(2) для доступа к ней. Драйвер
    vinum хранит метку тома отдельно от данных тома, так что эта команда не нужна
    для newfs(8). Использовать эту команду не рекомендуется.</p>
<p>list [-r] [-V] [том | сплетение | поддиск]<br>
  l [-r] [-V] [том | сплетение | поддиск]<br>
  ld [-r] [-s] [-v] [-V] [том]<br>
  ls [-r] [-s] [-v] [-V] [поддиск]<br>
  lp [-r] [-s] [-v] [-V] [сплетение]<br>
  lv [-r] [-s] [-v] [-V] [том]<br>
  Команда list используется для получения информации об указанном объекте. Если
  аргумент не указан, выдается информация о всех объектах, известных драйверу
  vinum. Команда l - синоним для list. <br>
  Опция -r относится к томам и сплетениям: если она указана, то рекурсивно выдает
  информацию для поддисков и (для тома) сплетений, составляющих объекты. Команды
  lv, lp, ls и ld выдают только тома, сплетения, поддиски и диски, соответственно.
  Они особенно полезны при вызове без параметров.</p>
<p>Опция -s вызывает выдачу утилитой vinum статистической информации по устройствам,
  опция -v (verbose) приводит к выдаче определенной дополнительной информации,
  а опция -V обеспечивает выдачу существенного объема дополнительной информации.</p>
<p>makedev<br>
  Команда makedev удаляет каталог /dev/vinum и пересоздает его вместе со специальными
    файлами устройств, отражающими текущую конфигурацию. Эта команда не предназначена
    для общего использования и должна использоваться только в критических ситуациях.</p>
<p>mirror [-f] [-n имя] [-s] [-v] диски<br>
  Команда mirror является упрощенной альтернативой команде create при создании
    зеркалированных томов. При вызове без опций она создает том типа RAID-1 (зеркалированный)
    из двух конкатенированных сплетений. Самые большие фрагменты свободного места
    на каждом диске используются для создания поддисков для сплетений. Первое
    сплетение строится из дисков в списке с нечетными номерами, а второе - из
    четных. Если диски - разного размера, то и сплетения получатся разного размера. <br>
  Если указана опция -s, команда mirror строит сплетения с чередованием, с размером
  полосы 279 Кбайт. Размер поддисков в каждом сплетении соответствует размеру
  наименьшего фрагмента подряд идущего свободного места на всех дисках, формирующих
  сплетение. И в этом случае рамзеры сплетений могут отличаться.</p>
<p>Обычно команда mirror автоматически создает имя для тома и его компонентов.
  Это имя состоит из слова &quot;vinum&quot; и небольшого целого числа, например, &quot;vinum3&quot;.
  Это можно изменить с помощью опции -n имя, которая присваивает указанное имя
  тому. Имена сплетений и поддисков строятся на основе имени тома стандартным
  образом.</p>
<p>Имена дисков выбирать нельзя. Если диски уже были проинициализированы как
  диски vinum, их имена неизменны. В противном случае, диски получают имена,
  состоящие из слова &quot;vinumdrive&quot; и небольшого целого числа, например, &quot;vinumdrive7&quot;.
  Как и в случае команды create, опция -f может использоваться для указания того,
  что прежнее имя надо изменить. Опция -v используется для выдачи более детальной
  информации.</p>
<p>Ряд примеров использования этой команды представлен в разделе &quot;<a href="VINUM.8.shtml#pref1">УПРОЩЕННОЕ
  КОНФИГУРИРОВАНИЕ</a>&quot; ниже.</p>
<p>mv -f диск объект ...<br>
  move -f диск объект ...<br>
  Переносит все поддиски указанных объектов на новый диск. Объектами могут быть
  поддиски, диски или сплетения. Если указаны диски или сплетения, переносятся
  все поддиски, связанные с этими объектами. <br>
  Опция -f для этой функции необходима, поскольку в настоящее время она не сохраняет
  данные на поддиске. Эта возможность будет добавлена в дальнейшем. Но и в нынешнем
  виде эта команда подходит для восстановления после сбоя диска.</p>
<p>printconfig [файл]<br>
  Записывает копию текущей конфигурации в файл в формате, который можно использовать
    для воссоздания конфигурации vinum. В отличие от хранящейся на диске конфигурации,
    она включает определения дисков. Если файл не указан, утилита vinum выдает
    информацию в стандартный выходной поток.</p>
<p>quit<br>
  Завершает работу утилиты vinum в интерактивном режиме. Обычно для этого достаточно
    ввести символ конца файла (EOF).</p>
<p>read диск ...<br>
  Команда read сканирует указанные диски в поисках разделов vinum, содержащих
    ранее созданную информацию о конфигурации. Она читает информацию о конфигурации,
    начиная с последних изменений и до самых давних. Утилита vinum поддерживает
    актуальну копию всей конфигурационной информации на каждом разделе диска.
    Необходимо указать все секции (slices) в конфигурации в качестве параметра
    этой команды. <br>
  Команда read предназначена для избирательной загрузки конфигурации vinum в
  системе, где есть другие разделы vinum. Если необходимо запустить все разделы
  в системе, проще использовать команду start.</p>
<p>Если по ходу выполнения этой команды утилитой vinum возникают любые ошибки,
  она отключает автоматическое обновление конфигурации, чтобы предотвратить повреждение
  копий на диске. Это также происходит, если в конфигурации на диске обнаруживается
  ошибка (например, поддиски с недопустимой спецификацией занимаемого места).
  Изменения можно возобновить с помощью команд setdaemon и saveconfig. Сбросьте
  бит 2 (числовое значение - 4) в маске опций демона, чтобы снова можно было
  сохранять изменения конфигурации.</p>
<p>rebuildparity сплетение [-f] [-v] [-V]<br>
  Пересоздает блоки четности для указанного сплетения типа RAID-4 или RAID-5.
    Это действие поддерживает указатель на сплетение, так что его можно остановить
    и в дальнейшем перезапустить с того же места, при необходимости. Кроме того,
    этот указатель используется командой checkparity, поэтому пересоздание блоков
    четности можно будет начать с того места, где выявлена первая проблема четности. <br>
  Если указан флаг -f, команда rebuildparity начинает пересоздание с начала сплетения.
  Если указан флаг -v, команда rebuildparity сначала проверяет существующие блоки
  четности и выдает информацию о тех из них, которые оказались некорректными
  до пересоздания. Если указан флаг -V, команда rebuildparity выдает отчет о
  ходе работы.</p>
<p>rename [-r] [диск | поддиск | сплетение | том] новое_имя<br>
  Изменяет имя указанного объекта. Если указана опция -r, подчиненные объекты
    будут переименовываться по стандартным правилам: имена сплетений будут строиться
    путем добавления .номер_сплетения к имени тома, а имена поддисков - путем
    добавления .номер_поддиска к имени сплетения.</p>
<p>resetconfig<br>
  Команда resetconfig полностью сбрасывает конфигурацию vinum в системе. Используйте
    эту команду только при необходимости полностью удалить конфигурацию. Утилита
    vinum попросит подтверждения; необходимо ввсести слова NO FUTURE как показано
    ниже:</p>
<pre>
# vinum resetconfig
WARNING! This command will completely wipe out your vinum
configuration. All data will be lost. If you really want
to do this, enter the text
NO FUTURE
Enter text -&gt; NO FUTURE
Vinum configuration obliterated
</pre>
<p>Как и сказано в сообщении, эта команда - жест отчаяния. Используйте ее, только
  если хотите никогда больше не видеть существующую конфигурацию.</p>
<p>resetstats [-r] [том | сплетение | поддиск]<br>
  Драйвер vinum поддерживает ряд статистических счтетчиков для каждого объекта.
    Подробнее см. в заголовочном файле &lt;sys/dev/vinumvar.h&gt;. Команда resetstats
    используется для сброса этих счетчиков. При указании опции -r, vinum также
    сбрасывает счетчики подчиненных объектов.</p>
<p>rm [-f] [-r] том | сплетение | поддиск<br>
  Команда rm удаляет объект из конфигурации vinum. После удаления объекта восстановить
    его нельзя. Обычно перед удалением объекта утилита vinum выполняет множество
    проверок согласованности. Опция -f требует от vinum пропустить эти проверки
    и удалить объект в любом случае. Используйте эту опцию очень осторожно: она
    может привсети к полной потере данных тома. <br>
  Обычно команда vinum отказывается удалять том или сплетение, если у него есть
  подчиненные сплетения или поддиски, соответственно. Можно потребовать от vinum
  безусловного удаления объекта с помощью опции -f или просто удалить все подчиненные
  объекты тоже с помощью опции -r (recursive). При удалении тома с опцией -r
  будут удалены как сплетения, так и поддиски, принадлежащие сплетениям.</p>
<p>saveconfig<br>
  Сохраняет текущую конфигурацию на диск. Обычно это не нужно, поскольку утилита
    vinum автоматически сохраняет любые изменения в конфигурации. Если при запуске
    возникапет ошибка, обновления будут отключены. При их повторном включении
    с помощью команды setdaemon, vinum не сохраняет автоматически конфигурацию
    на диск. Используйте эту команду для сохранения конфигурации.</p>
<p>setdaemon [значение]<br>
  Команда setdaemon устанавливает переменную битовую маску для демона vinum.
    Эта команда - временная и будет заменена. В настоящее время битовая маска
    может содержать биты 1 (регистрировать каждое действие с помощью syslog)
    и 4 (не обновлять конфигурацию). Необязательный бит 4 может пригодиться при
    восстановлении после ошибки.</p>
<p>setstate состояние [том | сплетение | поддиск | диск]<br>
  Команда setstate устанавливает заданное состояние для указанных объектов. При
    этом не используется обычный механизм проверки согласованности vinum, так
    что эту команду следует использовать только для восстановления. Неправильное
    использование этой команды может вызвать сбой системы.</p>
<p>start [-i интервал] [-S размер] [-w] [сплетение | поддиск]<br>
  Команда start запускает (переводит в работающее состояние) одини или несколько
    объектов vinum. <br>
  Если имена объектов не указаны, утилита vinum сканирует все известные системе
  диски в поисках дисков vinum, а затем читает конфигурацию так, как было описано
  для команды read. Диск vinum (vinum drive) содердите заголовок со всей информацией
  о данных, хранящихся на диске, включая имена других дисков, которые необходимы
  для представления сплетений и томов.</p>
<p>Если по ходу выполнения этой команды утилитой vinum будут обнаружены ошибки,
  она отключит автоматическое обновление конфигурации, чтобы избежать повреждения
  копий на диске. То же самое произойдет, если конфигурация на диске содержит
  ошибку (например, поддиски с недопустимой спецификацией занимаемого места).
  Изменения можно возобновить с помощью команд setdaemon и saveconfig. Сбросьте
  бит 2 (числовое значение - 4) в маске опций демона, чтобы снова можно было
  сохранять изменения конфигурации.</p>
<p>Если имена объектов указаны, утилита vinum запускает их. Обычно эту операцию
  имеет смысл выполнять только для поддисков. Действие зависит от текущего состояния
  объекта:</p>
<p>Если объект уже работает, утилита vinum ничего не делает. <br>
  Если объект является поддиском в состояниях down или reborn, утлита vinum запускает
    его (меняет состояние на up). <br>
  Если объект является поддиском в состоянии empty (пуст), изменение зависит
  от поддиска. Если он входит в сплетение, являющееся частью тома, в котором
  есть и другие сплетения, утилита vinum переводит поддиск в состояние reviving
  и пытается скопировать данные с тома. По завершении этой операции поддиск запускается.
  Если же поддиск входит в сплетение, являющееся частью тома, в котором других
  сплетений нет, или если он вообще не входит в сплетение, утилита vinum запускает
  его немедленно. <br>
  Если объект является поддиском в состоянии reviving, утилита vinum продолжает
  его &quot;оживление&quot; в отключенном режиме. По завершении этой операции
  поддиск запускается. <br>
  Когда поддиск запускается (переводится в состояние up), утилита vinum автоматически
  проверяет состояние сплетения и тома, к которым он может принадлежать и изменяет
  их состояние при необходимости.</p>
<p>Если объект является сплетением, команда start проверяет состояние подчиненных
  поддисков (и сплетений, в случае тома) и запускает все поддиски, которые можно
  запустить.</p>
<p>Для запуска сплетения в томе из нескольких сплетений данные должны быть скопированы
  с другого сплетения в томе. Поскольку зачастую для этого требуется много времени,
  это обычно делается в фоновом режиме. Если необходимо дождаться завершения
  этой операции (например, если она выполняется в сценарии), используйте опцию
  -w.</p>
<p>Копирование данных не только требует много времени, но и может существенно
  нагружать систему. Можно указать размер передаваемого блока в байтах или секторах
  с помощью опции -S, и интервал (в миллисекундах) ожидания между копированиями
  каждого блока с помощью опции -i. Обе эти опции позволяют снизить нагрузку
  на систему.</p>
<p>stop [-f] [том | сплетение | поддиск]<br>
  Если параметры не указаны, команда stop удаляет демон ядра vinum и останавливает
    vinum(4). Это можно сделать, только если ни один из объектов не активен.
    В частности, опция -f не позволяет обойти это требование. Обычно команда
    stop записывает текущую конфигурацию обратно на диски перед завершением работы.
    Это будет невозможно, если изменения конфигурации отключены, поэтому vinum
    не остановится, если изменения конфигурации отключены. Это можно обойти,
    указав опцию -f. <br>
  Команда stop может работать только если vinum был загружен как демон ядра (kld),
  поскольку статически сконфигурированных драйвер выгрузить нельзя. Команда vinum
  stop не сработает, если vinum сконфигурирован статически.</p>
<p>Если имена объектов указаны, команда stop отключает доступ к объектам. Если
  объекты имеют подчиненные объекты, эти подчиненные объекты должны быть либо
  не активны (остановлены или в состоянии ошибки), либо надо указывать опции
  -r и -f. Эта команда не удаляет объекты из конфигурации. К ним можно будет
  снова получить доступ после команды start.</p>
<p>По умолчанию утилита vinum не останавливает активные объекты. Например, нельзя
  остановить сплетение, подключенное к активному тому, и нельзя отключить открытый
  том. Опция -f требует от vinum пропустить эту проверку и удалить объект в любом
  случае. Используйте эту опцию максимально осторожно, и только помня о последствиях:
  при некорректном использовании она может привести к серьезному повреждению
  данных.</p>
<p>stripe [-f] [-n имя] [-v] диски<br>
  Команда stripe является упрощенной альтернативой команде create для создания
    томов из единственного сплетения с чередованием. Размер поддисков определяется
    как размер максимального фрагмента свободного места, доступного на всех указанных
    дисках. Размер полосы фиксирован - 279 Кбайт. <br>
  Обычно команда stripe создает для тома и его компонентов стандартные имена.
  Имя состоит из слова &quot;vinum&quot; и небольшого целого числа, например, &quot;vinum3&quot;.
  Можно задать нестандартное имя с помощью опции -n имя, что присваивает указанное
  имя тому. Имена сплетений и поддисков строятся на основе имени тома стандартным
  образом.</p>
<p>Имена для дисков задавать нельзя. Если диски уже были проинициализированы
  как диски vinum, имя остается. В противном случае, диски получают имена, начинающиеся
  со слова &quot;vinumdrive&quot;, и заканчивающееся небольшим целым числом,
  например, &quot;vinumdrive7&quot;. Как и в случае команды create, можно использовать
  опцию -f для изменения прежнего имени. Опция -v используется для получения
  детальных результатов.</p>
<p>Несколько примеров использования этой команды см. в разделе &quot;<a href="VINUM.8.shtml#pref1">УПРОЩЕННОЕ
  КОНФИГУРИРОВАНИЕ</a>&quot; ниже.</p>
<h4><a name="pref1"></a>УПРОЩЕННОЕ КОНФИГУРИРОВАНИЕ</h4>
  В этом разделе описан упрощенный интерфейс для конфигурирования vinum с помощью
    команд concat, mirror и stripe. Эти команды создают удобные конфигурации
    для ряда стандартных ситуаций, но не обеспечивают такую гибкость, как команда
    create.</p>
<p>Описание этих команд было представлено выше. Вот ряд примеров, построенных
  на одном и том же наборе дисков. Учтите, что первый диск, /dev/da1h, - меньше
  других. Это влияет на размеры поддисков каждого вида.</p>
<p>Во всех следующих примерах используется -v, чтобы показать команды, передаваемые
  в систему, а также для получения информации о структуре тома. Без опции -v
  эти команды ничего не выдают.</p>
<p> Том с одним конкатенированным сплетением<br>
  Используйте том с одним конкатенированным сплетением для получения максимально
    возможного объема дисковой памяти без обеспечения защиты от сбоев диска:</p>
<pre>
vinum -&gt; concat -v /dev/da1h /dev/da2h /dev/da3h /dev/da4h
volume vinum0
plex name vinum0.p0 org concat
drive vinumdrive0 device /dev/da1h
sd name vinum0.p0.s0 drive vinumdrive0 size 0
drive vinumdrive1 device /dev/da2h
sd name vinum0.p0.s1 drive vinumdrive1 size 0
drive vinumdrive2 device /dev/da3h
sd name vinum0.p0.s2 drive vinumdrive2 size 0
drive vinumdrive3 device /dev/da4h
sd name vinum0.p0.s3 drive vinumdrive3 size 0
V vinum0 State: up Plexes: 1 Size: 2134 MB
P vinum0.p0 C State: up Subdisks: 4 Size: 2134 MB
S vinum0.p0.s0 State: up D: vinumdrive0 Size: 414 MB
S vinum0.p0.s1 State: up D: vinumdrive1 Size: 573 MB
S vinum0.p0.s2 State: up D: vinumdrive2 Size: 573 MB
S vinum0.p0.s3 State: up D: vinumdrive3 Size: 573 MB
</pre>
<p>В нашем случае использовано все место на всех четырех дисках, что дало нам
  в итоге 2134 Мбайта.</p>
<p> Том с одним сплетением с чередованием<br>
  Том из одного сплетения с чередованием может обеспечить более высокую производительность,
    чем конкатенированное сплетение, но ограничения на сплетения с чередованием
    могут привести к уменьшению размера тома. Такой том тоже не обеспечивает
    защиту от сбоя диска:</p>
<pre>
vinum -&gt; stripe -v /dev/da1h /dev/da2h /dev/da3h /dev/da4h
drive vinumdrive0 device /dev/da1h
drive vinumdrive1 device /dev/da2h
drive vinumdrive2 device /dev/da3h
drive vinumdrive3 device /dev/da4h
volume vinum0
plex name vinum0.p0 org striped 279k
sd name vinum0.p0.s0 drive vinumdrive0 size 849825b
sd name vinum0.p0.s1 drive vinumdrive1 size 849825b
sd name vinum0.p0.s2 drive vinumdrive2 size 849825b
sd name vinum0.p0.s3 drive vinumdrive3 size 849825b
V vinum0 State: up Plexes: 1 Size: 1659 MB
P vinum0.p0 S State: up Subdisks: 4 Size: 1659 MB
S vinum0.p0.s0 State: up D: vinumdrive0 Size: 414 MB
S vinum0.p0.s1 State: up D: vinumdrive1 Size: 414 MB
S vinum0.p0.s2 State: up D: vinumdrive2 Size: 414 MB
S vinum0.p0.s3 State: up D: vinumdrive3 Size: 414 MB
</pre>
<p>В этом случае размер поддисков ограничен наименьшим доступным диском, так
  что, получившийся в результате том имеет размер всего 1659 Мбайт.</p>
<p> Том с зеркалированием из двух конкатенированных сплетений<br>
  Для повышения надежности можно использовать зеркалированный и конкатенированный
    том:</p>
<pre>
vinum -&gt; mirror -v -n mirror /dev/da1h /dev/da2h /dev/da3h /dev/da4h
drive vinumdrive0 device /dev/da1h
drive vinumdrive1 device /dev/da2h
drive vinumdrive2 device /dev/da3h
drive vinumdrive3 device /dev/da4h
volume mirror setupstate
plex name mirror.p0 org concat
sd name mirror.p0.s0 drive vinumdrive0 size 0b
sd name mirror.p0.s1 drive vinumdrive2 size 0b
plex name mirror.p1 org concat
sd name mirror.p1.s0 drive vinumdrive1 size 0b
sd name mirror.p1.s1 drive vinumdrive3 size 0b
V mirror State: up Plexes: 2 Size: 1146 MB
P mirror.p0 C State: up Subdisks: 2 Size: 988 MB
P mirror.p1 C State: up Subdisks: 2 Size: 1146 MB
S vinum0.p0.s0 State: up D: vinumdrive0 Size: 414 MB
S vinum0.p0.s2 State: up D: vinumdrive2 Size: 414 MB
S vinum0.p0.s1 State: up D: vinumdrive1 Size: 414 MB
S vinum0.p0.s3 State: up D: vinumdrive3 Size: 414 MB
</pre>
<p>В этом примере явно указано имя тома, mirror. Поскольку один диск меньше других,
  два сплетения имеют разный размер, и последние 158 Мбайт тома не защищены от
  сбоев. Чтобы гарантировать полную надежность в такой ситуации, используйте
  команду create для создания тома размером 988 Мбайт.</p>
<p> Том с зеркалированием из двух сплетений с чередованием<br>
  В качестве альтернативы, используйте опцию -s для создания зеркалированного
    тома из двух сплетений с чередованием:</p>
<pre>
vinum -&gt; mirror -v -n raid10 -s /dev/da1h /dev/da2h /dev/da3h /dev/da4h
drive vinumdrive0 device /dev/da1h
drive vinumdrive1 device /dev/da2h
drive vinumdrive2 device /dev/da3h
drive vinumdrive3 device /dev/da4h
volume raid10 setupstate
plex name raid10.p0 org striped 279k
sd name raid10.p0.s0 drive vinumdrive0 size 849825b
sd name raid10.p0.s1 drive vinumdrive2 size 849825b
plex name raid10.p1 org striped 279k
sd name raid10.p1.s0 drive vinumdrive1 size 1173665b
sd name raid10.p1.s1 drive vinumdrive3 size 1173665b
V raid10 State: up Plexes: 2 Size: 1146 MB
P raid10.p0 S State: up Subdisks: 2 Size: 829 MB
P raid10.p1 S State: up Subdisks: 2 Size: 1146 MB
S raid10.p0.s0 State: up PO: 0 B Size: 414 MB
S raid10.p0.s1 State: up PO: 279 kB Size: 414 MB
S raid10.p1.s0 State: up PO: 0 B Size: 573 MB
S raid10.p1.s1 State: up PO: 279 kB Size: 573 MB
</pre>
<p>В этом случае полезная часть тома - еще меньше, поскольку первое сплетение
  было уменьшено до размера самого маленького диска.</p>
<h4><a name="configuration_file">ФАЙЛ КОНФИГУРАЦИИ </a></h4>
<p>Утилита <strong>vinum </strong> требует, чтобы все параметры команд <strong>create </strong> были
  в файле конфигурации. Записи в файле конфигурации определяют тома, сплетения
  и поддиски, и могут быть в произвольном формате, но каждая запись должна быть
  в отдельной строке. </p>
<h5> Единицы измерения </h5>
<p>Некоторые параметры файла конфигурации задают размер (длины, размеры полос).
  Эти значения можно задавать в байтах или с указанием одной из следующих единиц
  измерения: </p>
<table cellspacing="4">
  <tr>
    <td valign="top" width="10%"><strong>s </strong></td>
    <td>Указывает, что значение задано в секторах по 512 байтов. </td>
  </tr>
  <tr>
    <td valign="top" width="10%"><strong>k </strong></td>
    <td>Указывает, что значение задано в килобайтах (1024 байта). </td>
  </tr>
  <tr>
    <td valign="top" width="10%"><strong>m </strong></td>
    <td>Указывает, что значение задано в мегабайтах (1048576 байтов). </td>
  </tr>
  <tr>
    <td valign="top" width="10%"><strong>g </strong></td>
    <td>Указывает, что значение задано в гигабайтах (1073741824 байта). </td>
  </tr>
  <tr>
    <td valign="top" width="10%"><strong>b </strong></td>
    <td>Используется для совместимости с VERITAS. Указывает, что значение задано
      в блоках по 512 байтов. Это сокращение необнозначно, поскольку слово "блок" используется
      в разных смыслах, и его использование не рекомендуется. Используйте единицу
      измерения ' <strong>s </strong>'. </td>
  </tr>
</table>
<p>Например, значение 16777216 байтов можно также записать как <strong>16m </strong>, <strong>16384k </strong> или <strong>32768s </strong>. </p>
<p>Файл конфигурации может содержать следующие записи: </p>
<strong>drive имя имя_устройства [опции] </strong>Определяет диск. Поддерживаются
следующие опции: <strong>device имя_устройства </strong>Задает устройство, на
котором находится диск. <strong>Имя_устройства </strong> должно быть именем раздела
диска, например, <strong>/dev/da1e </strong> или <strong>/dev/ad3s2h </strong>,
это устройство должно быть типа <strong>vinum </strong>. Не испольуйте раздел " <strong>c </strong>",
который зарезервирован для представления всего диска. <br>
<br>
<strong>hotspare </strong>Определяет диск как диск "горячей замены" ("hot spare" drive),
который предназначен для автоматической замены сбойного диска. Утилита <strong>vinum </strong> не
позволяет использовать этот диск для любых других целей. В частности, на нем
нельзя создавать поддиски. Эта возможность еще не полностью реализована. <strong>volume
имя [опции] </strong>Определяет том с указанным <strong>именем </strong>. Поддерживаются
следующие опции: <strong>plex имя_сплетения </strong>Добавляет указанное сплетение
к тому. Если имя сплетения указано как <strong>* </strong>, утилита <strong>vinum </strong> будет
искать определение сплетения в следующей записи файла конфигурации после определения
тома. <br>
<br>
<strong>readpol правило </strong>Задает <em>правило чтения </em> (read policy)
для тома. В качестве правила можно указывать значение <strong>round </strong> или <strong>prefer
имя_предпочтительного_сплетения </strong>. Утилита <strong>vinum </strong> удовлетворяет
запросы на чтение только с одного из сплетений. Правило чтения <strong>round </strong> означает,
что каждое последующее чтение должно выполняться с другого сплетения, циклически.
Правило чтения <strong>prefer </strong> требует выполнять чтение каждый раз с
явно указанного сплетения. <br>
<br>
<strong>setupstate </strong>При создания тома из нескольких сплетений предполагать,
что содержимое всех сплетений согласовано. Обычно это не так, поэтому стандартно
утилита <strong>vinum </strong> устанавливает для всех сплетений, кроме первого,
состояние <strong>faulty </strong>. Используйте команду <strong>start </strong>,
чтобы сначала привести их в согласованное состояние. В случае конкатенированных
сплетений и сплетений с чередованием, однако, оставление сплетений в несогласованном
состоянии обычно не вызывает проблем: при использовании тома для создания файловой
системы или раздела подкачки прежнее содержимое дисков обычно не представляет
интереса, поэтому исходную согласованность можно проигнорировать. Если вы готовы
пойти на этот риск, используйте ключево слово <strong>setupstate </strong>. Оно
применяется только к сплетениям, определенным непосредственно после соответствующего
тома в файле конфигурации. При добавлении сплетений к тому в дальнейшем, их необходимо
интегрировать вручную с помощью команды <strong>start </strong>.
<p>Учтите, что для сплетений типа RAID-5 надо обязательно использовать команду <strong>init </strong>:
  иначе при сбое одного из поддисков произойдет существенное повреждение данных. </p>
<strong>plex [опции] </strong>Определяет сплетение. В отличие от тома, имя сплетения
задавать не обязательно. Поддерживаются следующие опции: <strong>name имя_сплетения </strong>Задает
имя сплетения. Учтите, что ключевое слово <strong>name </strong> надо обязательно
использовать при именовании сплетения или поддиска. <br>
<br>
<strong>org организация [размер_полосы] </strong>Задает организацию сплетения.
В качестве <strong>организации </strong> может быть задано одно из значений <strong>concat </strong>, <strong>striped </strong> или <strong>raid5 </strong>.
Для сплетений типа <strong>striped </strong> и <strong>raid5 </strong> необходимо
указывать параметр <strong>размер_полосы </strong>, а вот для сплетения типа <strong>concat </strong> его
указывать нельзя. Для сплетения типа <strong>striped </strong> значение <strong>размер_полосы </strong> задает
ширину каждой полосы. Для сплетения типа <strong>raid5 </strong> оно задает размер
группы. <em>Группа </em> - это часть сплетения, хранящая биты четности на одном
и том же поддиске. Размер сплетения должен быть кратен размеру группы (другими
словами, результат деления размера сплетения на размер полосы должен быть целым
числом), а размер группы должен быть кратен размеру сектора диска (512 байтов).
<p>Для оптимальной производительности полосы должны быть размером минимум 128
  Кбайт: меньший размер приведет к существенному увеличению количества операций
  ввода/вывода из-за распределения отдельных запросов по нескольким дискам. Повышение
  производительности из-за увеличения количества одновременных передач, вызванное
  таким распределением, не скомпенсирует падение производительности в связи с
  дополнительными задержками. Хорошей рекомендацией будет выбирать размер полосы
  в диапазоне от 256 Кбайт до 512 Кбайт. Степеней двойки при этом, однако, лучше
  избегать: обычно они приводят к размещению всех суперблоков на первом поддиске.
  Упрощенные команды используют размер полосы 279 Кбайт, что дает разумное распределение
  суперблоков. </p>
<p>Сплетение с чередованием должно иметь минимум два поддиска (иначе это просто
  конкатенированное сплетение), причем, одинакового размера. Сплетение типа RAID-5
  должно иметь как минимум три поддиска, причем, одинакового размера. Практически
  сплетение типа RAID-5 должно включать не менее 5 поддисков. </p>
<strong>volume имя_тома </strong>Добавляет сплетение к указанному тому. Если
ключевое слово <strong>volume </strong> не указано, сплетение будет добавлено
к последнему тому, упоминавшемуся в файле конфигурации. <br>
<br>
<strong>sd имя_поддиска смещение </strong>Добавляет указанный <strong>поддиск </strong> к
сплетению с указанного <strong>смещения </strong>. <strong>subdisk [опции] </strong>Определяет
поддиск. Поддерживаются следующие опции: <strong>name имя </strong>Задает <strong>имя </strong> поддиска.
Задавать имя для поддиска не обязательно - см. раздел "ИМЕНОВАНИЕ ОБЪЕКТОВ" выше.
Учтите, что если необходимо задать имя поддиска, ключевое слово <strong>name </strong> указывать
обязательно. <br>
<br>
<strong>plexoffset смещение </strong>Задает начальное смещение поддиска в сплетении.
Если смещение не указано, утилита <strong>vinum </strong> выделяет место сразу
после предыдущего поддиска, если он уже был определен, или с начала сплетения
в противном случае. <br>
<br>
<strong>driveoffset смещение </strong>Задает начальное смещение поддиска на диске.
Если <strong>смещение </strong> не задано, <strong>vinum </strong> выделяет первый
же фрагмент свободного места достаточного размера (см. <strong>length </strong>)
на диске. <br>
<br>
<strong>length длина </strong>Задает "длину" (размер) поддиска. Это ключевое
слово указывать обязательно. Стандартного значения нет, но можно указать значение
0 - оно означает "использовать самый большой фрагмент свободного места на диске".
Если диск пустой, это означает, что для поддиска будет использован весь диск.
Ключевое слово <strong>length </strong> можно сокращать до <strong>len </strong>. <br>
<br>
<strong>plex сплетение </strong>Задает сплетение, которому принадлежит поддиск.
По умолчанию, поддиск принадлежит последнему определенному сплетению. <br>
<br>
<strong>drive диск </strong>Задает диск, на котором находится поддиск. По умолчанию,
поддиск находится на последнем указанном диске. <br>
<br>
<strong>retryerrors </strong>Указывает, что поддиск не должен отключаться в случае
невосстановимых ошибок. Обычно <strong>vinum </strong> при возникновении таких
ошибок делает весь поддиск недоступным.
<h4>ПРИМЕР ФАЙЛА КОНФИГУРАЦИИ </h4>
<pre>
# Пример файла конфигурации vinum
#
# Наши диски
drive drive1 device /dev/da1h
drive drive2 device /dev/da2h
drive drive3 device /dev/da3h
drive drive4 device /dev/da4h
drive drive5 device /dev/da5h
drive drive6 device /dev/da6h
# Том из одного сплетения с чередованием
volume tinyvol
  plex org striped 279k
    sd length 64m drive drive2
    sd length 64m drive drive4
volume stripe
  plex org striped 279k
    sd length 512m drive drive2
    sd length 512m drive drive4
# Два сплетения
volume concat
  plex org concat
    sd length 100m drive drive2
    sd length 50m drive drive4
  plex org concat
    sd length 150m drive drive4
# Том из одного сплетения с чередованием и одного конкатенированного
volume strcon
  plex org striped 279k
    sd length 100m drive drive2
    sd length 100m drive drive4
  plex org concat
    sd length 150m drive drive2
    sd length 50m drive drive4
# Том из сплетения типа RAID-5 и сплетения с чередованием
# Обратите внимание, что сплетение RAID-5 длинее на 
# один поддиск
volume vol5
   plex org striped 491k
     sd length 1000m drive drive2
     sd length 1000m drive drive4
   plex org raid5 273k
     sd length 500m drive drive1
     sd length 500m drive drive2
     sd length 500m drive drive3
     sd length 500m drive drive4
     sd length 500m drive drive5
</pre>
<h4><a name="drive_layout">ПРИНЦИПЫ РАЗМЕЩЕНИЯ ДИСКОВ </a></h4>
<p>Диски <strong>vinum </strong> в настоящее время являются разделами дисков
  BSD. Они должны быть типа <strong>vinum </strong>, чтобы предотвратить перезапись
  данных, используемых для других целей. Для изменения определения типа раздела
  используйте команду <strong>disklabel -e </strong>. Ниже представлено типичное
  разбиение диска на разделы, выдаваемое <a href="http://www.freebsd.org/cgi/man.cgi?query=disklabel&sektion=8" target="_blank"><strong>disklabel(8) </strong></a>: </p>
<pre>
8 partitions:
#     size  offset   fstype  [fsize bsize bps/cpg]
a:   81920  344064   4.2BSD       0     0     0   # (Cyl.  240*- 297*)
b:  262144   81920     swap                       # (Cyl.   57*- 240*)
c: 4226725       0   unused       0     0         # (Cyl.0 - 2955*)
e:   81920       0   4.2BSD       0     0     0   # (Cyl.0 - 57*)
f: 1900000  425984   4.2BSD       0     0     0   # (Cyl.  297*- 1626*)
g: 1900741 2325984    vinum       0     0     0   # (Cyl. 1626*- 2955*)
</pre>
<p>В этом примере, раздел " <strong>g </strong>" может использоваться как раздел <strong>vinum </strong>.
  Разделы " <strong>a </strong>", " <strong>e </strong>" и " <strong>f </strong>" могут
  использоваться для создания файловых систем UFS или как разделы <strong>ccd </strong>.
  Раздел " <strong>b </strong>" является разделом подкачки, а раздел " <strong>c </strong>" представляет
  весь диск в целом и не должен использоваться для любых других целей. </p>
<p>Утилита <strong>vinum </strong> использует первые 265 секторов каждого раздела
  для информации о конфигурации, поэтому максимальный размер поддиска будет на
  265 секторов меньше, чем объем диска. </p>
<h4><a name="log_file">ЖУРНАЛЬНЫЙ ФАЙЛ </a></h4>
<p>Утилита <strong>vinum </strong> поддерживает журнальный файл, по умолчанию
  - <strong>/var/log/vinum_history </strong>, в который она записывает выполненные
  команды <strong>vinum </strong>. Имя этого файла можно изменить путем установки
  соответствующего значения переменной среды <strong>VINUM_HISTORY </strong>. </p>
<p>Перед каждым сообщением в журнальном файле указывается дата и время. Стандартный
  формат - " <strong>%e %b %Y %H:%M:%S </strong>". Подробнее о строке формата
  см. на странице справочного руководства <a href="http://www.freebsd.org/cgi/man.cgi?query=strftime&sektion=3" target="_blank"><strong>strftime(3) </strong></a>.
  Нестандартный формат можно задать в переменной среды <strong>VINUM_DATEFORMAT </strong>. </p>
<h4><a name="howto">КАК НАСТРОИТЬ VINUM </a></h4>
<p>В этом разделе представлены практические советы по использованию <strong>vinum </strong> в
  системе. </p>
<h5> Где размещать данные </h5>
<p>Прежде всего, надо решить, где размещать данные. Необходимо выделить разделы
  диска специально для <strong>vinum </strong>. Это должны быть именно разделы,
  а не устройства в целом; нельзя использовать также раздел " <strong>c </strong>".
  Например, прекрасно подходят имена устройств <strong>/dev/da0e </strong> или <strong>/dev/ad3s4a </strong>.
  Не подходят устройства <strong>/dev/da0 </strong> и <strong>/dev/da0s1 </strong>,
  поскольку представляют диск в целом, а не раздел, а также раздел <strong>/dev/ad1c </strong>,
  представляющий диск в целом - он должен быть типа <strong>unused </strong>.
  Примеры см. выше в разделе <a href="VINUM.8.shtml#drive_layout"><strong>ПРИНЦИПЫ РАЗМЕЩЕНИЯ
  ДИСКОВ </strong></a>. </p>
<h5> Проектирование томов </h5>
<p>Настройка томов <strong>vinum </strong> зависит от поставленных целей. Есть
  несколько вариантов: </p>
<ol>
  <li>Может потребоваться объединить несколько небольших дисков для получения
    файловой системы достаточного размера. Например, при наличии пяти небольших
    дисков, если необходимо использовать все дисковое пространство как один том,
    можно создать конфигурационный файл следующего вида:
<pre>
drive d1 device /dev/da2e
drive d2 device /dev/da3e
drive d3 device /dev/da4e
drive d4 device /dev/da5e
drive d5 device /dev/da6e
volume bigger
  plex org concat
    sd length 0 drive d1
    sd length 0 drive d2
    sd length 0 drive d3
    sd length 0 drive d4
    sd length 0 drive d5
</pre>		
      <p>В данном случае длина поддисков задается как 0, что означает "использоваться
        самый большой фрагмент свободного места, который удастся найти на диске".
        Если поддиск - единственный на диске, под него будет использоваться все
        свободное место. </p>
  <li>Можно настраивать <strong>vinum </strong> для получения дополнительной
    защиты от сбоев дисков. Для этого можно использовать либо конфигурацию RAID-1,
    которую также называют "зеркалирование", либо конфигурацию RAID-5, с битами
    четности.
        <p>Для настройки зеркалирования создайте несколько сплетений в томе.
          Например, для создания зеркалированного тома размером 2 Гбайта можно
          использовать следующий файл конфигурации: </p>
<pre>
drive d1 device /dev/da2e
drive d2 device /dev/da3e
volume mirror
  plex org concat
    sd length 2g drive d1
  plex org concat
    sd length 2g drive d2
</pre>        
        <p>При создании дисков с зеркалированием важно убедиться, что данные
          каждого сплетения находятся на другом физическом диске, чтобы драйвер <strong>vinum </strong> мог
          обращаться ко всему адресному пространству тома даже при сбое одного
          диска. Учтите, что для каждого сплетения потребуется столько же места,
          сколько и для всего тома: в нашем примере том имеет размер 2 Гбайта,
          поэтому каждое сплетение (и каждый поддиск) должны быть размером 2
          Гбайта, так что всего на дисках будет использовано 4 Гбайта. </p>
        <p>Для настройки массива RAID-5 создайте одно сплетение типа <strong>raid5 </strong>.
          Например, для создания эквивалентного тома размером 2 Гбайта, остающегося
          работоспособным при сбое одного диска, можно использовать следующий
          файл конфигурации: </p>
<pre>
drive d1 device /dev/da2e
drive d2 device /dev/da3e
drive d3 device /dev/da4e
drive d4 device /dev/da5e
drive d5 device /dev/da6e
volume raid
  plex org raid5 433k
    sd length 512m drive d1
    sd length 512m drive d2
    sd length 512m drive d3
    sd length 512m drive d4
    sd length 512m drive d5
</pre>        
        <p>Сплетения типа RAID-5 требуют минимум трех поддисков, один из которых
          используется для хранения информации о четности и дла хранения данных
          не доступен. Чем больше дисков используется, тем большая доля дискового
          прострнаства может использоваться для хранения собственно данных. В
          нашем примере суммарно используется 2,5 Гбайта по сравнению с 4 Гбайтами
          в конфигурации с зеркалированием. Если придется использовать всего
          три диска, для хранения той же информации потребуется 3 Гбайта, например: </p>
<pre>
drive d1 device /dev/da2e
drive d2 device /dev/da3e
drive d3 device /dev/da4e
volume raid
  plex org raid5 433k
    sd length 1g drive d1
    sd length 1g drive d2
    sd length 1g drive d3
</pre>
        <p>Как и при создании дисков с зеркалированием, важно проверить, что
          данные каждого поддиска находятся на другом физическом диске, чтобы
          драйвер <strong>vinum </strong> мог получить доступ ко всему адресонму
          пространству тома даже при сбое одного диска. </p>
  <li>Можно настроить <strong>vinum </strong> для обеспечения одновременного
    доступа к файловой системе большего количества пользователей. Во многих случаях,
    доступ к файловой системе ограничивается скоростью диска. Распределяя том
    по нескольким дискам, можно увеличить пропускную способность при многопользовательском
    доступе. Этот метод дает минимальные преимущества или вообще не дает преимуществ,
    если процессы обращаются к дискам по одному. Утилита <strong>vinum </strong> использует
    метод под названием "чередование" (иногда соответствующий массив называют
    RAID-0) для увеличения одновременности при доступе. Имя RAID-0 сбивает с
    толку: чередование не обеспечивает ни избыточности, ни повышенной надежности.
    Фактически, оно снижает надежность, поскольку сбой единственного диска делает
    бесполезным весь том, и чем больше дисков входит в том, тем больше вероятность,
    что на одном из них произойдет сбой.
        <p>Для реализации чередования используйте сплетение с чередованием: </p>
<pre>
drive d1 device /dev/da2e
drive d2 device /dev/da3e
drive d3 device /dev/da4e
drive d4 device /dev/da5e
volume raid
  plex org striped 433k
    sd length 512m drive d1
    sd length 512m drive d2
    sd length 512m drive d3
    sd length 512m drive d4
</pre>
        <p>Сплетение с чередованием должно состоять, как минимум, из двух поддисков,
          но повышение производительности будет больше при увеличении количества
          дисков. </p>
  <li>Можно попытаться получить лучшее из двух миров и обеспечить как защиту
    от сбоев, так и высокую производительность. Соответствующий массив иногда
    называют RAID-10 (комбинация RAID-1 и RAID-0), хотя и это имя сбивает с толку.
    Можно реализовать такой массив <strong>vinum </strong> с помощью следующего
    файла конфигурации: 
<pre>
drive d1 device /dev/da2e
drive d2 device /dev/da3e
drive d3 device /dev/da4e
drive d4 device /dev/da5e
volume raid setupstate
  plex org striped 433k
    sd length 512m drive d1
    sd length 512m drive d2
    sd length 512m drive d3
    sd length 512m drive d4
  plex org striped 433k
    sd length 512m drive d4
    sd length 512m drive d3
    sd length 512m drive d2
    sd length 512m drive d1
</pre>		
        <p>В данном случае сплетения сосданы с чередованием, что повышает производительность,
          а то, что их два, повышает надежность. Обратите внимание, что в этом
          примере поддиски второго сплетения идут в порядке, противоположном
          первому сплетению. Это сделано из соображений производительности, которые
          обсуждаются далее. Кроме того, определение тома включает ключевое слово <strong>setupstate </strong>,
          что гарантирует запуск всех сплетений сразу после создания. </p>
  </li>
</ol>
<h3> Создание томов </h3>
<p>После создания необходимых файлов конфигурации запустите <strong>vinum </strong> и
  создайте тома. В следующем примере конфигурация задана в файле <strong>configfile </strong>: </p>
<pre>
# vinum create -v configfile
   1: drive d1 device /dev/da2e
   2: drive d2 device /dev/da3e
   3: volume mirror
   4:   plex org concat
   5:     sd length 2g drive d1
   6:   plex org concat
   7:     sd length 2g drive d2
Configuration summary

Drives:         2 (4 configured)
Volumes:        1 (4 configured)
Plexes:         2 (8 configured)
Subdisks:       2 (16 configured)

Drive d1:       Device /dev/da2e
                Created on vinum.lemis.com at Tue Mar 23 12:30:31 1999
                Config last updated Tue Mar 23 14:30:32 1999
                Size:  60105216000 bytes (57320 MB)
                Used:   2147619328 bytes (2048 MB)
                Available: 57957596672 bytes (55272 MB)
                State: up
                Last error: none
Drive d2:       Device /dev/da3e
                Created on vinum.lemis.com at Tue Mar 23 12:30:32 1999
                Config last updated Tue Mar 23 14:30:33 1999
                Size:  60105216000 bytes (57320 MB)
                Used:   2147619328 bytes (2048 MB)
                Available: 57957596672 bytes (55272 MB)
                State: up
                Last error: none

Volume mirror:  Size: 2147483648 bytes (2048 MB)
                State: up
                Flags:
                2 plexes
                Read policy: round robin

Plex mirror.p0: Size:   2147483648 bytes (2048 MB)
                Subdisks:1
                State: up
                Organization: concat
                Part of volume mirror
Plex mirror.p1: Size:   2147483648 bytes (2048 MB)
                Subdisks:1
                State: up
                Organization: concat
                Part of volume mirror

Subdisk mirror.p0.s0:
                Size:   2147483648 bytes (2048 MB)
                State: up
                Plex mirror.p0 at offset 0
Subdisk mirror.p1.s0:
                Size:   2147483648 bytes (2048 MB)
                State: up
                Plex mirror.p1 at offset 0
</pre>
<p>Опция <strong>-v </strong> требует от утилиты <strong>vinum </strong> выдавать
  содержимое файла по ходу конфигурирования. Далее она выдает информацию о текущей
  конфигурации в том же формате, что и команда <strong>list -v </strong>. </p>
<h3> Создание дополнительных томов </h3>
<p>После создания томов <strong>vinum </strong>, драйвер <strong>vinum </strong> отслеживает
  их состояние в своих внутренних файлах конфигурации. Снова создавать их не
  придется. В частности, при повторном выполнении команды <strong>create </strong> будут
  созданы дополнительные объекты: </p>
<pre>
Drives:         2 (4 configured)
Volumes:        1 (4 configured)
Plexes:         4 (8 configured)
Subdisks:       4 (16 configured)

D d1    State: up  Device /dev/da2e  Avail: 53224/57320 MB (92%)
D d2    State: up  Device /dev/da3e  Avail: 53224/57320 MB (92%)

V mirror  State: up  Plexes: 4 Size: 2048 MB

P mirror.p0  C State: up  Subdisks:   1 Size: 2048 MB
P mirror.p1  C State: up  Subdisks:   1 Size: 2048 MB
P mirror.p2  C State: up  Subdisks:   1 Size: 2048 MB
P mirror.p3  C State: up  Subdisks:   1 Size: 2048 MB

S mirror.p0.s0  State: up  PO:0  B Size: 2048 MB
S mirror.p1.s0  State: up  PO:0  B Size: 2048 MB
S mirror.p2.s0  State: up  O:0   B Size: 2048 MB
S mirror.p3.s0  State: up  PO:0  B Size: 2048 MB
</pre>
<p>Как показывает этот пример (на этот раз добавлена опция <strong>-f </strong>),
  повторное выполнение команды <strong>create </strong> привело к созданию четырех
  новых сплетений, каждое - с новым поддиском. Если необходиом создать другие
  тома, создайте для них новые файлы конфигуации. В них не обязательно задавать
  диски, о которых драйвер <strong>vinum </strong> уже знает. Например, для создания
  тома <strong>raid </strong> на четырех дисках, <strong>/dev/da1e </strong>, <strong>/dev/da2e </strong>, <strong>/dev/da3e </strong> и <strong>/dev/da4e </strong>,
  достаточно упомянуть два оставшихся: </p>
<pre>
drive d3 device /dev/da1e
drive d4 device /dev/da4e
volume raid
  plex org raid5 433k
    sd size 2g drive d1
    sd size 2g drive d2
    sd size 2g drive d3
    sd size 2g drive d4
</pre>
<p>С помощью этого файла конфигурации мы получим: </p>
<pre>
# vinum create newconfig
Configuration summary

Drives:  4 (4 configured)
Volumes: 2 (4 configured)
Plexes:  5 (8 configured)
Subdisks:8 (16 configured)

D d1	State: up		Device /dev/da2e  Avail: 51176/57320 MB (89%)
D d2	State: up		Device /dev/da3e  Avail: 53220/57320 MB (89%)
D d3	State: up		Device /dev/da1e  Avail: 53224/57320 MB (92%)
D d4	State: up		Device /dev/da4e  Avail: 53224/57320 MB (92%)

V mirror	State: down  Plexes:  4 Size:  2048 MB
V raid		State: down  Plexes:  1 Size:  6144 MB

P mirror.p0  C State: init  Subdisks: 1 Size: 2048 MB
P mirror.p1  C State: init  Subdisks: 1 Size: 2048 MB
P mirror.p2  C State: init  Subdisks: 1 Size: 2048 MB
P mirror.p3  C State: init  Subdisks: 1 Size: 2048 MB
P raid.p0    R5 State: init Subdisks: 4 Size: 6144 MB

S mirror.p0.s0  State: up PO:  0  B Size:  2048 MB
S mirror.p1.s0  State: up PO:  0  B Size:  2048 MB
S mirror.p2.s0  State: up PO:  0  B Size:  2048 MB
S mirror.p3.s0  State: up PO:  0  B Size:  2048 MB
S raid.p0.s0    State: empty PO:  0  B Size:    2048 MB
S raid.p0.s1    State: empty PO:  433 kB Size:  2048 MB
S raid.p0.s2    State: empty PO:  866 kB Size:  2048 MB
S raid.p0.s3    State: empty PO:  1299 kB Size: 2048 MB
</pre>
<p>Обратите внимание на рразмер сплетения RAID-5: он составляет всего 6 Гбайт,
  хотя совместно все его компоненты занимают 8 Гбайт дискового пространства.
  Причина в том, что пространство объемом с один поддиск используется для хранения
  данных о четности. </p>
<h3> Перезапуск Vinum </h3>
<p>После перрезагрузки системы запустите <strong>vinum </strong> с помощью команды <strong>start </strong>: </p>
<code># vinum start</code>
<p>Эта команда запустит все диски <strong>vinum </strong> в системе. Если, по
  любой причине, необходимо запустить только некоторые из них, используйте команду <strong>read </strong> . </p>
<h3> Сообрражения производительности </h3>
<p>Есть рряд ошибочных представлений о том, как настраивать RAID-массив для достижения
  наилучшей производительности. В частности, в большинстве систем используется
  слишком маленький размер полосы. Следующее обсуждение применимо ко всем RAID-системам,
  а не только к <strong>vinum </strong>. </p>
<p>Система блочного ввода/вывода ОС FreeBSD выдает запросы на чтение от 0,5 Кбайта
  до 128 Кбайт; в среднем - около 8 Кбайт. Ни в одной системе чередования нельзя
  предотвратить разбиение запроса на два физических запроса, и если сделать размер
  полосы слишком маленьким, он может быть разбит и на нескольк запросов. Это
  приведет к существенному падению производительности: уменьшение времени передачи
  для каждого диска с лихвой компенсиуется на порядок увеличивающимся ожиданием
  доступа. </p>
<p>При современных размерах дисков и состоянии системы ввода/вывода FreeBSD,
  следует ожидать достаточно небольшой доли фрагментированных запросов при использовании
  полос размером от 256 до 512 Кбайт; хотя при обоснованном применении RAID-массивов
  нет очевидных причин не увеличить размер до 2-4 Мбайт для больших дисков. </p>
<p>При выборе размера полосы учитывайте, что большинство современных файловых
  систем UFS использует группы цилиндров размером 32 Мбайта. Если размер полосы
  и количество дисков - степени двойки, вероятно, что все суперблоки и индексные
  дескрипторы будут помещены на один и тот же поддиск, что существенно повлияет
  на производительность. Выбирайте лучше нечетное число, например, 479 Кбайт. </p>
<p>Самый простой способ учесть влияние любой передачи данных в системе с множественным
  доступом - рассматривать ее с точки зрения потенциального узкого места, дисковой
  подсистемы: сколько всего времени работы диска потребует эта передача? Поскольку
  практически все кэшируется, время от выдачи запроса до его выполнения не так
  важно: важно, сколько всего времени запрос активно использует диски, время,
  в течение которого диски недоступны для выполнения передач других данных. В
  результате, не так уж важно, выполняются ли передачи одновременно или в разное
  врремя. Практически, время, которое нас интересует - это сумма общей задержки
  (времени на позиционирование и ожидания при вращении пластин, или времени,
  за которое требуемые данные окажутся под головками диска) и общего времени
  передачи. Для передачи данных по одному и тому же адресу на диски с той же
  скоростью вращения, время передачи зависит только от объема пеедаваемых данных. </p>
<p>Рассмотрим типичную статью дискуссионной группы или web-страницу размером
  24 Кбайта, которая, вероятно, будети прочитана одной операцией ввода/вывода.
  Пусть диски обеспечивают скорость передачи 6 Мбайт/сек, среднее время позиционирования
  составляет 8 миллисекунд, а файловая система имеет размер блока 4 Кбайта. Поскольку
  прочитать надо 24 Кбайта, фрагменты можнео не учитывать, так что, считаем,
  что файл начинается на границе очердных 4 Кбайт. Количество необходимых передач
  зависит от того, где начинается блок: в данном случае, оно вычисляется по формуле <strong>(S
  + F - 1) / S </strong>, где <strong>S </strong> - размер полосы в блоках файловой
  системы, а <strong>F </strong> - размер файла в блоках файловой системы. </p>
<ol>
  <li>При размере полосы 4 Кбайта потребуется 6 передач. Общая нагрузка на дисковую
    подсистему: задержка - 48 миллисекунд, передача - 2 миллисекунды, всего -
    50 миллисекунд.
    <li>При размере полосы 8 Кбайт в среднем потребуется 3,5 передачи. Общая
      нагрузка на дисковую подсистему: задержка - 28 миллисекунд, передача -
      2 миллисекунды, всего - 30 миллисекунд.
    <li>При размере полосы 16 Кбайт в среднем потребуется 2,25 передачи. Общая
      нагрузка на дисковую подсистему: задержка - 18 миллисекунд, передача -
      2 миллисекунды, всего - 20 миллисекунд.
    <li>При размере полосы 256 Кбайт в среднем потребуется 1,08 передачи. Общая
      нагрузка на дисковую подсистему: задержка - 8,6 миллисекунд, передача -
      2 миллисекунды, всего - 10,6 миллисекунды.
    <li>При размере полосы 4 Мбайта в среднем потребуется 1,0009 передачи. Общая
      нагрузка на дисковую подсистему: задержка - 8,01 миллисекунды, передача
      - 2 миллисекунды, всего - 10,01 миллисекунды. </li>
</ol>
<p>Похоже, что у некоторых аппаратных RAID-систем есть проблемы с большими полосами:
  они, по-видимому, передают на диск и с диска только всю полосу, так что увеличение
  размера полосы может отрицательно влиять на производительность. Утилита <strong>vinum </strong> от
  этой проблемы не страдает: все обмены данными оптимизируются и ненужные данные
  не передаются. </p>
<p>Учтите, что ни одна из широко известных программ оценки производительности
  не реализует условия действительно множественного доступа (более 100 одновременно
  работающих пользователей), так что правильность представленных утверждений
  проверить трудно. </p>
<p>С учетом представленных соображений, на производительность тома <strong>vinum </strong> влияют
  следующие факторы: </p>
<ol>
  <li>Чередование повышает производительность только при множественном доступе,
    поскольку повышает вероятность того, что отдельные запросы будут переадресованы
    на разные диски.
    <li>Конкатенированные файловые системы UFS из нескольких дисков тоже могут
      повысить производительность при доступе к множеству файлов, поскольку UFS
      делит файловую систему на группы цилиндров и пытается поддерживать файлы
      в одной группе цилиндров. В общем случае, В общем случае, это не так эффективно,
      как чередование.
    <li>Зеркалирование может повысить производительность множественного доступа
      при чтении, поскольку по умолчанию каждое следующее чтение <strong>vinum </strong> выполняет
      со следующего сплетения.
    <li>Зеркалирование снижает производительность для всех видов записи, будь-то
      множественные или отдельные, поскольку данные надо записать на все сплетения.
      Это объясняет выбранное размещение дисков в представленном ранее примере
      конфигурации с зеркалированием: если соответствующий поддиск в каждом сплетении
      располагается на другом физическом диске, команды записи могут выполняться
      параллельно, а при размещении на одном физическом диске они будут выполняться
      строго последовательно.
    <li>Чтения с массива RAID-5 имеют, по сути, те же особенности, что и чтения
      с массива с чередованием, если только сплетение с чередованием не входит
      в том с зеркалированием, - в этом случае производительность тома с зеркалированием
      будет выше.
    <li>Скорость записи на массив RAID-5 составляет примерно 25% от скорости
      записи на массив с чередованием: для выполнения записи утилита <strong>vinum </strong> должна
      сначала прочитать блок данных и соответствующий блок четности, выполнить
      ряд вычислений и записать блок четности и блок данных, что требует в четыре
      раза больше передач, чем при записи на сплетение с чередованием. С другой
      стороны, это компенсируется отсутствием затрат на зеркалирование, поэтому
      запись на том с единственным сплетением типа RAID-5 выполняется примерно
      вдвое медленнее, чем на правильно сконфигурированный том из двух сплетений
      с чередованием.
    <li>При изменении конфигурации <strong>vinum </strong> (например, при добавлении
      или удалении объектов, или при изменении состояния одного из объектов), <strong>vinum </strong> записывает
      до 128 Кбайт обновленной информации о конфигурации на каждый диск. Чем
      больше дисков задействовано, тем больше времени это займет. </li>
</ol>
<h5> Создание файловых систем на томах Vinum </h5>
<p>Перед созданием файловой системы на томе <strong>vinum </strong> запускать
  утилиту <a href="http://www.freebsd.org/cgi/man.cgi?query=disklabel&sektion=8" target="_blank"><strong>disklabel(8) </strong></a> не нужно.
  Просто выполните команду <a href="http://www.freebsd.org/cgi/man.cgi?query=newfs&sektion=8" target="_blank"><strong>newfs(8) </strong></a>.
  Используйте опцию <strong>-v </strong>, чтобы указать, что устройство не разбито
  на разделы. Например, чтобы создать файловую систему на томе <strong>mirror </strong>,
  выполните следующую команду: </p>
<code># newfs -v /dev/vinum/mirror</code>
<p>При конфигурировании <strong>vinum </strong> следует учитывать также следующее: </p>
<ul>
  <li>Создание нескольких дисков <strong>vimun </strong> на одном физическом
    диске не дает никаких преимуществ. На каждом диске 131,5 Кбайта используется
    для метки и хранения информации о конфигурации, а изменение конфигурации
    вызывает снижение производительности. Используйте лучше поддиски соответствующего
    размера.
    <li>Можно увеличить размер конкатенированного сплетения <strong>vinum </strong>,
      но вот размер спелетений с чередованием и сплетений типа RAID-5 в настоящее
      время увеличить нельзя. В настоящее время размер существующей файловой
      системы UFS увеличить тоже нельзя, но планируется сделать сплетения и файловые
      системы расширяемыми. </li>
</ul>
<h4><a name="state_management">УПРАВЛЕНИЕ СОСТОЯНИЕМ </a></h4>
<p>Для объектов <strong>vinum </strong> существует понятие состояния. Подробнее
  см. на странице справочного руководства <strong>vinum(4) </strong>. Объекты
  полностью доступны тольк в запущеном ( <strong>up </strong>) состоянии. Чтобы
  изменить состояние объекта на <strong>up </strong>, используйте команду <strong>start </strong>.
  Для перевода объекта в состояние <strong>down </strong> используйте команду <strong>stop </strong>.
  Обычно переход в другие состояния осуществляется автоматически с учетом взаимосвязей
  объектов. Например, при добавлении сплетения к тому поддиски сплетения оказываются
  в состоянии <strong>empty </strong>, показывая, что хотя фактически диск доступен,
  данные на поддиске некорректны. В результате установки такого состояния, соответствующее
  сплетение будет установлено в состояние сбоя ( <strong>faulty </strong>). </p>
<h5> Состояние "reviving" </h5>
<p>Во многих случаях при запуске поддиска система должна скопировать данные на
  поддиск. В зависимости от размера поддиска, это может потребовать много времени.
  На это время поддиск устанавливается в состояние <strong>reviving </strong> ("оживляется").
  После успешного завершения операции копирования он автоматически запускается
  (устанавливается в состояние <strong>up </strong>). Можно останавливать и перезапускать
  процесс, выполняющий "оживление". Система отслеживает, насколько диск уже "оживлен" и,
  при повторном выполнении команды <strong>start </strong>, копирование продолжается
  с этой позиции. </p>
<p>Для поддержки согласованности тома пока одно или несколько его сплетений "оживляется",
  драйвер <strong>vinum </strong> записывает на поддиски, уже восстановленные
  до места записи. Он может также читать из сплетения, если считываемая область
  уже была восстановлена. </p>
<h4><a name="gotchas">ОСОБЕННОСТИ </a></h4>
<p>Следующие особенности работы не связаны с ошибками, и у них есть весьма существенные
  причины, но, оказалось, что они вызывают непонимание. Каждая из этих особенностей
  уже была описана в соответствующем разделе выше. </p>
<ol>
  <li>Диски <strong>vinum </strong> являются разделами диска UNIX, и должны быть
    разделами типа <strong>vinum </strong>. Это отличается от драйвера <strong>ccd </strong>,
    которому необходимы разделы типа 4.2BSD. Такое поведение драйвера <strong>ccd </strong> провоцирует
    опасные ошибки (в оригинале - <strong>is an invitation to shoot yourself
    in the foot </strong>. Тому, кто придумает адекватный перевод - приз. <em>Прим.
    В.К. </em>): при использовании <strong>ccd </strong> можно легко перезаписать
    файловую систему. Утилита <strong>vinum </strong> этого не допустит.
        <p>По аналогичным причинам команда <strong>vinum start </strong> не позволят
          создать диск на разделе " <strong>c </strong>". Раздел " <strong>c </strong>" используется
          системой для представления всего диска, и должен быть типа <strong>unused </strong>.
          Тут есть явный конфликт, который утилита <strong>vinum </strong> решает,
          просто не используя раздел " <strong>c </strong>". </p>
  <li>При создании тома с несколькими сплетениями утилита <strong>vinum </strong> не
    инициализирует сплетения автоматически. Это означает, что содержимое их неизвестно,
    но определенно не согласовано. В результате, по умолчанию <strong>vinum </strong> устанавливает
    для всех вновь созданных сплетений, кроме первого, состояние <strong>faulty </strong>.
    Чтобы синхронизировать их с первым сплетением, необходимо их запустить, что
    приводит к копированию данных со сплетения, находящегося в состоянии <strong>up </strong>.
    В зависимости от размера задействованных поддисков, это может потребовать
    много времени.
        <p>На практике пользователей не часто интересует, что было в сплетении
          при создании, и другие диспетчеры томов жульничают, просто устанавливая
          всем сплетениям состояние up. Утилита <strong>vinum </strong> предлагает
          два способа обеспечить перевод вновь созданных сплетений в состояние <strong>up </strong>: </p>
        <ul>
          <li>Создать сплетения, а затем синхронизировать их с помощью команды <strong>vinum
              start </strong>.
          <li>Создать том (не сплетение) с ключевым словом <strong>setupstate </strong>,
              которое требует от утилиты <strong>vinum </strong> игнорировать
              любые несогласованности и сразу переводить сплетения в состояние <strong>up </strong>. </li>
        </ul>
  <li>Некоторые из команд, поддерживаемых в настоящее время утилитой <strong>vinum </strong>,
    фактически не нужны. По непонятным мне причинам оказывается, что пользователи
    часто пытаются использовать команды <a href="VINUM.8.shtml#label"><strong>label </strong></a> и <a href="VINUM.8.shtml#resetconfig"><strong>resetconfig </strong></a>,
    хотя, в частности, <strong>resetconfig </strong> выдает всевозможные страшные
    предупреждения. Не используйте эти команды без веских на то причин.
    <li>Некоторые переходы из одного состояния в другое интуитивно непонятны.
      Фактчиески, не ясно, ошибка это или особенность. Если оказывается, что
      вы не можете запустить объект, находящийся в некотором странном состоянии,
      например, <strong>reborn subdisk </strong>, сначала попытайтесь перевести
      его в состояние <strong>stopped </strong> с помощью команд <strong>stop </strong> или <strong>stop
      -f </strong>. Если это сработает, вы затем сможете его запустить. Если
      окажется, что это единственный способ выйти из ситуации, и более простые
      методы не срабатывают, сообщите, пожалуйста, об этой ситуации.
    <li>Если вы собираете модуль ядра с опцией <strong>-DVINUMDEBUG </strong>,
      надо утилиту <strong>vinum </strong> тоже собирать с опцией <strong>-DVINUMDEBUG </strong>,
      поскольку размер некоторых объектов данных, используемых обоими компонентами,
      зависит от этой опции. Если этого не сделать, команды будут завершаться
      с выдачей соответствующего сообщения об ошибке.
    <li>Команда <strong>vinum read </strong> имеет особенно противный синтаксис.
      Когда-то она была единственным способом запуска <strong>vinum </strong>,
      но сейчас предпочтительнее использовать для этого команду <strong>vinum
      start </strong>. Команда <strong>vinum read </strong> должна использоваться
      только в целях сопровождения. Обратите внимание, что ее синтаксис изменился,
      а аргументами должны быть секции диска (slices), например, <strong>/dev/da0 </strong>,
      а не разделы (partitions) вроде <strong>/dev/da0e </strong>. </li>
</ol>
<h4><a name="files">ФАЙЛЫ </a></h4>
<strong>/dev/vinum </strong>каталог с файлами устройств для объектов <strong>vinum </strong><strong>/dev/vinum/control </strong>управляющее
устройство для <strong>vinum </strong><strong>/dev/vinum/plex </strong>коталог,
содержащий файлы устройств для сплетений <strong>vinum </strong><strong>/dev/vinum/sd </strong>каталог,
содержащий файлы устройств для поддисков <strong>vinum </strong>
<h4><a name="environment">СРЕДА </a></h4>
<strong>VINUM_HISTORY </strong>Имя журнального файла, по умолчанию, - <strong>/var/log/vinum_history </strong>. <strong>VINUM_DATEFORMAT </strong>Формат
дат в журнальном файле, по умолчанию, - <strong>"%e %b %Y %H:%M:%S" </strong>. <strong>EDITOR </strong>Имя
редактора, который будет использоваться для редактирования файлов конфигурации,
по умолчанию - <strong>vi </strong>.
<h4><a name="see_also">ССЫЛКИ </a></h4>
<a href="http://www.freebsd.org/cgi/man.cgi?query=strftime&sektion=3" target="_blank"><strong>strftime(3) </strong></a>, <a href="VINUM.4.shtml"><strong>vinum(4) </strong></a>, <a href="http://www.freebsd.org/cgi/man.cgi?query=disklabel&sektion=8" target="_blank"><strong>disklabel(8) </strong></a>, <a href="http://www.freebsd.org/cgi/man.cgi?query=newfs&sektion=8" target="_blank"><strong>newfs(8) </strong></a><br>
<a href="http://www.vinumvm.org/vinum/" target="_blank"><strong>http://www.vinumvm.org/vinum/ </strong></a>, <br>
<a href="http://www.vinumvm.org/vinum/how-to-debug.html" target="_blank"><strong>http://www.vinumvm.org/vinum/how-to-debug.html </strong></a>.
<h4><a name="authors">АВТОРЫ </a></h4>
Грег Лихи (Greg Lehey) &lt;grog@lemis.com&gt;
<h4><a name="history">ИСТОРИЯ </a></h4>
<p>Утилита <strong>vinum </strong> впервые появилась в ОС FreeBSD 3.0. Компонент
  RAID-5 системы <strong>vinum </strong> был разработан для корпорации <strong>Cybernet
  Inc. </strong> (<strong><a href="http://www.cybernet.com" target="_blank">www.cybernet.com</a></strong>), для ее продукта NetMAX. </p>
<h4><a name="bugs">ОШИБКИ </a></h4>
<p>Драйвер <a href="VINUM.4.shtml"><strong>vinum(4) </strong></a> не использует
  подсистему <a href="GEOM.4.shtml"><strong>geom(4) </strong></a>, поэтому тома <a href="VINUM.4.shtml"><strong>vinum(4) </strong></a> нельзя
  использовать для средств, использующих GEOM, например, <a href="http://www.freebsd.org/cgi/man.cgi?query=gbde&sektion=8" target="_blank"><strong>gbde(8) </strong></a>. </p>
<p align="center">FreeBSD 4.9 5 мая 2003 года </p>
</div>
</div>


<center><div style="width:500px; border:1px solid black; text-align: left;">  
  <div id="gfi_slide2" style="display: none;  padding:5px; font-family: 'Open Sans', sans-serif !important; font-size:16px !important; color:black !important;">
	  <a href="http://gfi-software.ru/languard/?utm_source=citforum&utm_medium=banner&utm_campaign=languard" target="_blank" style="text-decoration:none; display:block; color:black !important;">
    <table cellpadding=0 cellspacing=0 width=490><tr><td><img src="http://static.gfi.me.uk/images/thumbs/LANSS-1413629426-7a56c.png" width="183" height="30" alt="GFI LanGuard"></td>
    <td align=right><nobr><b>Код <b style="color:#f90000">CITFORUM</b> для скидки</b></nobr></td>
    </tr>
    <tr><td colspan=2 align=center>Поиск и автоматическое устранение уязвимостей в сети</td></tr>
    <tr><td colspan=2 align=center>Инвентаризация и управление программным обеспечением</td></tr>
    </table>
	  </a>
  </div>
  <div id="gfi_slide1" style="display: block;  padding:5px; font-family: 'Open Sans', sans-serif !important; font-size:16px !important; color:black !important;">
	  <a href="http://gfi-software.ru/mailessentials/?utm_source=citforum&utm_medium=banner&utm_campaign=mailessentials" target="_blank" style="text-decoration:none; display:block; color:black !important;">
    <table cellpadding=0 cellspacing=0 width=490><tr><td><img src="http://static.gfi.me.uk/images/thumbs/ME-1413629452-7a56c.png" width="235" height="30" alt="GFI MailEssentials"></td>
    <td align=right><nobr><b>Код <b style="color:#f90000">CITFORUM</b> для скидки</b></nobr></td>
    </tr>
    <tr><td colspan=2 align=center>Защита от спама и вирусов для почтового сервера №1</td></tr>
    <tr><td colspan=2 align=center>Качество фильтрации выше 99%, без ложных срабатываний</td></tr>
    </table>
	  </a>
  </div>
  <div id="gfi_slide4" style="display: none;  padding:5px; font-family: 'Open Sans', sans-serif !important; font-size:16px !important; color:black !important;">
	  <a href="http://gfi-software.ru/archiver/?utm_source=citforum&utm_medium=banner&utm_campaign=archiver" target="_blank" style="text-decoration:none; display:block; color:black !important;">
    <table cellpadding=0 cellspacing=0 width=490><tr><td><img src="http://static.gfi.me.uk/images/thumbs/AR-1422970393-7a56c.png" width="164" height="30" alt="GFI Archiver"></td>
    <td align=right><nobr><b>Код <b style="color:#f90000">CITFORUM</b> для скидки</b></nobr></td>
    </tr>
    <tr><td colspan=2 align=center>Резервное копирование электронных писем и документов</td></tr>
    <tr><td colspan=2 align=center>Быстрый поиск по архиву, анализ контента, отчетность</td></tr>
    </table>
	  </a>
  </div>
  <div id="gfi_slide3" style="display: none;  padding:5px; font-family: 'Open Sans', sans-serif !important; font-size:16px !important; color:black !important;">
	  <a href="http://gfi-software.ru/webmonitor/?utm_source=citforum&utm_medium=banner&utm_campaign=webmonitor" target="_blank" style="text-decoration:none; display:block; color:black !important;">
    <table cellpadding=0 cellspacing=0 width=490><tr><td><img src="http://static.gfi.me.uk/images/thumbs/WM-1413629470-7a56c.png" width="214" height="30" alt="GFI WebMonitor"></td>
    <td align=right><nobr><b>Код <b style="color:#f90000">CITFORUM</b> для скидки</b></nobr></td>
    </tr>
    <tr><td colspan=2 align=center>Контроль и безопасность доступа сотрудников в веб</td></tr>
    <tr><td colspan=2 align=center>Более 460.000.000 веб-сайтов в базе по категориям</td></tr>
    </table>
	  </a>
  </div>
  <div style="background:#F0F0F0; padding:2px; font-family: 'Open Sans', sans-serif !important; font-size:12px !important; color:black !important; text-align:center;">
    <b>30 дней бесплатно.</b> Техническая поддержка на русском.
  </div>
  <script>
    (function addEvent(element, event, fn) {
      if (element.addEventListener){
        element.addEventListener(event, fn, false);
      }else if (element.attachEvent){
        element.attachEvent('on' + event, fn);
      }
    })(window, 'load', function(){
      window.gfi_slides=4;
      window.gfi_slider=1;
      setInterval(function(){
        for(var i=1; i<=window.gfi_slides; i++){
          document.getElementById("gfi_slide"+i).style.display="none";
        }
        window.gfi_slider++;
        if (window.gfi_slider>window.gfi_slides){
          window.gfi_slider=1
        }
        document.getElementById("gfi_slide"+window.gfi_slider).style.display="block";
      }, 6000)
    });
  </script>
</div>
</center>

<center>


</center>

</td>


<td>

<table cellspacing=0 cellpadding=0 border=0 width="100%" align=right><tr>
<td bgcolor=#008080><img src="../../../pictures/1x1.gif" width=1 height=1 border=0></td>
<td bgcolor=#daecd7><img src="../../../pictures/1x1.gif" width=2 height=1 border=0></td>
<td>

<table cellpadding=0 cellspacing=0 border=0>

<tr><td align="center"><!--  AdRiver code START. Type:240x400 Site: citforum PZ: 0 BN: 1 -->
<script language="javascript" type="text/javascript"><!--
var RndNum4NoCash = Math.round(Math.random() * 1000000000);
var ar_Tail='unknown'; if (document.referrer) ar_Tail = escape(document.referrer);
document.write(
'<iframe src="http://ad.adriver.ru/cgi-bin/erle.cgi?'
+ 'sid=137295&bn=1&target=blank&bt=22&pz=0&rnd=' + RndNum4NoCash + '&tail256=' + ar_Tail
+ '" frameborder=0 vspace=0 hspace=0 width=240 height=400 marginwidth=0'
+ ' marginheight=0 scrolling=no></iframe>');
//--></script>
<noscript>
<a href="http://ad.adriver.ru/cgi-bin/click.cgi?sid=137295&bn=1&bt=22&pz=0&rnd=1132854728" target=_blank>
<img src="http://ad.adriver.ru/cgi-bin/rle.cgi?sid=137295&bn=1&bt=22&pz=0&rnd=1132854728" alt="-AdRiver-" border=0 width=240 height=400></a>
</noscript>

<!--  AdRiver code END  --></td></tr>



<tr><td bgcolor=#008080><img src="../../../pictures/1x1.gif" width=1 height=1 border=0 alt=""></td></tr>
<tr><td bgcolor=#daecd7><img src="../../../pictures/1x1.gif" width=1 height=3 border=0 alt=""></td></tr>
<tr><td bgcolor=#ffffff>
<font size=2>
<p><b>Новости мира IT:</b>
<ul class=column>
<!--<b><a target=_blank href=http://citcity.ru/20070/>4&#x2013;5 декабря пройдёт &#xab;Платформа 2009&#xbb;</a></b>
<hr>-->

<li>06.02 - <a href=http://citforum.ru/news/33352/>В Почте и на портале Mail.Ru заработала двухфакторная аутентификация</a><li>06.02 - <a href=http://citforum.ru/news/33351/>Apple задумалась над созданием поисковой системы</a><li>06.02 - <a href=http://citforum.ru/news/33350/>IBM открыла первый центр предоставления услуг в России</a><li>06.02 - <a href=http://citforum.ru/news/33349/>Платформа Windows RT официально закрыта</a><li>06.02 - <a href=http://citforum.ru/news/33348/>Toshiba выпустила флеш-брелоки с шифрованием и клавиатурой для ввода пароля</a><li>06.02 - <a href=http://citforum.ru/news/33347/>Motorola бьёт рекорды продаж смартфонов после перехода в Lenovo</a><li>06.02 - <a href=http://citforum.ru/news/33346/>Buhel SoundGlasses: беспроводная гарнитура в солнцезащитных очках</a><li>06.02 - <a href=http://citforum.ru/news/33345/>Microsoft приобретет разработчика календарей для iOS и Android</a><li>05.02 - <a href=http://citforum.ru/news/33344/>Проведены первые операции через национальную систему платёжных карт</a><li>05.02 - <a href=http://citforum.ru/news/33343/>Рейтинг Rookies Award определил лучшие открытые проекты, созданные в 2014 году</a><li>05.02 - <a href=http://citforum.ru/news/33342/>OneBoard PRO+: механическая клавиатура со встроенным Android-компьютером</a><li>05.02 - <a href=http://citforum.ru/news/33341/>Проект FreeBSD переходит на новую модель поддержки релизов</a><li>05.02 - <a href=http://citforum.ru/news/33340/>IBM расширила штат инженеров, работающих над техпроцессами тоньше 7 нм</a><li>05.02 - <a href=http://citforum.ru/news/33339/>ARM представила 64-битное ядро Cortex-A72</a><li>05.02 - <a href=http://citforum.ru/news/33338/>Yota Devices заключила мировое соглашение в споре с PocketBook</a><li>05.02 - <a href=http://citforum.ru/news/33337/>На долю LTE-моделей впервые пришлось больше половины продаж смартфонов в России</a><li>04.02 - <a href=http://citforum.ru/news/33336/>Почта Mail.Ru предлагает пользователям убраться в ящике</a><li>04.02 - <a href=http://citforum.ru/news/33335/>Российский образовательный онлайн-проект привлек 2,1 миллиона долларов</a><li>04.02 - <a href=http://citforum.ru/news/33334/>&#xab;Яндекс&#xbb; внедрил двухфакторную аутентификацию</a><li>04.02 - <a href=http://citforum.ru/news/33333/>Sony продала подразделение видеоигр</a>

</ul>
<p><a target=_blank href=http://citforum.ru/news/><b>Архив новостей</b></a>
</font>
<p align=right><a href=http://citforum.ru/news/rss/news.xml><img src="../../../pictures/xml_rss.gif" border=0 width=36 height=14></a>
</td></tr>


<tr><td bgcolor=#008080><img src="../../../pictures/1x1.gif" width=1 height=1 border=0 alt=""></td></tr>
<tr><td bgcolor=#daecd7><img src="../../../pictures/1x1.gif" width=1 height=3 border=0 alt=""></td></tr>
<tr><td bgcolor=#008080><img src="../../../pictures/1x1.gif" width=1 height=1 border=0 alt=""></td></tr>
<tr><td style="padding-left: 5px; min-width: 240px"><p><b>Последние комментарии:</b>	<div class=comments_menu>
		<a href=http://citforum.ru/news/33329/#comments>Минкомсвязь предлагает перенести домены в компании-регистраторы в РФ</a>&nbsp;(12)<br>
		<div class=comments_menu_date>Суббота 07.02, 21:22		</div>
	</div>	<div class=comments_menu>
		<a href=http://citforum.ru/news/33352/#comments>В Почте и на портале Mail.Ru заработала двухфакторная аутентификация</a>&nbsp;(4)<br>
		<div class=comments_menu_date>Суббота 07.02, 09:08		</div>
	</div>	<div class=comments_menu>
		<a href=http://citforum.ru/news/33349/#comments>Платформа Windows RT официально закрыта</a>&nbsp;(4)<br>
		<div class=comments_menu_date>Суббота 07.02, 09:04		</div>
	</div>	<div class=comments_menu>
		<a href=http://citforum.ru/news/33307/#comments>В метро Петербурга запустили систему бесконтактных платежей PayPass</a>&nbsp;(13)<br>
		<div class=comments_menu_date>Суббота 07.02, 09:01		</div>
	</div>	<div class=comments_menu>
		<a href=http://citforum.ru/news/33313/#comments>Ideum Duet: кофейный столик с двумя встроенными компьютерами и двумя ОС</a>&nbsp;(7)<br>
		<div class=comments_menu_date>Пятница 06.02, 21:32		</div>
	</div>	<div class=comments_menu>
		<a href=http://citforum.ru/news/33346/#comments>Buhel SoundGlasses: беспроводная гарнитура в солнцезащитных очках</a>&nbsp;(2)<br>
		<div class=comments_menu_date>Пятница 06.02, 21:25		</div>
	</div>	<div class=comments_menu>
		<a href=http://citforum.ru/news/33347/#comments>Motorola бьёт рекорды продаж смартфонов после перехода в Lenovo</a>&nbsp;(1)<br>
		<div class=comments_menu_date>Пятница 06.02, 09:36		</div>
	</div>	<div class=comments_menu>
		<a href=http://citforum.ru/news/33306/#comments>Прибыль Microsoft упала на 11 %</a>&nbsp;(4)<br>
		<div class=comments_menu_date>Пятница 06.02, 09:20		</div>
	</div>	<div class=comments_menu>
		<a href=http://citforum.ru/news/32977/#comments>Новый &#xab;антипиратский&#xbb; закон вступит в силу 1 мая 2015 года</a>&nbsp;(35)<br>
		<div class=comments_menu_date>Пятница 06.02, 09:16		</div>
	</div>	<div class=comments_menu>
		<a href=http://citforum.ru/news/33328/#comments>МТС создаст отечественный аналог Skype</a>&nbsp;(5)<br>
		<div class=comments_menu_date>Пятница 06.02, 00:18		</div>
	</div></td></tr>

<tr><td bgcolor=#008080><img src="../../../pictures/1x1.gif" width=1 height=1 border=0 alt=""></td></tr>
<tr><td bgcolor=#daecd7><img src="../../../pictures/1x1.gif" width=1 height=3 border=0 alt=""></td></tr>
<tr><td bgcolor=#008080><img src="../../../pictures/1x1.gif" width=1 height=1 border=0 alt=""></td></tr>
<tr><td><div id="cse" style="width: 100%;">Loading</div>
<script src="http://www.google.com/jsapi" type="text/javascript"></script>
<script type="text/javascript"> 
  google.load('search', '1', {language : 'ru'});
  google.setOnLoadCallback(function() {
    var customSearchControl = new google.search.CustomSearchControl('018117224161927867877:xbac02ystjy');
    customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
    customSearchControl.draw('cse');
  }, true);
</script>
<link rel="stylesheet" href="http://www.google.com/cse/style/look/default.css" type="text/css" />
</td></tr>

<tr><td align="center"><!-- Soloway 240x400 code START-->
<script language="javascript" type="text/javascript"><!--
if(typeof(ar_cn)=="undefined") var ar_cn=1;
var ar_Tail=document.referrer ? escape(document.referrer) : 'unknown';
var ar_link="http://ad.adriver.ru/cgi-bin/erle.cgi?sid=126751&bt=49&target=blank&tail256=" + ar_Tail;
document.write('<div style="visibility:hidden;height:0px;"><iframe id="ar_container_'+ar_cn+'" width=1 height=1 marginwidth=0 marginheight=0 scrolling=no frameborder=0><\/iframe><\/div><div id="ad_ph_'+ar_cn+'"><\/div>');
function ar_getDoc(t,n,l){var doc;if(t<100){if(document.all && !window.opera){doc = window.frames['ar_container_'+n].document}
else if(document.getElementById){doc=document.getElementById('ar_container_'+n).contentDocument}
if(!doc){setTimeout('ar_getDoc('+(++t)+','+n+',"'+l+'")', 100)}else {var RndNum4NoCash = Math.round(Math.random() * 1000000000);
doc.write ('<sc'+'ript language="JavaScript" type="text/javascript">var ar_bnum='+n+';<\/sc'+'ript>');
doc.write ('<sc'+'ript language="JavaScript" type="text/javascript" src="'+l+'&rnd='+RndNum4NoCash+'"><\/sc'+'ript>');}}}
(function(num,link){function addEvent(e,t,f){if(e.addEventListener)e.addEventListener(t,f,false);else if(e.attachEvent)e.attachEvent('on'+t,f)}
function removeEvent(e,t,f){if(e.removeEventListener)e.removeEventListener(t,f,false);else if(e.detachEvent)e.detachEvent('on'+t,f)}
var BannerLoader={top:0,height:400,cm:document.compatMode=="CSS1Compat",
scroll:function(){var ch=self.innerHeight||this.cm&&document.documentElement.clientHeight||document.body.clientHeight;
var st=self.pageYOffset||this.cm&&document.documentElement.scrollTop||document.body.scrollTop;
var sh=self.scrollHeight||this.cm&&document.documentElement.scrollHeight||document.body.scrollHeight;
if((st-this.top<=this.height*0.2&&st+ch-this.top>=this.height*0.8)||(sh-this.top<=this.height*0.8&&(sh-st-ch<1||sh<ch))){
removeEvent(window,'scroll',this.sfunc);ar_getDoc(0,num,link)}},
sfunc: function(){BannerLoader.scroll()},init:function(){var t=this,obj=document.getElementById('ad_ph_'+num);
if(obj){while(obj.offsetParent){t.top += obj.offsetTop; obj = obj.offsetParent}
addEvent(window,'scroll',this.sfunc);t.scroll()}}};addEvent(window, 'load', function(){BannerLoader.init()})})(ar_cn++,ar_link);
//--></script>
<!-- Soloway 240x400 code END -->
</td></tr>

<tr><td align="center">
<font size="2"><a class=head href=http://forum.citforum.ru/>Форумы</a>
<a class=head href=http://citforum.ru/gazeta/>Газета</a></font>
</td></tr>
</table>

</td>
<td bgcolor=#daecd7><img src="../../../pictures/1x1.gif" width=2 height=1 border=0></td>
<td bgcolor=#008080><img src="../../../pictures/1x1.gif" width=1 height=1 border=0></td>
</tr></table>

</td>
 <!--no_right-->

</tr>
</table>
</td>

</tr></table>

<p>
<table   cellspacing=0 cellpadding=0 border=0 width=100%>
<tr><td bgcolor=#008080><img src="../../../pictures/1x1.gif" width=931 height=1 alt="" border=0></td></tr>
<tr><td bgcolor=#daecd7><img src="../../../pictures/1x1.gif" width=1 height=3 alt="" border=0></td></tr>
<tr><td bgcolor=#008080>

<table cellspacing=1 cellpadding=3 border=0 width=100%>
<tr>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/consulting/">IT-консалтинг</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/SE/">Software Engineering</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/programming/">Программирование</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/database/">СУБД</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/security/">Безопасность</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/internet/">Internet</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/nets/">Сети</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/operating_systems/">Операционные системы</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href="http://citforum.ru/hardware/">Hardware</a></font></td>
<!--
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href=/faq/>FAQ (ЧаВО)</a></font></td>
<td bgcolor=#F4F9F3 align=center><font size=-1><a class=head href=/howto/>HOWTO</a></font></td>
--> 
</tr>
</table>

</td></tr>
</table>

<p>

<table width=100%>
<tr><td>
<a href="http://citforum.ru/about/"><font size=2>Информация для рекламодателей</font></a> 
</td><td><font size=2>PR-акции, размещение рекламы &mdash; <a href="mailto:adv@citforum.ru">adv@citforum.ru</a>,
<br>тел. +7 495 6608306, ICQ 232284597</font>
</td><td align=right><font size=2>Пресс-релизы &mdash; <a href=mailto:pr@citforum.ru>pr@citforum.ru</a></font>
</td></tr></table>


<table cellspacing=0 cellpadding=0 border=0 width="100%"><tr><td><img src="../../../pictures/1x1.gif" width=1 height=5 border=0 alt=""></td></tr>
<tr><td bgcolor=#008080><img src="../../../pictures/1x1.gif" width=1 height=1 border=0 alt=""></td></tr>
<tr><td bgcolor=#daecd7><img src="../../../pictures/1x1.gif" width=1 height=3 border=0 alt=""></td></tr></table>

<table cellspacing=0 cellpadding=4 border=0 width=100%><tr>
<td><font size=2>
<a href=http://www.citforum.ru/feedback.php?page=/operating_systems/manpages/freebsd/VINUM.8.shtml&server=citforum.ru>Послать комментарий</a><br>
<a href="http://citforum.ru/how.shtml">Информация для авторов</a>

</font></td>

<td><a href=http://top100.rambler.ru/cgi-bin/stats_top100.cgi?13078><img src="../../../pictures/logos/banner-88x31-rambler-darkblue2.gif" width=88 height=31 border=0 alt="Rambler's Top100"></a></td>
<td><!--TopList LOGO--><a target=_top href="http://top.list.ru/jump?from=26978"><img src="http://top.list.ru/counter?id=26978;t=54;l=1" border=0 height=31 width=88 alt="TopList"></a><!--TopList LOGO--></td>
<td>
<!--LiveInternet logo--><a href="http://www.liveinternet.ru/click" target=_blank><img
src="http://counter.yadro.ru/logo?12.6" border=0
alt="liveinternet.ru: показано число просмотров за 24 часа, посетителей за 24 часа и за сегодня"
width=88 height=31></a><!--/LiveInternet-->
</td>

<td align=right valign=bottom><FONT SIZE=1 face="Arial, sans-serif">This Web server launched on February 24, 1997<br>
Copyright &copy; 1997-2000 CIT, &copy; 2001-2015 <a href="http://citforum.ru/info.shtml">CIT Forum</a></font></td>
</tr></table>

<table cellspacing=0 cellpadding=0 border=0 width=100%><tr><td bgcolor=#daecd7><img src="../../../pictures/1x1.gif" width=1 height=3 border=0 alt=""></td></tr><tr><td bgcolor=#008080><img src="../../../pictures/1x1.gif" width=1 height=1 border=0 alt=""></td></tr></table>
<table cellspacing=0 cellpadding=0 border=0 width=100%><tr><td align=center><font size=1 face="Arial, sans-serif"><b>Внимание!</b> Любой из материалов, опубликованных на этом сервере, не может быть  воспроизведен в какой бы то ни было форме и какими бы то ни было средствами без письменного разрешения владельцев авторских прав. <a href="http://citforum.ru/copyright.shtml">Подробнее...</a></td></tr></table>


</table></center>


<!-- AdGravity Javascript code START-->
<script language="javascript" type="text/javascript"><!--
var RndNum4NoCash = Math.round(Math.random() * 1000000000);
var ar_Tail='unknown'; if (document.referrer) ar_Tail = escape(document.referrer);
document.write('<sc' + 'ript language="JavaScript" src="http://ad.adriver.ru/cgi-bin/erle.cgi?sid=126751&bt=16&target=blank&tail256="' + ar_Tail + '"></sc' + 'ript>');
//--></script>
<!-- AdGravity Javascript code END -->



</body>
<html>


