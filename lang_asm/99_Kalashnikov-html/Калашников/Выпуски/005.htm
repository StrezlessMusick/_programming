<HTML><HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<TITLE>Калашников.ru - Ассемблер? Это просто!.. (Выпуск № 005)</TITLE>
</HEAD><BODY BGCOLOR=#EBD2A5 link=#660000 alink=#000000 vlink=#000000 text=#000000>

<P align=center><A 
href="http://ad.ir.ru/bb.cgi?cmd=go&pubid=128269&pg=2&vbn=10001&nocache=77524" 
target=_top><IMG alt="InterReklama " border=0 
src="http://ad.ir.ru/bb.cgi?cmd=ad&pubid=128269&pg=2&vbn=10001&nocache=77524"></A></P>
<P align=center><A href="http://www.ir.ru" target=_top><FONT size=1>InterReklama 
Advertising</FONT></A> </P>
<HR>

<table border="1" cellspacing="0" width="100%" bgcolor="#D2E8F2">
 <tr>
 <td><div align="center"><center><table border="3"
 width="100%" bgcolor="#C0C0C0">
 <tr>
 <td align="center"><p align="center"><font
 color="#000080" size="5"><em><strong>Здравствуйте,
 уважаемые любители
 Ассемблера!</strong></em></font></p>
 <hr>
 <p align="center"><font color="#000080" size="4"><em><strong>Выпуск
 N 005.</strong></em></font></p>
 </td>
 </tr>
 </table>
 </center></div><p align="left"><font color="#0000A0"
 size="5"><strong>Сегодня у нас:</strong></font></p>
 <p><font size="4"><strong>План рассылки:</strong></font></p>
 <ul>
 <li><a href="#letters"><em>Ваши письма</em></a></li>
 <li><a href="#site"><em>Смена сайта</em></a></li>
 <li><a href="#suggest"><em>Ваши предложения
 по ведению рассылки</em></a></li>
 <li><a href="#theory"><em>Немного теории</em></a></li>
 <li><a href="#operators"><em>Новые
 операторы</em></a></li>
 <li><a href="#practice"><em>Программка
 для практики</em></a></li>
 </ul>
 <hr>
 <p align="center"><a name="letters"><font size="5"><em><strong>Ваши
 письма</strong></em></font></a></p>
 <p>Дорогие мои! На прошлой
 неделе я получил от Вас
 огромное количество писем.
 Ответил всем, кто мне присылал.
 Как я уже говорил, кто не
 получил ответ, <a
 href="mailto:oleg77@online.ru?Subject=Повтор:">напишите</a>
 еще раз, т.к. мой ящик был
 частенько перегружен. Очень
 многие просили выслать
 предыдущие выпуски, которые
 занимают 100 Кб.</p>
 <p>Также поступало много
 вопросов по поводу
 возникновения ошибок в
 программах, либо в ассемблере и
 компоновщике. Я старался
 отвечать как можно быстрее,
 понимая, что всем вам не терпелось быстрее научится
 &quot;топтать кнопки&quot;.</p>
 <p>Пожалуйста, указывайте в
 письме, если вы хотите, чтобы
 Ваше полное имя с e-mail было
 опубликовано.</p>
 <p>Возникло несколько заморочек
 с моим сайтом. Все исправил.
 Прошу прощения за причиненные
 неудобства.</p>
 <p>Многие уже довольно-таки
 хорошо освоили Ассемблер из
 моих предыдущих выпусков, чем
 меня порадовали своими
 собственными программами
 (особенно АНДРЕЙ, Дмитрий).</p>
 <p>Очень порадовал меня Дмитрий
 Лазебник, который предложил
 вариант оформления рассылок.
 Очень здорово у него все
 получилось. Думаю, что я помещу
 это вариант на сайт к себе (с
 разрешения Дмитрия).</p>
 <p>Есть еще несколько вопросов
 по поводу отладчика CodeView. Дело
 в том, что для полноценной
 работы CV недостаточно одного
 файла cv.exe. Нужно иметь еще
 несколько дополнительных
 библиотек, которые в 2 раза
 больше cv.exe. Подписчик <em>Eugene</em>
 выслал мне по e-mail TASM 3.01 и AFD, о
 котором я писал в первом
 выпуске рассылки. AFD, конечно,
 не очень актуален в настоящий
 момент по следующим причинам:</p>
 <ul>
 <li><em>не поддерживает 32-х
 разрядные регистры;</em></li>
 <li><em>не распознает формат PE и
 NE (Windows).</em></li>
 </ul>
 <p>Зато у него есть
 преимущества:</p>
 <ul>
 <li><em>удобен и прост в
 использовании;</em></li>
 <li><em>показывает в одном окне
 регистры, код, память и др.</em></li>
 </ul>
 <p>Для изучения работы программ
 в DOS его больше чем достаточно.
 Спасибо, <em>Eugene</em>!</p>
 <p>В прежние времена я работал
 только с AFD. Затем, к моему
 сожалению, его потерял. Теперь
 AFD можно взять на <a
 href="http://asm.kalashnikoff.ru/prog"><font
 color="#0000FF">сайте</font></a>
 (прибл. 64 Кб). Николай помог
 заархивировать этот файл, в
 результате чего его размер
 уменьшился почти в два раза!</p>
 <p>Спасибо всем, кто помог мне
 справиться с текущими
 проблемами!</p>
 <p>Пришло несколько пожеланий
 сменить фон рассылки, т.к. на ч/б
 принтере плохо видны символы.
 Я, как видите, сделал фон
 посветлее по вашим просьбам.</p>
 <p><em>Андрей Литвиенко</em>
 предложил алгоритм по переводу
 двоичных чисел в десятичные и
 наоборот:</p>
 <p>Вот таблица в помощь:</p>
 <div align="center"><center><table border="1" width="80%">
 <tr>
 <td align="center">128</td>
 <td align="center">64</td>
 <td align="center">32</td>
 <td align="center">16</td>
 <td align="center">8</td>
 <td align="center">4</td>
 <td align="center">2</td>
 <td align="center">1</td>
 </tr>
 <tr>
 <td align="center">0</td>
 <td align="center">0</td>
 <td align="center">0</td>
 <td align="center">1</td>
 <td align="center">0</td>
 <td align="center">1</td>
 <td align="center">0</td>
 <td align="center">0</td>
 </tr>
 </table>
 </center></div><p>В верхнем столбике
 вписываем разряды, а в нижнем -
 биты.</p>
 <p>Теперь просто складываем:</p>
 <p>128*0 + 64*0 + 32*0 + 16*1 + 8*0 + 4*1 + 2*0 + 1*0 =
 20</p>
 <p>или еще проще:</p>
 <p>0+0+0+16+0+4+0+0 = 20</p>
 <p><em><strong>Спасибо Андрею!</strong></em></p>
 <p><em>Gregory</em> спрашивал, каким
 ассемблером лучше
 пользоваться: <em>Borland</em> (TASM) или <em>Microsoft</em>
 (MASM). Под DOS я всегда писал
 программы используя MASM 5.10,
 которым был очень доволен. В
 принципе, большой разницы
 между MASM и TASM на данный момент
 нет. Но, на мой взгляд, под Win9x
 лучше использовать TASM32.</p>
 <p><em>Igor Korot</em> указал не
 неточность в программе из
 прошлого выпуска. 0B800h - сегмент
 видеобуфера цветного дисплея
 (CGA, EGA, VGA, sVGA), но не монохромного
 (у него 0A000h, кажется).</p>
 <p align="center">__________</p>
 <p>Для тех, кто мало знаком с HTML.
 Для того, чтобы было легче
 рассортировать ваши письма,
 отправляйте, пожалуйста,
 письмо с того места, с которого
 я вас прошу отправить. Если вы,
 например, наведете курсор
 &quot;мыши&quot; на слово &quot;от
 сюда&quot; из следующего абзаца,
 то увидите внизу экрана
 надпись:
 mailto:oleg77@online.ru?Subject=Разместить
 мой e-mail</p>
 <p>Когда мне придет письмо, то в
 поле &quot;Тема:&quot; уже будет
 указано то, что размещается
 после знака &quot;=&quot;.</p>
 <p align="center">__________</p>
 <p>Энергичный и веселый парень
 Сергей (<a href="mailto:sergey@email.orgus.ru">sergey@email.orgus.ru</a>),
 с которым у меня завязалась
 небольшая переписка, предложил
 такой вариант:</p>
 <p>пусть подписчики (кто
 захочет) помещают свои e-mail в
 рассылку для того, чтобы они
 (т.е. вы) могли обмениваться
 опытом. В связи с чем, очень
 просил меня поместить его
 адрес в этой рассылке, что я и
 делаю. Если вы также захотите,
 чтобы ваш адрес был доступен
 всем подписчикам, то пришлите
 мне письмо именно <a
 href="mailto:oleg77@online.ru?Subject=Разместить мой e-mail">от
 сюда</a> (в теле письма укажите
 ваш адрес).</p>
 <p>Есть еще вариант. <a
 href="http://www.newmail.ru">Newmail.ru</a>
 любезно предоставил мне
 возможность открыть
 собственный форум и чат. Форум
 в настоящий момент создается, и
 вы скоро (через 1-2 дня) сможете
 его посетить. Адрес форума
 будет на моем сайте. Можно
 также открыть чат по <a
 href="mailto:oleg77@online.ru?Subject=Чат">вашим
 просьбам</a>. Я там также буду
 появляться.</p>
 <hr>
 <p align="center"><a name="site"><font size="5"><strong>Смена
 сайта</strong></font></a></p>
 <p align="left"><font size="3">Уважаемые
 подписчики! 27 июля 2000 года у
 меня изменился адрес сайта.
 Дело в том, что Narod.ru отказал мне
 в предоставлении дальнейших
 услуг в связи с тем, что я
 разместил на своем сайте Turbo
 Assembler. Дорогие мои! Я хотел,
 чтобы у вас все было под рукой,
 чтобы вы не бегали на рынок и не
 искали там необходимые
 программы. С вашего разрешения
 я опубликовываю завязавшуюся
 между мной и г-ном Dilevsky
 переписку на прошлой неделе
 (стиль письма и орфография
 сохранены. Некоторые фразы
 вырезаны мной в целях экономии
 места, но суть от этого не
 меняется. E-mail г-на Dilevsky на
 всякий случай удален).</font></p>
 <p><font size="1" face="Arial Cyr"><b>От: </b>Alexander
 Dilevsky</font></p>
 <p><font size="1" face="Arial Cyr"><b>Дата: </b>24
 июля 2000 г. 18:45<br>
 </font><font color="#0000FF" size="1" face="Arial Cyr">Hello
 Oleg!</font></p>
 <p><font color="#0000FF" size="1" face="Arial Cyr">На
 вашем сайте наблюдаются
 некоторые ашипки: команда push imm
 работает только на процессорах
 80286 и выше (ну, может еще на 186).
 Поэтому push 0B800h может и не
 сработать.</font></p>
 <p><font color="#0000FF" size="1" face="Arial Cyr">Компьютер
 обычно вешается комбинацией cli
 hlt. На один байт короче
 получается :) И под форточками
 это обычно не работает, ибо кто
 ж даст пользовательской
 программе запретить все
 прерывания..</font></p>
 <p><font color="#0000FF" size="1" face="Arial Cyr">И
 уберите, пожалуйста, со своего
 сайта tasm. Я что-то не слышал,
 чтобы его выпускали в
 бесплатное пользование.</font></p>
 <p><font color="#0000FF" size="1" face="Arial Cyr">Alexander
 Dilevsky<br>
 narod.ru system administrator</font><font size="1"
 face="Arial Cyr"><br>
 </font></p>
 <p><font size="1" face="Arial Cyr"><b>From:</b>
 Калашников Олег [mailto:oleg77@online.ru]<br>
 <b>Sent:</b> Thursday, July 27, 2000 3:43 PM<br>
 </font><font color="#000080" size="1" face="Arial Cyr">Здравствуйте,
 Александр!</font><font size="1" face="Arial Cyr">
 </font></p>
 <p><font color="#000080" size="1" face="Arial Cyr">Во-первых,
 сайт предназначен для моих
 подписчиков, и я поместил на
 нем информацию, которая
 необходимо им прежде всего.
 Никакой рекламы своего сайта я
 не давал, за исключением
 рассылки.</font><font size="1" face="Arial Cyr"> </font></p>
 <p><font color="#000080" size="1" face="Arial Cyr">Далее.
 Комбинация</font><font size="1"
 face="Arial Cyr"> </font><font color="#000080" size="1"
 face="Arial Cyr">cli</font><font size="1"
 face="Arial Cyr"> </font><font color="#000080" size="1"
 face="Arial Cyr">hlt</font><font size="1"
 face="Arial Cyr"> </font><font color="#000080" size="1"
 face="Arial Cyr">очень четко
 контролируется Win. В случае
 выполнения данных строк Win
 сообщает, что программа
 выполнила некорректную
 операцию, но сам Win не виснет!</font><font
 size="1" face="Arial Cyr"> </font></p>
 <p><font color="#000080" size="1" face="Arial Cyr">В
 моем примере</font><font size="1"
 face="Arial Cyr"> </font><font color="#000080" size="1"
 face="Arial Cyr">cli</font><font size="1"
 face="Arial Cyr"> </font><font color="#000080" size="1"
 face="Arial Cyr">jmp $</font><font size="1"
 face="Arial Cyr"> </font><font color="#000080" size="1"
 face="Arial Cyr">вешается не только DOS,
 но и Win9x.</font><font size="1" face="Arial Cyr"> </font><font
 color="#000080" size="1" face="Arial Cyr">Если Вы
 не в курсе, то хотя бы
 проверили, прежде чем писать...</font><font
 size="1" face="Arial Cyr"> </font></p>
 <p><font color="#000080" size="1" face="Arial Cyr">Tasm
 я убирать не собираюсь. Кто Вам
 сказал, что у меня нет
 соответствующей лицензии
 (разрешения) на размещение его
 на сайте?</font><font size="1" face="Arial Cyr"> </font></p>
 <p><font color="#000080" size="1" face="Arial Cyr">Счастливо!</font><font
 size="1" face="Arial Cyr"> </font></p>
 <p><font size="1" face="Arial Cyr"><b>От: </b>Alexander
 Dilevsky </font></p>
 <p><font size="1" face="Arial Cyr"><b>Дата: </b>27
 июля 2000 г. 8:17<br>
 </font><font color="#0000FF" size="1" face="Arial Cyr">Будьте
 добры, пришлите мне хотя бы
 текст документа, разрешающего
 выкладывать tasm на сайт,
 позволяющий скачивать его всем
 желающим... Лучше, конечно,
 копию этого документа.
 Насколько мне известно,
 компания Borland... не позволяла
 его бесплатного
 распространения... </font></p>
 <p><font size="1" face="Arial Cyr"><b>From:</b>
 Калашников Олег [mailto:oleg77@online.ru]<br>
 <b>Sent:</b> Thursday, July 27, 2000 7:19 PM<br>
 </font><font color="#000080" size="1" face="Arial Cyr">Уважаемый
 Alexander Dilevsky!</font><font size="1" face="Arial Cyr">
 </font></p>
 <p><font color="#000080" size="1" face="Arial Cyr">Я
 не обязан высылать такую
 информацию всем подряд. Тем
 более, что у меня нет ни
 времени, ни желания возиться с
 данным документом..., чтобы
 удовлетворить Ваше
 любопытство.</font><font size="1"
 face="Arial Cyr"> </font><font color="#000080" size="1"
 face="Arial Cyr">Я предъявлю его <b><u>только</u></b>
 уполномоченным на то лицам и по
 их <b><u>официальному</u></b>
 требованию.</font><font size="1"
 face="Arial Cyr">..</font></p>
 <p><font size="1" face="Arial Cyr"><b>От: </b>Alexander
 Dilevsky<br>
 <b>Дата: </b>27 июля 2000 г. 12:46<br>
 </font><font color="#0000FF" size="1" face="Arial Cyr">Как
 системный администратор
 сервера narod.ru я все-таки попрошу
 вас прислать мне этот документ
 либо удалить с вашего сайта Turbo
 Assembler. В противном случае мы
 будем считать, что вы нарушаете
 права компании Inprice Corporation и
 пункт 5.3.5 Пользовательского
 Соглашения, что приведет к
 удалению вашего сайта. </font></p>
 <p><font color="#0000FF" size="1" face="Arial Cyr">В
 письме, полученном из Inprise
 Corporation, утверждается, что Turbo
 Assembler не является свободно
 распространяемым продуктом и
 размещение его на вашем сайте
 нарушает лицензионное
 соглашение Inprise/Borland.</font><font
 size="1" face="Arial Cyr"> </font></p>
 <p><font color="#0000FF" size="1" face="Arial Cyr">Alexander
 Dilevsky</font></p>
 <p><font size="1" face="Arial Cyr"><b>From:</b>
 Калашников Олег [mailto:oleg77@online.ru]<br>
 <b>Sent:</b> Thursday, July 27, 2000 7:39 PM<br>
 </font><font color="#000080" size="1" face="Arial Cyr">Уважаемый
 Alexander Dilevsky!</font><font size="1" face="Arial Cyr">
 </font></p>
 <p><font color="#000080" size="1" face="Arial Cyr">В
 таком случае, прошу Вас выслать
 мне письмо, полученное от
 компании Inprise Corporation, в котором
 говорится о том, что мне не дано
 право помещать на сайт Narod.ru TASM.</font><font
 size="1" face="Arial Cyr"> </font></p>
 <p><font color="#000080" size="1" face="Arial Cyr">По
 данному письму я должен <u>точно
 установить</u>, что оно получено
 от указанной выше компании, а
 не напечатано каким-либо лицом,
 не имеющим отношения к Inprise
 Corporation.</font><font size="1" face="Arial Cyr"> </font></p>
 <p><font color="#000080" size="1" face="Arial Cyr">Более
 того, мне необходимо
 удостовериться в том, что Вы <u>действительно</u>
 являетесь системным
 администратором сайта Narod.ru.
 Каким образом будет это
 доказано - меня не интересует.</font><font
 size="1" face="Arial Cyr"> </font></p>
 <p><font color="#000080" size="1" face="Arial Cyr">В
 противном случае, никаких
 ответных писем Вам выслано не
 будет.</font><font size="1" face="Arial Cyr"> </font></p>
 <p><font color="#000080" size="1" face="Arial Cyr">С
 уважением,</font><font size="1" face="Arial Cyr">
 </font></p>
 <p><font color="#000080" size="1" face="Arial Cyr">_____________________________<br>
 Калашников Олег Александрович<br>
 Контракт-менеджер<br>
 ФПС &quot;БИН&quot;</font></p>
 <p><font size="2">В ответ уважаемый г-н
 Dilevsky выслал мне письмо, в
 котором говориться о том, что
 Borland не разрешала размещать на
 сайтах свои продукты. </font></p>
 <p>Вот так у нас всегда, друзья
 мои: борются не с причиной, а со
 следствием. То, что можно
 купить любое программное
 обеспечение за полтинник на
 Митинском рынке или на
 Горбушке, это никого не
 интересует. TASM же, размещенный
 на моем сайте, очень сильно
 взволновал г-на Dilevsky, за что
 сайт был ликвидирован с
 сервера Narod.ru.</p>
 <p>Да, моя вина в том, что я не
 выслал документ, разрешающий
 размещать на сайте TASM. Но, как
 говорится, не бывает худа без
 добра. Я перешел на новый
 сервер <a href="http://www.newmail.ru"><font
 color="#0000FF">NEWMAIL.RU</font></a>, что и
 предлагали мне сделать многие
 подписчики, т.к. связь с
 &quot;Народом&quot; не совсем
 качественная (по крайней мере,
 мне приходилось перекачивать
 для проверки со своего сайта TASM
 по 2-3 раза, т.к. он приходил
 &quot;битый&quot;, о чем я
 предупреждал вас в прошлом
 выпуске. Многие из вас также
 жаловались на плохую связь,
 предлагая мне перейти на newmail).
 Теперь проблема решена. Более
 того, NEWMAIL не требует никаких
 документальных подтверждений
 программных продуктов,
 размещенных на их сервере.</p>
 <p><font size="4">Новый адрес моего
 сайта: </font><a href="http://www.Kalashnikoff.ru"><font
 color="#0000FF" size="4">www.Kalashnikoff.ru</font></a><font
 size="4"> </font></p>
 <hr>
 <p align="center"><a name="suggest"><font size="5"><strong>Ваши
 предложения по ведению
 рассылки</strong></font></a></p>
 <p>В прошлом выпуске я попросил
 вас прислать свои предложения
 по поводу того, какую программу
 вы бы хотели писать,
 параллельно изучая Ассемблер.
 Вот какие варианты были
 предложены (если Вы хотите
 проголосовать, то нажмите в
 соответствующей строке кнопку
 &quot;мыши&quot;; в теле письма
 желательно ничего не укаывать
 совсем, т.к. может не выдержать
 мой ящик):</p>
 <ul>
 <li>графическая игра или
 просто работа с графикой (<a
 href="mailto:oleg77@online.ru?Subject=Графическая игра">жмите
 здесь</a>);</li>
 <li>просто Тетрис (<a
 href="mailto:oleg77@online.ru?Subject=Тетрис">жмите
 здесь</a>);</li>
 <li>безобидный вирус (<a
 href="mailto:oleg77@online.ru?Subject=Вирус">жмите
 здесь</a>);</li>
 <li>оболочка типа Norton Commander (<a
 href="mailto:oleg77@online.ru?Subject=Типа Нортона">жмите
 здесь</a>);</li>
 <li>программа, производящая
 сложные арифметические
 операции (типа sin, cos и т.п.) (<a
 href="mailto:oleg77@online.ru?Subject=Математика">жмите
 здесь</a>);</li>
 <li>дизассемблер (<a
 href="mailto:oleg77@online.ru?Subject=Дизассемблер">жмите
 здесь</a>);</li>
 <li>рассмотреть работу
 регистров процессоров 486
 или Pentium (<a
 href="mailto:oleg77@online.ru?Subject=Работа и регистры 486">жмите
 здесь</a>);</li>
 <li>графическая заставка с
 музыкой (<a
 href="mailto:oleg77@online.ru?Subject=Заставка с музыкой">жмите
 здесь</a>);</li>
 <li>viewer для просмотра
 графических картинок JPEG (<a
 href="mailto:oleg77@online.ru?Subject=Просмотр картинок JPEG">жмите
 здесь</a>);</li>
 <li>какую-нибудь резидентную
 (постоянно находящуюся в
 памяти) программу (<a
 href="mailto:oleg77@online.ru?Subject=Резидент">жмите
 здесь</a>);</li>
 <li>программировать адаптеры
 локальной сети (<a
 href="mailto:oleg77@online.ru?Subject=Локальная сеть">жмите
 здесь</a>);</li>
 <li>текстовый редактор (<a
 href="mailto:oleg77@online.ru?Subject=Текстовый редактор">жмите
 здесь</a>);</li>
 <li>калькулятор как в DOS-Navigator'е
 (<a
 href="mailto:oleg77@online.ru?Subject=Калькулятор">жмите
 здесь</a>).</li>
 </ul>
 <p><em>Некоторые пояснения.</em></p>
 <p>На Ассемблере очень сложно
 написать графическую игру. Для
 этого обычно используются
 специальные графические
 программы, в которых рисуются
 изображения людей, деревьев,
 дорог и пр. А на Ассемблере (и то
 не всегда) пишется только ядро,
 которое управляет графикой.</p>
 <p>Дизассемблер тоже не так-то
 просто написать, хотя вполне
 реально. Для этого нужно будет
 изучить формирование
 машинного кода в компьютере, а
 это довольно большой курс.</p>
 <p>Viewer для просмотра графики
 можно сделать, если кто-нибудь
 пришлет формат того или иного
 файла (jpg, bmp и т.п.). Я, к
 сожалению, этим никогда не
 занимался...</p>
 <p>Голосуйте, друзья мои! Ваши
 письма принимаются до выхода
 следующего выпуска. Жду с
 нетерпением!</p>
 <hr>
 <p align="center"><a name="theory"><font size="5"><strong>Немного
 теории</strong></font></a></p>
 <p>Я получил много писем с таким
 вопросом:</p>
 <p>TASM выдает ошибку: Near jump or call to
 different CS.</p>
 <p>Я предложил вставить строку
 assume cs:CSEG. Что же происходит?</p>
 <p>Дело в том, что эта строка
 указывает Ассемблеру на
 привязку сегментного регистра
 CS к нашему сегменту (CSEG). MASM
 ассемблирует прекрасно и без
 этой строки. Если оператор assume
 отсутствует, то MASM как бы по
 умолчанию вставляет ее
 автоматически.</p>
 <p>Другое дело TASM. Он, встретив в
 программе строки вида:</p>
 <p>loop Label_1</p>
 <p>jmp Label_2</p>
 <p>call Procedure</p>
 <p>не может &quot;понять&quot; к
 какому сегменту следует
 обратиться (CS, DS, ES) и выдает
 сообщение об ошибке.</p>
 <p>Как уже говорилось, мы пишем
 com-файлы в которых всего один
 сегмент (мы обзываем его CSEG).
 Если вы создадите еще один
 (например, DSEG), то компоновщик
 (link.exe), при попытке создать
 com-файл, выдаст ошибку.</p>
 <p>Чтобы полностью закрыть
 данную тему, привожу полный вид
 разбираемой нами строки:</p>
 <p>assume cs:CSEG, ds:CSEG, es:CSEG, ss:CSEG</p>
 <p>Этим мы указываем Ассемблеру
 на то, что сегментные регистры
 CS, DS, ES, SS будут указывать на наш
 единственный сегмент.</p>
 <hr>
 <p align="center"><a name="operators"><font size="5"><strong>Новые
 операторы</strong></font></a></p>
 <p align="left">Сегодня рассмотрим
 всего один оператор, но зато
 какой!</p>
 <div align="left"><table border="1">
 <tr>
 <td bgcolor="#4481DB"><p align="center">Команда</p>
 </td>
 <td bgcolor="#4481DB"><p align="center">Перевод
 (с англ.)</p>
 </td>
 <td bgcolor="#4481DB"><p align="center">Назначение</p>
 </td>
 <td bgcolor="#4481DB"><p align="center">Процессор</p>
 </td>
 </tr>
 <tr>
 <td>CALL метка</td>
 <td>call - вызов</td>
 <td>Вызов подпрограммы</td>
 <td>8086</td>
 </tr>
 </table>
 </div><p align="left"><font size="3">Итак, вы
 уже немного знакомы из </font><a
 href="http://www.subscribe.ru/archive/comp.prog.assembler"><font
 color="#0000FF" size="3">предыдущих
 выпусков</font></a><font size="3"> с
 подпрограммами.</font></p>
 <p align="left"><font size="3">Допустим, нам
 необходимо написать программу,
 которая выводит на экран
 сообщение</font></p>
 <p align="left"><font size="3"><em>Нажмите
 любую клавишу...</em></font></p>
 <p align="left"><font size="3">ждет нажатия
 клавиши, а затем выводит еще
 одно сообщение:</font></p>
 <p align="left"><font size="3"><em>Вы успешно
 нажали клавишу!</em></font></p>
 <p align="left"><font size="3">ждет от
 пользователя клавишу и
 завершается.</font></p>
 <p align="left">Что нужно для этого?
 Вызвать два раза функцию 09h
 прерывания 21h и столько же
 функцию 10h прерывания 16h (вы это
 уже прекрасно знаете).</p>
 <p align="left">Вот так:</p>
 <p align="left">...</p>
 <p align="left">(1) mov ah,9</p>
 <p align="left">(2) mov dx,offset Mess1</p>
 <p align="left">(3) int 21h</p>
 <p align="left">(4) mov ah,10h</p>
 <p align="left">(5) int 16h</p>
 <p align="left">(6) mov ah,9</p>
 <p align="left">(7) mov dx,offset Mess2</p>
 <p align="left">(8) int 21h</p>
 <p align="left">(9) mov ah,10h</p>
 <p align="left">(10) int 16h</p>
 <p align="left">(11) int 20h</p>
 <p align="left">...</p>
 <p align="left">(12) Mess1 db 'Нажмите любую
 клавишу...$'</p>
 <p align="left">(13) Mess2 db 'Вы успешно
 нажали клавишу!$'</p>
 <p align="left">...</p>
 <p align="left">Там, где стоит
 многоточие, опущен код
 программы. Я буду часто так
 делать для того, чтобы
 постоянно не печатать
 операторы, тем самым занимая
 место в рассылке. Я думаю, вы
 без труда разберете, какие
 команды необходимо вставить...</p>
 <p align="left">Смотрим дальше. Строки
 (1) - (3) и (6) - (8) выводят строку.
 Они очень похожи, за
 исключением загрузки в DX
 разных строк.</p>
 <p align="left">Строки же (4) - (5) и (9) - (10)
 полностью идентичны.
 Получается, что мы теряем
 байты...</p>
 <p align="left">Чтобы упростить
 программу и, тем самым,
 уменьшить ее размер,
 воспользуемся оператором CALL
 (создадим подпрограммы). Вот
 что у нас получится:</p>
 <p align="left">...</p>
 <p align="left">(1) mov dx,offset Mess1</p>
 <p align="left">(2) call Out_string</p>
 <p align="left">(3) call Wait_key</p>
 <p align="left">(4) mov dx,offset Mess2</p>
 <p align="left">(5) call Out_string</p>
 <p align="left">(6) call Wait_key</p>
 <p align="left">(7) int 20h</p>
 <p align="left">(8) Out_string proc</p>
 <p align="left">(9) mov ah,9</p>
 <p align="left">(10) int 21h</p>
 <p align="left">(11) ret</p>
 <p align="left">(12) Out_string endp</p>
 <p align="left">(13) Wait_key proc</p>
 <p align="left">(14) mov ah,10h</p>
 <p align="left">(15) int 16h</p>
 <p align="left">(16) ret</p>
 <p align="left">(17) Wait_key endp</p>
 <p align="left"><font size="3">(18) </font>Mess1 db
 'Нажмите любую клавишу...$'</p>
 <p align="left">(19) Mess2 db 'Вы успешно
 нажали клавишу!$'</p>
 <p align="left"><font size="3">...</font></p>
 <p align="left"><font size="3">Длиннее получилось... Не обращайте на
 это пока внимания.
 Подпрограммы используются в
 более сложных программах. Наш
 же вариант представлен для
 изучения.</font></p>
 <p align="left"><font size="3">Итак, что
 здесь происходит? Думаю, что
 многие уже догадались. Однако,
 нужны некоторые пояснения.</font></p>
 <p align="left"><font size="3"><strong>Минутка
 внимания!</strong> В строке (1)
 загружаем в DX адрес строки Mess1.
 В строке (2) вызываем
 подпрограмму, которую мы
 назвали Out_string. Что делает
 компьютер? Он запоминает адрес
 (смещение) следующей команды
 (строка (3)) и переходит на метку
 Out_string (строка (8)). DX при этом не
 меняется (т.е. в нем сохраняется
 адрес строки Mess1)! В строках (9) -
 (10) используем функцию 09h
 прерывания 21h для вывода строки
 на экран. В строке (11) компьютер
 берет запомненный адрес и
 переходит на него (в данном
 случае на строку (3)) (ret - return -
 возврат). ВСЕ! Процедура
 отработала!</font></p>
 <p align="left"><font size="3">У вас,
 вероятно, появился вопрос: А
 где это, интересно, компьютер
 запоминает куда нужно
 возвращаться???</font></p>
 <p align="left"><font size="3">Отвечу
 вкратце, т.к. эта тема достойна
 отдельного выпуска. Есть такая
 область памяти. Называется <strong>стек</strong>
 (stack). Вот именно туда и
 &quot;ложится&quot; адрес для
 возврата из подпрограммы. В
 следующем выпуске мы подробно
 рассмотрим стек, сегмент стека,
 а также регистры SS и SP, которые
 отвечают за стек.</font></p>
 <p align="left"><font size="3">Надеюсь, что
 разобраться в дальнейшей
 работе программы (начиная со
 строки (3)) не составит труда.
 Все ведь очень просто!</font></p>
 <p align="left"><font size="3">Обратите
 внимание на оформление
 процедуры:</font></p>
 <p align="left"><font size="3">______________</font></p>
 <p align="left"><font size="3">Out_string proc</font></p>
 <p align="left"><font size="3">Out_string endp</font></p>
 <p align="left"><font size="3">______________</font></p>
 <p align="left"><font size="3">Out_string -
 название процедуры</font></p>
 <p align="left"><font size="3">Proc - <strong>proc</strong>edure
 - процедура</font></p>
 <p align="left"><font size="3">endp - <strong>end p</strong>rocedure
 - конец процедуры</font></p>
 <p align="left"><font size="3">Стоит еще
 отметить, что из одной
 подпрограммы можно вызывать
 другие. Из других - третьи.
 Главное правило - не запутаться
 в возвратах, иначе компьютер
 просто виснет! Внимательно
 следить за работой подпрограмм
 позволяет отладчик.</font></p>
 <hr>
 <p align="center"><a name="practice"><font size="5"><strong>Программка
 для практики</strong></font></a></p>
 <p align="left"><font size="3">Хотите
 увидеть всю мощь Ассемблера?</font></p>
 <p align="left"><font size="3">Давайте
 усовершенствуем программу с </font><a
 href="http://www.Kalashnikoff.ru/Assembler/Programs/Less004.asm"><font
 size="3">предыдущего выпуска</font></a><font
 size="3">.</font></p>
 <p align="left"><font size="3">(1) CSEG segment</font></p>
 <p align="left"><font size="3">(2) assume CS:CSEG,
 DS:CSEG, ES:CSEG, SS:CSEG</font></p>
 <p align="left"><font size="3">(3) org 100h</font></p>
 <p align="left"><font size="3">(4) Start:</font></p>
 <p align="left"><font size="3">(5) mov ax,0B800h</font></p>
 <p align="left"><font size="3">(6) mov es,ax</font></p>
 <p align="left"><font size="3">(7) mov al,1</font></p>
 <p align="left"><font size="3">(8) mov ah,31</font></p>
 <p align="left"><font size="3">(9) mov cx,254</font></p>
 <p align="left"><font size="3">(10) Next_screen:</font></p>
 <p align="left"><font size="3">(11) mov di,0</font></p>
 <p align="left"><font size="3">(12) call Out_chars</font></p>
 <p align="left"><font size="3">(13) inc al</font></p>
 <p align="left"><font size="3">(14) loop Next_screen</font></p>
 <p align="left"><font size="3">(15) mov ah,10h</font></p>
 <p align="left"><font size="3">(16) int 16h</font></p>
 <p align="left"><font size="3">(17) int 20h</font></p>
 <p align="left"><font size="3">(18) Out_chars proc</font></p>
 <p align="left"><font size="3">(19) mov dx,cx</font></p>
 <p align="left"><font size="3">(20) mov cx,2000</font></p>
 <p align="left"><font size="3">(21) Next_face:</font></p>
 <p align="left"><font size="3">(22) mov es:[di],ax</font></p>
 <p align="left"><font size="3">(23) add di,2</font></p>
 <p align="left"><font size="3">(24) loop Next_face</font></p>
 <p align="left"><font size="3">(25) mov cx,dx</font></p>
 <p align="left"><font size="3">(26) ret</font></p>
 <p align="left"><font size="3">(27) Out_chars endp</font></p>
 <p align="left"><font size="3">(28) CSEG ends</font></p>
 <p align="left"><font size="3">(29) end Start</font></p>
 <p align="left"><font size="3">Не устали?</font></p>
 <p align="left"><font size="3">Будем
 разбираться... Хотя, собственно,
 ничего сложного нет.</font></p>
 <p align="left"><font size="3">Итак, строки (1)
 - (8), (15) - (17) и (28) - (29) опускаем.
 Вопросов по ним быть не должно.</font></p>
 <p align="left"><font size="3">В строке (9)
 заносим в CX число 254,
 указывающее на то, сколько раз
 будет выполняться основной
 цикл. Строки (10) и (14) -
 &quot;голова&quot; и &quot;хвост&quot;
 нашего основного цикла
 соответственно. DI будет
 меняться в процедуре, поэтому
 нам необходимо будет его
 постоянно аннулировать (11). В
 строке (12) вызываем процедуру,
 которая заполнит экран кодом
 символа, который находится в AL
 (в первом случае - это 01
 &quot;рожица&quot;). Все! Теперь
 экран заполнен кодом 01. При
 этом DI будет равно 2001 (поэтому
 нам и нужно его обнулять). Далее
 увеличим на единицу код,
 который находится в AL (теперь AL
 содержит 02 - тоже &quot;рожица&quot;,
 но немного другого вида)
 (строка (13)), уменьшим счетчик на
 1 и перейдем к заполнению
 экрана кодом 02 (строка 14). И так
 254 раза.</font></p>
 <p align="left"><font size="3">Теперь
 процедура.</font></p>
 <p align="left"><font size="3">В строке (19)
 сохраним CX (просто перенесем
 его в DX), т.к. он будет изменен во
 вложенном цикле ниже. Строки (21)
 и (24) - &quot;голова&quot; и
 &quot;хвост&quot; вложенного цикла,
 который будет выполняться 2000
 раз (надо же заполнить экран
 полностью) (см. строку (20), в
 которой загружаем счетчик в CX).
 Все! Осталось только
 восстановить CX (строка (25)) и
 выйти из подпрограммы (26).</font></p>
 <p align="left"><font size="3">Итак, у нас
 здесь два цикла: основной и
 вложенный (так мы их назвали).
 Основной выполняется 254 раза, а
 вложенный - 2000 раз.</font></p>
 <p align="left"><font size="3">Если у Вас
 Pentium, то, боюсь, что вы не
 успеете заметить вывод всех
 символов. Очень быстро
 работает, хотя это далеко и не
 оптимальный алгоритм (кто
 знаком с языком - подтвердят
 мои слова).</font></p>
 <p align="left"><font size="3">Для
 исследования данного примера я
 рекомендую вам
 воспользоваться отладчиком.
 Т.к. у многих есть CV и AFD, то
 вкратце еще раз объясню, какие
 кнопки давить.</font></p>
 <p align="left"><font size="4"><strong>CodeView:</strong></font></p>
 <p align="left"><font size="3">F8 - пошаговое
 выполнение команд (с заходом в
 подпрограммы);</font></p>
 <p align="left"><font size="3">F10 - выполнение
 команды за один шаг (без захода
 в подпрограммы).</font></p>
 <p align="left"><font size="4"><strong>AFD:</strong></font></p>
 <p align="left"><font size="3">F1 - пошаговое
 выполнение команд (с заходом в
 подпрограммы и прерывания);</font></p>
 <p align="left"><font size="3">F2 - выполнение
 команды за один шаг (без захода
 в подпрограммы и прерывания).</font></p>
 <p align="left"><font size="3">Что-то я тут
 намудрил... Ну, поэкспериментируйте с
 клавишами. Принцип прост.</font></p>
 <p align="left"><font size="3">На сегодня
 все!</font></p>
 <p align="left"><font size="3"><strong>Удачного
 программирования!</strong></font></p>
 <p align="left"><font size="3"><em><strong>С
 уважением,</strong></em></font></p>
 <p align="left"><font size="3"><em><strong>Калашников
 Олег</strong></em><strong> </strong>(</font><a
 href="mailto:oleg77@online.ru"><font color="#0000FF"
 size="3">oleg77@online.ru</font></a><font size="3">).</font></p>

<hr>

<p align="center">[<a href="006.htm">Следующий выпуск</a>] [<a target=_BLANK href="http://www.Kalashnikoff.ru/">На главную страницу</a>]</p>

<HR NOSHADE><CENTER>
<!-- SpyLOG v2 f:0211 --><script language="javascript">  
u="u496.71.spylog.com";d=document;nv=navigator;na=nv.appName;p=1;  
bv=Math.round(parseFloat(nv.appVersion)*100);  
n=(na.substring(0,2)=="Mi")?0:1;rn=Math.random();z="p="+p+"&rn="+rn;y="";  
y+="<a href='http://"+u+"/cnt?f=3&p="+p+"&rn="+rn+"' target=_blank>";  
y+="<img src='http://"+u+"/cnt?"+z+  
"&r="+escape(d.referrer)+"&pg="+escape(window.location.href)+"' border=0 width=88 height=31 alt='SpyLOG'>";  
y+="</a>"; d.write(y);if(!n) { d.write("<"+"!--"); }//--></script><noscript><p align="center"><a 
href="http://u496.71.spylog.com/cnt?f=3&amp;p=1" 
target="_blank"><img src="http://u496.71.spylog.com/cnt?p=1" alt="SpyLOG" align="middle" border="0"></a> 
<a href="http://u496.71.spylog.com/cnt?f=3&amp;p=1" target="_blank"></noscript></a> 
<a href="http://u496.71.spylog.com/cnt?f=3&amp;p=1" target="_blank"> 
<script language="javascript1.2"><!-- if(!n) { d.write("--"+">"); }//--></script></a> 
<!-- SpyLOG --> 
 
 <a target=_top href="http://www.one.ru"><img src="http://cnt.one.ru/cgi-bin/cnt.cgi?id=16871&t=9" width=88 height=31 alt="be number one" border=0></a> 
 
 <script language="JavaScript"><!-- 
d=document;a='';a+=';r='+escape(d.referrer) 
js=10//--></script><script language="JavaScript1.1"><!-- 
a+=';j='+navigator.javaEnabled() 
js=11//--></script><script language="JavaScript1.2"><!-- 
s=screen;a+=';s='+s.width+'*'+s.height 
a+=';d='+(s.colorDepth?s.colorDepth:s.pixelDepth) 
js=12//--></script><script language="JavaScript1.3"><!-- 
js=13//--></script><script language="JavaScript"><!-- 
d.write('<a href="http://top.list.ru/jump?from=87856"'+ 
' target=_top><img src="http://top.list.ru/counter'+ 
'?id=87856;t=54;js='+js+a+';rand='+Math.random()+ 
'" alt="TopList"'+' border=0 height=31 width=88></a>') 
if(js>11)d.write('<'+'!-- ')//--></script><noscript><a 
target=_top href="http://top.list.ru/jump?from=87856"><img 
src="http://top.list.ru/counter?js=na;id=87856;t=54" 
border=0 height=31 width=88 
alt="TopList"></a></noscript><script language="JavaScript"><!-- 
if(js>11)d.write('--'+'>')//--></script> 
 
<br><br> 

</BODY>