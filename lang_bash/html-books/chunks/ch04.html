<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Глава 4. Введение в переменные и параметры</title><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/><link rel="home" href="index.html" title="Advanced Bash Scripting по-русски"/><link rel="up" href="pt02.html" title="Часть Part 2. Основы"/><link rel="prev" href="ch03.html" title="Глава 3. Специальные символы"/><link rel="next" href="ch04s02.html" title="Присваивание значений переменным"/></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Глава 4. Введение в переменные и параметры</th></tr><tr><td align="left"><a accesskey="p" href="ch03.html">Пред.</a> </td><th width="60%" align="center">Часть Part 2. Основы</th><td align="right"> <a accesskey="n" href="ch04s02.html">След.</a></td></tr></table><hr/></div><div class="chapter" title="Глава 4. Введение в переменные и параметры"><div class="titlepage"><div><div><h2 class="title"><a id="variables"/>Глава 4. Введение в переменные и параметры</h2></div></div></div><div class="toc"><p><b>Содержание</b></p><dl><dt><span class="sect1"><a href="ch04.html#varsubn">Подстановка переменных</a></span></dt><dt><span class="sect1"><a href="ch04s02.html">Присваивание значений переменным</a></span></dt><dt><span class="sect1"><a href="ch04s03.html">Переменные Bash не типизированы</a></span></dt><dt><span class="sect1"><a href="ch04s04.html">Специальные типы переменных</a></span></dt></dl></div><p><em class="firstterm">Переменные</em> - это способ представления данных
	 в различных языках программирования. Переменная не более чем 
	<em class="firstterm">метка</em> - имя, назначенное области или группе 
	областей памяти компьютера, где содержатся данные.</p><p>Переменные участвуют в арифметических операциях, манипуляции 
	с величинами, а также при синтаксическом анализе строк.</p><div class="sect1" title="Подстановка переменных"><div class="titlepage"><div><div><h2 class="title"><a id="varsubn"/>Подстановка переменных</h2></div></div></div><p><em class="firstterm">Имя</em> переменной - это "контейнер" 
	для хранения <em class="firstterm">значения</em> данных.
  Обращение к значению (получение значения) переменной называется
  <em class="firstterm">подстановкой переменной</em>.</p><div class="variablelist"><a id="dollarsign"/><dl><dt><span class="term"><span class="token">$</span></span></dt><dd><p><a id="varnameval"/></p><p>Отметим, что надо различать
    <em class="firstterm">имя</em> переменной и ее
    <em class="firstterm">значение</em>. Если
    <strong class="userinput"><code>variable1</code></strong> - имя переменной,
    то <strong class="userinput"><code>$variable1</code></strong> -
    обращение к <em class="firstterm">значению</em>,
    которое она содержит.
    
      <sup>[<a id="idp7879088" href="#ftn.idp7879088" class="footnote">22</a>]</sup>


    </p><p>
        </p><pre class="screen"><code class="prompt">bash$ </code><strong class="userinput"><code>variable1=23</code></strong>


<code class="prompt">bash$ </code><strong class="userinput"><code>echo variable1</code></strong>
<code class="computeroutput">variable1</code>

<code class="prompt">bash$ </code><strong class="userinput"><code>echo $variable1</code></strong>
<code class="computeroutput">23</code></pre><p>        
        </p><p>Немногими случаями, когда используются <span class="quote">«<span class="quote">голые</span>»</span>
    переменные -- без префикса <span class="token">$</span>   -- являются:
    объявление или присваивание, использование <em class="firstterm">unset</em>,
    <a class="link" href="ch14.html#exportref">экспортирование</a>,
    или особый случай представления переменной как
    <a class="link" href="ch29.html#signald">сигнала</a> (смотри
    <a class="xref" href="ch29.html#ex76" title="Пример 29.5. Trapping at exit">Пример 29.5, «Trapping at exit»</a>). Присваивание переменной может происходить 
	при помощи оператора
    <span class="token">=</span> (как в <em class="parameter"><code>var1=27</code></em>),
    в операции <a class="link" href="ch14.html#readref">read</a>,
    а также в заголовке цикла (<em class="parameter"><code>for var2 in 1 2
    3</code></em>).</p><p><a id="dblquo"/>Взятие переменной в
        <em class="firstterm">двойные кавычки</em> (<span class="token">" ... "</span>)
        не препятствует подстановке значения. Это
        называется <em class="firstterm">частичные кавычки</em>, так же
        упоминается как <span class="quote">«<span class="quote">нестрогие (weak) кавычки</span>»</span>. <a id="snglquo"/>При использовании одиночных кавычек (<span class="token">' ... '</span>)
        имя переменной используется непосредственно,
        без подстановки значения. Данный механизм называется <em class="firstterm">полные
        кавычки</em>, можно встретить обозначение 'строгие (strong)
        кавычки'. Смотри <a class="xref" href="ch05.html" title="Глава 5. Использование кавычек">Глава 5, <i>Использование кавычек</i></a> для
        более подробного ознакомления.</p><p>Обратите внимание, что <strong class="userinput"><code>$variable</code></strong>,
        фактически, является упрощенной записью от
        <strong class="userinput"><code>${variable}</code></strong>. В ситуациях, когда
        синтаксис записи вида  <strong class="userinput"><code>$variable</code></strong>
        вызовет ошибки, более длинная форма будет работать корректно (смотри <a class="xref" href="ch09s03.html" title="Parameter Substitution">«Parameter Substitution»</a>, ниже).</p><p><a id="varunsetting"/></p><div class="example"><a id="ex9"/><p class="title"><b>Пример 4.1. Присваивание значений и подстановка переменных</b></p><div class="example-contents"><pre class="programlisting">
#!/bin/bash
# Переменные: присваивание и подстановка

a=375
hello=$a

#-------------------------------------------------------------------------
# При инициализации переменной, с обеих сторон от знака = пробелов быть не должно.
# Что будет если там окажется пробел?

#  "VARIABLE =value"
#           ^
#% Сценарий попытается выполнить команду "VARIABLE" с аргументом "=value".

#  "VARIABLE= value"
#            ^
#% Сценарий попытается выполнить команду "value" с
#+ определением переменной окружения "VARIABLE" как "".
#-------------------------------------------------------------------------


echo hello    # hello
# Это не обращение к переменной, просто строка "hello". . .

echo $hello   # 375
#    ^          Это обращение к переменной.
echo ${hello} # 375
# Также обращение к переменной, как указано выше.

# Кавычки . . .
echo "$hello"    # 375
echo "${hello}"  # 375

echo

hello="A B  C   D"
echo $hello   # A B C D
echo "$hello" # A B  C   D
# Как вы видите, echo $hello и echo "$hello" дают разные результаты.
# Почему?
# =======================================
# Заключенная в кавычки переменная сохраняет пробелы.
# =======================================

echo

echo '$hello'  # $hello
#    ^      ^
#  Одиночные кавычки запрещают обращение к переменной,
#+ что заставляет интерпретировать "$" как символ.

# Обратите внимание на результаты использования разных видов кавычек.


hello=    # Задаем пустое значение переменной.
echo "\$hello (пустое значение) = $hello"
#  Отметим, что задание переменной с пустым значением, не то же самое, что
#+ очистка значения, хотя конечный результат такой же (смотри ниже).

# --------------------------------------------------------------

#  Можно задать несколько переменных в одной строке,
#+ если разделить их пробелами.
#  Осторожно, это может привести к снижению понимания и быть непереносимым.

var1=21  var2=22  var3=$V3
echo
echo "var1=$var1   var2=$var2   var3=$var3"

# Могут возникнуть проблемы со старыми версиями "sh" . . .

# --------------------------------------------------------------

echo; echo

numbers="один два три"
#            ^   ^
other_numbers="1 2 3"
#               ^ ^
#  Если есть пробел между числами, то кавычки необходимы.
#  other_numbers=1 2 3                  # Вызовет ошибку.
echo "numbers = $numbers"		# numbers = один два три
echo "other_numbers = $other_numbers"   # other_numbers = 1 2 3
#  Конструкция с экранированным пробелом тоже работает.
mixed_bag=2\ ---\ Что-нибудь
#           ^    ^ Пробел после символа экранирования(escape) (\).

echo "$mixed_bag"         # 2 --- Что-нибудь

echo; echo

echo "uninitialized_variable = $uninitialized_variable"
# Неинициализированные переменные имеют пустое значение.
uninitialized_variable=   #  Объявлние без инициализации --
                          #+ то же что задание пустого значения, как упомянуто выше.
echo "uninitialized_variable = $uninitialized_variable"
                          # Она до сих пор имеет пустое значение.

uninitialized_variable=23       # Задаем значение.
unset uninitialized_variable    # Очищаем значение.
echo "uninitialized_variable = $uninitialized_variable"
                                # Она все еще имеет пустое значение.
echo

# drBatty отметил следующее:
# Есть переменная, которая имеет пустое значение:
ZZZZ=""
set | grep ZZZZ		# ZZZZ=
# Переменная ZZZZ инициализирована, и имеет значение - пустая строка.
# С другой стороны, рассмотрим переменную YYYYY
echo $YYYYY
# Она тоже имеет значение - "пустая строка", однако:
set | grep YYYYY	# нет ответа
# Нет такой переменной. Значит она не имеет никакого значения.
# Однако это "никакое", по правилам bash, преобразуется в "пустая строка".

exit 0
</pre></div></div><br class="example-break"/><div class="caution" title="Предостережение" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Предостережение</h3><p><a id="uninitvar1"/></p><p>Неинициализированная переменная имеет
        <span class="quote">«<span class="quote">пустое</span>»</span> значение -- неназначенное значение
        (<span class="emphasis"><em>не</em></span> нуль!).

              </p><pre class="programlisting">if [ -z "$unassigned" ]
then
  echo "\$unassigned пуста."
fi     # $unassigned пуста.</pre><p>Использование переменной до
        присвоения ей значения может вызвать проблемы.
        Тем не менее, можно производить арифметические операции
        над неинициализированными переменными.

          </p><pre class="programlisting">echo "$uninitialized"                                # (пустая строка)
let "uninitialized += 5"                             # Прибавить 5.
echo "$uninitialized"                                # 5

#  Заключение:
#  Неинициализированная переменная не имеет значения,
#+ однако, она играет роль 0 в арифметических выражениях.
#  Это недокументированное (и возможно непереносимое) поведение,
#+ и, по возможности, не должно быть использовано в сценариях.</pre><p>

              Смотри также <a class="xref" href="ch14.html#selfsource" title="Пример 14.23. A (useless) script that sources itself">Пример 14.23, «A (useless) script that sources itself»</a>.</p></div></dd></dl></div></div><div class="footnotes"><br/><hr/><div class="footnote"><p><sup>[<a id="ftn.idp7879088" href="#idp7879088" class="para">22</a>] </sup><a id="lvalueref"/>Технически, 
          <em class="firstterm">имя</em> переменной называется
          <em class="firstterm">l-значением (lvalue)</em>, имеется ввиду,
	 что оно фигурирует в
          <span class="emphasis"><em>левой (left)</em></span> части операции присваивания,
          например как в <strong class="userinput"><code>VARIABLE=23</code></strong>.
          <em class="firstterm">Значение</em> переменной
          называется <em class="firstterm">r-значением (rvalue)</em>, имеется ввиду,
          что оно фигурирует в <span class="emphasis"><em>правой (right)</em></span>
          части операции присваивания, например как в
          <strong class="userinput"><code>VAR2=$VARIABLE</code></strong>.</p><p><a id="pointerref"/>
          <em class="firstterm">Имя</em> переменной - в действительности,
          <em class="firstterm">ссылка</em>,
          <em class="firstterm">указатель</em> на область(ти) памяти, 
	  где фактические данные связаны 
	  со значением, которое они хранят.</p></div></div></div><div class="navfooter"><hr/><table width="100%" summary="Navigation footer"><tr><td align="left"><a accesskey="p" href="ch03.html">Пред.</a> </td><td align="center"><a accesskey="u" href="pt02.html">Уровень выше</a></td><td align="right"> <a accesskey="n" href="ch04s02.html">След.</a></td></tr><tr><td align="left" valign="top">Глава 3. Специальные символы </td><td align="center"><a accesskey="h" href="index.html">Начало</a></td><td align="right" valign="top"> Присваивание значений переменным</td></tr></table></div></body></html>
