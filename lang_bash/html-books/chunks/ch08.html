<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Глава 8. Operations and Related Topics</title><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/><link rel="home" href="index.html" title="Advanced Bash Scripting по-русски"/><link rel="up" href="pt02.html" title="Часть Part 2. Основы"/><link rel="prev" href="ch07s05.html" title="Проверка знаний по теме &quot;Проверка условий&quot;"/><link rel="next" href="ch08s02.html" title="Numerical Constants"/></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Глава 8. Operations and Related Topics</th></tr><tr><td align="left"><a accesskey="p" href="ch07s05.html">Пред.</a> </td><th width="60%" align="center">Часть Part 2. Основы</th><td align="right"> <a accesskey="n" href="ch08s02.html">След.</a></td></tr></table><hr/></div><div class="chapter" title="Глава 8. Operations and Related Topics"><div class="titlepage"><div><div><h2 class="title"><a id="operations"/>Глава 8. Operations and Related Topics</h2></div></div></div><div class="toc"><p><b>Содержание</b></p><dl><dt><span class="sect1"><a href="ch08.html#ops">Operators</a></span></dt><dt><span class="sect1"><a href="ch08s02.html">Numerical Constants</a></span></dt></dl></div><div class="sect1" title="Operators"><div class="titlepage"><div><div><h2 class="title"><a id="ops"/>Operators</h2></div></div></div><div class="variablelist" title="assignment"><a id="asnop"/><p class="title"><b><a id="asnop1"/>assignment</b></p><dl><dt><span class="term"><em class="replaceable"><code>variable assignment</code></em></span></dt><dd><p>Initializing or changing the value of a variable</p></dd><dt><span class="term">=</span></dt><dd><p>All-purpose assignment operator, which works for both
      arithmetic and string assignments.</p><p>
        </p><pre class="programlisting">var=27
category=minerals  # No spaces allowed after the "=".</pre><p>
      </p><div class="caution" title="Предостережение" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Предостережение</h3><p>Do not confuse the <span class="quote">«<span class="quote">=</span>»</span> assignment
        operator with the <a class="link" href="ch07s03.html#equalsignref">= test
        operator</a>.</p><p>
        </p><pre class="programlisting">#   =  as a test operator

if [ "$string1" = "$string2" ]
then
   command
fi

#  if [ "X$string1" = "X$string2" ] is safer,
#+ to prevent an error message should one of the variables be empty.
#  (The prepended "X" characters cancel out.)</pre><p>
      </p></div></dd></dl></div><a id="idp8733104" class="indexterm"/><a id="idp8734112" class="indexterm"/><a id="idp8735504" class="indexterm"/><a id="idp8736512" class="indexterm"/><div class="variablelist" title="arithmetic operators"><a id="arops"/><p class="title"><b><a id="arops1"/>arithmetic operators</b></p><dl><dt><span class="term"><span class="token">+</span></span></dt><dd><p>plus</p></dd><dt><span class="term"><span class="token">-</span></span></dt><dd><p>minus</p></dd><dt><span class="term"><span class="token">*</span></span></dt><dd><p>multiplication</p></dd><dt><span class="term"><span class="token">/</span></span></dt><dd><p>division</p></dd><dt><span class="term"><a id="exponentiationref"/><span class="token">**</span></span></dt><dd><p>exponentiation</p><p>
      </p><pre class="programlisting"># Bash, version 2.02, introduced the "**" exponentiation operator.

let "z=5**3"    # 5 * 5 * 5
echo "z = $z"   # z = 125</pre><p>
          </p></dd><dt><span class="term"><a id="moduloref"/><span class="token">%</span></span></dt><dd><p>modulo, or mod (returns the
      <em class="firstterm">remainder</em> of an integer division
      operation)</p><p>
        </p><pre class="screen"><code class="prompt">bash$ </code><strong class="userinput"><code>expr 5 % 3</code></strong>
<code class="computeroutput">2</code>
        </pre><p>
        <span class="emphasis"><em>5/3 = 1, with remainder 2</em></span>
      </p><p>This operator finds use in, among other things,
      generating numbers within a specific range (see <a class="xref" href="ch09s06.html#ex21" title="Пример 9.26. Generating random numbers">Пример 9.26, «Generating random numbers»</a> and <a class="xref" href="ch09s06.html#randomtest" title="Пример 9.30. Rolling a single die with RANDOM">Пример 9.30, «Rolling a single die with RANDOM»</a>) and
      formatting program output (see <a class="xref" href="ch26.html#qfunction" title="Пример 26.16. Complex array application: Exploring a weird mathematical series">Пример 26.16, «Complex array application:
             <span class="emphasis"><em>Exploring a weird mathematical series</em></span>»</a> and
      <a class="xref" href="apa.html#collatz" title="Пример A.6. Collatz series">Пример A.6, «Collatz series»</a>). It can even be used to generate
      prime numbers, (see <a class="xref" href="apa.html#primes" title="Пример A.15. Generating prime numbers using the modulo operator">Пример A.15, «Generating prime numbers using the modulo operator»</a>). Modulo turns
      up surprisingly often in numerical recipes.</p><div class="example"><a id="gcd"/><p class="title"><b>Пример 8.1. Greatest common divisor</b></p><div class="example-contents"><pre class="programlisting">&amp;gcd;</pre></div></div><br class="example-break"/></dd><dt><span class="term"><a id="arithopscomb"/><span class="token">+=</span></span></dt><dd><p><em class="firstterm">plus-equal</em> (increment
      variable by a constant)</p><p><strong class="userinput"><code>let "var += 5"</code></strong> results in
        <em class="parameter"><code>var</code></em> being incremented by
        <code class="literal">5</code>.</p></dd><dt><span class="term"><span class="token">-=</span></span></dt><dd><p><em class="firstterm">minus-equal</em> (decrement
      variable by a constant)</p></dd><dt><span class="term"><span class="token">*=</span></span></dt><dd><p><em class="firstterm">times-equal</em> (multiply
      variable by a constant)</p><p><strong class="userinput"><code>let "var *= 4"</code></strong> results in <em class="parameter"><code>var</code></em>
      being multiplied by <code class="literal">4</code>.</p></dd><dt><span class="term"><span class="token">/=</span></span></dt><dd><p><em class="firstterm">slash-equal</em> (divide
      variable by a constant)</p></dd><dt><span class="term"><span class="token">%=</span></span></dt><dd><p><em class="firstterm">mod-equal</em>
      (<em class="firstterm">remainder</em>
      of dividing variable by a constant)</p><p><span class="emphasis"><em>Arithmetic operators often occur in an
        <a class="link" href="ch15s02.html#exprref">expr</a> or <a class="link" href="ch14.html#letref">let</a> expression.</em></span></p><div class="example"><a id="arithops"/><p class="title"><b>Пример 8.2. Using Arithmetic Operations</b></p><div class="example-contents"><pre class="programlisting">&amp;arithops;</pre></div></div><br class="example-break"/></dd></dl></div><p><a id="intvarref"/></p><div class="note" title="Замечание" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Замечание</h3><p>Integer variables in older versions of Bash were signed
  <em class="firstterm">long</em> (32-bit) integers, in the range of
  -2147483648 to 2147483647. An operation that took a variable
  outside these limits gave an erroneous result.</p><p>
    </p><pre class="programlisting">echo $BASH_VERSION   # 1.14

a=2147483646
echo "a = $a"        # a = 2147483646
let "a+=1"           # Increment "a".
echo "a = $a"        # a = 2147483647
let "a+=1"           # increment "a" again, past the limit.
echo "a = $a"        # a = -2147483648
                     #      ERROR: out of range,
                     # +    and the leftmost bit, the sign bit,
                     # +    has been set, making the result negative.</pre><p>
  </p><p>As of version &gt;= 2.05b, Bash supports 64-bit integers.</p></div><div class="caution" title="Предостережение" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Предостережение</h3><p><a id="nofloatingpoint"/></p><p>Bash does not understand floating point arithmetic. It
        treats numbers containing a decimal point as strings.</p><p>
        </p><pre class="programlisting">a=1.5

let "b = $a + 1.3"  # Error.
# t2.sh: let: b = 1.5 + 1.3: syntax error in expression
#                            (error token is ".5 + 1.3")

echo "b = $b"       # b=1</pre><p>
      </p><p>Use <a class="link" href="ch15s08.html#bcref">bc</a> in scripts that that need floating
  point calculations or math library functions.</p></div><p title="bitwise operators"><b>bitwise operators. </b>The bitwise operators seldom make an appearance in shell scripts.
  Their chief use seems to be manipulating and testing values read
  from ports or <a class="link" href="ch27.html#socketref">sockets</a>. <span class="quote">«<span class="quote">Bit
  flipping</span>»</span> is more relevant to compiled languages, such
  as C and C++, which provide direct access to system
  hardware.</p><div class="variablelist" title="bitwise operators"><a id="bitwsops"/><p class="title"><b><a id="bitwsops1"/>bitwise operators</b></p><dl><dt><span class="term"><span class="token">&lt;&lt;</span></span></dt><dd><p>bitwise left shift (multiplies by <code class="literal">2</code>
        for each shift position)</p></dd><dt><span class="term"><span class="token">&lt;&lt;=</span></span></dt><dd><p><em class="firstterm">left-shift-equal</em></p><p><strong class="userinput"><code>let "var &lt;&lt;= 2"</code></strong> results in <em class="parameter"><code>var</code></em>
      left-shifted <code class="literal">2</code> bits (multiplied by <code class="literal">4</code>)</p></dd><dt><span class="term"><span class="token">&gt;&gt;</span></span></dt><dd><p>bitwise right shift (divides by <code class="literal">2</code>
        for each shift position)</p></dd><dt><span class="term"><span class="token">&gt;&gt;=</span></span></dt><dd><p><em class="firstterm">right-shift-equal</em>
      (inverse of <span class="token">&lt;&lt;=</span>)</p></dd><dt><span class="term"><span class="token">&amp;amp;</span></span></dt><dd><p>bitwise AND</p></dd><dt><span class="term"><span class="token">&amp;=</span></span></dt><dd><p>bitwise <em class="firstterm">AND-equal</em></p></dd><dt><span class="term"><span class="token">|</span></span></dt><dd><p>bitwise OR</p></dd><dt><span class="term"><span class="token">|=</span></span></dt><dd><p>bitwise <em class="firstterm">OR-equal</em></p></dd><dt><span class="term"><span class="token">~</span></span></dt><dd><p>bitwise NOT</p></dd><dt><span class="term"><span class="token">^</span></span></dt><dd><p>bitwise XOR</p></dd><dt><span class="term"><span class="token">^=</span></span></dt><dd><p>bitwise <em class="firstterm">XOR-equal</em></p></dd></dl></div><div class="variablelist" title="logical (boolean) operators"><a id="logops"/><p class="title"><b><a id="logops1"/>logical (boolean) operators</b></p><dl><dt><span class="term"><span class="token">!</span></span></dt><dd><p>NOT</p><pre class="programlisting">if [ ! -f $FILENAME ]
then
  ...</pre></dd><dt><span class="term"><span class="token">&amp;&amp;</span></span></dt><dd><p>AND</p><pre class="programlisting">if [ $condition1 ] &amp;&amp; [ $condition2 ]
#  Same as:  if [ $condition1 -a $condition2 ]
#  Returns true if both condition1 and condition2 hold true...

if [[ $condition1 &amp;&amp; $condition2 ]]    # Also works.
#  Note that &amp;&amp; operator not permitted <span class="emphasis"><em>inside brackets</em></span>
#+ of [ ... ] construct.</pre><div class="note" title="Замечание" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Замечание</h3><p><span class="token">&amp;&amp;</span> may also be used, depending on context,
      in an <a class="link" href="ch25.html#listconsref">and list</a>
      to concatenate commands.</p></div></dd><dt><span class="term"><a id="orref"/><span class="token">||</span></span></dt><dd><p>OR</p><pre class="programlisting">if [ $condition1 ] || [ $condition2 ]
# Same as:  if [ $condition1 -o $condition2 ]
# Returns true if either condition1 or condition2 holds true...

if [[ $condition1 || $condition2 ]]    # Also works.
#  Note that || operator not permitted <span class="emphasis"><em>inside brackets</em></span>
#+ of a [ ... ] construct.</pre><div class="note" title="Замечание" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Замечание</h3><p>Bash tests the <a class="link" href="ch06.html#exitstatusref">exit
      status</a> of each statement linked with a logical
      operator.</p></div><div class="example"><a id="andor"/><p class="title"><b>Пример 8.3. Compound Condition Tests Using &amp;&amp; and ||</b></p><div class="example-contents"><pre class="programlisting">&amp;andor;</pre></div></div><br class="example-break"/><p>The <span class="token">&amp;&amp;</span> and <span class="token">||</span> operators also
        find use in an arithmetic context.</p><p>
        </p><pre class="screen"><code class="prompt">bash$ </code><strong class="userinput"><code>echo $(( 1 &amp;&amp; 2 )) $((3 &amp;&amp; 0)) $((4 || 0)) $((0 || 0))</code></strong>
<code class="computeroutput">1 0 1 0</code>
        </pre><p>
      </p></dd></dl></div><div class="variablelist" title="miscellaneous operators"><a id="miscop"/><p class="title"><b><a id="miscop1"/>miscellaneous operators</b></p><dl><dt><span class="term"><a id="commaop"/><span class="token">,</span></span></dt><dd><p>Comma operator</p><p>The <span class="command"><strong>comma operator</strong></span> chains together
        two or more arithmetic operations. All the operations are
        evaluated (with possible <em class="firstterm">side
        effects</em>.
          <sup>[<a id="idp8924816" href="#ftn.idp8924816" class="footnote">34</a>]</sup>
             </p><p>
       </p><pre class="programlisting">let "t1 = ((5 + 3, 7 - 1, 15 - 4))"
echo "t1 = $t1"           ^^^^^^  # t1 = 11
# Here t1 is set to the result of the last operation. Why?

let "t2 = ((a = 9, 15 / 3))"      # Set "a" and calculate "t2".
echo "t2 = $t2    a = $a"         # t2 = 5    a = 9</pre><p>
       </p><p>The comma operator finds use mainly in <a class="link" href="ch10.html#forloopref1">for loops</a>. See <a class="xref" href="ch10.html#forloopc" title="Пример 10.12. C-подобный синтаксис оператора цикла for">Пример 10.12, «C-подобный синтаксис оператора цикла <em class="firstterm">for</em> »</a>.</p></dd></dl></div></div><div class="footnotes"><br/><hr/><div class="footnote"><p><sup>[<a id="ftn.idp8924816" href="#idp8924816" class="para">34</a>] </sup><em class="firstterm">Side effects</em>
    are, of course, unintended -- and usually undesirable --
    consequences.</p></div></div></div><div class="navfooter"><hr/><table width="100%" summary="Navigation footer"><tr><td align="left"><a accesskey="p" href="ch07s05.html">Пред.</a> </td><td align="center"><a accesskey="u" href="pt02.html">Уровень выше</a></td><td align="right"> <a accesskey="n" href="ch08s02.html">След.</a></td></tr><tr><td align="left" valign="top">Проверка знаний по теме "Проверка условий" </td><td align="center"><a accesskey="h" href="index.html">Начало</a></td><td align="right" valign="top"> Numerical Constants</td></tr></table></div></body></html>
