<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>$RANDOM: generate random integer</title><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/><link rel="home" href="index.html" title="Advanced Bash Scripting по-русски"/><link rel="up" href="ch09.html" title="Глава 9. К вопросу о переменных"/><link rel="prev" href="ch09s05.html" title="Indirect References"/><link rel="next" href="ch09s07.html" title="The Double-Parentheses Construct"/></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">$RANDOM: generate random integer</th></tr><tr><td align="left"><a accesskey="p" href="ch09s05.html">Пред.</a> </td><th width="60%" align="center">Глава 9. К вопросу о переменных</th><td align="right"> <a accesskey="n" href="ch09s07.html">След.</a></td></tr></table><hr/></div><div class="sect1" title="$RANDOM: generate random integer"><div class="titlepage"><div><div><h2 class="title"><a id="randomvar"/>$RANDOM: generate random integer</h2></div></div></div><a id="idp9939968" class="indexterm"/><a id="idp9941008" class="indexterm"/><p><a id="randomvar01"/></p><p><code class="varname">$RANDOM</code> is an internal Bash <a class="link" href="ch23.html#functionref">function</a> (not a constant) that
    returns a <em class="firstterm">pseudorandom</em>

      <sup>[<a id="idp9945584" href="#ftn.idp9945584" class="footnote">44</a>]</sup>

    integer in the range 0 - 32767. It should
    <em class="replaceable"><code>not</code></em> be used to generate an encryption
    key.</p><div class="example"><a id="ex21"/><p class="title"><b>Пример 9.26. Generating random numbers</b></p><div class="example-contents"><pre class="programlisting">&amp;ex21;</pre></div></div><br class="example-break"/><div class="example"><a id="pickcard"/><p class="title"><b>Пример 9.27. Picking a random card from a deck</b></p><div class="example-contents"><pre class="programlisting">&amp;pickcard;</pre></div></div><br class="example-break"/><p><a id="brownianref"/></p><div class="example"><a id="brownian"/><p class="title"><b>Пример 9.28. Brownian Motion Simulation</b></p><div class="example-contents"><pre class="programlisting">&amp;brownian;</pre></div></div><br class="example-break"/><p>
  <span class="emphasis"><em>Jipe</em></span> points out a set of techniques for
  generating random numbers within a range.

  </p><pre class="programlisting">#  Generate random number between 6 and 30.
   rnumber=$((RANDOM%25+6)) 

#  Generate random number in the same 6 - 30 range,
#+ but the number must be evenly divisible by 3.
   rnumber=$(((RANDOM%30/3+1)*3))

#  Note that this will not work all the time.
#  It fails if $RANDOM%30 returns 0.

#  Frank Wang suggests the following alternative:
   rnumber=$(( RANDOM%27/3*3+6 ))</pre><p>
  </p><p>
  <span class="emphasis"><em>Bill Gradwohl</em></span> came up with an improved
  formula that works for positive numbers.
  </p><pre class="programlisting">rnumber=$(((RANDOM%(max-min+divisibleBy))/divisibleBy*divisibleBy+min))</pre><p>
  </p><p>Here Bill presents a versatile function that returns
    a random number between two specified values.</p><div class="example"><a id="randombetween"/><p class="title"><b>Пример 9.29. Random between values</b></p><div class="example-contents"><pre class="programlisting">&amp;randombetween;</pre></div></div><br class="example-break"/><p>Just how random is <code class="varname">$RANDOM</code>? The best
    way to test this is to write a script that tracks
    the distribution of <span class="quote">«<span class="quote">random</span>»</span> numbers
    generated by <code class="varname">$RANDOM</code>. Let's roll a
    <code class="varname">$RANDOM</code> die a few times . . .</p><div class="example"><a id="randomtest"/><p class="title"><b>Пример 9.30. Rolling a single die with RANDOM</b></p><div class="example-contents"><pre class="programlisting">&amp;randomtest;</pre></div></div><br class="example-break"/><p>As we have seen in the last example, it is best to
    <em class="firstterm">reseed</em> the <em class="parameter"><code>RANDOM</code></em>
    generator each time it is invoked. Using the same seed
    for <em class="parameter"><code>RANDOM</code></em> repeats the same series
    of numbers.
      <sup>[<a id="idp9967808" href="#ftn.idp9967808" class="footnote">45</a>]</sup>
    (This mirrors the behavior of the
    <em class="replaceable"><code>random()</code></em> function in
    <em class="firstterm">C</em>.)</p><div class="example"><a id="seedingrandom"/><p class="title"><b>Пример 9.31. Reseeding RANDOM</b></p><div class="example-contents"><pre class="programlisting">&amp;seedingrandom;</pre></div></div><br class="example-break"/><p><a id="urandomref"/></p><div class="note" title="Замечание" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Замечание</h3><p>The <code class="filename">/dev/urandom</code> pseudo-device file
    provides a method of generating much more <span class="quote">«<span class="quote">random</span>»</span>
    pseudorandom numbers than the <code class="varname">$RANDOM</code>
    variable.  <strong class="userinput"><code>dd if=/dev/urandom of=targetfile
    bs=1 count=XX</code></strong> creates a file of well-scattered
    pseudorandom numbers.  However, assigning these numbers
    to a variable in a script requires a workaround, such
    as filtering through <a class="link" href="ch15s09.html#odref">od</a>
    (as in above example, <a class="xref" href="ch15s04.html#rnd" title="Пример 15.14. Generating 10-digit random numbers">Пример 15.14, «Generating 10-digit random numbers»</a>, and
    <a class="xref" href="apa.html#insertionsort" title="Пример A.36. Insertion sort">Пример A.36, «Insertion sort»</a>), or even piping to
    <a class="link" href="ch15s05.html#md5sumref">md5sum</a> (see <a class="xref" href="ch33s06.html#horserace" title="Пример 33.14. A «horserace» game">Пример 33.14, «A <span class="quote">«<span class="quote">horserace</span>»</span> game»</a>).</p><p><a id="awkrandomref"/></p><p>There are also other ways to generate pseudorandom
          numbers in a script. <span class="command"><strong>Awk</strong></span> provides a
    convenient means of doing this.</p><div class="example"><a id="random2"/><p class="title"><b>Пример 9.32. Pseudorandom numbers, using <a class="link" href="apcs02.html#awkref">awk</a></b></p><div class="example-contents"><pre class="programlisting">&amp;random2;</pre></div></div><br class="example-break"/><p>The <a class="link" href="ch15s03.html#dateref">date</a> command also lends
    itself to <a class="link" href="ch15s03.html#daterandref">generating pseudorandom
    integer sequences</a>.</p></div><div class="footnotes"><br/><hr/><div class="footnote"><p><sup>[<a id="ftn.idp9945584" href="#idp9945584" class="para">44</a>] </sup>True <span class="quote">«<span class="quote">randomness,</span>»</span> insofar as
      it exists at all, can only be found in certain incompletely
      understood natural phenomena, such as radioactive
      decay. Computers only <em class="firstterm">simulate</em>
      randomness, and computer-generated sequences of
      <span class="quote">«<span class="quote">random</span>»</span> numbers are therefore referred to as
      <em class="firstterm">pseudorandom</em>.</p></div><div class="footnote"><p><sup>[<a id="ftn.idp9967808" href="#idp9967808" class="para">45</a>] </sup>The <em class="firstterm">seed</em> of a
        computer-generated pseudorandom number series
        can be considered an identification label. For
        example, think of the pseudorandom series with a
        seed of <span class="emphasis"><em>23</em></span> as <em class="replaceable"><code>Series
        #23</code></em>.</p><p>A property of a pseurandom number series is the length of
        the cycle before it starts repeating itself. A good pseurandom
        generator will produce series with very long cycles.</p></div></div></div><div class="navfooter"><hr/><table width="100%" summary="Navigation footer"><tr><td align="left"><a accesskey="p" href="ch09s05.html">Пред.</a> </td><td align="center"><a accesskey="u" href="ch09.html">Уровень выше</a></td><td align="right"> <a accesskey="n" href="ch09s07.html">След.</a></td></tr><tr><td align="left" valign="top">Indirect References </td><td align="center"><a accesskey="h" href="index.html">Начало</a></td><td align="right" valign="top"> The Double-Parentheses Construct</td></tr></table></div></body></html>
