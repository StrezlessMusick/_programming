<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Redirecting Code Blocks</title><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/><link rel="home" href="index.html" title="Advanced Bash Scripting по-русски"/><link rel="up" href="ch19.html" title="Глава 19. I/O Redirection"/><link rel="prev" href="ch19.html" title="Глава 19. I/O Redirection"/><link rel="next" href="ch19s03.html" title="Applications"/></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Redirecting Code Blocks</th></tr><tr><td align="left"><a accesskey="p" href="ch19.html">Пред.</a> </td><th width="60%" align="center">Глава 19. I/O Redirection</th><td align="right"> <a accesskey="n" href="ch19s03.html">След.</a></td></tr></table><hr/></div><div class="sect1" title="Redirecting Code Blocks"><div class="titlepage"><div><div><h2 class="title"><a id="redircb"/>Redirecting Code Blocks</h2></div></div></div><p><a id="redirref"/>Blocks of code, such as <a class="link" href="ch10.html#whileloopref">while</a>, <a class="link" href="ch10.html#untilloopref">until</a>, and <a class="link" href="ch10.html#forloopref1">for</a> loops, even <a class="link" href="ch07.html#ifthen">if/then</a> test blocks can also incorporate
    redirection of <code class="filename">stdin</code>.  Even a function may
    use this form of redirection (see <a class="xref" href="ch23.html#realname" title="Пример 23.11. Настоящее имя по имени пользователя">Пример 23.11, «Настоящее имя по имени пользователя»</a>).
    The <span class="token">&amp;lt;</span> operator at the end of the code block
    accomplishes this.</p><div class="example"><a id="redir2"/><p class="title"><b>Пример 19.5. Redirected <em class="firstterm">while</em> loop</b></p><div class="example-contents"><pre class="programlisting">&amp;redir2;</pre></div></div><br class="example-break"/><div class="example"><a id="redir2a"/><p class="title"><b>Пример 19.6. Alternate form of redirected <em class="firstterm">while</em> loop</b></p><div class="example-contents"><pre class="programlisting">&amp;redir2a;</pre></div></div><br class="example-break"/><div class="example"><a id="redir3"/><p class="title"><b>Пример 19.7. Redirected <em class="firstterm">until</em> loop</b></p><div class="example-contents"><pre class="programlisting">&amp;redir3;</pre></div></div><br class="example-break"/><div class="example"><a id="redir4"/><p class="title"><b>Пример 19.8. Redirected <em class="firstterm">for</em> loop</b></p><div class="example-contents"><pre class="programlisting">&amp;redir4;</pre></div></div><br class="example-break"/><p>We can modify the previous example to also redirect the output of
        the loop.</p><div class="example"><a id="redir4a"/><p class="title"><b>Пример 19.9. Redirected <em class="firstterm">for</em> loop (both
    <code class="filename">stdin</code> and <code class="filename">stdout</code>
    redirected)</b></p><div class="example-contents"><pre class="programlisting">&amp;redir4a;</pre></div></div><br class="example-break"/><div class="example"><a id="redir5"/><p class="title"><b>Пример 19.10. Redirected <em class="firstterm">if/then</em> test</b></p><div class="example-contents"><pre class="programlisting">&amp;redir5;</pre></div></div><br class="example-break"/><div class="example"><a id="namesdata"/><p class="title"><b>Пример 19.11. Data file <em class="firstterm">names.data</em> for above
  examples</b></p><div class="example-contents"><pre class="programlisting">&amp;namesdata;</pre></div></div><br class="example-break"/><p>Redirecting the <code class="filename">stdout</code> of a code
  block has the effect of saving its output to a file. See <a class="xref" href="ch03.html#rpmcheck" title="Пример 3.2. Saving the output of a code block to a file">Пример 3.2, «Saving the output of a code block to a file»</a>.</p><p><a class="link" href="ch18.html#heredocref">Here documents</a>
        are a special case of redirected code blocks. That being the case,
  it should be possible to feed the output of a <em class="firstterm">here
  document</em> into the <code class="filename">stdin</code> for a
  <em class="firstterm">while loop</em>.</p><p>
      </p><pre class="programlisting"># This example by Albert Siersema
# Used with permission (thanks!).

function doesOutput()
 # Could be an external command too, of course.
 # Here we show you can use a function as well.
{
  ls -al *.jpg | awk '{print $5,$9}'
}


nr=0          #  We want the while loop to be able to manipulate these and
totalSize=0   #+ to be able to see the changes after the while finished.

while read fileSize fileName ; do
  echo "$fileName is $fileSize bytes"
  let nr++
  totalSize=$((totalSize+fileSize))   # Or: "let totalSize+=fileSize"
done&lt;&lt;EOF
$(doesOutput)
EOF

echo "$nr files totaling $totalSize bytes"</pre><p>
            </p></div><div class="navfooter"><hr/><table width="100%" summary="Navigation footer"><tr><td align="left"><a accesskey="p" href="ch19.html">Пред.</a> </td><td align="center"><a accesskey="u" href="ch19.html">Уровень выше</a></td><td align="right"> <a accesskey="n" href="ch19s03.html">След.</a></td></tr><tr><td align="left" valign="top">Глава 19. I/O Redirection </td><td align="center"><a accesskey="h" href="index.html">Начало</a></td><td align="right" valign="top"> Applications</td></tr></table></div></body></html>
