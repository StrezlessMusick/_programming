<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content=
    "application/xhtml+xml; charset=koi8-r" />
    <title>
      6.47.&nbsp;Man-1.5o
    </title>
    <link rel="stylesheet" href="../stylesheets/lfs.css" type="text/css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.65.1" />
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
  </head>
  <body id="lfs" class="6.0">
    <div class="navheader">
      <div class="headertitles">
        <h4>
          Linux From Scratch - Версия 6.0
        </h4>
        <h3>
          Глава&nbsp;6.&nbsp;Установка основных системных программ
        </h3>
      </div>
      <ul class="headerlinks">
        <li class="prev">
          <a accesskey="p" href="gzip.html" title="Gzip-1.3.5">Назад</a>
          <p>
            Gzip-1.3.5
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="make.html" title="Make-3.80">Далее</a>
          <p>
            Make-3.80
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="chapter06.html" title=
          "Глава&nbsp;6.&nbsp;Установка основных системных программ">Наверх</a>.
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Linux From Scratch - Версия 6.0">В начало</a>
        </li>
      </ul>
    </div>
    <div class="wrap" lang="en" xml:lang="en">
      <div class="titlepage">
        <h1 class="sect1">
          6.47. Man-1.5o
        </h1>
      </div>
      <div class="package" lang="en" xml:lang="en">
        <p>
          Man является просмотрщиком man-страниц.
        </p>
        <div class="segmentedlist">
          <p>
            <b>Расчетное время сборки</b> 0.1 SBU
          </p>
          <p>
            <b>Требуемое место на диске</b> 1.9MB
          </p>
        </div>
        <div class="segmentedlist">
          <p>
            <b>Man - зависимости установки:</b> Bash, Binutils, Coreutils,
            Gawk, GCC, Glibc, Grep, Make и Sed
          </p>
        </div>
      </div>
      <div class="installation" lang="en" xml:lang="en">
        <div class="titlepage">
          <h2 class="sect2">
            6.47.1. Инсталируем Man
          </h2>
        </div>
        <p>
          Мы собираемся сделать три дополнения к исходникам Man.
        </p>
        <p>
          Первый патч решит проблему с фоматированием man страниц, содержащих
	  более 80 символов в сторке в связке с существующими релизами Groff.
	  Теперь man-страницы будут отображаться, используя полную ширину
          терминала вместо бывшего ограничения в 80 символов:
        </p>
        <pre class="userinput">
<kbd class="command">patch -Np1 -i ../man-1.5o-80cols-1.patch</kbd>
</pre>
        <p>
          Второй патч добавит параметр <i class=
          "parameter"><tt>-R</tt></i> в переменную <tt class=
          "envar">PAGER</tt> для правильного использования escape-последовательностей:
        </p>
        <pre class="userinput">
<kbd class="command">sed -i 's@-is@&amp;R@g' configure</kbd>
</pre>
        <p>
          Третий патч (sed-последовательность) закоментирует строку
          &ldquo;<span class="quote">MANPATH /usr/man</span>&rdquo; в
          файле <tt class="filename">man.conf</tt> для предупреждения излишней
	  многословности результатов при использовании таких программ как
          <span><b class="command">whatis</b></span>:
        </p>
        <pre class="userinput">
<kbd class=
"command">sed -i 's@MANPATH./usr/man@#&amp;@g' src/man.conf.in</kbd>
</pre>
        <p>
          Подготавливаем Man для компиляции:
        </p>
        <pre class="userinput">
<kbd class="command">./configure -confdir=/etc</kbd>
</pre>
        <p>
          Описание параметров конфигурации:
        </p>
        <div class="variablelist">
          <dl>
            <dt>
              <span class="term"><i class=
              "parameter"><tt>-confdir=/etc</tt></i></span>
            </dt>
            <dd>
              <p>
                Программа <span><b class="command">man</b></span>
                будет искать файл конфигурации <tt class="filename">man.conf</tt>
                в директории <tt class="filename">/etc</tt>.
              </p>
            </dd>
          </dl>
        </div>
        <p>
          Компилируем пакет
        </p>
        <pre class="userinput">
<kbd class="command">make</kbd>
</pre>
        <p>
          Устанавливаем пакет
        </p>
        <pre class="userinput">
<kbd class="command">make install</kbd>
</pre>
        <div class="note">
          <div class="admonhead">
            <img alt="[Note]" src="../images/note.png" />
            <h3 class="admontitle">
              Замечание
            </h3>
          </div>
          <div class="admonbody">
            <p>
              Для отключения Select Graphic Rendition (SGR) escape-последовательности,
              можно отредактировать файл <tt class="filename">man.conf</tt> и добавить
              параметр <i class="parameter"><tt>-c</tt></i> к переменной <tt class=
              "envar">NROFF</tt>.
            </p>
          </div>
        </div>
        <p>
          Если вы используете 8-битную кодировку символов, ищите строку, которая
          начинается с &ldquo;<span class="quote">NROFF</span>&rdquo; в
          <tt class="filename">/etc/man.conf</tt>, и проверьте, что она выглядит
          как следующая строка:
        </p>
        <pre class="screen">
NROFF  /usr/bin/nroff -Tlatin1 -mandoc
</pre>
        <p>
          Заметьте, что &ldquo;<span class="quote">latin1</span>&rdquo; должно быть
          использовано даже если это не используется в кодировке установденной локали.
          Смысл в том, что согласно спецификации, <span><b class=
          "command">groff</b></span> не имеет обозначений типа символов, установленного
          вне Интернациональной Организации по Стандартам (ISO) 8859-1, без
          некоторых неизвестных escape-кодов. Когда ман-страница форматирована,
          <span><b class="command">groff</b></span> думает, что она в кодировке
          ISO 8859-1 и этот ключ <i class="parameter"><tt>-Tlatin1</tt></i>
          говорит <span><b class="command">groff</b></span> использовать для вывода
	  ту же самую кодировку.
          Посе этого <span><b class="command">groff</b></span> не перекодирует
          входные символы, форматированный результат на выходе будет в той же
          кодировке, как и на входе, и это также можно использовать как вход для
          pager-а.
        </p>
        <p>
          Это не решает проблему с неработающей программой <span><b class=
          "command">man2dvi</b></span> для локализованных man-страниц в
          не-ISO 8859-1 локалях. Также это не работает с мультибайтными
          символами. Первая проблема пока не имеет решеня.
          Вторая проблема не интересна потому, что инсталяция LFS не
          поддерживает мультибайтные символы.
        </p>
        <p>
          Дополнительная информация с описанием сжатия страниц man и
          info может быть найдена в книге BLFS в <a href=
          "http://www.linuxfromscratch.org/blfs/view/cvs/postlfs/compressdoc.html">
          <i>http://www.linuxfromscratch.org/blfs/view/cvs/postlfs/compressdoc.html</i></a>.
        </p>
      </div>
      <div class="content" lang="en" xml:lang="en">
        <div class="titlepage">
          <a id="contents-man" name="contents-man"></a>
          <h2 class="sect2">
            6.47.2. Описание Man
          </h2>
        </div>
        <div class="segmentedlist">
          <p>
            <b>Проинсталированные программы:</b> apropos, makewhatis, man, man2dvi,
            man2html и whatis
          </p>
        </div>
        <div class="variablelist">
          <h3>
            Короткое описание
          </h3>
          <dl>
            <dt>
              <a id="apropos" name="apropos"></a><span class=
              "term"><span><b class="command">apropos</b></span></span>
            </dt>
            <dd>
              <p>
                Ищет в базе данных whatis и отображает краткое описание системной
		команды, которое содержит указанную строку.
              </p>
            </dd>
            <dt>
              <a id="makewhatis" name="makewhatis"></a><span class=
              "term"><span><b class="command">makewhatis</b></span></span>
            </dt>
            <dd>
              <p>
                Создает базу данных whatis. Он рассматривает все страницы документации
		man в соответствующих путях и добавляет запись команды и ее краткого
		описания в базу данных whatis.
              </p>
            </dd>
            <dt>
              <a id="man" name="man"></a><span class="term"><span><b class=
              "command">man</b></span></span>
            </dt>
            <dd>
              <p>
                Форматирует и отображает запрошенную man-страницу.
              </p>
            </dd>
            <dt>
              <a id="man2dvi" name="man2dvi"></a><span class=
              "term"><span><b class="command">man2dvi</b></span></span>
            </dt>
            <dd>
              <p>
                Конвертирует man-страницу в формат dvi.
              </p>
            </dd>
            <dt>
              <a id="man2html" name="man2html"></a><span class=
              "term"><span><b class="command">man2html</b></span></span>
            </dt>
            <dd>
              <p>
                Конвертирует man-страницу в html.
              </p>
            </dd>
            <dt>
              <a id="whatis" name="whatis"></a><span class=
              "term"><span><b class="command">whatis</b></span></span>
            </dt>
            <dd>
              <p>
                Ищет в базе данных whatis и отображает краткое описание системной
		команды, содержащей указанное ключевое слово или несколько слов.
              </p>
            </dd>
          </dl>
        </div>
      </div>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="gzip.html" title="Gzip-1.3.5">Назад</a>
          <p>
            Gzip-1.3.5
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="make.html" title="Make-3.80">Далее</a>
          <p>
            Make-3.80
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="chapter06.html" title=
          "Глава&nbsp;6.&nbsp;Установка основных системных программ">Наверх</a>.
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Linux From Scratch - Версия 6.0">В начало</a>.
        </li>
      </ul>
    </div>
  </body>
</html>
