<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8" /><link rel="stylesheet" href="../tpl/style.css@f4e332aa" type="text/css" /><link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css' /><style type="text/css">h1,h2,h3,h4{font-family:'Open Sans',sans-serif}</style><link rel="canonical" href="../4638.rfc" /><meta name="Robots" content="noindex, nofollow" /><title>Перевод RFC 4638 — Согласование для протокола PPPoE значений MTU/MRU более 1492</title><link rel="alternate" type="application/rss+xml" title="RFC2.ru - Русские Переводы RFC" href="../rss.xml"></head><body><div id="content"><div id="nav"><div class="icon i0"></div> <a href="../index.html" accesskey="`">На Главную</a></div><div id="search" class="ya-site-form ya-site-form_inited_no"><form action="http://yandex.ru/sitesearch" method="get" target="_blank"><input type="hidden" name="searchid" value="2154295"/><input type="hidden" name="l10n" value="ru"/><input type="hidden" name="reqenc" value=""/><input type="hidden" name="submit" value="Найти"/><input type="search" value="" name="text" placeholder="Поиск по RFC2.ru" /></form></div><div itemscope itemtype="http://schema.org/ScholarlyArticle"><meta itemprop="inLanguage" content="ru" /><meta itemprop="editor" content="ru" /><div id="header"><h1><a itemprop="headline" href="../4638.rfc">RFC 4638 — Согласование для протокола PPPoE значений MTU/MRU более 1492</a></h1></div><dl class="mute"><dt></dt><dd><div class="icon i1"></div> RFC: 4638</dd><dd><div class="icon i3"></div> Оригинал: <a href="original" target="_blank"><span itemprop="alternativeHeadline">Accommodating a Maximum Transit Unit/Maximum Receive Unit (MTU/MRU) Greater Than 1492 in the</span></a></dd><dd><div class="icon i2"></div> Категория: <span itemprop="articleSection">Информационный</span></dd><dd><div class="icon i4"></div> Дата публикации: <time itemprop="datePublished" datetime="2006-09-06">Сентябрь 2006</time></dd><dd><div class="icon i5"></div> Авторы: <span itemprop="author">Peter Arberg</span>, <span itemprop="author">Diamantis Kourkouzelis</span>, <span itemprop="author">Mike Duckett</span>, <span itemprop="author">Tom Anschutz</span>, <span itemprop="author">Jerome Moisand</span></dd><dd><div class="icon i6"></div> Перевод: <span itemprop="editor">Николай Малых</span></dd></dl><div id="text" itemprop="articleBody"><h3>Статус документа</h3><p>В этом документе содержится информация для сообщества Internet. Документ не задает каких-либо стандартов Internet и может распространяться без ограничений.</p><h3>Замечание IESG</h3><p>На момент создания этого документа не была стандарта IEEE, поддерживающего использование "jumbo-кадров" (MTU более 1500). Хотя в этом документе описан рекомендуемый механизм обнаружения проблем, связанных с использованием таких кадров, интероперабельность и надежность нестандартных расширений не может быть гарантирована. Разработчикам и пользователям описанного здесь протокола следует с осторожностью подходить к его применению.</p><h3>Тезисы</h3><p>Протокол PPPoE (Point-to-Point Protocol over Ethernet), описанный в RFC 2516, диктует ограничение на максимальное значение согласованного размера максимального принимаемого блока данных (MRU, Maximum Receive Unit) — 1492. В этом документе предложено решение, позволяющее смягчить данное ограничение и позволить согласование значений MRU более 1492 для снижения уровня фрагментации в широкополосных сетях нового поколения.</p><h2>Оглавление</h2><ul class="map"><li><a href="print#p1" title="Введение">1. Введение</a></li><li><a href="print#p2" title="Терминология">2. Терминология</a></li><li><a href="print#p3" title="Предлагаемое решение">3. Предлагаемое решение</a></li><li><a href="print#p4" title="Этап PPPoE Discovery">4. Этап PPPoE Discovery</a></li><li><a href="print#p5" title="Вопросы LCP">5. Вопросы LCP</a></li><li class="lia"><a href="print#p5.1" title="Согласование MRU">5.1. Согласование MRU</a></li><li class="lia"><a href="print#p5.2" title="MRU Test and Troubleshooting">5.2. MRU Test and Troubleshooting</a></li><li><a href="print#p6" title="Вопросы безопасности">6. Вопросы безопасности</a></li><li><a href="print#p7" title="Согласование с IANA">7. Согласование с IANA</a></li><li><a href="print#p8" title="Благодарности">8. Благодарности</a></li><li><a href="print#p9" title="Нормативные документы">9. Нормативные документы</a></li><li><a href="print#p10" title="Дополнительная литература">10. Дополнительная литература</a></li></ul><h2 id="p1">1. Введение</h2><p>Широкополосные сети переходят от инициируемых ПК сессий PPPoE [1] и инфраструктуры Ethernet/ATM (см. рисунок 1) к более интеллектуальным системам PPPoE со шлюзами RG и инфраструктурой Gigabit Ethernet/ATM (рис. 2 и 3), требуя при этом повышения максимального размера передаваемых и принимаемых блоков информации PPPoE для снижения уровня фрагментации пакетов в сети.</p><pre>  &lt;------------------ PPPoE session ------------------&gt;

                                  +-----+           +-----+
+--+              +---+           |     |           |     |
|PC|--------------|CPE|-----------|DSLAM|-----------| BRAS|
+--+  &lt;Ethernet&gt;  +---+   &lt;ATM&gt;   |     |   &lt;ATM&gt;   |     |
                                  +-----+           +-----+

Рисунок 1: Традиционная структура широкополосной сети PPPoE.</pre><p>В схеме, показанной на рисунке 1, фрагментация обычно не вызывает проблем, поскольку абонентские сеансы PPPoE организуются между ПК и BRAS. Следовательно, согласование для PPP значения MRU в 1492 октета приемлемо, поскольку оно обеспечивает возможность включения кадра PPPoE с максимальным размером в стандартный блок Ethernet MTU (1500 октетов).</p><pre>&lt;----- IPoE -----&gt; &lt;--------- PPPoE session ---------&gt;

                                  +-----+            +-----+
+--+              +---+           |     |            |     |
|PC|--------------| RG|-----------|DSLAM|------------| BRAS|
+--+  &lt;Ethernet&gt;  +---+   &lt;ATM&gt;   |     |   &lt;GigE&gt;   |     |
                                  +-----+            +-----+

Рисунок 2: Структура сети PPPoE нового поколения.</pre><p>В сети, показанной на рисунке 2, фрагментация становится основной проблемой, поскольку абонентская сессия объединяет в себе IpoE и PPPoE. Протокол IPoE обычно использует значение MTU в 1500 октетов. Однако, когда шлюз RG и концентратор BRAS являются конечными точками сессий PPPoE и, следовательно, не могут согласовать между собой значения MTU/MRU более 1492 октетов, в результате в сети существенно повышается уровень фрагментации пакетов.</p><pre> &lt;----- IPoE -----&gt; &lt;---- PPPoA ----&gt; &lt;- PPPoE session -&gt;

                                   +-----+            +-----+
+--+              +---+            |     |            |     |
|PC|--------------| RG|------------|DSLAM|------------| BRAS|
+--+  &lt;Ethernet&gt;  +---+    &lt;ATM&gt;   |     |   &lt;GigE&gt;   |     |
                                   +-----+            +-----+


  &lt;-------------- PPPoA -------------&gt; &lt;- PPPoE session -&gt;

                                   +-----+            +-----+
+--+              +---+            |     |            |     |
|PC|--------------|CPE|------------|DSLAM|------------| BRAS|
+--+    &lt;ATM&gt;     +---+    &lt;ATM&gt;   |     |   &lt;GigE&gt;   |     |
                                   +-----+            +-----+

Рисунок 3: Широкополосная сеть с преобразованием PPPoA-PPPoE</pre><p>В показанной на рисунке 3 схеме сети, которая исследовалась в DSL-Forum в контексте перехода к Ethernet для широкополосных объединенных сетей, фрагментация не является единственной проблемой, когда существует различие между MRU для сеансов PPPoA (Point-to-Point Protocol over AAL5) и PPPoE.</p><p>Пользовательская сессия представляет собой сеанс PPP, работающий через комбинацию PPPoA и PPPoE. Хост PPP/PPPoA обычно согласует значение 1500 октетов для MRU. Широко распространенные хосты PPP/PPPoA в оборудовании CPE (Customer Premises Equipment) не поддерживают MRU в 1492 октета, что создает проблему для BRAS (сервер <a href="../2516.rfc" title="RFC 2516 - Метод передачи PPP через Ethernet (PPPoE)">PPPoE</a>) при строгом выполнении требований RFC 2516 [1]. Если хосты PPP/PPPoA способны согласовать MRU=1492, мы возвращаемся к проблеме фрагментации.</p><h2 id="p2">2. Терминология</h2><p>Ключевые слова: необходимо (MUST), недопустимо (MUST NOT), требуется (REQUIRED), нужно (SHALL), не нужно (SHALL NOT), следует (SHOULD), не следует (SHOULD NOT), рекомендуется (RECOMMENDED), возможно (MAY), необязательно (OPTIONAL) в данном документе интерпретируются в соответствии с RFC 2119 [3].</p><ul><li>ATM — асинхронный режим передачи (Asynchronous Transfer Mode)</li><li>PPP — протокола связи "точка-точка" (Point-to-Point Protocol)</li><li>PPPoA — протокол PPP через AAL5 (PPP over AAL5)</li><li>PPPoE — протокол PPP через Ethernet (PPP over Ethernet)</li><li>MTU — максимальный размер передаваемого блока (Maximum Transmit Unit)</li><li>MRU — максимальный размер принимаемого блока (Maximum Receive Unit)</li><li>PC — персональный компьютер (Personal Computer)</li><li>CPE — оборудование, размещенное у абонента (Customer Premises Equipment)</li><li>RG — шлюз, расположенный в жилом районе (Residential Gateway)</li><li>BRAS — широкополосный сервер удаленного доступа (Broadband Remote Access Server)</li><li>DSLAM — мультиплексор цифровых абонентских линий доступа (Digital Subscriber Line Access Multiplexer)</li><li>PPPoE client — клиентский ПК, RG или CPE, инициирующие сеанс PPPoE</li><li>PPPoE server — сервер BRAS, завершающий инициированную клиентом сессию PPPoE</li><li>PADI — пакет обнаружения сервера (PPPoE Active Discovery Initiation)</li><li>PADO — пакет с предложением услуг от сервера (PPPoE Active Discovery Offer)</li><li>PADR — запрос на обслуживание клиента (PPPoE Active Discovery Request)</li><li>PADS — подтверждение сеанса PPPoE (PPPoE Active Discovery Session-confirmation)</li></ul><h2 id="p3">3. Предлагаемое решение</h2><p>Процедура, описанная в этом документе, не соответствует в точности требованиям стандартов IEEE для размера пакетов Ethernet, но она основана широко распространенных кадрах с форматом пакетов Ethernet, хотя их размер превышает максимально допустимое значение, заданное в [4].</p><p>Поскольку широкополосные сети нового поколения строятся на базе систем Ethernet, поддерживающих кадры baby-giants и jumbo с размером поля данных, превышающим обычное значение Ethernet MTU в 1500 октетов, устройства BRAS, действующие как серверы PPPoE, должны поддерживать для PPPoE MRU согласование значений более 1492 октетов, чтобы ограничить уровень фрагментации пакетов в сети, как было сказано в главе 1.</p><p>По умолчанию опция MRU должна соответствовать требованиям RFC 1661 [2], но недопустимо согласовывать значения более 1492 для обеспечения совместимости с сегментами сетей Ethernet, в которых размер кадра ограничен 1500 октетами. Заголовок PPPoE занимает 6 октетов, а идентификатор PPP Protocol ID — 2 octets, что в результате и делает недопустимым для PPP MRU использование значений более 1492.</p><p>Необязательный тег PPPoE "PPP-Max-Payload" позволяет клиенту PPPoE изменить принятое по умолчанию поведение, задавая для информационного поля PPP максимальное значение, поддерживаемое в обоих направлениях. Когда сервер PPPoE получает такой тег, он может разрешить согласование значения MRU > 1492 и использовать значения MTU &gt; 1492, в зависимости от заданных локальной конфигурацией параметров и в соответствии с правилами, установленными RFC 1661 [2], а также учитывая максимальный размер информационного поля, заданный клиентом PPPoE.</p><h2 id="p4">4. Этап PPPoE Discovery</h2><p>Если клиент PPPoE желает использовать значение MTU/MRU более 1492 октетов, он должен включить тег PPP-Max-Payload в пакеты PADI и PADR. Если сервер PPPoE может поддерживать MTU/MRU более 1492 октетов, он должен скопировать полученный от клиента тег PPP-Max-Payload в передаваемые клиенту пакеты PADO и PADS.</p><ul><li><strong>Tag-name:</strong> PPP-Max-Payload</li><li><strong>Tag-value:</strong> 0x0120</li><li><strong>Tag-length:</strong> 2 октета</li><li><strong>Tag-value:</strong> бинарное значение (максимальный размер поля данных PPP в октетах)</li></ul><p>Описание тега</p><ul><li>
Этот тег показывает, что клиент и сервер способны поддерживать указанное в теге максимальное значение размера поля данных PPP более 1492 октетов для обоих направлений обмена данными. Отметим, что это значение определяет размер данных PPP и, следовательно, его можно напрямую сопоставлять со значением, используемым при согласовании PPP MRU.</li></ul><h2 id="p5">5. Вопросы LCP</h2><h3 id="p5.1">5.1. Согласование MRU</h3><p>Поскольку для Ethernet (без кадров jumbo) максимальный размер данных ограничен 1500 октетами, заголовок PPPoE занимает 6 октетов, а поле PPP Protocol ID — 2 октета, для опции MRU (Maximum-Receive-Unit) недопустимо согласовывать значение более 1492 октетов, если клиент и сервер PPPoE не указали свою возможность использования больших значений MRU на этапе PPPoE Discovery.</p><p>Начальное согласование MRU для сервера PPP/PPPoE должно следовать приведенной ниже процедуре:</p><pre>If PPPoE {
    PPP_MRU_Max = 1492
    If (PPP-Max-Payload-Tag) AND (PPP-Max-Payload-Tag &gt; 1492)
        Then PPP_MRU_Max = min (PPP-Max-Payload-Tag, Interface MTU-8)
}
нормальная процедура PPP_MRU_Negotiation (PPP_MRU_Max)</pre><p>Если присутствует тег PPP-Max-Payload со значением более 1492, это значение должно рассматриваться наряду с установками MTU для интерфейсов сервера при нормальном согласовании в соответствии RFC 1661 [2] используемого протоколом значения MRU.</p><p>Если тег PPP-Max-Payload не задан или указывает значение меньше 1492, существующее для MRU ограничение 1492 должно сохранять свою применимость в целях обеспечения совместимости с более ранними версиями.</p><p>Таким образом, в результате имеет место следующее поведение:</p><ol><li><p>При получении тега PPP-Max-Payload</p><ul class="lat"><li>значение этого тега показывает значение MRU, допущенное или предложенное при согласовании MRU</li><li>если значение MRU не согласовано, RFC 1661 [2] будет задавать принятое по умолчанию значение MRU = 1500. Это говорит о том, что тег PPP-Max-Payload может указывать значение более 1500, но в этом случае RFC 1661 [2] установит принятое по умолчанию значение 1500, а заданное тегом PPP-Max-Payload большее значение может быть использовано только в тех случаях, когда согласовано достаточно большое значение MRU (вплоть до максимального размера поля данных).</li></ul></li><li>Если тег PPP-Max-Payload не получен ни одной из сторон, используется правило, заданное в RFC 2516 [1].</li></ol><h3 id="p5.2">5.2. Тестирование MRU и поиск неполадок</h3><p>Если для MRU согласовано значение более 1492 октетов, передающей стороне следует иметь опцию для передачи одного или более пакета Echo-Request размером MRU в начале сеанса. Это позволит убедиться в том, что принимающая сторона, все промежуточные сегменты Ethernet и оборудование могут работать с пакетами такого размера.</p><p>Если в ответ не было получено откликов Echo-Replies, передающая сторона может повторить проверку с помощью пакетов Echo-Request размером 1492 октета. Если на эти пакеты будут получены отклики, передающая сторона должна отправлять в этой сессии пакеты размером не более 1492 октетов.</p><p>Такую проверку следует включать по умолчанию. Ее следует делать настраиваемой и можно отключать в сетях, где есть основания (предварительный опыт) считать такую проверку ненужной.</p><h2 id="p6">6. Вопросы безопасности</h2><p>Этот документ не создает новых проблем, связанных с безопасностью. Вопросы безопасности, относящиеся к исходному протоколу PPPoE [1], сохраняют свою актуальность.</p><h2 id="p7">7. Согласование с IANA</h2><p>Этот документ определяет новое значение в пространстве, для которого в настоящее время не используется реестра IANA. Ведется работа по созданию такого реестра [5] и подготавливаемый документ уже содержит выделенное здесь значение. От IANA не требуется никаких действий в связи с настоящим документом.</p><h2 id="p8">8. Благодарности</h2><p>Авторы выражают свою признательность Prakash Jayaraman, Amit Cohen, Jim Ellis, David Thorne, John Reid, Oliver Thorp, Wojciech Dec, Jim Wilks, Mark Townsley, Bart Salaets, Tom Mistretta, Paul Howard, Dave Bernard и Darren Nobel за их вклад и комментарии к документу.</p><h2 id="p9">9. Нормативные документы</h2><table itemprop="references"><tr><td>[1]</td><td>Mamakos, L., Lidl, K., Evarts, J., Carrel, D., Simone, D., и R. Wheeler, <a href="../2516.rfc" title="RFC 2516 - Метод передачи PPP через Ethernet (PPPoE)">«Метод передачи PPP через Ethernet (PPPoE)», RFC 2516</a>, Февраль 1999.</td></tr><tr><td>[2]</td><td>Simpson, W., «The Point-to-Point Protocol (PPP)», STD 51, RFC 1661, Июль 1994.</td></tr><tr><td>[3]</td><td>Bradner, S., «Key words for use in RFCs to Indicate Requirement Levels», BCP 14, RFC 2119, Март 1997.</td></tr><tr><td>[4]</td><td>Institute of Electrical and Electronic Engineers, IEEE Std 802.3-2005, «IEEE Standard for Carrier Sense Multiple Access with Collision Detection (CSMA/CD) Access Method and Physical Layer Specifications — Draft amendment to — Information technology — Telecommunications and information exchange between systems — Local and metropolitan area networks — Specific requirements — Part 3: Carrier sense multiple access with collision detection (CSMA/CD) access method and physical layer specifications — Media Access Control Parameters, Physical Layers and Management Parameters», Декабрь 2005.</td></tr></table><h2 id="p10">10. Дополнительная литература</h2><table itemprop="references"><tr><td>[5]</td><td>Arberg, P. и V. Mammoliti, «IANA Considerations for PPP over Ethernet (PPPoE)», Work in Progress, Июнь 2006.</td></tr></table><h2>Адреса авторов</h2><p>Peter Arberg<br />Redback Networks, Inc.<br />300 Holger Way<br />San Jose, CA 95134<br />EMail: <bdo dir="rtl">&#109;&#111;&#99;&#46;&#107;&#99;&#97;&#98;&#100;&#101;&#114;&#64;&#103;&#114;&#101;&#98;&#114;&#97;&#112;</bdo></p><p>Diamantis Kourkouzelis<br />Redback Networks, Inc.<br />300 Holger Way<br />San Jose, CA 95134<br />EMail: <bdo dir="rtl">&#109;&#111;&#99;&#46;&#107;&#99;&#97;&#98;&#100;&#101;&#114;&#64;&#107;&#100;&#110;&#111;&#109;&#97;&#105;&#100;</bdo></p><p>Mike Duckett<br />BellSouth Telecommunications, Inc.<br />575 Morosgo Drive<br />Atlanta, GA 30324<br />EMail: <bdo dir="rtl">&#109;&#111;&#99;&#46;&#104;&#116;&#117;&#111;&#115;&#108;&#108;&#101;&#98;&#64;&#116;&#116;&#101;&#107;&#99;&#117;&#100;&#46;&#101;&#107;&#105;&#109;</bdo></p><p>Tom Anschutz<br />BellSouth Science and Technology<br />725 W. Peachtree St.<br />Atlanta, GA 30308<br />EMail: <bdo dir="rtl">&#109;&#111;&#99;&#46;&#104;&#116;&#117;&#111;&#115;&#108;&#108;&#101;&#98;&#64;&#122;&#116;&#117;&#104;&#99;&#115;&#110;&#97;&#46;&#109;&#111;&#116;</bdo></p><p>Jerome Moisand<br />Juniper Networks, Inc.<br />10 Technology Park Drive<br />Westford, MA 01886<br />EMail: <bdo dir="rtl">&#116;&#101;&#110;&#46;&#114;&#101;&#112;&#105;&#110;&#117;&#106;&#64;&#100;&#110;&#97;&#115;&#105;&#111;&#109;&#106;</bdo></p></div></div><div id="disqus_thread"></div><script type="text/javascript">var disqus_shortname="rfc2",disqus_title="RFC 4638 - Согласование для протокола PPPoE значений MTU/MRU более 1492",disqus_identifier="4638.rfc",disqus_url="http://rfc2.ru/4638.rfc";(function(){var dsq=document.createElement("script");dsq.type="text/javascript";dsq.async=true;dsq.src = "//"+disqus_shortname+".disqus.com/embed.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(dsq);})();</script><div class="bubble">2007 - 2014 © <a href="../index.html" title="Русские переводы RFC">Русские переводы RFC</a>, IETF, ISOC.</div></div><div id="bottom" style="position:static !important;bottom:auto !important"><div class="bubble"><ul><li><!--723572853672--></li></ul></div></div><!-- Yandex.Metrika counter --><script type="text/javascript">(function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter4680559 = new Ya.Metrika({id:4680559, webvisor:true, clickmap:true, accurateTrackBounce:true, trackHash:true, ut:"noindex"}); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="http://mc.yandex.ru/watch/4680559?ut=noindex" style="position:absolute; left:-9999px;" alt="" /></div></noscript><!-- /Yandex.Metrika counter --></body></html>