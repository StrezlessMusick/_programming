<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8" /><link rel="stylesheet" href="../tpl/style.css@f4e332aa" type="text/css" /><link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css' /><style type="text/css">h1,h2,h3,h4{font-family:'Open Sans',sans-serif}</style><link rel="canonical" href="../2427.rfc" /><meta name="Robots" content="noindex, nofollow" /><title>Перевод RFC 2427 — Многопротокольные соединения через Frame Relay</title><link rel="alternate" type="application/rss+xml" title="RFC2.ru - Русские Переводы RFC" href="../rss.xml"></head><body><div id="content"><div id="nav"><div class="icon i0"></div> <a href="../index.html" accesskey="`">На Главную</a></div><div id="search" class="ya-site-form ya-site-form_inited_no"><form action="http://yandex.ru/sitesearch" method="get" target="_blank"><input type="hidden" name="searchid" value="2154295"/><input type="hidden" name="l10n" value="ru"/><input type="hidden" name="reqenc" value=""/><input type="hidden" name="submit" value="Найти"/><input type="search" value="" name="text" placeholder="Поиск по RFC2.ru" /></form></div><div itemscope itemtype="http://schema.org/ScholarlyArticle"><meta itemprop="inLanguage" content="ru" /><meta itemprop="editor" content="ru" /><div id="header"><h1><a itemprop="headline" href="../2427.rfc">RFC 2427 — Многопротокольные соединения через Frame Relay</a></h1></div><dl class="mute"><dt></dt><dd><div class="icon i1"></div> RFC: 2427</dd><dd><div class="icon i3"></div> Оригинал: <a href="original" target="_blank" rel="nofollow"><span itemprop="alternativeHeadline">Multiprotocol Interconnect over Frame Relay</span></a></dd><dd><div class="icon i7"></div> Предыдущие версии: RFC 1294, RFC 1490</dd><dd><div class="icon i2"></div> Категория: <span itemprop="articleSection">Стандарт Интернета</span></dd><dd><div class="icon i4"></div> Дата публикации: <time itemprop="datePublished" datetime="1998-09-17">Сентябрь 1998</time></dd><dd><div class="icon i5"></div> Авторы: <span itemprop="author">Andrew Malis</span>, <span itemprop="author">Caralyn Brown</span></dd><dd><div class="icon i6"></div> Перевод: <span itemprop="editor">Николай Малых</span></dd></dl><div id="text" itemprop="articleBody"><h3>Статус документа</h3><p>Этот документ содержит спецификации стандарта Internet для сообщества Internet и приглашает к обсуждению вопроса для дальнейшего развития стандарта. Статус документа вы можете найти в текущей редакции Internet Official Protocol Standards (STD 1). Допускается свободное распространение документа.</p><h3>Тезисы</h3><p>В этом документе описаны методы инкапсуляции для передачи межсетевого трафика через магистрали Frame Relay. В документе рассмотрены вопросы маршрутизации и организации мостов (Bridging).</p><p>Системы, способные поддерживать оба описанных pltcm метода инкапсуляции, а также иные методы, должны знать a-priori для каких виртуальных устройств используется тот или иной метод инкапсуляции. Инкапсуляция определенного типа может использоваться только для тех виртуальных устройств, которые настроены на такое использование.</p><h3>Благодарности</h3><p>Этот документ не был бы завершен без поддержки Terry Bradley из компании Avici Systems, Inc.. В документе содержатся результаты работы множества людей. Особо отметим вклад Ray Samora (Proteon), Ken Rehbehn (Visual Networks), Fred Baker и Charles Carvalho (Cisco Systems), Mostafa Sherif (AT&amp;T). Отдельная благодарность выражается Dory Leifer (University of Michigan) за вклад в рассмотрение вопросов фрагментации (несмотря на то, что этот раздел был удален из окончательной версии документа), а также Floyd Backes и Laura Bridge (3Com) за их вклад в рассмотрение вопросов, связанных с мостами. Документ никогда бы не удалось завершить без использования опыта рабочих групп IETF «IP over Large Public Data Networks» и «IP over NBMA».</p><h2>1. Терминология и сокращения</h2><p>Ключевые слова необходимо (MUST), недопустимо (MUST NOT), требуется (REQUIRED), нужно (SHALL), не нужно (SHALL NOT), следует (SHOULD), не следует(SHOULD NOT), рекомендуется (RECOMMENDED), возможно (MAY), необязательно (OPTIONAL) в данном документе должны интерпретироваться в соответствии с документом <a href="../2119.rfc" title="RFC 2119 - Ключевые слова для обозначения уровня требований в RFC">RFC 2119</a>.</p><p>На схемах в документе биты выводятся слева направо по старшинству (младший бит слева):</p><pre>0   1   2   3   4   5   6   7 биты октета
+---+---+---+---+---+---+---+

+---------------------------+
|    Флаг (7E hexadecimal)  |
+---------------------------+
|        Адрес  Q.922       |
+--                       --+
|                           |
+---------------------------+
:                           :
:                           :
+---------------------------+</pre><p>Для больших диаграмм в одной строке может размещаться изображение двух октетов. На некоторых рисунках старший бит показан слева (такие случаи указаны явно).</p><pre>|---    октет 1      ---|---   октет  2   ---|
0  1  2  3  4  5  6  7  0  1  2  3  4  5  6  7
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

+--------------------------------------------+
| Уникальный идентификатор                   |
+--                     +--------------------+
| организации           | Идентификатор      |
+-----------------------+--------------------+
| протокола             |
+-----------------------+</pre><p>Ниже приведен список основных сокращений, использованных в документе:</p><ul class="dot"><li>BECN Backward Explicit Congestion Notification — обратное уведомление о насыщении</li><li>BPDU Bridge Protocol Data Unit — единица данных протокола моста</li><li>C/R  Command/Response bit — бит команда/отклик</li><li>DCE Data Communication Equipment — коммуникационное оборудование</li><li>DE Discard Eligibility bit — бит возможности отбрасывания</li><li>DTE Data Terminal Equipment — терминальное оборудование</li><li>FECN Forward Explicit Congestion Notification — прямое уведомление о насыщении</li><li>PDU Protocol Data Unit — единица данных протокола</li><li>PTT Postal Telephone & Telegraph (название компании)</li><li>SNAP Subnetwork Access Protocol — протокол доступа в подсеть.</li></ul><h2>2. Введение</h2><p>Рассмотренные ниже вопросы относятся к устройствам, функционирующим в качестве конечных станций (end station, DTE) частных или публичных сетей Frame Relay. Поведение станций, являющихся частью сети Frame Relay (DCE), рассматриваться не будет, за исключением тех случаев, в которых от этого поведения зависит реакция устройств DTE.</p><p>Сеть Frame обеспечивает множество виртуальных устройств (virtual circuit), создающих основу для организации соединений между станциями, подключенными к одной сети Frame Relay. Набор соединенных между собой устройств формирует частную группу Frame Relay, члены которой могут быть соединены со всеми остальными (многосвязная сеть с использованием всех возможных соединений) или только с частью других станций. В любом случае каждое виртуальное устройство уникально идентифицируется на каждом интерфейсе Frame Relay с помощью DLCI (Data Link Connection Identifier — идентификатор соединения на канальном уровне). В большинстве случаев значения DLCI имеют локальную значимость в масштабах каждого интерфейса Frame Relay.</p><p>Рассматриваемые в этом документе спецификации применимы как к коммутируемым (switched), так и к постоянным (permanent) виртуальным устройствам.</p><h2>3. Формат кадров</h2><p>Все протоколы должны инкапсулировать свои пакеты в кадры Q.922 Annex A [1]. Кроме того, рекомендуется включать в кадры информацию, позволяющую идентифицировать протокол, передаваемый в PDU — это дает возможность приемнику корректно обрабатывать входящие пакеты. Формат пакетов показан ниже:</p><pre>+---------------------------+
|    Флаг (7E hexadecimal)  |
+---------------------------+
|        Адрес Q.922        |
+--                       --+
|                           |
+---------------------------+
|    Control (UI = 0x03)    |
+---------------------------+
|Заполнение - необяз. (0x00)|
+---------------------------+
|           NLPID           |
+---------------------------+
|             .             |
|             .             |
|             .             |
|           Данные          |
|             .             |
|             .             |
+---------------------------+
|  Контрольная сумма FCS    |
+--           .           --+
|        (2 октета)         |
+---------------------------+
|   Флаг (7E hexadecimal)   |
+---------------------------+</pre><p>Адреса Q.922 в соответствии с действующим стандартом являются 2-октетными и содержат 10-битовые идентификаторы DLCI. В некоторых сетях адреса Q.922 могут быть увеличены до 3 или 4 октетов.</p><p>Поле Control представляет собой поле управления Q.922. Если явно не оговорено иное, в качестве значения этого пол используется UI (0x03). Допустимо использование значения XID (0xAF или 0xBF), рассмотренного ниже.</p><p>Необязательное поле pad используется для выравнивания оставшейся части кадра по 2-октетной границе. Поле pad может содержать один или два октета; значение октетов заполнения должно быть нулевым. Далее будут приведены явные рекомендации по использованию пол заполнения.</p><p>Значения пол идентификатора протокола сетевого уровня NLPID (Network Level Protocol ID) распределяются ISO и ITU. Предусмотрены идентификаторы для множества распространенных протоколов, включая IP, CLNP и IEEE Subnetwork Access Protocol (SNAP) [10]. Это поле говорит принимающему устройству об используемом методе инкапсуляции и передаваемом протоколе. Возможные значения пол определены стандартом ISO/IEC TR 9577 [3]. Значение NLPID=0x00 определено в ISO/IEC TR 9577 как Null Network Layer или Inactive Set. Поскольку это значение невозможно отличить от заполнения, а в данной схеме инкапсуляции это значение просто не имеет смысла, при рассмотрении инкапсуляции Frame Relay значение NLPID=0x00 считается некорректным. В приложении A содержится список наиболее распространенных значений NLPID.</p><p>Для сетей Frame Relay не существует общепринятого нижнего порога для максимального размера кадров. Реальные сети, однако, должны поддерживать кадры размером, по крайней мере, 262 октета. В общем случае максимальный размер кадра больше или равен 1600 октетов, но каждый оператор Frame Relay может выбрать для своей сети наиболее подходящее значение. Устройства DTE в сетях Frame Relay, следовательно, должны обеспечивать возможность настройки значений максимального размера кадров.</p><p>Минимальный размер кадров Frame Relay требует наличия не менее 5 октетов между стартовым и закрывающим флагами с учетом 2-октетного поля адреса Q.922. Это значение возрастает до 6 октетов для 3-октетного адреса Q.922 и до 7 октетов в случае использования 4-октетного формата для адресов Q.922.</p><h2>4. Межсетевые соединения</h2><p>Существует два основных типа пакетов, передаваемых через сети Frame Relay — маршрутизируемые пакеты и пакеты, передаваемые с использованием мостов (bridged). Для этих пакетов используются различные форматы и, следовательно, должен обеспечиваться способ идентификации, позволяющий получателю корректно интерпретировать содержимое кадра. Индикатор типа помещается в поле NLPID и заголовок SNAP.</p><p>Для тех протоколов, которые еще не получили идентификатора NLPID, требуется обеспечить механизм простой идентификации протокола. Существует значение NLPID, показывающее присутствие заголовка SNAP.</p><p>Заголовок SNAP имеет форму:</p><pre>+--------------------------------------------+
| Уникальный идентификатор                   |
+--                     +--------------------+
| организации           | Идентификатор      |
+-----------------------+--------------------+
| протокола             |
+-----------------------+</pre><p>Трехоктетное поле OUI (Organizationally Unique Identifier) указывает организацию, ответственную за администрирование последующего идентификатора протокола (PID). Значения OUI и PID совместно позволяют однозначно идентифицировать протокол. Отметим, что значение OUI=0x00-00-00 указывает, что поле PID имеет значение Ethertype.</p><h3>4.1. Маршрутизируемые кадры</h3><p>С некоторыми протоколами связаны значения NLPID, но ограниченность пространства номеров NLPID не позволяет выделить такие идентификаторы для всех протоколов. Когда пакеты протоколов, не имеющих идентификатора, маршрутизируются через сети Frame Relay, для таких пакетов используется значение NLPID=0x80 (оно говорит о наличии SNAP), за которым следует заголовок SNAP. Если для протокола выделено значение Ethertype, поле OUI имеет значение 0x00-00-00 (это значение говорит о наличии поля Ethertype) и поле PID принимает значение Ethertype для используемого протокола.</p><p>При наличии упомянутого выше заголовка SNAP используется один октет заполнения для выравнивания протокольных данных по 2-октетной границе, как показано ниже</p><pre>  Формат маршрутизируемых кадров
       с заголовком SNAP

+-------------------------------+
|          Адрес Q.922          |
+---------------+---------------+
| Control  0x03 | pad     0x00  |
+---------------+---------------+
| NLPID    0x80 | Organization- |
+---------------+               |
| ally Unique Identifier (OUI)  |
+-------------------------------+
| Идентификатор протокола (PID) |
+-------------------------------+
|                               |
|      Протокольные данные      |
|                               |
+-------------------------------+
|              FCS              |
+-------------------------------+</pre><p>В тех случаях, когда протокол имеет идентификатор NLPID (см. Приложение A), можно сократить заголовок на 48 битов за счет использования показанного ниже формата:</p><pre>  Формат маршрутизируемых кадров
  при наличии NLPID для протокола

+-------------------------------+
|          Адрес Q.922          |
+---------------+---------------+
| Control  0x03 |     NLPID     |
+---------------+---------------+
|      Протокольные данные      |
+-------------------------------+
|              FCS              |
+-------------------------------+</pre><p>Инкапсуляция NLPID не требует использовать заполнение, поэтому данное поле отсутствует в заголовке.</p><p>Для некоторых протоколов ISO значение NLPID рассматривается как первый октет данных протокола. В таких случаях нет необходимости дублировать поле NLPID. Один октет используется для демультиплексирования и в качестве данных протокола (см. параграф «Инкапсуляция других протоколов»). Другие протоколы (такие, как IP) имеют значение NLPID (для IP — 0xCC), но это значение не является частью протокольных данных.</p><pre>Формат маршрутизируемой дейтаграммы IP

+-------------------------------+
|          Адрес Q.922          |
+---------------+---------------+
| Control  0x03 |  NLPID  0xCC  |
+---------------+---------------+
|        Дейтаграмма IP         |
+-------------------------------+
|              FCS              |
+-------------------------------+</pre><h3>4.2. Кадры, передаваемые через мосты</h3><p>Вторым типом трафика Frame Relay являются пакеты, передаваемые с использованием мостов (bridged packet). Такие пакеты инкапсулируются с использованием NLPID=0x80 (указывает наличие SNAP). Как и с другими протоколами, использующими SNAP-инкапсулцию, может добавляться один октет заполнения для выравнивания границы данных инкапсулированного кадра. Заголовок SNAP, который следует после NLPID, идентифицирует формат пакета, передаваемого с использованием мостов. Значение OUI, используемое для такой инкапсуляции, является кодом комитета IEEE 802.1 и имеет значение 0x00-80-C2. PID-часть заголовка SNAP (два байта вслед за OUI) указывает формат заголовка MAC, который следует сразу после заголовка SNAP. Кроме того, PID показывает наличие исходной контрольной суммы FCS в bridged-кадре.</p><p>Следуя практике RFC 1638, будем использовать неканонические MAC-адреса получателей для инкапсуляции кадров IEEE 802.5 и FDDI; канонические MAC-адреса получателей будут использоваться для инкапсуляции иных кадров, рассматриваемых в данном параграфе.</p><p>Комитет IEEE 802.1 зарезервировал для использования с Frame Relay следующие значения:</p><table class="c"><tr><td colspan="2">Значения PID для OUI 0x00-80-C2</td><td rowspan="2">Среда</td></tr><tr><td>С сохранением FCS</td><td>Без сохранения FCS</td></tr><tr><td>0x00-01</td><td>0x00-07</td><td>802.3/Ethernet</td></tr><tr><td>0x00-02</td><td>0x00-08</td><td>802.4</td></tr><tr><td>0x00-03</td><td>0x00-09</td><td>802.5</td></tr><tr><td>0x00-04</td><td>0x00-0A</td><td>FDDI</td></tr><tr><td></td><td>0x00-0B</td><td>802.6</td></tr></table><p>Кроме того,  при OUI=0x00-80-C2  указывает на модуль данных BPDU (Bridge Protocol Data Unit), как определено в стандарте 802.1d или 802.1g [12], а значение PID=0x00-0F идентифицирует Source Routing BPDU.</p><p>Пакеты, передаваемые с использованием мостов через сеть Frame Relay, будут, следовательно, иметь один из следующих форматов:</p><pre>         Формат кадров
     Bridged Ethernet/802.3

+-------------------------------+
|         Адрес Q.922           |
+---------------+---------------+
| Control  0x03 | pad     0x00  |
+---------------+---------------+
| NLPID    0x80 | OUI     0x00  |
+---------------+             --+
|        OUI     0x80-C2        |
+-------------------------------+
|    PID 0x00-01 or 0x00-07     |
+-------------------------------+
|     MAC-адрес получателя      |
:                               :
|                               |
+-------------------------------+
|      (остаток кадра MAC)      |
+-------------------------------+
|  LAN FCS (если PID 0x00-01)   |
+-------------------------------+
|              FCS              |
+-------------------------------+</pre><pre>  Формат кадров Bridged 802.4

+-------------------------------+
|         Адрес Q.922           |
+---------------+---------------+
| Control  0x03 | pad     0x00  |
+---------------+---------------+
| NLPID    0x80 | OUI     0x00  |
+---------------+             --+
|        OUI     0x80-C2        |
+-------------------------------+
|    PID 0x00-02 or 0x00-08     |
+---------------+---------------+
| pad      0x00 | Frame Control |
+---------------+---------------+
|     MAC-адрес получателя      |
:                               :
|                               |
+-------------------------------+
|      (остаток кадра MAC)      |
+-------------------------------+
|  LAN FCS (если PID 0x00-02)   |
+-------------------------------+
|              FCS              |
+-------------------------------+</pre><pre>  Формат кадров Bridged 802.5

+-------------------------------+
|         Адрес Q.922           |
+---------------+---------------+
| Control  0x03 | pad     0x00  |
+---------------+---------------+
| NLPID    0x80 | OUI     0x00  |
+---------------+             --+
|        OUI     0x80-C2        |
+-------------------------------+
|    PID 0x00-03 or 0x00-09     |
+---------------+---------------+
| pad      0x00 | Frame Control |
+---------------+---------------+
|     MAC-адрес получателя      |
:                               :
|                               |
+-------------------------------+
|      (остаток кадра MAC)      |
+-------------------------------+
|  LAN FCS (если PID 0x00-03)   |
|                               |
+-------------------------------+
|              FCS              |
+-------------------------------+</pre><pre>Формат кадров Bridged FDDI

+-------------------------------+
|         Адрес Q.922           |
+---------------+---------------+
| Control  0x03 | pad     0x00  |
+---------------+---------------+
| NLPID    0x80 | OUI     0x00  |
+---------------+             --+
|        OUI     0x80-C2        |
+-------------------------------+
|    PID 0x00-04 or 0x00-0A     |
+---------------+---------------+
| pad      0x00 | Frame Control |
+---------------+---------------+
|     MAC-адрес получателя      |
:                               :
|                               |
+-------------------------------+
|      (остаток кадра MAC)      |
+-------------------------------+
|  LAN FCS (если PID 0x00-04)   |
|                               |
+-------------------------------+
|              FCS              |
+-------------------------------+</pre><pre>  Формат кадров Bridged 802.6 

+-------------------------------+
|         Адрес Q.922           |
+---------------+---------------+
| Control  0x03 | pad     0x00  |
+---------------+---------------+
| NLPID    0x80 | OUI     0x00  |
+---------------+             --+
|        OUI     0x80-C2        |
+-------------------------------+
|        PID     0x00-0B        |
+---------------+---------------+ -------
|    Резерв     |     BEtag     |  Заголовок
+---------------+---------------+  Common
|            BAsize             |  PDU
+-------------------------------+ -------
|     MAC-адрес получателя      |
:                               :
|                               |
+-------------------------------+
|      (остаток кадра MAC)      |
+-------------------------------+
|                               |
+-     Трейлер Common PDU      -+
|                               |
+-------------------------------+
|              FCS              |
+-------------------------------+</pre><p class="note">Отметим, что для PDU мостов 802.6 возможно только одно значение PID, поскольку наличие контрольной суммы CRC-32 указывается битом CIB в заголовке кадра MAC.</p><p>Заголовок и трейлер общего модуля данных протокола CPDU (Common Protocol Data Unit) перемещаются для того, чтобы разрешить конвейерную обработку на выходном мосту в подсеть 802.6. В частности, заголовок CPDU содержит поле BAsize, указывающее длину PDU. Если это поле недоступно для выходного моста 802.6, этот мост не сможет начать передачу сегментированного PDU до тех пор, пока не будет получен PDU целиком, рассчитан размер и значение размера помещено в поле BAsize. Если это поле доступно, выходной мост 802.6 может определить размер по значению поля BAsize в заголовке Common PDU, вставить это значение в соответствующее поле первого сегмента и незамедлительно передать пакет в подсеть 802.6. Таким образом, мост может начать передачу 802.6 PDU до того, как PDU будет принят полностью.</p><p>Однако, следует отметить, что заголовок и трейлер Common PDU инкапсулированного кадра не должны просто копироваться в адресуемую подсеть 802.6, поскольку инкапсулированное значение BEtag может конфликтовать с предыдущим значением BEtag, переданным этим мостом.</p><pre>       Формат кадров BPDU

+-------------------------------+
|         Адрес Q.922           |
+-------------------------------+
|        Control   0x03         |
+-------------------------------+
|          PAD     0x00         |
+-------------------------------+
|         NLPID    0x80         |
+-------------------------------+
|        OUI 0x00-80-C2         |
+-------------------------------+
|          PID 0x00-0E          |
+-------------------------------+
|                               |
|     BPDU в соответствии с     |
|    802.1(d) или 802.1(g)[12]  |
|                               |
+-------------------------------+
|              FCS              |
+-------------------------------+</pre><pre>Формат кадров Source Routing BPDU

+-------------------------------+
|         Адрес Q.922           |
+-------------------------------+
|        Control   0x03         |
+-------------------------------+
|          PAD     0x00         |
+-------------------------------+
|         NLPID    0x80         |
+-------------------------------+
|        OUI 0x00-80-C2         |
+-------------------------------+
|          PID 0x00-0F          |
+-------------------------------+
|                               |
|      Source Routing BPDU      |
|                               |
|                               |
+-------------------------------+
|              FCS              |
+-------------------------------+</pre><h2>5. Согласование параметров канального уровня</h2><p>Станции Frame Relay могут по своему выбору поддерживать идентификаторы обмена XID (Exchange Identification), определенные в приложении Appendix III к стандарту Q.922 [1]. Обмен идентификаторами XID позволяет согласовать ряд параметров при инициализации устройства (виртуального соединения) Frame Relay — максимальный размер кадра N201, таймер повторной передачи T200 и максимальное число отложенных информационных (I) кадров K (окно).</p><p>Станция может обозначить свое нежелание поддерживать режим мультикадрового окна с подтверждением, установив нулевое значение для максимального размера окна K.</p><p>Если такой обмен не используется, перечисленные параметры должны быть заданы статически при настройке для станции параметров соединения на канальном уровне DLC (Data Link Connection) или следует использовать принятые по умолчанию значения в соответствии с разделом 5.9 спецификации Q.922:</p><table class="nobrd"><tr><td>N201:</td><td>260 октетов</td></tr><tr><td>K:</td><td>3 для каналов 16 кбит/с,</td></tr><tr><td></td><td>7 для каналов 64 кбит/с,</td></tr><tr><td></td><td>32 для каналов 384 кбит/с,</td></tr><tr><td></td><td>40 для каналов 1.536 и более кбит/с</td></tr><tr><td>T200:</td><td>1.5 сек [см. Q.922]</td></tr></table><p>Если станция, поддерживающая XID, получает кадр XID, она должна передать XID-отклик. Если при обработке XID обнаруживается, что на удаленной станции размер окна меньше локального значения, локальная станция должна уменьшить размер окна для данного соединения DLC в соответствии с заданным для удаленной станции размером окна. Отметим, что такое изменение размера должно быть выполнено до генерации отклика XID.</p><p>На рисунке показан процесс использования XID для отказа от использования мультикадрового окна с подтверждением.</p><pre>Отказ от использования мультикадрового окна

       +---------------+
       |     Адрес     |     (2,3 или 4 октета)
       |               |
       +---------------+
       | Control 0xAF  |
       +---------------+
       | Формат  0x82  |
       +---------------+
       | Group ID 0x80 |
       +---------------+
       | Group Length  |     (2 октета)
       |    0x00-0E    |
       +---------------+
       |      0x05     |     PI = Размер кадра (передача)
       +---------------+
       |      0x02     |     PL = 2
       +---------------+
       |    Maximum    |     (2 октета)
       |   Frame Size  |
       +---------------+
       |      0x06     |     PI = Размер кадра (прием)
       +---------------+
       |      0x02     |     PL = 2
       +---------------+
       | Максимальный  |     (2 октета)
       | размер кадра  |
       +---------------+
       |      0x07     |     PI = Размер окна
       +---------------+
       |      0x01     |     PL = 1
       +---------------+
       |      0x00     |
       +---------------+
       |      0x09     |     PI = Таймер повторной передачи
       +---------------+
       |      0x01     |     PL = 1
       +---------------+
       |      0x00     |
       +---------------+
       |      FCS      |     (2 октета)
       |               |
       +---------------+</pre><h2>6. Преобразование адресов для PVC</h2><p>В данном документе вопросы преобразования адресов рассматриваются только для постоянных соединений PVC. Работа с коммутируемыми соединениями SVC будет рассмотрена в других документах.</p><p>В некоторых ситуациях станциям Frame Relay может потребоваться динамическое преобразование протокольных адресов. Преобразование адресов может быть выполнено с помощью стандартного протокола ARP (Address Resolution Protocol) [<a href="../826.rfc" title="RFC 826 - Протокол преобразования адресов Ethernet (ARP)">RFC826</a>], инкапсулированного в пакетах Frame Relay со SNAP-кодированием:</p><pre>+-----------------------+-----------------------+
|                  Адрес Q.922                  |
+-----------------------+-----------------------+
| Control (UI)  0x03    |     pad     0x00      |
+-----------------------+-----------------------+
|    NLPID    0x80      |                       |  Заголовок SNAP
+-----------------------+  OUI   0x00-00-00     +  показывающий
|                                               |  ARP
+-----------------------+-----------------------+
|                  PID   0x0806                 |
+-----------------------+-----------------------+
|                   Пакет ARP                   |
|                       .                       |
|                       .                       |
|                       .                       |
+-----------------------+-----------------------+</pre><p>Пакет ARP использует следующие форматы и значения:</p><table class="nobrd"><tr><td>ar$hrd</td><td>16 битов</td><td>тип оборудования (Hardware type)</td></tr><tr><td>ar$pro</td><td>16 битов</td><td>тип протокола (Protocol type)</td></tr><tr><td>ar$hln</td><td>8 битов</td><td>размер аппаратного адреса в октетах (n)</td></tr><tr><td>ar$pln</td><td>8 битов</td><td>размер протокольного адреса в октетах (m)</td></tr><tr><td>ar$op</td><td>16 битов</td><td>код операции (запрос или отклик)</td></tr><tr><td>ar$sha</td><td>n октетов</td><td>аппаратный адрес отправителя</td></tr><tr><td>ar$spa</td><td>m октетов</td><td>протокольный адрес отправителя</td></tr><tr><td>ar$tha</td><td>n октетов</td><td>аппаратный адрес получателя</td></tr><tr><td>ar$tpa</td><td>m октетов</td><td>протокольный адрес получателя</td></tr></table><ul class="dot"><li>ar$hrd — для Frame Relay используется десятичное значение 15 (0x000F) [RFC1700].</li><li>ar$pro — см. номер протокола ID для использования ARP (0x0800).</li><li>ar$hln — размер адресного поля в байтах (2, 3 или 4)</li><li>ar$pln — размер протокольного адреса зависит от протокола (ar$pro); для IP ar$pln=4.</li><li>ar$op — 1 для запросов, 2 для откликов.</li><li>ar$sha — аппаратный адрес Q.922 для отправителя с C/R, FECN, BECN и DE, равными 0.</li><li>ar$tha — аппаратный адрес Q.922 для получателя с C/R, FECN, BECN и DE, равными 0.</li></ul><p>Поскольку идентификаторы DLCI в большинстве сетей Frame Relay имеют лишь локальное значение, конечные станции не имеют в результате собственных (уникальных) идентификаторов DLCI. Следовательно, такие станции не имеют адреса, который можно было бы включить в запрос или отклик ARP. К счастью, в сетях Frame Relay существует способ получения корректных значений DLCI. Предложенное ниже решение для сетей Frame Relay с локальной адресацией будет также хорошо работать в сетях, где идентификаторы DLCI имеют глобальную значимость.</p><p>Значения DLCI, содержащиеся в заголовках Frame Relay, изменяются при передаче кадров через сеть. Когда пакет приходит к получателю, идентификатор DLCI может не совпадать со значением, установленным передавшей пакет станцией. Например, когда станция A (рисунок 1) передает сообщение станции B, она будет устанавливать в заголовке Frame Relay значение DLCI=50. Когда станция B получит это сообщение, значение DLCI будет изменено сетью (в приведенном примере DLCI=70).</p><pre>                   ~~~~~~~~~~~~~~~
                  (                )
+-----+          (                  )             +-----+
|     |-50------(--------------------)---------70-|     |
|  A  |        (                      )           |  B  |
|     |-60-----(---------+            )           |     |
+-----+         (        |           )            +-----+
                 (       |          )
                  (      |         )  &lt;--- сеть Frame Relay
                   ~~~~~~~~~~~~~~~~
                         80
                         |
                      +-----+
                      |     |
                      |  C  |
                      |     |
                      +-----+


Рисунок 1</pre><p>Линии на рисунке 1 представляют виртуальные соединения (DLC), числа показывают локальные идентификаторы DLCI для каждого соединения.</p><p>Преобразование DLCI в адреса Q.922 для рисунка 1:</p><table class="c nobrd"><tr><td>DLCI (дес.)</td><td>адрес Q.922 (шестн.)</td></tr><tr><td>50</td><td>0x0C21</td></tr><tr><td>60</td><td>0x0CC1</td></tr><tr><td>70</td><td>0x1061</td></tr><tr><td>80</td><td>0x1401</td></tr></table><p>Официальные сведения о соотношениях между DLCI и адресами Q.922 следует искать в спецификации Q.922 [1]. Здесь мы лишь напомним о том, что преобразование между DLCI и адресами Q.922 основано на 2-байтовой длине адреса с использованием формата кодирования Q.922, показанного ниже.</p><pre>  8   7   6   5   4   3    2   1
+------------------------+---+--+
|  DLCI (high order)     |C/R|EA|
+--------------+----+----+---+--+
| DLCI (lower) |FECN|BECN|DE |EA|
+--------------+----+----+---+--+</pre><p>Для ARP и вариантов этого протокола значения битовых полей FECN, BECN, C/R и DE предполагаются нулевыми.</p><p>Когда сообщение ARP приходит к адресату, все аппаратные адреса в нем являются некорректными. Однако, адреса, определенные из заголовков кадров, остаются верными. Хотя это и нарушает чистоту деления по уровням, Frame Relay может использовать адреса из заголовков в качестве аппаратных адресов отправителей. Следует отметить, что аппаратные адреса получателей в запросах и откликах ARP также являются некорректными. Это не должно вызывать сложностей, поскольку ARP не использует эти поля и, фактически, для них можно задавать нулевые значения или просто игнорировать.</p><p>В качестве примера работы схемы замены адресов снова рассмотрим рисунок 1. Если станция A (протокольный адрес pA) хочет преобразовать адрес станции B (протокольный адрес pB), она должна сформировать запрос ARP со следующими значениями:</p><pre>Запрос ARP от станции A
    ar$op   1 (запрос)
    ar$sha  неизвестен
    ar$spa  pA
    ar$tha  не определен
    ar$tpa  pB</pre><p>Поскольку станция A не имеет связанного с ней адреса отправителя, поле аппаратного адреса отправителя является некорректным. Следовательно, при получении запроса ARP корректный аппаратный адрес должен быть определен из заголовка Frame Relay и помещен в поле аппаратного адреса отправителя. В результате этого запрос ARP принимает форму:</p><pre>Запрос ARP от станции A после изменения станцией B
    ar$op   1 (запрос)
    ar$sha  0x1061 (DLCI 70) из заголовка Frame Relay
    ar$spa  pA
    ar$tha  не определен
    ar$tpa  pB</pre><p>Протокол ARP на станции B может сейчас корректно сохранить протокольный адрес станции A и ее адрес Q.922 в таблице ARP. После этого станция B будет формировать отклик. Многие разработчики просто помещают адрес отправителя из запроса ARP в поле адреса получателя, а в поле адреса отправителя указывают свой адрес. В этом случае отклик ARP будет иметь вид:</p><pre>Отклик ARP от станции B
    ar$op   2 (отклик)
    ar$sha  неизвестен
    ar$spa  pB
    ar$tha  0x1061 (DLCI 70)
    ar$tpa  pA</pre><p>Аппаратный адрес отправителя по-прежнему остается неизвестным и при получении отклика станция A должна получить адрес из заголовка Frame Relay и поместить его в поле аппаратного адреса отправителя. После этой операции отклик имеет форму:</p><pre>Отклик ARP от станции B после изменения его станцией A
    ar$op   2 (отклик)
    ar$sha  0x0C21 (DLCI 50)
    ar$spa  pB
    ar$tha  0x1061 (DLCI 70)
    ar$tpa  pA</pre><p>Станция A сейчас может корректно распознавать станцию B по ее протокольному адресу pB, связанному с адресом Q.922 — 0x0C21 (DLCI 50).</p><p>Обратное преобразование адресов (RARP) [<a href="../903.rfc" title="RFC 903 - Протокол RARP">RFC903</a>] будет выполняться по аналогии с прямым. Возвращаясь к рисунку 1, предположим, что станция C является сервером адресов. В этом случае произойдет следующий обмен пакетами RARP:</p><pre>RARP-запрос от A                Запрос RARP после изменения станцией C
    ar$op  3 (RARP request)         ar$op  3  (RARP request)
    ar$sha unknown                  ar$sha 0x1401 (DLCI 80)
    ar$spa undefined                ar$spa undefined
    ar$tha 0x0CC1 (DLCI 60)         ar$tha 0x0CC1 (DLCI 60)
    ar$tpa pC                       ar$tpa pC</pre><p>Станция C будет искать протокольный адрес, соответствующий адресу Q.922 0x1401 (DLCI 80), и передавать отклик RARP.</p><pre>RARP-отклик от C                Отклик RARP после изменения станцией A
    ar$op  4  (RARP response)       ar$op  4 (RARP response)
    ar$sha unknown                  ar$sha 0x0CC1 (DLCI 60)
    ar$spa pC                       ar$spa pC
    ar$tha 0x1401 (DLCI 80)         ar$tha 0x1401 (DLCI 80)
    ar$tpa pA                       ar$tpa pA</pre><p>Это означает, что интерфейс Frame Relay должен включаться только в обработку входящих пакетов.
При отсутствии подходящего механизма групповой адресации (multicast) процедуру ARP все равно можно реализовать. Для решения этой задачи конечная станция просто должна передать копию запроса ARP с использованием всех имеющих отношение к делу DLC (это имитирует широковещательную рассылку).</p><p>Вопрос использования групповых адресов в среде Frame Relay, как указано в работе [19], рассматривается операторами Frame Relay. Отметим, что групповая адресация может оказаться полезной для передачи запросов ARP и других «широковещательных» сообщений.</p><p>По причине неэффективности эмуляции широковещания в среде Frame Relay, был разработан новый вариант преобразования адресов. Этот метод получил название Inverse ARP [RFC2390] (инверсное преобразование) и основан на определении протокольного адреса при известном аппаратном адресе. Для случая Frame Relay известным аппаратным адресом является идентификатор DLCI. Поддержка Inverse ARP не требуется для реализации данной спецификации, но она может оказаться весьма полезной для автоматической настройки конфигурационных параметров интерфейсов Frame Relay. Описание и примеры использования Inverse ARP для сетей Frame Relay приводятся в работе RFC 2390.</p><p>Станции должны быть способны отобразить несколько адресов IPIP из одной IP-подсети (префикс адреса CIDR) на один идентификатор DLCI интерфейса Frame Relay. Это требование порождается приложениями (типа систем удаленного доступа), в которых серверы должны функционировать как ARP-прокси для множества удаленных (dial-in ) клиентов, каждый из которых использует собственный адрес IP при работе через одно соединение DLC. Динамическая природа таких приложений приводит к частым сменам адресных ассоциаций, которые не должны влиять на состояние DLC, сообщаемое системой сигнализации Frame Relay PVC Statu Signaling.</p><p>Как и другие интерфейсы, использующие протокол ARP, станции могут обучаться, определяя ассоциации между IP-адресами и DLCI путем обработки запросов ARP, поступающих в соединение DLC. Если одна станция (возможно, терминальный сервер или сервер удаленного доступа) хочет проинформировать станцию того же уровня (peer) на другой стороне Frame Relay DLC о новой связи между адресом IP и постоянным соединением PVC, такая станция должна передать по своей инициативе запрос ARP с IP-адресом отправителя, который совпадает с IP-адресом получателя, после чего обе станции будут знать о том, что в данном DLC используется новый IP-адрес. Это позволяет станции «анонсировать» новое клиентское подключение для отдельного DLCI. Принимающая станция должна сохранить новую ассоциацию и удалить (при необходимости) ассоциации для этого адреса с любыми другими DLCI на данном интерфейсе.</p><h2>7. Передача IP через Frame Relay</h2><p>Дейтаграммы IP [<a href="../1042.rfc" title="RFC 1042 - Стандарт передачи дейтаграмм IP в сетях IEEE 802">RFC1042</a>] (IP) передаются через сеть Frame Relay с использованием описанной выше инкапсуляции. В этом контексте может использоваться два варианта инкапсуляции IP.</p><ol><li><p>Значение NLPID указывает на IP</p><pre>+-----------------------+-----------------------+
|                  Адрес Q.922                  |
+-----------------------+-----------------------+
| Control (UI)  0x03    |       NLPID  0xCC     |
+-----------------------+-----------------------+
|                    IP пакет                   |
|                       .                       |
|                       .                       |
|                       .                       |
+-----------------------+-----------------------+</pre></li><li><p>Значение NLPID указывает на SNAP</p><pre>+-----------------------+-----------------------+
|                  Адрес Q.922                  |
+-----------------------+-----------------------+
| Control (UI)  0x03    |     pad     0x00      |
+-----------------------+-----------------------+
|   NLPID       0x80    |                       |  Заголовок SNAP
+-----------------------+  OUI = 0x00-00-00     +  указывающий
|                                               |  IP
+-----------------------+-----------------------+
|                  PID   0x0800                 |
+-----------------------+-----------------------+
|                    IP пакет                   |
|                       .                       |
|                       .                       |
|                       .                       |
+-----------------------+-----------------------+</pre></li></ol><p>Хотя оба варианта поддерживаются описанной схемой инкапсуляции, лучше выбрать для инкапсуляции данных IP единственный метод. Следовательно, данные IP должны инкапсулироваться с использованием значения NLPID=0xCC, указывающего протокол IP (вариант 1). Этот вариант инкапсуляции обеспечивает большую эффективность (заголовок уменьшается на 48 битов) и согласуется с инкапсуляцией IP в сетях X.25.</p><h2>8. Передача других протоколов через Frame Relay</h2><p>Как и в случае инкапсуляции IP существуют альтернативные способы передачи разных протоколов в рамках настоящего определения. Во избежание конфликтов SNAP-инкапсулция используется только в тех случаях, когда для протокола не определено значение NLPID.</p><p>В качестве примера рассмотрим протокол ISO CLNP, для которого определено NLPID=0x81.</p><p>Следовательно, поле NLPID будет указывать на протокол ISO CLNP и данные из пакета могут помещаться вслед за NLPID. Кадр будет иметь следующий формат:</p><pre>+---------------------------------------------+
|                 Адрес Q.922                 |
+----------------------+----------------------+
| Control (UI)  0x03   | NLPID   0x81 (CLNP)  |
+----------------------+----------------------+
|             остаток пакета CLNP             |
|                      .                      |
|                      .                      |
+---------------------------------------------+</pre><p>В этом примере значение NLPID служит для идентификации принадлежности пакета протоколу CLNP. Это поле рассматривается так же в качестве части пакета CLNP и, таким образом, поле NLPID не должно удаляться перед отправкой пакета для обработки протоколу вышележащего уровня. Значение поля NLPID не дублируется в пакетах.</p><p>Некоторые протоколы (например, IPX) не имеют значения NLPID. В соответствии со сказанным выше, протокол IPX должен инкапсулироваться с использованием заголовка SNAP. В этом случае кадр будет иметь формат:</p><pre>+---------------------------------------------+
|                 Адрес Q.922                 |
+----------------------+----------------------+
| Control (UI)  0x03   |      pad  0x00       |
+----------------------+----------------------+
| NLPID    0x80 (SNAP) | OUI - 0x00 00 00     |
+----------------------+                      |
|                                             |
+---------------------------------------------+
|                PID    0x8137                |
+---------------------------------------------+
|                 пакет IPX                   |
|                      .                      |
|                      .                      |
+---------------------------------------------+</pre><h2>9. Модель мостов для Frame Relay</h2><p>Модель организации мостов в сетях Frame Relay идентична модели удаленных мостов, описанной в стандарте IEEE P802.1g Remote MAC Bridging [13], и поддерживает концепцию виртуальных портов (Virtual Port). Удаленные мосты с портами ЛВС принимают и передают MAC-кадры для (от) локальных сетей, к которым эти порты подключены. Мосты могут также передавать кадры MAC через виртуальные порты другим удаленным мостам или принимать кадры от таких мостов. Виртуальный порт может представлять абстракцию точки доступа удаленного моста к одному или нескольким другим удаленным мостам.</p><p>Удаленные мосты с помощью системы сетевого управления статически задаются в качестве членов группы удаленного моста. Все члены группы удаленного моста подключены к одному или нескольким виртуальным портам. Множество удаленных мостов MAC-уровня в группе удаленного моста обеспечивает реальное или «потенциальное» соединение MAC-уровн между множеством ЛВС и другими группами удаленных мостов, с которыми удаленные мосты (данной группы) соединены.</p><p>В сети Frame Relay должна присутствовать полносвязная (full mesh — каждый с каждым) сеть виртуальных соединений Frame Relay (VC) между мостами и группой удаленного моста. Если сеть Frame Relay не обеспечивает полной связности, сеть на базе мостов (bridge network) должна быть поделена на множество групп удаленных мостов (remote bridge group).</p><p>Виртуальные соединения Frame Relay, связывающие мосты из группы удаленного моста, могут комбинироваться или использоваться индивидуально для формирования одного или нескольких виртуальных портов моста. Это позволяет трактовать интерфейс Frame Relay как один виртуальный порт моста со всеми VC в группе или как множество портов моста (с индивидуальными или групповыми VC).</p><p>Когда один виртуальный порт моста обеспечивает соединения для всех мостов в данной группе удаленного моста (т. е. все VC объединены в один виртуальный порт), можно использовать стандартный алгоритм Spanning Tree для определения состояния виртуального порта. Если в данной группе удаленного моста определены несколько виртуальных портов, требуется использовать расширенный алгоритм Spanning Tree (это расширение определено в стандарте IEEE 802.1g [13]). Этот алгоритм работает так, что данный виртуальный порт переводится в резервное состояние (backup) только при наличии петель во внешней по отношению к группе удаленного моста сети.</p><p>Простейшей конфигурацией для моста в сети Frame Relay является вариант ЛВС (LAN LAN view ), при котором все VC объединены в один виртуальный порт. Кадры (такие, как BPDU), которые передаются в ЛВС как широковещательные, должны пересылаться (flood) в каждое виртуальное соединение VC (или должна использоваться групповая адресация, если она поддерживается для сервиса Frame Relay). Лавинная маршрутизация (Flooding) реализуется путем передачи пакета для каждого, имеющего отношение к делу DLC, связанного с интерфейсом Frame Relay. Виртуальные соединения VC в такой среде в общем случае невидимы для моста, т. е. мост передает кадр с лавинной маршрутизацией интерфейсу Frame Relay и «не видит», что кадр передается индивидуально в каждое виртуальное соединение (VC). Если все участвующие в этом процессе мосты соединены «каждый с каждым» (full mesh), для такой конфигурации достаточно стандартного алгоритма Spanning Tree.</p><p>Обычно мосты ЛВС определяют достижимость интерфейса конкретной конечной станции, связывая MAC-адрес с портом моста. В сети Frame Relay, настроенной на работу с одним bridge-портом типа моста ЛВС (или любым набором VC, объединенных для формирования одного bridge-порта), мост должен ассоциироваться не только с MAC-адресом bridge-порта, но и с идентификатором соединения. Для сетей Frame Relay в качестве идентификаторов соединений используются значения DLCI. Неразумно, а возможно и нереально, требовать статической настройки мостов для создания ассоциаций между всеми возможными MAC-адресами получателей и DLC. Следовательно, мосты в сетях Frame Relay, действующие по типу мостов ЛВС, должны обеспечивать механизм, позволяющий bridge-портам Frame Relay динамически создавать такие ассоциации. Для реализации автоматического обучения передаваемый с использованием мостов пакет должен соответствовать требованиям к инкапсуляции, описанным в разделе 4.2. В этом случае приемный интерфейс Frame Relay будет знать, как работать с пакетом, полученным через мост, для сбора требуемой информации.</p><p>Другое приближение для мостов Frame Relay (point-to-point view) трактует каждое виртуальное соединение Frame Relay VC как отдельный порт моста. В этом варианте лавинная маршрутизация и пересылка пакетов существенно упрощаются, поскольку каждый порт моста связан с единственным адресатом (destination). Нет необходимости организовывать искусственную лавинную маршрутизацию (flooding) или связывать DLCI с MAC-адресами получателей. В зависимости от топологии соединений (VC) может потребоваться использование расширенного алгоритма Spanning Tree для того, чтобы сохранялась активность всех портов, пока не возникает петель во внешней по отношению к группе удаленного моста.</p><p>Возможно также использовать комбинированную (LAN и point-to-point) модель для одного интерфейса Frame Relay. Для реализации такого подхода некоторые VC объединяются для формирования одного виртуального bridge-порта, а остальные VC образуют независимые порты мостов.</p><p>На рисунке показаны различные варианты конфигурации мостов (пунктирные линии задают виртуальные соединения).</p><pre>                                +-------+
             -------------------|   B   |
            /            -------|       |
           /            /       +-------+
          /             |
+-------+/              \       +-------+
|   A   |                -------|   C   |
|       |-----------------------|       |
+-------+\                      +-------+
          \
           \                    +-------+
            \                   |   D   |
             -------------------|       |
                                +-------+</pre><p>Поскольку в приведенном примере отсутствует полная связность (VC между каждой парой мостов), сеть должна быть разделена на несколько групп remote bridge. Разумно объединить мосты A, B и C в одну группу, а мосты A и D — в другую.</p><p>Конфигурация первой группы объединяет VC, соединяющие три моста (A, B, C) в один виртуальный порт. Это является примером LAN-конфигурации. Вторая группа также содержит один виртуальный порт, который просто соединяет мосты A и D. В этой конфигурации стандартного алгоритма Spanning Tree достаточно для обнаружения петель.</p><p>Альтернативный вариант конфигурации будет иметь 3 отдельных виртуальных порта, соответствующих VC, которые связывают мосты A, B и C. Поскольку применение стандартного алгоритма Spanning Tree в этой конфигурации будет приводить к обнаружению петли, для сохранения активности всех виртуальных портов требуется использовать расширенный алгоритм Spanning Tree. Отметим, что вторая группа по-прежнему содержит один виртуальный порт и может использовать стандартный алгоритм Spanning Tree.</p><p>Используя тот же пример (см. рисунок), мы можем создать конфигурацию удаленных мостов с тремя группами. Это будет примером конфигурации point-to-point. В этом случае виртуальные соединения VC, связывающие A и B, VC между A и C, а также VC между A и D являются bridge-группами с одним виртуальным портом.</p><h2>10. Вопросы безопасности</h2><p>В этом документе определены механизмы идентификации для мультипротокольной инкапсуляции дейтаграмм в сетях Frame Relay. Во всех протоколах инкапсуляции обычно используется элемент доверия — получатель должен быть уверен, что отправитель корректно идентифицировал инкапсулируемый протокол. В общем случае приемная сторона не имеет механизма проверки корректности идентификации протокола передающей стороной.</p><p>В документе также рассматривается использование протоколов ARP и RARP в сетях Frame Relay, а эти протоколы имеет отношение к безопасности. Поскольку ARP не использует средств аутентификации, не возникает связанных с этим вопросов безопасности (например, возможность подмены хостов). При использовании протоколов ARP и RARP в сетях Frame Relay не применяется каких-либо дополнительных средств обеспечения безопасности.</p><h2>11. Приложение A — NLPID и PID</h2><p>Список наиболее часто используемых NLPID:</p><pre>   0x00    Null Network Layer or Inactive Set (не используется с Frame Relay)
   0x08    Q.933 [2]
   0x80    SNAP
   0x81    ISO CLNP
   0x82    ISO ESIS
   0x83    ISO ISIS
   0x8E    IPv6
   0xB0    FRF.9 Data Compression [14]
   0xB1    FRF.12 Fragmentation [18]
   0xCC    IPv4
   0xCF    PPP in Frame Relay [RFC1973]</pre><p>Список PID для OUI=00-80-C2 :</p><pre>   С сохранением FCS    Без сохранения FCS    Среда
   ------------------   ------------------    --------------
   0x00-01              0x00-07               802.3/Ethernet
   0x00-02              0x00-08               802.4
   0x00-03              0x00-09               802.5
   0x00-04              0x00-0A               FDDI
                        0x00-0B               802.6
                        0x00-0D               Фрагменты
                        0x00-0E               BPDU в соответствии с
                                                802.1(d) или
                                                802.1(g)[12].
                        0x00-0F               Source Routing BPDUs</pre><h2>12. Приложение B — Ориентированные на соединения процедуры</h2><p>Это приложение содержит дополнительные сведения и рекомендации по использованию ITU Q.933 и других стандартов ITU для инкапсуляции данных в сетях Frame Relay. Содержащаяся здесь информация подобна (в некоторых случаях идентична) сведениям, содержащимся в приложении Annex E к стандарту ITU Q.933. Первичным источником является стандарт, а в настоящем документе эти сведения приведены только для удобства.</p><p>Значения идентификаторов протокола сетевого уровня NLPID (Network Level Protocol ID) распределяются ISO и ITU. Список содержит идентификаторы для множества протоколов, включая IP, CLNP (ISO 8473) ITU Q.933, ISO 8208. На рисунке показаны общие методы инкапсуляции при передаче данных через сети Frame Relay. Гибкость приведенной схемы заключается в идентификации различных вариантов обозначения протоколов, используемых</p><ul class="dot"><li>системами сквозной передачи (end-to-end system)</li><li>мостами или маршрутизаторами, соединяющими ЛВС</li><li>или комбинированными системами</li></ul><p>для передачи трафика через сети Frame Relay.</p><pre>                       Q.922 control
                            |
                            |
       --------------------------------------------
       |                                          |
      UI                                       I Frame
       |                                          |
 ---------------------------------         --------------
 | 0x08    | 0x81      |0xCC     | 0x80    |..01....    |..10....
 |         |           |         |         |            |
Q.933     CLNP        IP        SNAP     ISO 8208    ISO 8208
 |                               |       Modulo 8    Modulo 128
 |                               |
 --------------------           OUI
 |                  |            |
L2 ID              L3 ID      -------
 |               User         |     |
 |               Specified    |     |
 |               0x70        802.3 802.6
 |
 ---------------------------
 |0x51 |0x4E |     |0x4C   |0x50
 |     |     |     |       |
7776  Q.922 Others 802.2  User
                          Specified</pre><p>Для тех протоколов, не имеющих идентификатора NLPID или не поддерживающих SNAP-инкапсулцию, следует использовать значение NLPID=0x08, указывающее на необходимость применять рекомендации ITU Q.933. 4 октета после поля NLPID включают идентификацию протоколов канального (2) и сетевого (3) уровня. Коды для большинства протоколов определены информационными элементами совместимости на нижних уровнях в стандарте ITU Q.933. Пользовательские коды (User Specified) описаны в стандарте in Frame Relay Forum FRF .3.1 [15]. Этот же стандарт содержит варианты для определения нестандартных протоколов.</p><pre>  Формат заголовка для других
  протоколов с использованием
          Q.933 NLPID

+-------------------------------+
|          Адрес Q.922          |
+---------------+---------------+
| Control  0x03 | NLPID   0x08  |
+---------------+---------------+
|        L2 Protocol ID         |
|   октет 1     |   октет 2     |
+---------------+---------------+
|         L3 Protocol ID        |
|    октет 1    |   октет 2     |
+---------------+---------------+
|      Протокольные данные      |
+-------------------------------+
|              FCS              |
+-------------------------------+</pre><pre>      ISO 8802/2 с заданным
     пользователем уровнем 3

+-------------------------------+
|          Адрес Q.922          |
+---------------+---------------+
| Control  0x03 | NLPID   0x08  |
+---------------+---------------+
|  802/2   0x4C |      0x80     |
+---------------+---------------+
|User Spec. 0x70| Примечание 1  |
+---------------+---------------+
|     DSAP      |     SSAP      |
+---------------+---------------+
|   Control  (Примечание 2)     |
+-------------------------------+
|          Остаток PDU          |
+-------------------------------+
|              FCS              |
+-------------------------------+</pre><ul><li>Примечание 1: Показывает код заданного пользователем протокола сетевого уровня.</li><li>Примечание 2: Поле Control содержит два октета для кадров формата I и S (см. 88002/2)</li></ul><p>Инкапсуляция с использованием I-кадра (уровень 2):</p><p>I-кадры Q.922 I используются для поддержки протоколов сетевого уровня, которые требуют подтверждений от канального уровня (например, ISO 8208). Бит C/R (адрес T1.618) будет использоваться для индикации команд и откликов.</p><pre>Формат кадра ISO 8208 с модулем 8

+-------------------------------+
|          Адрес Q.922          |
+---------------+---------------+
|   ....Control I frame         |
+---------------+---------------+
| Пакет 8208 (modulo 8) Прим. 3 |
|                               |
+-------------------------------+
|              FCS              |
+-------------------------------+</pre><p>Примечание 3: Первый октет пакетов 8208 также идентифицирует NLPID (..01....).</p><pre>Формат кадра ISO 8208 с модулем 128

+-------------------------------+
|          Адрес Q.922          |
+---------------+---------------+
|   ....Control I frame         |
+---------------+---------------+
|    Пакет 8208  (modulo 128)   |
|         Примечание 4          |
+-------------------------------+
|              FCS              |
+-------------------------------+</pre><p>Примечание 4: Первый октет пакетов 8208 также идентифицирует NLPID (..10....).</p><h2>13. Приложение C — Отличия от RFC 1490</h2><p>Документ RFC 1490 получил широкое распространение, многократно реализован и учтен в стандартах Frame Relay Forum FRF.3.1 [15] и ITU Q.933 [2]. В этом разделе рассмотрены отличия настоящего документа от RFC 1490, внесенные в результате практического использования спецификации и накопленного опыта взаимодействия (интероперабельности) систем.</p><p>В RFC 1490 были внесены некоторые стилистические изменения. Ни одно из этих изменений не затрагивает технических аспектов документа — целью этих изменений было сохранение приведенных в документе схем и более четкое изложение материала. Ниже перечислены наиболее существенные изменения.</p><ul class="lat"><li><p>Требование поддержки протоколов со SNAP-инкапсуляцией для протоколов, имеющих NLPID, было снято. В RFC 1490 сказано, что для протоколов, имеющих идентификатор NLPID (например, IP), должна использоваться NLPID-инкапсуляция. Ниже в том же документе было указано, что станции должны воспринимать эти протоколы и со SNAP-инкапсуляцией. Непоследовательность такого подхода очевидна. Станции должны передавать и воспринимать инкапсуляцию NLPID для таких протоколов и могут (но не обязаны) воспринимать также SNAP-инкапсуляцию.</p></li><li><p>Удален раздел, посвященный фрагментации. К настоящему времени отсутствует интероперабельность для алгоритма фрагментации, предложенного в RFC 1490. Кроме того, некоторые элементы предложенного механизма фрагментации делают его неприемлемым для отдельных приложений Frame Relay. В результате рассмотрение вопросов фрагментации было исключено из данного документа и предлагается использовать фрагментацию в соответствии со стандартом FRF.12 [18].</p></li><li><p>Механизм преобразования адресов, предложенный в RFC 1490, подходит только для постоянных соединений PVC и не может быть использован в средах с коммутируемыми соединениями SVC. Поэтому название раздела в данном документе было соответствующим образом изменено. Вопросы преобразования адресов в средах с коммутируемыми соединениями SVC рассматриваются рабочей группой ION.</p></li><li><p>В данном документе дополнительно рассмотрена инкапсуляция Source Routing BPDU и соответствующее добавление было сделано в Приложении A.</p></li><li><p>Более четко изложены вопросы использования канонических и неканонических MAC-адресов получателей.</p></li><li><p>Описание протокола Inverse ARP было опущено в связи с выпуском спецификации Inverse ARP [RFC2390].</p></li><li><p>Добавлен раздел, посвященный вопросам безопасности.</p></li></ul><h2>14. Литература</h2><table itemprop="references"><tr><td>[1]</td><td>International Telecommunication Union, «ISDN Data Link Layer Specification for Frame Mode Bearer Services», ITU-T Recommendation Q.922, 1992.</td></tr><tr><td>[2]</td><td>International Telecommunication Union, «Signalling Specifications for Frame Mode Switched and Permanent Virtual Connection Control and Status Monitoring», ITU-T Recommendation Q.933, 1995.</td></tr><tr><td>[3]</td><td>Information technology - Telecommunications and Information Exchange between systems - Protocol Identification in the Network Layer, ISO/IEC TR 9577: 1992.</td></tr><tr><td>[RFC1638]</td><td>Baker, F., and R. Bowen, «PPP Bridging Control Protocol (BCP)», RFC 1638, June 1994.</td></tr><tr><td>[5]</td><td>International Standard, Information Processing Systems - Local Area Networks - Logical Link Control, ISO 8802-2, ANSI/IEEE, Second Edition, 1994-12-30.</td></tr><tr><td>[RFC826]</td><td>David C. Plummer, <a href="../826.rfc" title="RFC 826 - Протокол преобразования адресов Ethernet (ARP)">«Протокол преобразования адресов Ethernet (ARP)», RFC 826</a>, Ноябрь 1982.</td></tr><tr><td>[RFC1700]</td><td>Reynolds, J., and J. Postel, «Assigned Numbers», STD 2, RFC 1700, October 1994. See also: http://www.iana.org/numbers.html</td></tr><tr><td>[RFC903]</td><td>Finlayson, Mann, Mogul, и Theimer, <a href="../903.rfc" title="RFC 903 - Протокол RARP">«Протокол RARP», RFC 903</a>, Июнь 1984.</td></tr><tr><td>[RFC1042]</td><td> J. Postel и J. Reynolds, <a href="../1042.rfc" title="RFC 1042 - Стандарт передачи дейтаграмм IP в сетях IEEE 802">«Стандарт передачи дейтаграмм IP в сетях IEEE 802», RFC 1042</a>, Февраль 1988.</td></tr><tr><td>[10]</td><td>IEEE, «IEEE Standard for Local and Metropolitan Area Networks: Overview and architecture», IEEE Standard 802-1990.</td></tr><tr><td>[RFC2390]</td><td>Bradley, T., Brown, C., and A. Malis, «Inverse Address Resolution Protocol», RFC 2390, September 1998.</td></tr><tr><td>[12]</td><td>IEEE, «IEEE Standard for Local and Metropolitan Networks: Media Access Control (MAC) Bridges», IEEE Standard 802.1D-1990.</td></tr><tr><td>[13]</td><td>ISO/IEC 15802-5 : 1998 (IEEE Standard 802.1G), Remote Media Access Control (MAC) Bridging, March 12, 1997.</td></tr><tr><td>[14]</td><td>Frame Relay Forum, «Data Compression Over Frame Relay Implementation Agreement», FRF.9, January 22, 1996.</td></tr><tr><td>[15]</td><td>Frame Relay Forum, «Multiprotocol Encapsulation Implementation Agreement», FRF.3.1, June 22, 1995.</td></tr><tr><td>[RFC2119]</td><td>Scott Bradner, <a href="../2119.rfc" title="RFC 2119 - Ключевые слова для обозначения уровня требований в RFC">«Ключевые слова для обозначения уровня требований в RFC», RFC 2119</a>, Март 1997.</td></tr><tr><td>[RFC1973]</td><td>Simpson, W., «PPP in Frame Relay», RFC 1973, June 1996.</td></tr><tr><td>[18]</td><td>Frame Relay Forum, «Frame Relay Fragmentation Implementation Agreement», FRF.12, December 1997.</td></tr><tr><td>[19]</td><td>Frame Relay Forum, «Frame Relay PVC Multicast Service and Protocol Implementation Agreement», FRF.7, October 21, 1994.</table><h2>Адреса авторов</h2><p>Caralyn Brown<br />Consultant<br />EMail: <bdo dir="rtl">&#109;&#111;&#99;&#46;&#111;&#110;&#117;&#106;&#64;&#110;&#119;&#111;&#114;&#98;&#99;</bdo></p><p>Andrew Malis<br />Ascend Communications, Inc.<br />1 Robbins Road Westford, MA 01886<br />Phone: (978) 952-7414<br />EMail: <bdo dir="rtl">&#109;&#111;&#99;&#46;&#100;&#110;&#101;&#99;&#115;&#97;&#64;&#115;&#105;&#108;&#97;&#109;</bdo></p></div></div><div id="disqus_thread"></div><script type="text/javascript">var disqus_shortname="rfc2",disqus_title="RFC 2427 - Многопротокольные соединения через Frame Relay",disqus_identifier="2427.rfc",disqus_url="http://rfc2.ru/2427.rfc";(function(){var dsq=document.createElement("script");dsq.type="text/javascript";dsq.async=true;dsq.src = "//"+disqus_shortname+".disqus.com/embed.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(dsq);})();</script><div class="bubble">2007 - 2014 © <a href="../index.html" title="Русские переводы RFC">Русские переводы RFC</a>, IETF, ISOC.</div></div><div id="bottom" style="position:static !important;bottom:auto !important"><div class="bubble"><ul><li><!--723572853672--></li></ul></div></div><!-- Yandex.Metrika counter --><script type="text/javascript">(function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter4680559 = new Ya.Metrika({id:4680559, webvisor:true, clickmap:true, accurateTrackBounce:true, trackHash:true, ut:"noindex"}); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="http://mc.yandex.ru/watch/4680559?ut=noindex" style="position:absolute; left:-9999px;" alt="" /></div></noscript><!-- /Yandex.Metrika counter --></body></html>