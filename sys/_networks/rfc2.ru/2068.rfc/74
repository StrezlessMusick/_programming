<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8" /><link rel="stylesheet" href="../tpl/style.css@f4e332aa" type="text/css" /><link rel="prev" href="73" /><link rel="next" href="75" /><link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css' /><style type="text/css">h1,h2,h3,h4{font-family:'Open Sans',sans-serif}</style><title>Перевод RFC 2068 — Протокол Передачи Гипертекста - HTTP/1.1, стр. 74</title><meta name="author" content="R. Fielding, J.Gettys, J. Mogul, H. Frystyk, T. Berners-Lee" /><link rel="alternate" type="application/rss+xml" title="RFC2.ru - Русские Переводы RFC" href="../rss.xml"></head><body><div id="content"><div id="nav"><div class="icon i0"></div> <a href="../index.html" accesskey="`">На Главную</a></div><div id="search" class="ya-site-form ya-site-form_inited_no"><form action="http://yandex.ru/sitesearch" method="get" target="_blank"><input type="hidden" name="searchid" value="2154295"/><input type="hidden" name="l10n" value="ru"/><input type="hidden" name="reqenc" value=""/><input type="hidden" name="submit" value="Найти"/><input type="search" value="" name="text" placeholder="Поиск по RFC2.ru" /></form></div><div itemscope itemtype="http://schema.org/ScholarlyArticle"><meta itemprop="inLanguage" content="ru" /><meta itemprop="editor" content="ru" /><div id="header"><h1><a itemprop="headline" href="../2068.rfc">RFC 2068 — Протокол Передачи Гипертекста - HTTP/1.1</a></h1></div><dl class="mute"><dt></dt><dd><div class="icon i1"></div> RFC: 2068</dd><dd><div class="icon i3"></div> Оригинал: <a href="original" target="_blank" rel="nofollow"><span itemprop="alternativeHeadline">Hypertext Transfer Protocol - HTTP/1.1</span></a></dd><dd><div class="icon i7"></div> Другие версии: <strong class="obsoleted_by">RFC 2616</strong></dd><dd><div class="icon i2"></div> Категория: <span itemprop="articleSection">Предложенный стандарт</span></dd><dd><div class="icon i4"></div> Дата публикации: <time itemprop="datePublished" datetime="1997-01-01">Январь 1997</time></dd><dd><div class="icon i5"></div> Авторы: <span itemprop="author">R. Fielding</span>, <span itemprop="author">J.Gettys</span>, <span itemprop="author">J. Mogul</span>, <span itemprop="author">H. Frystyk</span>, <span itemprop="author">T. Berners-Lee</span></dd><dd><div class="icon i6"></div> Перевод: <span itemprop="editor">Алексей Симонов</span></dd></dl><div class="pages"><p class="r"> <h2 class="pt"><span class="z">RFC 2068,</span> Страница 74 из 160</h2></p><ul><li><noindex><a href="print" rel="nofollow">Одной Страницей</a></noindex></li><li><a accesskey="1" title="Первая страница" href="../2068.rfc" class="arr">&lArr;</a></li><li><a accesskey="2" title="На страницу назад" href="73"><b>&larr;</b></a></li><li><a class="x" href="../2068.rfc">1</a></li><li><a class="x" href="2">2</a></li><li><a class="x" href="3">3</a></li><li><a class="x" href="4">4</a></li><li><a class="x" href="5">5</a></li><li><a class="x" href="6">6</a></li><li><a class="x" href="7">7</a></li><li><a class="x" href="8">8</a></li><li><a class="x" href="9">9</a></li><li><a class="x" href="10">10</a></li><li><a class="x" href="11">11</a></li><li><a class="x" href="12">12</a></li><li><a class="x" href="13">13</a></li><li><a class="x" href="14">14</a></li><li><a class="x" href="15">15</a></li><li><a class="x" href="16">16</a></li><li><a class="x" href="17">17</a></li><li><a class="x" href="18">18</a></li><li><a class="x" href="19">19</a></li><li><a class="x" href="20">20</a></li><li><a class="x" href="21">21</a></li><li><a class="x" href="22">22</a></li><li><a class="x" href="23">23</a></li><li><a class="x" href="24">24</a></li><li><a class="x" href="25">25</a></li><li><a class="x" href="26">26</a></li><li><a class="x" href="27">27</a></li><li><a class="x" href="28">28</a></li><li><a class="x" href="29">29</a></li><li><a class="x" href="30">30</a></li><li><a class="x" href="31">31</a></li><li><a class="x" href="32">32</a></li><li><a class="x" href="33">33</a></li><li><a class="x" href="34">34</a></li><li><a class="x" href="35">35</a></li><li><a class="x" href="36">36</a></li><li><a class="x" href="37">37</a></li><li><a class="x" href="38">38</a></li><li><a class="x" href="39">39</a></li><li><a class="x" href="40">40</a></li><li><a class="x" href="41">41</a></li><li><a class="x" href="42">42</a></li><li><a class="x" href="43">43</a></li><li><a class="x" href="44">44</a></li><li><a class="x" href="45">45</a></li><li><a class="x" href="46">46</a></li><li><a class="x" href="47">47</a></li><li><a class="x" href="48">48</a></li><li><a class="x" href="49">49</a></li><li><a class="x" href="50">50</a></li><li><a class="x" href="51">51</a></li><li><a class="x" href="52">52</a></li><li><a class="x" href="53">53</a></li><li><a class="x" href="54">54</a></li><li><a class="x" href="55">55</a></li><li><a class="x" href="56">56</a></li><li><a class="x" href="57">57</a></li><li><a class="x" href="58">58</a></li><li><a class="x" href="59">59</a></li><li><a class="x" href="60">60</a></li><li><a class="x" href="61">61</a></li><li><a class="x" href="62">62</a></li><li><a class="x" href="63">63</a></li><li><a class="x" href="64">64</a></li><li><a class="x" href="65">65</a></li><li><a class="x" href="66">66</a></li><li><a class="x" href="67">67</a></li><li><a class="x" href="68">68</a></li><li><a class="x" href="69">69</a></li><li><a href="70">70</a></li><li><a href="71">71</a></li><li><a href="72">72</a></li><li><a href="73">73</a></li><li class="this"><span>74</span></li><li><a href="75">75</a></li><li><a href="76">76</a></li><li><a href="77">77</a></li><li><a href="78">78</a></li><li><a class="x" href="79">79</a></li><li><a class="x" href="80">80</a></li><li><a class="x" href="81">81</a></li><li><a class="x" href="82">82</a></li><li><a class="x" href="83">83</a></li><li><a class="x" href="84">84</a></li><li><a class="x" href="85">85</a></li><li><a class="x" href="86">86</a></li><li><a class="x" href="87">87</a></li><li><a class="x" href="88">88</a></li><li><a class="x" href="89">89</a></li><li><a class="x" href="90">90</a></li><li><a class="x" href="91">91</a></li><li><a class="x" href="92">92</a></li><li><a class="x" href="93">93</a></li><li><a class="x" href="94">94</a></li><li><a class="x" href="95">95</a></li><li><a class="x" href="96">96</a></li><li><a class="x" href="97">97</a></li><li><a class="x" href="98">98</a></li><li><a class="x" href="99">99</a></li><li><a class="x" href="100">100</a></li><li><a class="x" href="101">101</a></li><li><a class="x" href="102">102</a></li><li><a class="x" href="103">103</a></li><li><a class="x" href="104">104</a></li><li><a class="x" href="105">105</a></li><li><a class="x" href="106">106</a></li><li><a class="x" href="107">107</a></li><li><a class="x" href="108">108</a></li><li><a class="x" href="109">109</a></li><li><a class="x" href="110">110</a></li><li><a class="x" href="111">111</a></li><li><a class="x" href="112">112</a></li><li><a class="x" href="113">113</a></li><li><a class="x" href="114">114</a></li><li><a class="x" href="115">115</a></li><li><a class="x" href="116">116</a></li><li><a class="x" href="117">117</a></li><li><a class="x" href="118">118</a></li><li><a class="x" href="119">119</a></li><li><a class="x" href="120">120</a></li><li><a class="x" href="121">121</a></li><li><a class="x" href="122">122</a></li><li><a class="x" href="123">123</a></li><li><a class="x" href="124">124</a></li><li><a class="x" href="125">125</a></li><li><a class="x" href="126">126</a></li><li><a class="x" href="127">127</a></li><li><a class="x" href="128">128</a></li><li><a class="x" href="129">129</a></li><li><a class="x" href="130">130</a></li><li><a class="x" href="131">131</a></li><li><a class="x" href="132">132</a></li><li><a class="x" href="133">133</a></li><li><a class="x" href="134">134</a></li><li><a class="x" href="135">135</a></li><li><a class="x" href="136">136</a></li><li><a class="x" href="137">137</a></li><li><a class="x" href="138">138</a></li><li><a class="x" href="139">139</a></li><li><a class="x" href="140">140</a></li><li><a class="x" href="141">141</a></li><li><a class="x" href="142">142</a></li><li><a class="x" href="143">143</a></li><li><a class="x" href="144">144</a></li><li><a class="x" href="145">145</a></li><li><a class="x" href="146">146</a></li><li><a class="x" href="147">147</a></li><li><a class="x" href="148">148</a></li><li><a class="x" href="149">149</a></li><li><a class="x" href="150">150</a></li><li><a class="x" href="151">151</a></li><li><a class="x" href="152">152</a></li><li><a class="x" href="153">153</a></li><li><a class="x" href="154">154</a></li><li><a class="x" href="155">155</a></li><li><a class="x" href="156">156</a></li><li><a class="x" href="157">157</a></li><li><a class="x" href="158">158</a></li><li><a class="x" href="159">159</a></li><li><a class="x" href="160">160</a></li><li><a accesskey="3" title="На страницу вперед" href="75">&rarr;</a></li><li><a accesskey="4" title="Последняя страница" href="160">&rArr;</a></li></ul></div><div id="text" itemprop="articleBody"><h4 id="p13.2.3">13.2.3. Вычисление возраста</h4><p>Чтобы знать, нов ли кэшируемый элемент, кэш должен знать, превышает ли его возраст свое время существования свежести. Мы обсуждаем, как вычислить последнего в разделе 13.2.4; этот раздел описывает, как вычислить возраст элемента кэша или ответа.</p><p>В этом обсуждении мы используем термин "теперь", чтобы означать "текущее значение часов в хосте, выполняющем вычисление." Хосты, которые используют HTTP, но особенно хосты, выполняющие серверы происхождения и кэши, должны использовать NTP [28] или некоторый подобный протокол, чтобы синхронизировать их часы к глобально точному стандарту времени.</p><p>Также отметьте, что HTTP/1.1 требует, чтобы серверы происхождения отправили заголовок Date с каждым ответом, давая время, в которое был сгенерирован ответ. Мы используем термин "date_value", чтобы обозначить значение заголовка Date, в форме, соответствующей арифметическим операциям.</p><p>HTTP/1.1 использует заголовок ответа Age, чтобы помочь передавать информацию о возрасте между кэшами. Значение заголовка Age — оценка отправителя количества времени, так как ответ был сгенерирован в сервере происхождения. В случае кэшируемого ответа, который был повторно утвержден с сервером происхождения, значение Age основано на времени придания вновь юридической силы, не оригинального ответа.</p><p>В основном, значение Age — сумма времени, когда ответ был жителем в каждом из кэшей вдоль пути от сервера происхождения, плюс количество времени, он в пути приехал сетевые пути.</p><p>Мы используем термин "age_value", чтобы обозначить значение заголовка Age, в форме, соответствующей арифметическим операциям.</p><p>Возраст ответа может быть вычислен двумя полностью независимыми способами:</p><ol><li>теперь минус date_value, если локальные часы разумно хорошо синхронизированы на часы сервера происхождения. Если результат — негатив, результат заменен нулем.</li><li>age_value, если все кэши вдоль пути ответа реализуют HTTP/1.1.</li></ol><p>Учитывая, что у нас есть два независимых способа вычислить возраст ответа, когда он получен, мы можем объединить их как</p><pre>corrected_received_age = max(now - date_value, age_value)</pre><p>и пока мы или почти синхронизировали часы или все-HTTP/1.1 пути, каждый получает надежный (консервативный) результат.</p><p>Обратите внимание, что это исправление применен в каждом HTTP/1.1 кэш вдоль пути, так, чтобы, если есть HTTP/1.0 кэш в пути, правильный полученный возраст вычислен, пока часы кэша получения находятся почти в синхронизации. Мы не должны от начала до конца синхронизировать синхронизацию (хотя он хорош, чтобы иметь), и нет никакого явного шага синхронизации часов.</p><p>Из-за наложенных на сеть задержек некоторый существенный интервал может передать со времени, когда сервер генерирует ответ и время, он получен в следующем экспортном кэше или клиенте. Если неисправлено, эта задержка могла бы закончиться ненадлежащим образом низкими возрастами.</p><p>Поскольку запрос, который закончился возвращенным значением Age, должно быть, был инициализирован до той генерации значения Age, мы можем исправить для задержек, наложенных сетью, делая запись времени, в которое был инициализирован запрос. Затем, когда значение Age получено, оно ДОЛЖНО быть интерпретировано относительно времени, запрос был инициализирован, не время, когда ответ был получен. Этот алгоритм заканчивается консервативным поведением независимо от того, сколько задержки испытано. Так, мы вычисляем:</p><pre>corrected_initial_age = corrected_received_age + (now - request_time)</pre><p>где "request_time" — время (согласно локальным часам), когда запрос, который выявлял этот ответ, отправили.</p><p>Резюме алгоритма вычисления возраста, когда кэш получает ответ:</p><pre>/*
 * age_value
 *      is the value of Age: header received by the cache with
 *              this response.
 * date_value
 *      is the value of the origin server's Date: header
 * request_time
 *      is the (local) time when the cache made the request
 *              that resulted in this cached response
 * response_time
 *      is the (local) time when the cache received the
 *              response
 * now
 *      is the current (local) time
 */
apparent_age = max(0, response_time - date_value);
corrected_received_age = max(apparent_age, age_value);
response_delay = response_time - request_time;
corrected_initial_age = corrected_received_age + response_delay;
resident_time = now - response_time;
current_age   = corrected_initial_age + resident_time;</pre><p>Когда кэш отправляет ответ, он должен добавить к corrected_initial_age количество времени, что ответ был жителем локально. Он должен тогда передать этот полный возраст, используя заголовок Age, к следующему кэшу получателя.</p><p class="note">Обратите внимание: То, что клиент не может надежно сказать, что ответ на собственном опыте — но присутствие заголовка Age указывает, что ответ определенно не непосредственно. Кроме того, если Date в ответе является более ранним чем локальное время запроса клиента, ответ вероятно не непосредственно (в отсутствии серьезной расфазировки тактовых сигналов).</p></div></div><noindex><div class="pages"><p class="r"> <b>Страница 74 из 160</b></p><ul><li><noindex><a href="print" rel="nofollow">Одной Страницей</a></noindex></li><li><a title="Первая страница" href="../2068.rfc" class="arr">&lArr;</a></li><li><a title="На страницу назад" href="73"><b>&larr;</b></a></li><li><a class="x" href="../2068.rfc">1</a></li><li><a class="x" href="2">2</a></li><li><a class="x" href="3">3</a></li><li><a class="x" href="4">4</a></li><li><a class="x" href="5">5</a></li><li><a class="x" href="6">6</a></li><li><a class="x" href="7">7</a></li><li><a class="x" href="8">8</a></li><li><a class="x" href="9">9</a></li><li><a class="x" href="10">10</a></li><li><a class="x" href="11">11</a></li><li><a class="x" href="12">12</a></li><li><a class="x" href="13">13</a></li><li><a class="x" href="14">14</a></li><li><a class="x" href="15">15</a></li><li><a class="x" href="16">16</a></li><li><a class="x" href="17">17</a></li><li><a class="x" href="18">18</a></li><li><a class="x" href="19">19</a></li><li><a class="x" href="20">20</a></li><li><a class="x" href="21">21</a></li><li><a class="x" href="22">22</a></li><li><a class="x" href="23">23</a></li><li><a class="x" href="24">24</a></li><li><a class="x" href="25">25</a></li><li><a class="x" href="26">26</a></li><li><a class="x" href="27">27</a></li><li><a class="x" href="28">28</a></li><li><a class="x" href="29">29</a></li><li><a class="x" href="30">30</a></li><li><a class="x" href="31">31</a></li><li><a class="x" href="32">32</a></li><li><a class="x" href="33">33</a></li><li><a class="x" href="34">34</a></li><li><a class="x" href="35">35</a></li><li><a class="x" href="36">36</a></li><li><a class="x" href="37">37</a></li><li><a class="x" href="38">38</a></li><li><a class="x" href="39">39</a></li><li><a class="x" href="40">40</a></li><li><a class="x" href="41">41</a></li><li><a class="x" href="42">42</a></li><li><a class="x" href="43">43</a></li><li><a class="x" href="44">44</a></li><li><a class="x" href="45">45</a></li><li><a class="x" href="46">46</a></li><li><a class="x" href="47">47</a></li><li><a class="x" href="48">48</a></li><li><a class="x" href="49">49</a></li><li><a class="x" href="50">50</a></li><li><a class="x" href="51">51</a></li><li><a class="x" href="52">52</a></li><li><a class="x" href="53">53</a></li><li><a class="x" href="54">54</a></li><li><a class="x" href="55">55</a></li><li><a class="x" href="56">56</a></li><li><a class="x" href="57">57</a></li><li><a class="x" href="58">58</a></li><li><a class="x" href="59">59</a></li><li><a class="x" href="60">60</a></li><li><a class="x" href="61">61</a></li><li><a class="x" href="62">62</a></li><li><a class="x" href="63">63</a></li><li><a class="x" href="64">64</a></li><li><a class="x" href="65">65</a></li><li><a class="x" href="66">66</a></li><li><a class="x" href="67">67</a></li><li><a class="x" href="68">68</a></li><li><a class="x" href="69">69</a></li><li><a href="70">70</a></li><li><a href="71">71</a></li><li><a href="72">72</a></li><li><a href="73">73</a></li><li class="this"><span>74</span></li><li><a href="75">75</a></li><li><a href="76">76</a></li><li><a href="77">77</a></li><li><a href="78">78</a></li><li><a class="x" href="79">79</a></li><li><a class="x" href="80">80</a></li><li><a class="x" href="81">81</a></li><li><a class="x" href="82">82</a></li><li><a class="x" href="83">83</a></li><li><a class="x" href="84">84</a></li><li><a class="x" href="85">85</a></li><li><a class="x" href="86">86</a></li><li><a class="x" href="87">87</a></li><li><a class="x" href="88">88</a></li><li><a class="x" href="89">89</a></li><li><a class="x" href="90">90</a></li><li><a class="x" href="91">91</a></li><li><a class="x" href="92">92</a></li><li><a class="x" href="93">93</a></li><li><a class="x" href="94">94</a></li><li><a class="x" href="95">95</a></li><li><a class="x" href="96">96</a></li><li><a class="x" href="97">97</a></li><li><a class="x" href="98">98</a></li><li><a class="x" href="99">99</a></li><li><a class="x" href="100">100</a></li><li><a class="x" href="101">101</a></li><li><a class="x" href="102">102</a></li><li><a class="x" href="103">103</a></li><li><a class="x" href="104">104</a></li><li><a class="x" href="105">105</a></li><li><a class="x" href="106">106</a></li><li><a class="x" href="107">107</a></li><li><a class="x" href="108">108</a></li><li><a class="x" href="109">109</a></li><li><a class="x" href="110">110</a></li><li><a class="x" href="111">111</a></li><li><a class="x" href="112">112</a></li><li><a class="x" href="113">113</a></li><li><a class="x" href="114">114</a></li><li><a class="x" href="115">115</a></li><li><a class="x" href="116">116</a></li><li><a class="x" href="117">117</a></li><li><a class="x" href="118">118</a></li><li><a class="x" href="119">119</a></li><li><a class="x" href="120">120</a></li><li><a class="x" href="121">121</a></li><li><a class="x" href="122">122</a></li><li><a class="x" href="123">123</a></li><li><a class="x" href="124">124</a></li><li><a class="x" href="125">125</a></li><li><a class="x" href="126">126</a></li><li><a class="x" href="127">127</a></li><li><a class="x" href="128">128</a></li><li><a class="x" href="129">129</a></li><li><a class="x" href="130">130</a></li><li><a class="x" href="131">131</a></li><li><a class="x" href="132">132</a></li><li><a class="x" href="133">133</a></li><li><a class="x" href="134">134</a></li><li><a class="x" href="135">135</a></li><li><a class="x" href="136">136</a></li><li><a class="x" href="137">137</a></li><li><a class="x" href="138">138</a></li><li><a class="x" href="139">139</a></li><li><a class="x" href="140">140</a></li><li><a class="x" href="141">141</a></li><li><a class="x" href="142">142</a></li><li><a class="x" href="143">143</a></li><li><a class="x" href="144">144</a></li><li><a class="x" href="145">145</a></li><li><a class="x" href="146">146</a></li><li><a class="x" href="147">147</a></li><li><a class="x" href="148">148</a></li><li><a class="x" href="149">149</a></li><li><a class="x" href="150">150</a></li><li><a class="x" href="151">151</a></li><li><a class="x" href="152">152</a></li><li><a class="x" href="153">153</a></li><li><a class="x" href="154">154</a></li><li><a class="x" href="155">155</a></li><li><a class="x" href="156">156</a></li><li><a class="x" href="157">157</a></li><li><a class="x" href="158">158</a></li><li><a class="x" href="159">159</a></li><li><a class="x" href="160">160</a></li><li><a title="На страницу вперед" href="75">&rarr;</a></li><li><a title="Последняя страница" href="160">&rArr;</a></li></ul></div></noindex><div id="disqus_thread"></div><script type="text/javascript">var disqus_shortname="rfc2",disqus_title="RFC 2068 - Протокол Передачи Гипертекста - HTTP/1.1",disqus_identifier="2068.rfc",disqus_url="http://rfc2.ru/2068.rfc";(function(){var dsq=document.createElement("script");dsq.type="text/javascript";dsq.async=true;dsq.src = "//"+disqus_shortname+".disqus.com/embed.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(dsq);})();</script><div class="bubble">2007 - 2014 © <a href="../index.html" title="Русские переводы RFC">Русские переводы RFC</a>, IETF, ISOC.</div></div><div id="bottom" style="position:static !important;bottom:auto !important"><div class="bubble"><ul><li><!--723572853672--></li></ul></div></div><!-- Yandex.Metrika counter --><script type="text/javascript">(function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter4680559 = new Ya.Metrika({id:4680559, webvisor:true, clickmap:true, accurateTrackBounce:true, trackHash:true}); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="http://mc.yandex.ru/watch/4680559" style="position:absolute; left:-9999px;" alt="" /></div></noscript><!-- /Yandex.Metrika counter --></body></html>