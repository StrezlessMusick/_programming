<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8" /><link rel="stylesheet" href="../tpl/style.css@f4e332aa" type="text/css" /><link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css' /><style type="text/css">h1,h2,h3,h4{font-family:'Open Sans',sans-serif}</style><link rel="canonical" href="../5195.rfc" /><meta name="Robots" content="noindex, nofollow" /><title>Перевод RFC 5195 — Автоматическое детектирование Layer-1 VPN на основе BGP</title><link rel="alternate" type="application/rss+xml" title="RFC2.ru - Русские Переводы RFC" href="../rss.xml"></head><body><div id="content"><div id="nav"><div class="icon i0"></div> <a href="../index.html" accesskey="`">На Главную</a></div><div id="search" class="ya-site-form ya-site-form_inited_no"><form action="http://yandex.ru/sitesearch" method="get" target="_blank"><input type="hidden" name="searchid" value="2154295"/><input type="hidden" name="l10n" value="ru"/><input type="hidden" name="reqenc" value=""/><input type="hidden" name="submit" value="Найти"/><input type="search" value="" name="text" placeholder="Поиск по RFC2.ru" /></form></div><div itemscope itemtype="http://schema.org/ScholarlyArticle"><meta itemprop="inLanguage" content="ru" /><meta itemprop="editor" content="ru" /><div id="header"><h1><a itemprop="headline" href="../5195.rfc">RFC 5195 — Автоматическое детектирование Layer-1 VPN на основе BGP</a></h1></div><dl class="mute"><dt></dt><dd><div class="icon i1"></div> RFC: 5195</dd><dd><div class="icon i3"></div> Оригинал: <a href="original" target="_blank" rel="nofollow"><span itemprop="alternativeHeadline">BGP-Based Auto-Discovery for Layer-1 VPNs</span></a></dd><dd><div class="icon i2"></div> Категория: <span itemprop="articleSection">Предложенный стандарт</span></dd><dd><div class="icon i4"></div> Дата публикации: <time itemprop="datePublished" datetime="2008-06-01">Июнь 2008</time></dd><dd><div class="icon i5"></div> Авторы: <span itemprop="author">Hamid Ould-Brahim</span>, <span itemprop="author">Yakov Rekhter</span>, <span itemprop="author">Don Fedyk</span></dd><dd><div class="icon i6"></div> Перевод: <span itemprop="editor">Николай Малых</span></dd></dl><div id="text" itemprop="articleBody"><h3>Статус документа</h3><p>Этот документ представляет проект стандартного протокола для сообщества Internet и служит приглашением к дискуссии в целях развития и совершенствования протокола. Информацию о текущем состоянии стандартизации протокола можно найти в документе «Internet Official Protocol Standards» (STD 1). Настоящий документ может распространяться без ограничений.</p><h3>Тезисы</h3><p>Целью настоящего документа является определение механизма автоматического детектирования Layer-1 VPN (L1VPN) на основе протокола BGP. Механизм автоматического детектирования для L1VPN позволяет устройствам сети провайдера автоматически находить набор PE (Provider Edge — краевое устройство провайдера), имеющих порты, подключенные к устройствам CE (Customer Edge — краевое устройство пользователя), которые входят в одну сеть VPN. Эта информация требуется для завершения сигнальной фазы соединений L1VPN. Одной из основных задач механизма автоматического детектирования L1VPN является поддержка модели «single-end provisioning», в которой добавление порта в данную L1VPN будет вызывать изменения конфигурации только того устройства PE, которое включает затронутый соединением порт, и устройства CE, подключенного к PE через этот порт.</p><h2>1. Введение</h2><p>Целью настоящего документа является определение механизма автоматического детектирования Layer-1 VPN [L1VPN-FRMK]. Механизм автоматического детектирования для L1VPN позволяет устройствам сети провайдера автоматически находить набор PE, имеющих порты, подключенные к устройствам CE, которые входят в одну сеть VPN. Эта информация требуется для завершения сигнальной фазы соединений L1VPN. Одной из основных задач механизма автоматического детектирования L1VPN является поддержка модели «single-end provisioning», в которой добавление порта в данную L1VPN будет вызывать изменения конфигурации только того устройства PE, которое включает затронутый соединением порт, и устройства CE, подключенного к PE через этот порт.</p><p>Механизм автоматического детектирования обеспечивается за счет того, что PE анонсирует другим устройствам PE по крайней мере свой адрес IP и список локальных для данного PE пар &lt;private address, provider address&gt;. После получения этой информации устройства PE будут будут знать список членов VPN, связанных с данным PE, и использовать переданную механизмом автоматического детектирования информацию для преобразования адресов во время сигнальной фазы соединений L1VPN.</p><p>Рисунок 1 показывает схему работы механизма автоматического детектирования для L1VPN на основе BGP. Для работы механизма автоматического детектирования требуется активизация BGP только в сети провайдера. Устройства PE поддерживают для каждой VPN информационные таблицы PIT (Port Information Table — таблица информации для порта), относящиеся к парам &lt;private address, provider address&gt;. Дополнительная информация о таблицах PIT приведена в разделе 2.</p><pre>            PE1                        PE2
            +----------+             +--------------+
+--------+  | +------+ |             | +----------+ | +--------+
| VPN-A  |  | |VPN-A | |             | |  VPN-A   | | |  VPN-A |
|  CE1   |--| |PIT   | |  BGP route  | |  PIT     | |-|   CE2  |
+--------+  | |      | |&lt;-----------&gt;| |          | | +--------+
            | +------+ | Distribution| +----------+ |
            |          |             |              |
+--------+  | +------+ |             | +----------+ | +--------+
| VPN-B  |  | |VPN-B | |  --------   | |   VPN-B  | | |  VPN-B |
|  CE1   |--| |PIT   | |-(   GMPLS )-| |   PIT    | |-|   CE2  |
+--------+  | |      | | (Backbone ) | |          | | +--------+
            | +------+ |  ---------  | +----------+ |
            |          |             |              |
+--------+  | +-----+  |             | +----------+ | +--------+
| VPN-C  |  | |VPN-C|  |             | |   VPN-C  | | |  VPN-C |
|  CE1   |--| |PIT  |  |             | |   PIT    | |-|   CE2  |
+--------+  | |     |  |             | |          | | +--------+
            | +-----+  |             | +----------+ |
            +----------+             +--------------+


Рисунок 1: BGP Auto-Discovery для L1VPN</pre><p>В документе [L1VPN-FRMK] описаны два режима работы L1VPN — базовый и расширенный (enhanced). В настоящем документе рассматривается механизм автоматического детектирования только для базового режима.</p><h3>1.1. Термины</h3><p>Ключевые слова необходимо (MUST), недопустимо (MUST NOT), требуется (REQUIRED), нужно (SHALL), не следует (SHALL NOT), следует (SHOULD), не нужно (SHOULD NOT), рекомендуется (RECOMMENDED), возможно (MAY), необязательно (OPTIONAL) в данном документе интерпретируются в соответствии с [RFC2119].</p><h2>2. Процедуры</h2><p>В контексте L1VPN устройства CE подключаются к PE через один или множество портов и каждый порт может включать один или множество каналов или субканалов. Каждый порт CE, соединяющий CE с PE имеет уникальный в масштабе L1VPN идентификатор (значения идентификаторов в разных L1VPN могут перекрываться). Этот идентификатор мы будем называть CPI (Customer port identifier — идентификатор пользовательского порта). Каждый порт PE также имеет уникальный в рамках сети провайдера идентификатор. Будем обозначать эти идентификаторы PPI (Provider port identifier — идентификатор порта провайдера). Отметим, что для CPI и PPI могут использоваться адреса IPv4 или IPv6.</p><p>Для каждой L1VPN, которая имеет на PE хотя бы один сконфигурированный порт, PE поддерживает таблицу PIT, содержащую список пар &lt;CPI, PPI&gt; для всех портов в L1VPN. Отметим, что PIT может также включать маршрутную информацию (например, когда значения CPI определяются с использованием протокола маршрутизации).</p><p>Таблица PIT для данного PE включает два типа информации:</p><ul><li><p>информация, связанная с портами CE, подключенными к PE; эта информация может быть задана в локальной конфигурации PE или получена от CE;</p></li><li><p>информация, полученная от других PE с использованием механизма автоматического детектирования.</p></li></ul><p>Информацию первого типа будем называть локальной, а второго — удаленной. Распространение локальной информации другим PE осуществляется с использованием многопротокольного расширения BGP [RFC4760]. Для ограничения потока такой информации только PIT, относящимися к данной L1VPN, мы будем использовать фильтрацию маршрутов BGP на основе Route Target Extended Community [BGP-COMM], как описано ниже.</p><p>Для каждой таблицы PIT в конфигурации устройства PE задается по крайней мере одна группа Route Target, которую будем называть «export Route Targets», эта группа будет использоваться для того, чтобы помечать локальную информацию при ее экспорте в BGP провайдера. Гранулярность таких тегов может уменьшаться до уровня отдельной пары &lt;CPI, PPI&gt;. В дополнение к этому конфигурация каждой таблицы PIT в PE содержит по крайней мере одну группу Route Target, которую мы будем называть «import Route Targets», эта группа ограничивает набор маршрутов, которые могут быть импортированы из BGP провайдера в PIT, только теми маршрутами, которые входят по крайней мере в одну из групп импорта.</p><p>При добавлении провайдером порта L1VPN в конкретном устройстве PE, этот порт связывается с таблицей PIT данного PE, а таблица PIT связывается с конкретной L1VPN.</p><p>Поскольку для заполнения таблиц PIT удаленной информацией используется протокол BGP, который работает со множеством автономных систем (AS), описанный в этом документе механизм позволяет поддерживать L1VPN, распределенные между несколькими автономными системами.</p><p>Хотя L1VPN такого типа в настоящее время не рассматриваются для базового режима, определенные здесь механизмы могут быть использованы в будущем. В настоящее время может потребоваться дополнительная работа по проверке различных аспектов, включая безопасность.</p><h2>3. Передача информации L1VPN в BGP</h2><p>Отображения &lt;CPI, PPI&gt; передаются с использованием многопротокольного расширения BGP [RFC4760]. Документ [RFC4760] определяет формат двух атрибутов BGP — MP_REACH_NLRI и MP_UNREACH_NLRI, которые могут использоваться для анонсирования и отзыва анонсов информации о доступности. В этом документе добавляется идентификатор семейства адресов, названный Layer-1 VPN auto-discovery information (значение 69) и определяется новый формат NLRI (Network Layer Reachability Information — информация о доступности на сетевом уровне) для передачи CPI и PPI.</p><p>В упомянутых выше атрибутах BGP может передаваться одна или множество пар &lt;PPI, CPI&gt;.</p><p>Рисунок 2 показывает формат NLRI2:</p><pre>+---------------------------------------+
|     Length (1 octet)                  |
+---------------------------------------+
|     Auto-discovery info (variable)    |
+---------------------------------------+


Рисунок 2: Кодирование NLRI</pre><p class="note">Отметим, что представление информации механизма автоматического детектирования описано в [L1VPN-BM] и подчеркнем также, что при значении Length = 4 в поле Next Hop (атрибут MP_REACH_NLRI) значением Next Hop будет адрес IPv4, а при значении 16 Next Hop будет содержать адрес IPv6.</p><h2>4. Передача информации L1VPN Traffic Engineering в BGP</h2><p>В дополнение к информации о доступности механизм автоматического детектирования может передавать информацию Traffic Engineering, используемую для выбора исходящего пути. Например, PE может узнать возможности коммутации и максимальную полосу LSP удаленных интерфейсов L1VPN от удаленных PE. Для передачи такой информации в данном документе предлагается использовать атрибут BGP Traffic Engineering [BGP-TE-ATTRIBUTE].</p><h2>5. Масштабируемость</h2><p>Напомним, что сеть провайдера состоит из (a) устройств PE, (b) маршрутных рефлекторов BGP, (c) узлов P (которые не являются ни PE, ни Route Reflector) и, в случае VPN с использованием нескольких провайдеров, (d) граничных маршрутизаторов автономных систем ASBR (Autonomous System Border Router — граничный маршрутизатор автономной системы).</p><p>Маршрутизатор PE, если он не является маршрутным рефлектором, не сохраняет связанной с L1VPN информации, пока на не нет хотя бы одной VPN со значением import Route Target, идентичным связанной с VPN информации атрибутов Route Target. Если PE не имеет VPN с соответствующим значением import Route Target, это устройство должно отбрасывать полученную информацию L1VPN. Для отбрасывания информации должна применяться фильтрация на входе. При последующем добавлении import Route Target для одной из VPN устройства PE (операция VPN Join) устройство PE должно принимать связанную с VPN информацию, которая ранее отбрасывалась.</p><p>Для таких случаев должен использоваться механизм обновления, описанный в [BGP-RFSH]. Могут также применяться механизмы фильтрации на выходе [BGP-ORF] и [BGP-CONS] для обеспечения более динамичной фильтрации.</p><p>Аналогично, если конкретное значение import Route Target больше не присутствует в VPN какого-либо PE (в результате выполнение одной или множества операций VPN Prune), устройство PE может отбрасывать BGP-маршруты L1VPN и в результате не иметь более import Route Targets в таблицах PIT устройств PE как атрибутов Route Target.</p><p class="note">Отметим, что операции VPN Join и VPN Prune являются неразрушающими и не требуют разрыва каких-либо соединений BGP или использования механизма обновления [BGP-RFSH].</p><p>В результате использования описанных правил распространения информации ни одному устройству PE не требуется иметь всех маршрутов во все L1VPN — это важно учитывать при рассмотрении вопросов масштабирования.</p><p>Рефлекторы маршрутов могут быть разделены между VPN так, чтобы каждая группа рефлекторов передавала маршруты только для подмножества L1VPN, поддерживаемых провайдером. Таким образом ни от одного из рефлекторов не требуется поддержки связанной с VPN информации для всех VPN.</p><p>Для VPN, включающих множество провайдеров, при использовании EBGP (External BGP — внешний BGP) через несколько интервалов маршрутизации от маршрутизаторов ASBR совсем не требуется поддержка и распространение связанной с VPN информации. Маршрутизаторы P не поддерживают у себя какой-либо информации, связанной с VPN.</p><p>В результате не возникает единой точки в сети провайдера, которая поддерживала бы всю связанную с VPN информацию для всех VPN. Таким образом, возможности провайдеров в части роста числа поддерживаемых VPN не ограничиваются возможностями какого-либо из конкретных устройств.</p><p>Важно подчеркнуть что возможна поддержка неограниченного числа систем BGP используемых для передачи связанной с VPN информации. Это отличается от ситуации в Internet, где каждая система BGP должна передавать все маршруты Internet. Таким образом, одно значимое (но, возможно, трудно уловимое) различие при использовании BGP для маршрутизации Internet и для распространения связанной с VPN информации состоит в том, что в первом случае невозможно разделение на части, а во втором это реально.</p><h2>6. Вопросы безопасности</h2><p>В этом документе описан механизм автоматического детектирования на базе протокола BGP, позволяющий устройствам PE, подключенным к L1VPN, находить другие маршрутизаторы PE, подключенные к той же VPN. Каждый маршрутизатор PE, который подключен к данной VPN, использует протокол BGP для анонсирования факта подключения. Другие маршрутизаторы PE, подключенные к той же VPN, получают анонсы BGP. Это позволяет всему множеству PE автоматически находить друг друга. Отметим, что PE не всегда будет получать эти анонсы непосредственно от удаленных PE — анонсы могут приходить от «промежуточных» узлов BGP.</p><p>Критически важно, что для любого маршрутизатора PE недопустимо его «детектирование» в качестве подключенного к VPN до того, как данный PE будет реально подключен к этой VPN, что неоспоримо говорит о наличии у маршрутизатора полномочий на подключение к данной VPN. Если произвольный узел Internet может начать передачу анонсов BGP о своей принадлежности к VPN и такие анонсы будут достигать других узлов PE при условии, что эти узлы PE будут принимать такие анонсы, тогда любой желающий сможет добавить любой сайт к любой L1VPN. Таким образом, описанный здесь механизм предполагает, что конкретный маршрутизатор PE доверяет своим партнерам BGP и, более того, считает этих партнеров обеспечивающими надежную защиту своих локальных подключений (т. е., PE должен верить, что его партнеры подключены к соответствующим L1VPN и имеют на такое подключение право).</p><p>Если некий удаленный маршрутизатор PE является BGP-партнером локального PE, следует использовать процедуры аутентификации BGP [RFC2385] для того, чтобы убедиться в том, что удаленному PE можно доверять (т. е., данный PE является тем, за кого он себя выдает).</p><p>Если некий удаленный маршрутизатор PE не является BGP-партнером локального PE, тогда анонсируемая удаленным PE информация будет приходить на локальный маршрутизатор PE через цепочку узлов BGP. Локальный PE должен верить, что его партнеры воспринимают информацию только от доверенных партнеров и, таким образом, доверительные отношения должны быть транзитивными (переходящими). Протокол BGP не обеспечивает возможности удостовериться в том, что информация, полученная от узла BGP, была передана в соответствии с имеющимися полномочиями. Следовательно, описанные в этом документе процедуры должны использоваться в средах, где могут поддерживаться адекватные доверительные отношения между узлами BGP (например, использование механизма автоматического детектирования в рамках сети одного провайдера).</p><h2>7. Согласование с IANA</h2><p>В этом документе выделяется новое значение SAFI (Subsequent Address Family Identifier — дополнительный идентификатор семейства адресов), названное Layer-1 VPN auto-discovery information (см. раздел 3). Это значение включено в реестр дополнительных идентификаторов семейств адресов (SAFI) с использованием процедуры Standards Action. Новый идентификатор имеет значение 69.</p><h2>8. Литература</h2><h3>8.1. Нормативные документы</h3><table itemprop="references"><tr><td>[RFC2119]</td><td>S. Bradner, «Key words for use in RFCs to Indicate Requirement Levels», BCP 14, RFC 2119, Март 1997.</td></tr><tr><td>[RFC4760]</td><td>T. Bates, R. Chandra, D. Katz, Y. Rekhter, <a href="../4760.rfc" title="Многопротокольные расширения для BGP-4">«Multiprotocol Extensions for BGP-4», RFC 47604</a>, Январь 2007</td></tr><tr><td>[BGP-RFSH]</td><td>E. Chen, <a href="../2918.rfc" title="RFC 2918 — Возможность обновления маршрутов для BGP-4">«Возможность обновления маршрутов для BGP-4», RFC 2918</a>, Сентябрь 2000.</td></tr></table><h3>8.2. Прочие ссылки</h3><table itemprop="references"><tr><td class="nobr">[BGP-TE-ATTRIBUTE]</td><td>H. Ould-Brahim, D. Fedyk, Y. Rekhter, «Traffic Engineering Attribute», Work in Progress, Январь 2008.</td></tr><tr><td>[BGP-ORF]</td><td>E. Chen, Y. Rekhter, <a href="../5291.rfc" title="RFC 5291 - Возможность выходной фильтрации маршрутов для BGP-4">«Возможность выходной фильтрации маршрутов для BGP-4», RFC 5291</a>, Август 2008</td></tr><tr><td>[BGP-CONS]</td><td>P. Marques, R. Bonica, L. Fang, L. Martini, R. Raszuk, K. Patel, J. Guichard, «Constrained Route Distribution for Border Gateway Protocol/MultiProtocol Label Switching (BGP/MPLS) Internet Protocol (IP) Virtual Private Networks (VPNs)», RFC 4684, Ноябрь 2006.</td></tr><tr><td>[BGP-COMM]</td><td>S. Sangli, D. Tappan, Y. Rekhter, <a href="../4360.rfc" title="Атрибут BGP Extended Communities">«Атрибут BGP Extended Communities», RFC 4360</a>, Февраль 2006</td></tr><tr><td>[L1VPN-FRMK]</td><td>T. Takeda, «Framework and Requirements for Layer 1 Virtual Private Networks», RFC 4847, Апрель 2007.</td></tr><tr><td>[L1VPN-BM]</td><td>D. Fedyk, Y. Rekhter, D. Papadimitriou, R. Rabbat, L. Berger, «Layer 1 VPN Basic Mode», RFC 5251, Июль 2008.</td></tr><tr><td>[RFC2385]</td><td>A. Heffernan, «Protection of BGP Sessions via the TCP MD5 Signature Option», RFC 2385, Август 1998.</td></tr></table><h2>9. Благодарности</h2><p>Авторы выражают благодарность Adrian Farrel за полезные комментарии.</p><h2>Адреса авторов</h2><p>Hamid Ould-Brahim<br />Nortel<br />PO Box 3511 Station C<br />Ottawa ON K1Y 4H7 Canada<br />Phone: +1 (613) 763 4730<br />EMail: <bdo dir="rtl">&#109;&#111;&#99;&#46;&#108;&#101;&#116;&#114;&#111;&#110;&#64;&#109;&#105;&#104;&#97;&#114;&#98;&#104;</bdo></p><p>Yakov Rekhter<br />Juniper Networks<br />1194 N. Mathilda Avenue<br />Sunnyvale, CA 94089 USA<br />EMail: <bdo dir="rtl">&#116;&#101;&#110;&#46;&#114;&#101;&#112;&#105;&#110;&#117;&#106;&#64;&#118;&#111;&#107;&#97;&#121;</bdo></p><p>Don Fedyk<br />Nortel<br />600 Technology Park<br />Billerica, MA 01821 USA<br />Phone: +1 (978) 288 3041<br />Email: <bdo dir="rtl">&#109;&#111;&#99;&#46;&#108;&#101;&#116;&#114;&#111;&#110;&#64;&#107;&#121;&#100;&#101;&#102;&#119;&#100;</bdo></p></div></div><div id="disqus_thread"></div><script type="text/javascript">var disqus_shortname="rfc2",disqus_title="RFC 5195 - Автоматическое детектирование Layer-1 VPN на основе BGP",disqus_identifier="5195.rfc",disqus_url="http://rfc2.ru/5195.rfc";(function(){var dsq=document.createElement("script");dsq.type="text/javascript";dsq.async=true;dsq.src = "//"+disqus_shortname+".disqus.com/embed.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(dsq);})();</script><div class="bubble">2007 - 2014 © <a href="../index.html" title="Русские переводы RFC">Русские переводы RFC</a>, IETF, ISOC.</div></div><div id="bottom" style="position:static !important;bottom:auto !important"><div class="bubble"><ul><li><!--723572853672--></li></ul></div></div><!-- Yandex.Metrika counter --><script type="text/javascript">(function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter4680559 = new Ya.Metrika({id:4680559, webvisor:true, clickmap:true, accurateTrackBounce:true, trackHash:true, ut:"noindex"}); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="http://mc.yandex.ru/watch/4680559?ut=noindex" style="position:absolute; left:-9999px;" alt="" /></div></noscript><!-- /Yandex.Metrika counter --></body></html>