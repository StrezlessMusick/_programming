<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8" /><link rel="stylesheet" href="../tpl/style.css@f4e332aa" type="text/css" /><link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css' /><style type="text/css">h1,h2,h3,h4{font-family:'Open Sans',sans-serif}</style><link rel="canonical" href="../3954.rfc" /><meta name="Robots" content="noindex, nofollow" /><title>Перевод RFC 3954 — Протокол экспорта NetFlow версии 9</title><link rel="alternate" type="application/rss+xml" title="RFC2.ru - Русские Переводы RFC" href="../rss.xml"></head><body><div id="content"><div id="nav"><div class="icon i0"></div> <a href="../index.html" accesskey="`">На Главную</a></div><div id="search" class="ya-site-form ya-site-form_inited_no"><form action="http://yandex.ru/sitesearch" method="get" target="_blank"><input type="hidden" name="searchid" value="2154295"/><input type="hidden" name="l10n" value="ru"/><input type="hidden" name="reqenc" value=""/><input type="hidden" name="submit" value="Найти"/><input type="search" value="" name="text" placeholder="Поиск по RFC2.ru" /></form></div><div itemscope itemtype="http://schema.org/ScholarlyArticle"><meta itemprop="inLanguage" content="ru" /><meta itemprop="editor" content="ru" /><div id="header"><h1><a itemprop="headline" href="../3954.rfc">RFC 3954 — Протокол экспорта NetFlow версии 9</a></h1></div><dl class="mute"><dt></dt><dd><div class="icon i1"></div> RFC: 3954</dd><dd><div class="icon i3"></div> Оригинал: <a href="original" target="_blank"><span itemprop="alternativeHeadline">Cisco Systems NetFlow Services Export Version 9</span></a></dd><dd><div class="icon i2"></div> Категория: <span itemprop="articleSection">Информационный</span></dd><dd><div class="icon i4"></div> Дата публикации: <time itemprop="datePublished" datetime="2004-10-02">Октябрь 2004</time></dd><dd><div class="icon i5"></div> Авторы: <span itemprop="author">Vamsidhar Valluri</span>, <span itemprop="author">Martin Djernaes</span>, <span itemprop="author">Ganesh Sadasivan</span>, <span itemprop="author">Benoit Claise</span></dd><dd><div class="icon i6"></div> Перевод: <span itemprop="editor">Николай Малых</span></dd></dl><div id="text" itemprop="articleBody"><h3>Примечание IESG</h3><p>В этом RFC документирован протокол экспорта NetFlow версии 9 в том виде, как он был представлен IETF в качестве основы для работы IPFIX WG.</p><p>Данный RFC сам по себе не рассматривается как возможный стандарт Internet. IETF не несет ответственности за возможность использования протокола с теми или иными целями и специально отмечает, что данный протокол не рассматривался полностью IETF на предмет безопасности, контроля насыщения и некорректного взаимодействия с другими протоколами. Редактор RFC принимал решение о публикации документа по своему усмотрению.</p><h3>Тезисы</h3><p>В этом документе содержится спецификация формата экспорта данных NetFlow версии 9 компании Cisco Systems для использования в реализациях сетевых элементов и/или программах сбора данных мониторинга. Формат экспорта NetFlow версии 9 использует шаблоны для предоставления доступа к информации о потоках пакетов IP с высоким уровнем гибкости и расширяемости. Шаблон определяет набор полей с соответствующими описаниями структуры и семантики.</p><h2>Оглавление</h2><ul class="map"><li><a href="print#p1" title="Введение">1. Введение</a></li><li><a href="print#p2" title="Терминология">2. Терминология</a></li><li class="lia"><a href="print#p2.1" title="Таблица терминов">2.1. Таблица терминов</a></li><li><a href="print#p3" title="Картина NetFlow на стороне экспортера">3. Картина NetFlow на стороне экспортера</a></li><li class="lia"><a href="print#p3.1" title="Процесс NetFlow у экспортера">3.1. Процесс NetFlow у экспортера</a></li><li class="lia"><a href="print#p3.2" title="Окончание срока действия потока">3.2. Окончание срока действия потока</a></li><li class="lia"><a href="print#p3.3" title="Транспортный протокол">3.3. Транспортный протокол</a></li><li><a href="print#p4" title="Структура пакета">4. Структура пакета</a></li><li><a href="print#p5" title="Формат пакета экспорта">5. Формат пакета экспорта</a></li><li class="lia"><a href="print#p5.1" title="Формат заголовка">5.1. Формат заголовка</a></li><li class="lia"><a href="print#p5.2" title="Формат шаблона FlowSet">5.2. Формат шаблона FlowSet</a></li><li class="lia"><a href="print#p5.3" title="Формат Data FlowSet">5.3. Формат Data FlowSet</a></li><li><a href="print#p6" title="Опции">6. Опции</a></li><li class="lia"><a href="print#p6.1" title="Формат шаблона опций">6.1. Формат шаблона опций</a></li><li class="lia"><a href="print#p6.2" title="Формат данных опций">6.2. Формат данных опций</a></li><li><a href="print#p7" title="Управление шаблонами">7. Управление шаблонами</a></li><li><a href="print#p8" title="Определения типов полей">8. Определения типов полей</a></li><li><a href="print#p9" title="Коллектор">9. Коллектор</a></li><li><a href="print#p10" title="Вопросы безопасности">10. Вопросы безопасности</a></li><li class="lia"><a href="print#p10.1" title="Раскрытие данных из потока">10.1. Раскрытие данных из потока</a></li><li class="lia"><a href="print#p10.2" title="Фальшивые записи для потоков и шаблонов">10.2. Фальшивые записи для потоков и шаблонов</a></li><li class="lia"><a href="print#p10.3" title="Атаки на коллектор NetFlow">10.3. Атаки на коллектор NetFlow</a></li><li><a href="print#p11" title="Примеры">11. Примеры</a></li><li class="lia"><a href="print#p11.1" title="Пример заголовка пакета">11.1. Пример заголовка пакета</a></li><li class="lia"><a href="print#p11.2" title="Пример шаблона FlowSet">11.2. Пример шаблона FlowSet</a></li><li class="lia"><a href="print#p11.3" title="Пример Data FlowSet">11.3. Пример Data FlowSet</a></li><li class="lia"><a href="print#p11.4" title="Пример Options Template FlowSet">11.4. Пример Options Template FlowSet</a></li><li class="lia"><a href="print#p11.5" title="Пример Data FlowSet с записями Options Data">11.5. Пример Data FlowSet с записями Options Data</a></li><li><a href="print#p12" title="Литература">12. Литература</a></li><li class="lia"><a href="print#p12.1" title="Нормативные документы">12.1. Нормативные документы</a></li><li class="lia"><a href="print#p12.2" title="Дополнительная литература">12.2. Дополнительная литература</a></li><li><a href="print#p13" title="Авторы">13. Авторы</a></li><li><a href="print#p14" title="Благодарности">14. Благодарности</a></li></ul><h2 id="p1">1. Введение</h2><p>Сервис NetFlow компании Cisco Systems обеспечивает администраторам доступ к информации о потоках IP в сети передачи данных. Элементы сети (маршрутизаторы и коммутаторы) собирают данные о потоках и экспортируют их в коллекторы. Собранные данные обеспечивают точное измерение параметров использования ресурсов с хорошей детализацией и гибким выбором параметров мониторинга.</p><p>Поток данных определяется как однонаправленная последовательность пакетов с неким общим набором свойств, проходящих через сетевое устройство. Собранная информация о потоках экспортируется на внешнее устройство, называемое коллектором NetFlow. Информация о потоках включает большой набор параметров — в частности, адреса IP, счетчики пакетов и байтов, временные метки, значения ToS, номера портов приложений, входные и выходные интерфейсы и т. п.</p><p>Экспортированные данные NetFlow используются для разных целей, включая учет передачи данных в масштабе предприятия и по отдельным подразделениям, учет потоков данных в сеть ISP, использование хранилищ данных, мониторинг сети, перспективное планирование сети, мониторинг и профилирование приложений и пользователей, анализ защищенности, сбор данных для маркетинга.</p><p>В этом документе содержится спецификация протокола экспорта NetFlow версии 9. Документ рассматривает спецификацию для реализаций протокола с точки зрения как сетевых элементов, так и коллекторов NetFlow. Эта спецификация должна помочь разработчикам реализаций NetFlow v.9 для различных платформ и различных производителей, снижая риск утраты интероперабельности. Формат экспорта NetFlow версии 9 использует шаблоны для предоставления доступа к информации о потоках пакетов IP с высоким уровнем гибкости и расширяемости.</p><p>Шаблон определяет набор полей с соответствующими описаниями структуры и семантики.</p><p>Основанная на шаблонах модель обеспечивает ряд преимуществ:</p><ul class="dot"><li><p>Новые поля могут добавляться в записи NetFlow о потоках без изменения структуры формата экспорта записей. В предыдущих версиях NetFlow добавление нового поля в запись для потока приводило к необходимости создания новой версии протокола экспорта и разработки новой версии коллектора NetFlow, которая позволила бы разбирать новый формат протокола экспорта.</p></li><li><p>Шаблоны, передаваемые коллектору NetFlow, содержат структурную информацию о полях экспортируемых записей, следовательно коллектор NetFlow, не понимающий семантику новых полей, сохраняет возможность интерпретации записи о потоке.</p></li><li><p>Гибкость механизма шаблонов позволяет экспортировать из потока коллектору NetFlow только требуемые поля. Это обеспечивает снижение объема передаваемой информации и может также снижать потребности в памяти при экспорте данных и на коллекторе NetFlow. Снижение объема передаваемой информации позволяет также уменьшить нагрузку на сеть.</p></li></ul><p>Рабочая группа IETF IPFIX (IP Flow Information eXport) разрабатывает новый протокол на основе версии 9 протокола NetFlow. Новый протокол IPFIX будет обеспечивать преимущества в ряде областей (устойчивый к перегрузкам траспорт, встроенная защита и т. п.). Более подробно узнать об этом протоколе можно из материалов рабочей группы IPFIX.</p><p>Ключевые слова необходимо (MUST), недопустимо (MUST NOT), требуется (REQUIRED), нужно (SHALL), не нужно (SHALL NOT), следует (SHOULD), не следует (SHOULD NOT), рекомендуется (RECOMMENDED), возможно (MAY), необязательно (OPTIONAL) в данном документе используются для обозначения уровня требований и интерпретируются в соответствии с BCP 14, RFC 2119 [RFC2119].</p><h2 id="p2">2. Терминология</h2><p>В этом разделе приведены определения терминов, используемых в документе. Отметим, что в таблице параграфа 2.1 приведен список используемых терминов и показаны связи между ними.</p><ul><li class="b">Observation Point — точка наблюдения</li><li class="lib">Observation Point представляет собой место в сети, где можно отслеживать пакеты IP (например, один или несколько интерфейсов маршрутизатора или другого сетевого устройства). Каждая точка наблюдения связана с областью (доменом) наблюдения — Observation Domain.</li><li class="b">Observation Domain — область (домен) наблюдения</li><li class="lib">Множество точек наблюдения, обеспечивающее наибольший агрегируемый набор информации о потоках на сетевом устройстве с поддержкой NetFlow, называется областью наблюдения. Например, интерфейсный модуль маршрутизатора является областью наблюдения, в которой каждый интерфейс является точкой наблюдения.</li><li class="b">IP Flow или Flow — поток IP или поток</li><li class="lib">Поток IP (или просто поток) определяется как множество пакетов IP, проходящих через точку наблюдения в течение некоторого времени. Все пакеты конкретного потока обладают общим набором свойств, связанным с содержащимися в пакетах данными или трактовкой пакетов в точке наблюдения.</li><li class="b">Flow Record — запись о потоке</li><li class="lib">Записи о потоках обеспечивают информацию о потоках IP в точке наблюдения. В этом документе используется также термин «запись для данных о потоке» (Flow Data Record) для обозначения данных NetFlow.</li><li class="b">Exporter — экспортер</li><li class="lib">Устройство (например, маршрутизатор) со включенным сервисом NetFlow, обеспечивающее мониторинг пакетов в точке наблюдения и создание потоков из этих пакетов. Информация из созданных потоков экспортируется в форме записей о потоке коллектору NetFlow.</li><li class="b">NetFlow Collector — коллектор NetFlow</li><li class="lib">Коллектор NetFlow получает записи о потоках от одного или множества экспортеров и обрабатывает полученные пакеты экспорта, разбирая и сохраняя информацию из записей о потоках. Записи о потоках могут агрегироваться перед их записью на диск. Коллекторы NetFlow в этом документе также могут сокращенно называться коллекторами.</li><li class="b">Export Packet — пакет экспорта</li><li class="lib">Пакет экспорта представляет собой исходящий от экспортера пакет, содержащий записи о потоках от данного экспортера и адресованный коллектору NetFlow.</li><li class="b">Packet Header — заголовок пакета</li><li class="lib">Заголовок пакета представляет собой первую часть пакета экспорта. Заголовок пакета содержит базовую информацию о пакете, включая номер версии NetFlow, число записей в данном пакете и порядковый номер.</li><li class="b">Template Record — шаблон</li><li class="lib">Шаблон определяет структуру и интерпретацию полей записи данных о потоке.</li><li class="b">Flow Data Record — запись данных о потоке</li><li class="lib">Запись данных о потоке представляет собой запись, содержащую параметры пакета в соответствии с шаблоном.</li><li class="b">Options Template Record — шаблон опций</li><li class="lib">Шаблон опций определяет структуру и интерпретацию полей в записи данных опций, включая определение границ применимости записи данных опций.</li><li class="b">Options Data Record — запись данных опций</li><li class="lib">Запись, содержащая значения и информацию о границах данных в параметрах измерения потока, соответствующие шаблону записи опций.</li><li class="b">FlowSet — набор потоков</li><li class="lib">FlowSet — базовый термин для набора записей о потоках, имеющих похожую структуру. В пакетах экспорта после заголовка следует один или множество наборов FlowSet. Существует три разных типа наборов FlowSet: Template FlowSet, Options Template FlowSet и Data FlowSet.</li><li class="b">Template FlowSet — набор шаблонов</li><li class="lib">Набор из одного или множества шаблонов, сгруппированных в пакете экспорта.</li><li class="b">Options Template FlowSet — набор шаблонов опций</li><li class="lib">Набор из одной или множества записей шаблонов опций, сгруппированных в пакете экспорта.</li><li class="b">Data FlowSet — набор данных</li><li class="lib">Набор из одной или множества однотипных записей, сгруппированных в пакете экспорта. Каждая запись имеет тип Flow Data или Options Data, как определено в шаблоне или шаблоне опций.</li></ul><h3 id="p2.1">2.1. Таблица терминов</h3><table><tr class="c"><td colspan="3">Содержимое</td></tr><tr><td>FlowSet</td><td>Template Record</td><td>Data Record</td></tr><tr><td>Data FlowSet</td><td>/</td><td>Запись (записи) Flow Data или Options Data</td></tr><tr><td>Template FlowSet</td><td>Шаблон(ы)</td><td>/</td></tr><tr><td>Options Template FlowSet</td><td>Шаблон(ы) опций</td><td>/</td></tr></table><p>Набор Data FlowSet состоит из записей данных опций или данных о потоке без включения шаблона. Шаблон определяет запись данных о потоке, а шаблон опций — запись данных опции.</p><p>Набор Template FlowSet состоит из шаблонов без включения данных о потоке или опциях.</p><p>Набор Options Template FlowSet состоит из шаблонов опций без включения данных о потоке или опциях.</p><h2 id="p3">3. Картина NetFlow на стороне экспортера</h2><h3 id="p3.1">3.1. Процесс NetFlow у экспортера</h3><p>Процесс NetFlow на стороне экспортера отвечает за создание потоков (Flow) из наблюдаемых пакетов IP. Детали этого процесса выходят за рамки данного документа.</p><h3 id="p3.2">3.2. Окончание срока действия потока</h3><p>Покток считается неактивным, если в точке наблюдения в течение заданного интервала времени не было отмечено относящихся к потоку пакетов. При появлении любого пакета, относящемуся к потоку, в течение заданного интервала поток рассматривается, как активный. Поток может экспортироваться при следующих условиях:</p><ol><li><p>Экспортер может детектировать окончание потока. Например, при обнаружении в потоке TCP [RFC793] пакета с флагом FIN или RST запись о потоке экспортируется.</p></li><li><p>Поток неактивен в течение заданного времени. Значение тайм-аута следует делать настраиваемым на стороне экспортера с возможностью задания нулевого тайм-аута для немедленного завершения.</p></li><li><p>Для долгосрочных потоков экспортеру следует экспортировать записи о потоке на регулярной основе. Значение периода экспорта следует делать настраиваемым на стороне экспортера.</p></li><li><p>Если у экспортера возникают внутренние ограничения, возможно досрочное завершение (экспорт) потока. Причиной такого досрочного завершения может явиться достижение верхней ганицы счетчиков или нехватка памяти.</p></li></ol><h3 id="p3.3">3.3. Транспортный протокол</h3><p>Для обеспечения эффективной обработки на уровне экспортеров с учетом большого объема пакетов экспорта в протоколе NetFlow используется инкапсуляция этих пакетов в дейтаграммы транспортного протокола UDP [RFC768] для передачи коллектору NetFlow. Однако NetFlow версии 9 обеспечивает независимость от транспортного протокола. Следовательно, обеспечивается возможность работы на базе протоколов с контролем насыщения, таких, как SCTP [RFC2960].</p><p>Отметим, что экспортер может работать со множеством коллекторов, независимо выбирая для них транспортный протокол.</p><p>Протокол UDP [RFC768] не поддерживает контроля насыщения, поэтому при развертывании NetFlow версии 9 в чувствительной к перегрузкам среде соединение между экспортером и коллектором осуществляется по выделенному каналу. Это обеспечивает воздействие выбросов трафика NetFlow исключительно на выделенный канал без негативного влияния на работу сети. Когда коллектор NetFlow невозможно разместить в одном интервале маршрутизации (one-hop distance) от экспортера или путь между экспортером и коллектором используется не только для передачи данных мониторинга, путь экспорта данных следует строить так, чтобы на нем обеспечивалась устойчивость к максимальным пикам трафика NetFlow от экспортера. Отметим, что при использовании слишком медленного канала экспортер может входить в насыщение.</p><h2 id="p4">4. Структура пакета</h2><p>Пакет экспорта состоит из заголовка, за которым следует по крайней мере один набор данных FlowSet. В качестве FlowSet могут использоваться три типа наборов данных: шаблон (Template), данные (Data), шаблон опций (Options Template).</p><pre>+--------+-------------------------------------------+
|        | +----------+ +---------+ +----------+     |
| Packet | | Template | | Data    | | Options  |     |
| Header | | FlowSet  | | FlowSet | | Template | ... |
|        | |          | |         | | FlowSet  |     |
|        | +----------+ +---------+ +----------+     |
+--------+-------------------------------------------+

Пакет экспорта</pre><p>Идентификатор набора FlowSet ID служит для идентификации различных типов FlowSet. Значения FlowSet ID меньше 256 зарезервированы для специальных наборов типа Template FlowSet (ID 0) и Options Template FlowSet (ID 1). Для наборов Data FlowSet используется значение FlowSet ID больше 255.</p><p>Формат наборов Template, Data и Options Template обсуждается ниже. Экспортер должен использовать для всех двоичных целых чисел в заголовке и наборах FlowSet сетевой порядок байтов (его также называют big-endian).</p><p>Ниже приведено несколько примеров пакетов экспорта.</p><ol><li><p>Пакет, состоящий из чередующихся наборов Template, Data и Options Template. Примером может служить вновь созданный шаблон, который нужно экспортировать как можно скорей. Поэтому, если уже есть пакет экспорта с Data FlowSet, подготавливаемый к экспорту, в него включают наборы Template и Option Template, чередуя их с данными, как показано на рисунке с учетом доступного в пакете пространства.</p><pre>+--------+--------------------------------------------------------+
|        | +----------+ +---------+     +-----------+ +---------+ |
| Packet | | Template | | Data    |     | Options   | | Data    | |
| Header | | FlowSet  | | FlowSet | ... | Template  | | FlowSet | |
|        | |          | |         |     | FlowSet   | |         | |
|        | +----------+ +---------+     +-----------+ +---------+ |
+--------+--------------------------------------------------------+</pre></li><li><p>Пакет экспорта, включающий только наборы Data. Примером может служить пакет экспорта, создаваемый после определения шаблонов записей для передачи их коллектору NetFlow Collector; большая часть пакетов экспорта включает только наборы Data FlowSet.</p><pre>+--------+----------------------------------------------+
|        | +---------+     +---------+      +---------+ |
| Packet | | Data    | ... | Data    | ...  | Data    | |
| Header | | FlowSet | ... | FlowSet | ...  | FlowSet | |
|        | +---------+     +---------+      +---------+ |
+--------+----------------------------------------------+</pre></li><li><p>Пакет экспорта, содержащий только наборы Template и Options Template. Например, экспортер может периодически передавать пакеты, содержащие Template и Options Template, чтобы помочь обеспечить коллектору корректность записей Template и Options Template при получении соответствующих записей Flow Data.</p><pre>+--------+-------------------------------------------------+
|        | +----------+     +----------+      +----------+ |
| Packet | | Template |     | Template |      | Options  | |
| Header | | FlowSet  | ... | FlowSet  | ...  | Template | |
|        | |          |     |          |      | FlowSet  | |
|        | +----------+     +----------+      +----------+ |
+--------+-------------------------------------------------+</pre></li></ol><h2 id="p5">5. Формат пакета экспорта</h2><h3 id="p5.1">5.1. Формат заголовка</h3><p>Формат заголовка пакета показан на рисунке.</p><pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       Version Number          |            Count              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           sysUpTime                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           UNIX Secs                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Sequence Number                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        Source ID                              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre><p>Ниже приведено описание полей заголовка экспорта.</p><ul><li class="b">Version — версия</li><li class="lib">Версия формата Flow Record, экспортируемого в данном пакете. Для текущей версии значение этого поля равно 9.</li><li class="b">Count — счетчик</li><li class="lib">Общее число записей в пакете экспорта, равное сумме числа записей Options FlowSet, Template FlowSet и Data FlowSet.</li><li class="b">sysUpTime</li><li class="lib">Время, прошедшее с момента загрузки системы (в миллисекундах).</li><li class="b">UNIX Secs</li><li class="lib">Число секунд, прошедших с момента 0000 UTC 1970 до момента отправки экспортером пакета экспорта.</li><li class="b">Sequence Number — порядковый номер</li><li class="lib">Нарастающий счетчик числа пакетов экспорта, переданных экспортером из данной точки наблюдения. Это значение должно быть накопительным и колекторам следует использовать его для детектирования потерь пакетов экспорта.</li><li class="b">Source ID</li><li class="lib">32-битовое значение, идентифицирующее область наблюдения экспортера. Коллекторам NetFlow следует использовать IP-адрес отправителя в комбинации с Source ID для идентификации различных потоков экспорта от одного экспортера.</li></ul><h3 id="p5.2">5.2. Формат шаблона FlowSet</h3><p>Одним из существенных элементов NetFlow является Template FlowSet. Шаблоны существенно повышают уровень гибкости формата записей о потоках, поскольку они позволяют коллекторам обрабатывать записи о потоках даже при отсутствии возможности интерпретации всех содержащихся в записи данных. Формат Template FlowSet показан на рисунке.</p><pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       FlowSet ID = 0          |          Length               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Template ID 256          |         Field Count           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Field Type 1           |         Field Length 1        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Field Type 2           |         Field Length 2        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             ...               |              ...              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Field Type N           |         Field Length N        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Template ID 257          |         Field Count           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Field Type 1           |         Field Length 1        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Field Type 2           |         Field Length 2        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             ...               |              ...              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Field Type M           |         Field Length M        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             ...               |              ...              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Template ID K          |         Field Count           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             ...               |              ...              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre><p>Ниже приводится описание полей шаблона.</p><ul><li class="b">FlowSet ID — идентификатор набора</li><li class="lib">Для Template FlowSet зарезервировано значение FlowSet ID = 0.</li><li class="b">Length — размер</li><li class="lib">Общий размер данного набора FlowSet. Поскольку Template FlowSet может включать множество записей Template Record, для определения позиции следующей записи FlowSet, которая может иметь любой тип FlowSet, должно использоваться значение поля Length. Размер представляет собой сумму размеров полей FlowSet ID, Length, а также всех записей Template Record в данном наборе FlowSet.</li><li class="b">Template ID — идентификатор шаблона</li><li class="lib">Каждой из вновь генерируемых записей Template присваивается уникальное значение Template ID. Уникальность должна обеспечиваться в масштабе области наблюдения, генерирующей Template ID. Значения Template ID от 0 до 255 зарезервированы для наборов Template FlowSet, Options FlowSet и других зарезервированных наборов FlowSet, которые будут создаваться. Template ID для наборов Data FlowSets принимают значения от 256 до 65535.</li><li class="b">Field Count — счетчик полей</li><li class="lib">Число полей в данной записи Template. Поскольку набор Template FlowSet обычно содержит множество записей Template, значение этого поля позволяет коллектору определить завершение текущей записи Template и начало следующей.</li><li class="b">Field Type — тип поля</li><li class="lib">Числовой идентификатор типа поля. Идентификаторы описаны в параграфе «Определения типов полей».</li><li class="b">Field Length — размер поля</li><li class="lib">Размер соответствующего Field Type в байтах (см. параграф «Определения типов полей»).</li></ul><h3 id="p5.3">5.3. Формат Data FlowSet</h3><p>Формат набора Data FlowSet показан на рисунке:</p><pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   FlowSet ID = Template ID    |          Length               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Record 1 - Field Value 1    |   Record 1 - Field Value 2    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Record 1 - Field Value 3    |             ...               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Record 2 - Field Value 1    |   Record 2 - Field Value 2    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Record 2 - Field Value 3    |             ...               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Record 3 - Field Value 1    |             ...               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|              ...              |            Padding            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre><p>Ниже приведены описания полей Data FlowSet.</p><ul><li class="b">FlowSet ID = Template ID</li><li class="lib">Каждый набор Data FlowSet имеет свой идентификатор FlowSet ID. Значение FlowSet ID совпадает с созданным ранее идентификатором Template ID. Коллектор должен использовать значение FlowSet ID для нахождения соответствующей записи Template и декодирования записей о потоках из набора FlowSet.</li><li class="b">Length — размер</li><li class="lib">Размер данного набора FlowSet, определяемый суммой размеров полей FlowSet ID, Length, всех записей Flow Record в данном наборе FlowSet и байтов заполнения, если они используются.</li><li class="b">Record N — Field Value M — запись N — значение поля M</li><li class="lib">Оставшаяся часть Data FlowSet представляет собой набор записей Flow Data, каждая из которых является набором значений полей. Поля Type и Length заранее определяются в записи Template Record, указанной полем FlowSet ID или Template ID.</li><li class="b">Padding — заполнение</li><li class="lib">Экспортеру следует использовать байты заполнения для выравнивания наборов FlowSet по 4-байтовой границе. Важно отметить, что значение поля Length учитывает байты заполнения. Для заполнения следует использовать значения 0.</li></ul><p>Интерпретация формата Data FlowSet возможна только в тех случаях, когда коллектору доступен шаблон Template FlowSet, соответствующий значению Template ID.</p><h2 id="p6">6. Опции</h2><h3 id="p6.1">6.1. Формат шаблона опций</h3><p>Записи Options Template (и соответствующие записи Options Data) используются для передачи данных о конфигурации процесса NetFlow или специфических для процесса данных, а не информации о потоке IP.</p><p>Например, Options Template FlowSet может показывать частоту выборки для конкретного интерфейса и используемый метод выборки информации.</p><p>Формат набора Options Template FlowSet показан на рисунке:</p><pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       FlowSet ID = 1          |          Length               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Template ID           |      Option Scope Length      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Option Length          |       Scope 1 Field Type      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Scope 1 Field Length      |               ...             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Scope N Field Length      |      Option 1 Field Type      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Option 1 Field Length     |             ...               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Option M Field Length     |           Padding             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre><p>Ниже описаны поля Options Template FlowSet.</p><ul><li class="b">FlowSet ID = 1</li><li class="lib">Значение FlowSet ID = 1 соответствует шаблону опций (Options Template).</li><li class="b">Length — размер</li><li class="lib"><p>Общий размер данного набора FlowSet. Каждый набор шаблонов опций может включать множество записей Options Template. Следовательно, поле Length должно использоваться для определения начала следующей записи FlowSet, которая может представлять собой Template FlowSet или Data FlowSet.</p><p>Значения поля Length равно сумме размеров полей FlowSet ID и Length, а также всех записей Options Template в данном FlowSet Template ID.</p></li><li class="b">Template ID — идентификатор шаблона</li><li class="lib">Идентификатор данного шаблона опций. Значение этого поля больше 255.</li><li class="b">Option Scope Length — размер определений поля Scope</li><li class="lib">Размер (в байтах) всех определений поля Scope, содержащегося в записи Options Template (использование поля Scope рассматривается ниже).</li><li class="b">Option Length — размер опций</li><li class="lib">Размер (в байтах) всех полей определения опций, содержащихся в данной записи Options Template.</li><li class="b">Scope 1 Field Type — тип поля Scope 1</li><li class="lib"><p>Часть процесса Exporter/NetFlow, на которую указывает запись Options Template. В настоящее время определены значения:</p><ul><li>1 System — система;</li><li>2 Interface — интерфейс;</li><li>3 Line Card — линейная плата;</li><li>4 Cache — кэш;</li><li>5 Template — шаблон.</li></ul><p>Например, процесс NetFlow может быть реализован для каждого интерфейса и запись Options Template будет говорить о конфигурации интерфейса, если в качестве типа поля Scope будет указано значение 2 (интерфейс). Соответствующий идентификатор интерфейса будет в этом случае передаваться в связанном наборе Options Data. Возможна дополнительная конкретизация Scope путем указания множества типов, которым соответствует процесс. Отметим, что поля Scope всегда предшествуют полям Option.</p></li><li class="b">Scope 1 Field Length — размер поля Scope 1</li><li class="lib">Размер (в байтах) поля Scope в записи Options Data.</li><li class="b">Option 1 Field Type — тип поля Option 1</li><li class="lib">Числовой идентификатор типа поля, которое будет появляться в записи Options Template. Значения идентификаторов приведены в параграфе «Определения типов полей».</li><li class="b">Option 1 Field Length — размер поля Option 1</li><li class="lib">Размер поля Option в байтах.</li><li class="b">Padding — заполнение</li><li class="lib">Экспортеру следует использовать байты заполнения для выравнивания начала следующего набора FlowSet по 4-байтовой границе. Важно отметить, что байты заполнения учитываются в поле Length. Для заполнения следует использовать значение 0.</li></ul><h3 id="p6.2">6.2. Формат данных опций</h3><p>Записи Options Data передаются в наборах Data FlowSets регулярно, но не с каждой записью Flow Data. Частота отправки записей Options Data задается в конфигурации (см. параграф «Управление шаблонами»).</p><p>Формат набора Data FlowSet с записями Options Data показан на рисунке:</p><pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    FlowSet ID = Template ID   |          Length               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Record 1 - Scope 1 Value    |Record 1 - Option Field 1 Value|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Record 1 - Option Field 2 Value|             ...               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Record 2 - Scope 1 Value    |Record 2 - Option Field 1 Value|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Record 2 - Option Field 2 Value|             ...               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Record 3 - Scope 1 Value    |Record 3 - Option Field 1 Value|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Record 3 - Option Field 2 Value|             ...               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|              ...              |            Padding            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre><p>Ниже приводится описание полей записей Options Data в наборе Data FlowSet.</p><ul><li class="b">FlowSet ID = Template ID</li><li class="lib">Идентификатор FlowSet ID предшествует каждой группе записей Options Data в наборе Data FlowSet. Значение FlowSet ID совпадает с созданным ранее идентификатором Template ID соответствующей записи Options Template. Коллектор должен использовать FlowSet ID для отображения подходящего типа и размера значений всех последующих полей.</li><li class="b">Length (размер)</li><li class="lib">Размер данного набора FlowSet, определяемый суммой размеров полей FlowSet ID и Length, всех записей Options Data в данном наборе FlowSet и байтов заполнения, если они используются.</li><li class="b">Record N — Option Field M Value (запись N — значение поля опции M)</li><li class="lib">Оставшаяся часть Data FlowSet представляет собой набор записей о потоках, каждая из которых содержит область охвата и значения полей. Тип и размер полей определяются записью Options Template, указанной идентификатором FlowSet ID или Template ID.</li><li class="b">Padding (заполнение)</li><li class="lib">Экспортеру следует использовать байты заполнения для выравнивания начала следующего набора FlowSet по 4-байтовой границе. Важно отметить, что байты заполнения учитываются в поле Length. Для заполнения следует использовать значение 0.</li></ul><p>Формат Data FlowSet может интерпретироваться только при доступности для коллектора набора Options Template FlowSet, соответствующего идентификатору Template ID.</p><h2 id="p7">7. Управление шаблонами</h2><p>Записи Flow Data, соответствующие Template Record, могут появляться в том же или последующих пакетах. Записи Template не обязательно передавать в каждом пакете экспорта. Поэтому коллектор NetFlow должен сохранять запись Template для интерпретации соответствующих записей Flow Data, которые будут получены в последующих пакетах.</p><p>Коллектор NetFlow, получающий пакеты экспорта от одного экспортера для нескольких областей наблюдения, должен принимать во внимание отсутствие гарантии уникальности Template ID в разных областях наблюдения.</p><p>Значения Template ID должны сохраняться в течение всего срока жизни процесса NetFlow на стороне экспортера. Если экспортер или процесс NetFlow по той или иной причине запускается заново (перезагрузка), вся информация о шаблонах теряется и значения Template ID создаются заново. Таким образом, согласованность идентификаторов Template ID после рестарта экспортера или процесса NetFlow не гарантируется.</p><p>Вновь созданной записи Template экспортером присваивается неиспользуемое значение Template ID. Если конфигурация шаблона изменяется, текущее значение Template ID «закрывается» и его не следует использовать до перезапуска экспортера или процесса NetFlow. Если коллектор получает новое определение для уже существующего идентификатора Template ID, он должен отбросить предыдущее определение шаблона и использовать взамен новое.</p><p>Если настроенный на экспортере шаблон удаляется и создается вновь с такими же параметрами конфигурации, можно повторно использовать тот же идентификатор Template ID.</p><p>Экспортер передает наборы данных Template FlowSet и Options Template FlowSet в следующих случаях:</p><ol><li><p>После перезапуска процесса NetFlow экспортеру недопустимо передавать какие-либо Data FlowSet без отправки соответствующего Template FlowSet и требуемого Options Template FlowSet в предыдущем пакете экспорта или включения этих наборов в тот же пакет. Можно передавать Template FlowSet и Options Template FlowSet заранее, без каких-либо Data FlowSets для того, чтобы обеспечить гарантию наличия у коллектора корректного шаблона до получения первой записи Flow или Options Data.</p></li><li><p>В случае смены конфигурации экспортеру следует в ускоренном режиме передать новые определения шаблона. В таких случаях экспортер может передать измененные записи Template и Options Template без каких-либо данных заранее, чтобы обеспечить гарантию наличия у коллектора корректного шаблона до получения данных.</p></li><li><p>В регулярном режиме экспортер должен передать все записи Template и Options Template для обновления коллектора. Срок жизни идентификаторов Template ID на коллекторе ограничен и эти идентификаторы должны периодически обновляться. Существует два варианта обновления шаблонов на стороне коллектора:</p><ul class="dot"><li>обновление через каждые N пакетов экспорта;</li><li>обновление по времени — через каждые N минут.</li></ul><p>Обе опции должны быть настраиваемыми пользователем на стороне экспортера. При выполнении одного из условий экспортер должен передать Template FlowSet и Options Template.</p></li><li><p>При изменении конфигурации таймера на стороне экспортера последнему следует в ускоренном режиме передать определения шаблонов.</p></li></ol><h2 id="p8">8. Определения типов полей</h2><p>В приведенной ниже таблице даны определения всех полей, которые экспортер может поддерживать. Поля могут быть выборкой полей заголовков пакетов, результатами просмотра (например, номерами автономных систем или масками подсетей) и свойствами пакетов (например, размером).</p><table><tr><td>Тип поля</td><td>Код</td><td>Размер в байтах</td><td>Описание</td></tr><tr><td>IN_BYTES</td><td>1</td><td>N</td><td>Счетчик входящих данных с размерностью N x 8 битов для подсчета числа байтов, связанных с потоком IP. По умолчанию N = 4.</td></tr><tr><td>IN_PKTS</td><td>2</td><td>N</td><td>Счетчик входящих данных с размерностью N x 8 битов для подсчета числа пакетов, связанных с потоком IP. По умолчанию N = 4.</td></tr><tr><td>FLOWS</td><td>3</td><td>N</td><td>Число агрегированных потоков; по умолчанию N = 4.</td></tr><tr><td>PROTOCOL</td><td>4</td><td>1</td><td>Тип протокола IP.</td></tr><tr><td>TOS</td><td>5</td><td>1</td><td>Байт типа обслуживания, задаваемый на входном интерфейсе.</td></tr><tr><td>TCP_FLAGS</td><td>6</td><td>1</td><td>Флаги TCP; объединение всех флагов TCP, замеченных в данном потоке.</td></tr><tr><td>L4_SRC_PORT</td><td>7</td><td>2</td><td>Номер порта TCP/UDP на стороне отправителя (например, FTP, <a href="http://putty.org.ru/securecrt.html">Telnet</a> и т. п.).</td></tr><tr><td>IPV4_SRC_ADDR</td><td>8</td><td>4</td><td>Адрес IPv4 на стороне отправителя.</td></tr><tr><td>SRC_MASK</td><td>9</td><td>1</td><td>Число непрерывных битов в маске подсети на стороне отправителя (значение маски в нотации /).</td></tr><tr><td>INPUT_SNMP</td><td>10</td><td>N</td><td>Индекс входного интерфейса. По умолчанию N = 2, но могут использоваться большие значения.</td></tr><tr><td>L4_DST_PORT</td><td>11</td><td>2</td><td>Номер порта TCP/UDP на стороне получателя (например, FTP, Telnet и т. п.).</td></tr><tr><td>IPV4_DST_ADDR</td><td>12</td><td>4</td><td>Адрес IPv4 на стороне получателя.</td></tr><tr><td>DST_MASK</td><td>13</td><td>1</td><td>Число непрерывных битов в маске подсети на стороне получателя (значение маски в нотации /).</td></tr><tr><td>OUTPUT_SNMP</td><td>14</td><td>N</td><td>Индекс выходного интерфейса. По умолчанию N = 2, но могут использоваться большие значения.</td></tr><tr><td>IPV4_NEXT_HOP</td><td>15</td><td>4</td><td>Адрес IPv4 для следующего маршрутизатора.</td></tr><tr><td>SRC_AS</td><td>16</td><td>N</td><td>Номер автономной системы BGP на стороне отправителя. N может принимать значения 2 или 4. По умолчанию N = 2.</td></tr><tr><td>DST_AS</td><td>17</td><td>N</td><td>Номер автономной системы BGP на стороне получателя. N может принимать значения 2 или 4. По умолчанию N = 2.</td></tr><tr><td>BGP_IPV4_NEXT_HOP</td><td>18</td><td>4</td><td>IP-адрес следующего маршрутизатора в домене BGP.</td></tr><tr><td>MUL_DST_PKTS</td><td>19</td><td>N</td><td>Счетчик исходящих пакетов IP с групповой адресацией с размерностью N x 8 битов для учета пакетов, связанных с потоком IP. По умолчанию N = 4.</td></tr><tr><td>MUL_DST_BYTES</td><td>20</td><td>N</td><td>Счетчик исходящих октетов (байтов) с групповой адресацией с размерностью N x 8 битов для учета байтов, связанных с потоком IP. По умолчанию N = 4.</td></tr><tr><td>LAST_SWITCHED</td><td>21</td><td>4</td><td>Значение sysUptime в миллисекундах на момент коммутации последнего пакета в данном потоке.</td></tr><tr><td>FIRST_SWITCHED</td><td>22</td><td>4</td><td>Значение sysUptime в миллисекундах на момент коммутации первого пакета в данном потоке.</td></tr><tr><td>OUT_BYTES</td><td>23</td><td>N</td><td>Счетчик исходящих данных с размерностью N x 8 битов для подсчета числа байтов, связанных с потоком IP. По умолчанию N = 4.</td></tr><tr><td>OUT_PKTS</td><td>24</td><td>N</td><td>Счетчик исходящих данных с размерностью N x 8 битов для подсчета числа пакетов, связанных с потоком IP. По умолчанию N = 4.</td></tr><tr><td>IPV6_SRC_ADDR</td><td>27</td><td>16</td><td>Адрес IPv6 на стороне отправителя.</td></tr><tr><td>IPV6_DST_ADDR</td><td>28</td><td>16</td><td>Адрес IPv6 на стороне получателя.</td></tr><tr><td>IPV6_SRC_MASK</td><td>29</td><td>1</td><td>Число непрерывных битов в маске IPv6 на стороне отправителя.</td></tr><tr><td>IPV6_DST_MASK</td><td>30</td><td>1</td><td>Число непрерывных битов в маске IPv6 на стороне получателя.</td></tr><tr><td>IPV6_FLOW_LABEL</td><td>31</td><td>3</td><td>Метка потока IPv6 в соответствии с <a href="../2460.rfc" title="RFC 2460 — Спецификация IPv6">RFC 2460</a>.</td></tr><tr><td>ICMP_TYPE</td><td>32</td><td>2</td><td>Тип пакета ICM1; в отчете указывается, как ICMP Type * 256 + ICMP code.</td></tr><tr><td>MUL_IGMP_TYPE</td><td>33</td><td>1</td><td>Тип пакета IGMP.</td></tr><tr><td>SAMPLING_INTERVAL</td><td>34</td><td>4</td><td>При использовании выборки NetFlow этот параметр определяет скорость выборки; например, значение 100 показывает, что отбирается каждый сотый пакет.</td></tr><tr><td>SAMPLING_ALGORITHM</td><td>35</td><td>1</td><td>Задает на уровне платформы алгоритм выборки NetFlow: 0x01 — детерминированная выборка; 0x02 — случайная выборка. Используется вместе с SAMPLING_INTERVAL.</td></tr><tr><td>FLOW_ACTIVE_TIMEOUT</td><td>36</td><td>2</td><td>Тайм-аут (в секундах) для активных потоков в кэше NetFlow.</td></tr><tr><td>FLOW_INACTIVE_TIMEOUT</td><td>37</td><td>2</td><td>Тайм-аут (в секундах) для неактивных потоков в кэше NetFlow.</td></tr><tr><td>ENGINE_TYPE</td><td>38</td><td>1</td><td>Тип машины коммутации потоков (маршрутный процессор, интерфейсная плата и т. п.).</td></tr><tr><td>ENGINE_ID</td><td>39</td><td>1</td><td>Числовой идентификатор машины коммутации потоков.</td></tr><tr><td>TOTAL_BYTES_EXP</td><td>40</td><td>N</td><td>Счетчик с размерностью N x 8 битов для подсчета байтов, экспортированных областью наблюдения. По умолчанию N = 4.</td></tr><tr><td>TOTAL_PKTS_EXP</td><td>41</td><td>N</td><td>Счетчик с размерностью N x 8 битов для подсчета пакетов, экспортированных областью наблюдения. По умолчанию N = 4.</td></tr><tr><td>TOTAL_FLOWS_EXP</td><td>42</td><td>N</td><td>Счетчик с размерностью N x 8 битов для подсчета потоков, экспортированных областью наблюдения. По умолчанию N = 4.</td></tr><tr><td>MPLS_TOP_LABEL_TYPE</td><td>46</td><td>1</td><td>Тип метки MPLS:<br />0x00 UNKNOWN<br />0x01 TE-MIDPT<br />0x02 ATOM<br />0x03 VPN<br />0x04 BGP<br />0x05 LDP</td></tr><tr><td>MPLS_TOP_LABEL_IP_ADDR</td><td>47</td><td>4</td><td>Класс эквивалента пересылки, соответствующий метке MPLS.</td></tr><tr><td>FLOW_SAMPLER_ID</td><td>48</td><td>1</td><td>Идентификатор, показываемый в «show flow-sampler».</td></tr><tr><td>FLOW_SAMPLER_MODE</td><td>49</td><td>1</td><td>Тип алгоритма, используемого для выборки данных: 0x02 — случайная выборка. Используется вместе с FLOW_SAMPLER_RANDOM_INTERVAL</td></tr><tr><td>FLOW_SAMPLER_RANDOM_INTERVAL</td><td>50</td><td>4</td><td>Интервал выборки (в пакетах). Используется вместе с FLOW_SAMPLER_MODE</td></tr><tr><td>DST_TOS</td><td>55</td><td>1</td><td>Байт типа обслуживания, задаваемый на выходном интерфейсе.</td></tr><tr><td>SRC_MAC</td><td>56</td><td>6</td><td>MAC-адрес на стороне отправителя.</td></tr><tr><td>DST_MAC</td><td>57</td><td>6</td><td>MAC-адрес на стороне получателя.</td></tr><tr><td>SRC_VLAN</td><td>58</td><td>2</td><td>Идентификатор виртуальной ЛВС (VLAN), связанной со входным интерфейсом.</td></tr><tr><td>DST_VLAN</td><td>59</td><td>2</td><td>Идентификатор виртуальной ЛВС (VLAN), связанной с выходным интерфейсом.</td></tr><tr><td>IP_PROTOCOL_VERSION</td><td>60</td><td>1</td><td>Номер версии протокола IP (4 для IPv4, 6 для IPv6). При отсутствии в шаблоне предполагается версия 4.</td></tr><tr><td>DIRECTION</td><td>61</td><td>1</td><td>Направление потока: 0 — входной; 1 — выходной.</td></tr><tr><td>IPV6_NEXT_HOP</td><td>62</td><td>16</td><td>Адрес IPv6 для следующего маршрутизатора.</td></tr><tr><td>BGP_IPV6_NEXT_HOP</td><td>63</td><td>16</td><td>Следующий маршрутизатор в домене BGP.</td></tr><tr><td>IPV6_OPTION_HEADERS</td><td>64</td><td>4</td><td>Битовое поле, показывающее заголовки опций IPv6, обнаруженные в потоке.</td></tr><tr><td>MPLS_LABEL_1</td><td>70</td><td>3</td><td>Метка MPLS на позиции 1 в стеке.</td></tr><tr><td>MPLS_LABEL_2</td><td>71</td><td>3</td><td>Метка MPLS на позиции 2 в стеке.</td></tr><tr><td>MPLS_LABEL_3</td><td>72</td><td>3</td><td>Метка MPLS на позиции 3 в стеке.</td></tr><tr><td>MPLS_LABEL_4</td><td>73</td><td>3</td><td>Метка MPLS на позиции 4 в стеке.</td></tr><tr><td>MPLS_LABEL_5</td><td>74</td><td>3</td><td>Метка MPLS на позиции 5 в стеке.</td></tr><tr><td>MPLS_LABEL_6</td><td>75</td><td>3</td><td>Метка MPLS на позиции 6 в стеке.</td></tr><tr><td>MPLS_LABEL_7</td><td>76</td><td>3</td><td>Метка MPLS на позиции 7 в стеке.</td></tr><tr><td>MPLS_LABEL_8</td><td>77</td><td>3</td><td>Метка MPLS на позиции 8 в стеке.</td></tr><tr><td>MPLS_LABEL_9</td><td>78</td><td>3</td><td>Метка MPLS на позиции 9 в стеке.</td></tr><tr><td>MPLS_LABEL_10</td><td>79</td><td>3</td><td>Метка MPLS на позиции 10 в стеке.</td></tr></table><p>Значение поля является числовым идентификатором данного типа. Для фирменных полей зарезервированы значения: 25, 26, 43 - 45, 51 - 54 и 65 - 69.</p><p>При необходимости расширения в список будут добавляться новые типы полей. Новые типы учитываются на стороне экспортера и коллектора, но формат экспорта NetFlow при этом не меняется. Список обновлений типов полей доступен на сайте Cisco.</p><p>В некоторых случаях размер поля фиксирован по определению (например, для полей PROTOCOL и IPV4_SRC_ADDR). Однако часть типов имеет переменный размер. Это повышает эффективность использования памяти на коллекторе и снижает загрузку сети, по которой осуществляется обмен данными между экспортером и коллектором. Например, для поля IN_BYTES маршрутизатору доступа может быть достаточно 32-битового счетчика (N = 4), а магистральному маршрутизатору потребуется 64 бита (N = 8).</p><p>Все счетчики и другие числовые объекты выражаются бесзнаковыми целыми числами размерностью N * 8 битов.</p><h2 id="p9">9. Коллектор</h2><p>Коллектор получает записи Template от экспортера (обычно до получения записей Flow Data или Options Data). Записи Flow Data (или Options Data) в этом случае могут декодироваться и сохраняться на локальных устройствах. Если записи Template не были получены к моменту приема Flow Data (или Options Data), коллектору следует сохранять записи Flow Data (или Options Data) и декодировать их после приема Template. Для коллектора недопустимо предполагать, что Data FlowSet и связанный с ним Template FlowSet (или Options Template FlowSet) экспортируются в одном пакете.</p><p>Для коллектора недопустимо предполагать, что в пакете экспорта содержится один и только один набор Template FlowSet.</p><p>Срок жизни шаблона в коллекторе ограничен фиксированным тайм-аутом обновления. Срок существования шаблонов, не обновленных экспортером до тайм-аута, истекает. Для коллектора недопустимы попытки декодирования записей Flow или Options Data с истекшим сроком существования шаблона. В любой момент времени коллектору следует поддерживать для всех текущих записей Template и Options Template информацию об экспортере, области наблюдения, последнем полученном пакете экспорта, а также Template ID и определение шаблона.</p><p>Отметим, что область наблюдения идентифицируется полем Source ID из пакета экспорта.</p><p>При изменении конфигурации часов на стороне экспортера коллектору следует отбросить все записи Template и Options Template, связанные с этим экспортером, чтобы коллектор получил новый набор значений Exporter, Observation Domain, Template ID, Template Definition, Last Received.</p><p>Значение Template ID уникально для экспортера и области наблюдения.</p><p>Если коллектор получает новую запись Template (например, при перезапуске экспортера), он должен незамедлительно переписать существующую запись Template.</p><p>В заключение отметим, что коллектор должен принимать байты заполнения в наборах Data FlowSet и Options Template FlowSet, которые могут использоваться для записей Flow Data, Options Data и Template. Информация о типах записей приведена в таблице параграфа 2.1.</p><h2 id="p10">10. Вопросы безопасности</h2><p>Протокол NetFlow версии 9 был разработан в предположении, что экспортер и коллектор находятся в одной приватной сети. Однако этот протокол может использоваться для передачи записей о потоках через публичную сеть Internet, что подвергает записи Flow различным угрозам. Например, атакующий может захватывать, менять или вставлять пакеты экспорта. Следовательно, существует риск перехвата или подмены информации IP Flow в целях атаки на коллектор NetFlow.</p><p>Разработчики NetFlow версии 9 не предъявляли каких-либо требований по конфиденциальности, целостности или аутентификации, поскольку это вело бы к снижению эффективности протокола, а на момент основных работ по созданию протокола предполагалось, что экспортер и коллектор будут размещаться в одной частной сети в достаточной близости один от другого.</p><p>Протокол IPFIX, использующий NetFlow версии 9 в качестве базового протокола, снимает описанные здесь проблемы безопасности. Дополнительную информацию можно найти в проекте требований IPFIX по безопасности [RFC3917].</p><h3 id="p10.1">10.1. Раскрытие данных из потока</h3><p>Поскольку пакеты экспорта NetFlow версии 9 не шифруются, просмотр записей Flow может дать атакующему информацию об активных потоках в сети, конечных точках обмена данными и картине трафика. Эта информация может использоваться для шпионажа за пользователями и планирования будущих атак.</p><p>Информация, которую атакующий может получить при перехвате записей Flow, зависит от определения потоков. Например, запись о потоке, содержащая IP-адреса отправителя и получателя может раскрывать приватные данные о действиях конечных пользователей, тогда как запись Flow, содержащая лишь информацию о сетях отправителя и получателя, будет раскрывать меньше данных.</p><h3 id="p10.2">10.2. Фальшивые записи для потоков и шаблонов</h3><p>Если записи Flow используются в приложениях по учету трафика и/или в защитных приложениях, для атакующих может оказаться весьма привлекательной подмена таких записей (например, для обмана поставщика услуг или сокрытия атаки). Подмена записей Flow может осуществляться путем изменения записей на пути между наблюдателем и коллектором или путем вставки фальшивых записей Flow, как будто они созданы экспортером.</p><p>Атакующий может подменить шаблоны и/или шаблоны опций, чтобы таким образом попытаться ввести в заблуждение коллектор NetFlow, убеждая его в неспособности декодировать пакеты экспорта.</p><h3 id="p10.3">10.3. Атаки на коллектор NetFlow</h3><p>DoS-атаки на коллектор NetFlow могут отнимать значительные ресурсы компьютера и коллектор не сможет принять и декодировать некоторые пакеты экспорта NetFlow. Эта опасность не является специфической для NetFlow версии 9 и для снижения вредного влияния могут применяться существующие методы смягчения DoS-атак.</p><h2 id="p11">11. Примеры</h2><p>Рассмотрим пакет экспорта, включающий Template FlowSet, Data FlowSet (с тремя записями Flow Data), Options Template FlowSet и Data FlowSet (с 2 записями Options Data).</p><p>Формат пакета показан на рисунке:</p><pre>+--------+---------------------------------------------. . .
|        | +--------------+ +-----------------------+
| Packet | | Template     | | Data                  |
| Header | | FlowSet      | | FlowSet               |   . . .
|        | | (1 Template) | | (3 Flow Data Records) |
|        | +--------------+ +-----------------------+
+--------+---------------------------------------------. . .

    . . .+-------------------------------------------------+
         +------------------+ +--------------------------+ |
         | Options          | | Data                     | |
    . . .| Template FlowSet | | FlowSet                  | |
         | (1 Template)     | | (2 Options Data Records) | |
         +------------------+ +--------------------------+ |
    . . .--------------------------------------------------+</pre><h3 id="p11.1">11.1. Пример заголовка пакета</h3><p>Заголовок пакета показан на рисунке:</p><pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Version = 9               |          Count = 7            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           sysUpTime                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           UNIX Secs                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Sequence Number                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Source ID                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre><h3 id="p11.2">11.2. Пример шаблона FlowSet</h3><p>Мы хоти включить в отчет следующие типы полей:</p><ul class="dot"><li>IP-адрес отправителя (IPv4), размером 4 байта;</li><li>IP-адрес получателя (IPv4), размером 4 байта;</li><li>IP-адрес следующего маршрутизатора (IPv4), размером 4 байта;</li><li>число байтов в потоке;</li><li>число пакетов в потоке.</li></ul><p>Следовательно, набор Template FlowSet будет иметь вид:</p><pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       FlowSet ID = 0          |      Length = 28 bytes        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       Template ID 256         |       Field Count = 5         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     IP_SRC_ADDR = 8           |       Field Length = 4        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     IP_DST_ADDR = 12          |       Field Length = 4        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     IP_NEXT_HOP = 15          |       Field Length = 4        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       IN_PKTS = 2             |       Field Length = 4        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       IN_BYTES = 1            |       Field Length = 4        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre><h3 id="p11.3">11.3. Пример Data FlowSet</h3><p>В этом примере отчет включает три записи о потоках:</p><pre>Src IP addr. | Dst IP addr. | Next Hop addr. | Packet | Bytes
             |              |                | Number | Number
---------------------------------------------------------------
198.168.1.12 | 10.5.12.254  | 192.168.1.1    | 5009   | 5344385
192.168.1.27 | 10.5.12.23   | 192.168.1.1    | 748    | 388934
192.168.1.56 | 10.5.12.65   | 192.168.1.1    | 5      | 6534</pre><pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       FlowSet ID = 256        |          Length = 64          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          198.168.1.12                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          10.5.12.254                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          192.168.1.1                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                             5009                              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                            5344385                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          192.168.1.27                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           10.5.12.23                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          192.168.1.1                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              748                              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                             388934                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          192.168.1.56                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           10.5.12.65                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           192.168.1.1                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               5                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              6534                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre><p>Отметим, что заполнение в этом примере не требуется.</p><h3 id="p11.4">11.4. Пример Options Template FlowSet</h3><p>Для каждой из двух линейных плат, с которыми связан экспортер, в отчет включаются следующие типы полей:</p><ul class="dot"><li>общее число пакетов экспорта;</li><li>общее число экспортируемых потоков;</li></ul><p>Формат Options Template FlowSet показан на рисунке:</p><pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       FlowSet ID = 1          |          Length = 24          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       Template ID 257         |    Option Scope Length = 4    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       Option Length = 8       |  Scope 1 Field Type = 3       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Scope 1 Field Length = 2    |   TOTAL_EXP_PKTS_SENT = 41    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       Field Length = 2        |     TOTAL_FLOWS_EXP = 42      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       Field Length = 2        |           Padding             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre><h3 id="p11.5">11.5. Пример Data FlowSet с записями Options Data</h3><p>В этом примере отчет включает две записи.</p><pre>Line Card ID | Export Packet| Export Flow
------------------------------------------
Line Card 1  | 345          | 10201
Line Card 2  | 690          | 20402</pre><pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    FlowSet ID = 257           |         Length = 16           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             1                 |             345               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           10201               |              2                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            690                |            20402              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre><h2 id="p12">12. Литература</h2><h3 id="p12.1">12.1. Нормативные документы</h3><table itemprop="references"><tr><td>[RFC2119]</td><td>Bradner, S., «Key words for use in RFCs to Indicate Requirement Levels», BCP 14, RFC 2119, Март 1997.</td></tr></table><h3 id="p12.2">12.2. Дополнительная литература</h3><table itemprop="references"><tr><td>[RFC768]</td><td>Postel, J., <a href="../768.rfc" title="RFC 768 - Протокол UDP">«Протокол UDP», STD 6, RFC 768</a>, Август 1980</td></tr><tr><td>[RFC793]</td><td>Postel, J., <a href="../793.rfc" title="RFC 793 - Протокол TCP">«Протокол TCP», STD 7, RFC 793</a>, Сентябрь 1981</td></tr><tr><td>[RFC2960]</td><td>Stewart, R., Xie, Q., Morneault, K., Sharp, C., Schwarzbauer, H., Taylor, T., Rytina, I., Kalla, M., Zhang, L., and V. Paxson, «Stream Control Transmission Protocol», RFC 2960, Октябрь 2000.</td></tr><tr><td>[RFC3917]</td><td>Quittek, J., Zseby, T., Claise, B., and S. Zander, «Requirements for IP Flow Information Export (IPFIX)», RFC 3917, Октябрь 2004.</td></tr></table><h2 id="p13">13. Авторы</h2><p>This document was jointly written by Vamsidhar Valluri, Martin Djernaes, Ganesh Sadasivan, and Benoit Claise.</p><h2 id="p14">14. Благодарности</h2><p>I would like to thank Pritam Shah, Paul Kohler, Dmitri Bouianovski, and Stewart Bryant for their valuable technical feedback.</p><h2>Адреса авторов</h2><p>Benoit Claise (Editor)<br />Cisco Systems<br />De Kleetlaan 6a b1<br />1831 Diegem Belgium<br />Phone: +32 2 704 5622<br />EMail: <bdo dir="rtl">&#109;&#111;&#99;&#46;&#111;&#99;&#115;&#105;&#99;&#64;&#101;&#115;&#105;&#97;&#108;&#99;&#98;</bdo></p><p>Ganesh Sadasivan<br />Cisco Systems, Inc.<br />3750 Cisco Way<br />San Jose, CA 95134 USA<br />Phone: +1 408 527-0251<br />EMail: <bdo dir="rtl">&#109;&#111;&#99;&#46;&#111;&#99;&#115;&#105;&#99;&#64;&#118;&#105;&#115;&#97;&#100;&#97;&#115;&#103;</bdo></p><p>Vamsi Valluri<br />Cisco Systems, Inc.<br />510 McCarthy Blvd.<br />San Jose, CA 95035 USA<br />Phone: +1 408 525-1835<br />EMail: <bdo dir="rtl">&#109;&#111;&#99;&#46;&#111;&#99;&#115;&#105;&#99;&#64;&#105;&#114;&#117;&#108;&#108;&#97;&#118;&#118;</bdo></p><p>Martin Djernaes<br />Cisco Systems, Inc.<br />510 McCarthy Blvd.<br />San Jose, CA 95035 USA<br />Phone: +1 408 853-1676<br />EMail: <bdo dir="rtl">&#109;&#111;&#99;&#46;&#111;&#99;&#115;&#105;&#99;&#64;&#115;&#101;&#97;&#110;&#114;&#101;&#106;&#100;</bdo></p></div></div><div id="disqus_thread"></div><script type="text/javascript">var disqus_shortname="rfc2",disqus_title="RFC 3954 - Протокол экспорта NetFlow версии 9",disqus_identifier="3954.rfc",disqus_url="http://rfc2.ru/3954.rfc";(function(){var dsq=document.createElement("script");dsq.type="text/javascript";dsq.async=true;dsq.src = "//"+disqus_shortname+".disqus.com/embed.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(dsq);})();</script><div class="bubble">2007 - 2014 © <a href="../index.html" title="Русские переводы RFC">Русские переводы RFC</a>, IETF, ISOC.</div></div><div id="bottom" style="position:static !important;bottom:auto !important"><div class="bubble"><ul><li><!--723572853672--></li></ul></div></div><!-- Yandex.Metrika counter --><script type="text/javascript">(function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter4680559 = new Ya.Metrika({id:4680559, webvisor:true, clickmap:true, accurateTrackBounce:true, trackHash:true, ut:"noindex"}); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="http://mc.yandex.ru/watch/4680559?ut=noindex" style="position:absolute; left:-9999px;" alt="" /></div></noscript><!-- /Yandex.Metrika counter --></body></html>