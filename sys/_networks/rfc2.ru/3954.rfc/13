<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8" /><link rel="stylesheet" href="../tpl/style.css@f4e332aa" type="text/css" /><link rel="prev" href="12" /><link rel="next" href="14" /><link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css' /><style type="text/css">h1,h2,h3,h4{font-family:'Open Sans',sans-serif}</style><title>Перевод RFC 3954 — Протокол экспорта NetFlow версии 9, стр. 13</title><meta name="author" content="Vamsidhar Valluri, Martin Djernaes, Ganesh Sadasivan, Benoit Claise" /><link rel="alternate" type="application/rss+xml" title="RFC2.ru - Русские Переводы RFC" href="../rss.xml"></head><body><div id="content"><div id="nav"><div class="icon i0"></div> <a href="../index.html" accesskey="`">На Главную</a></div><div id="search" class="ya-site-form ya-site-form_inited_no"><form action="http://yandex.ru/sitesearch" method="get" target="_blank"><input type="hidden" name="searchid" value="2154295"/><input type="hidden" name="l10n" value="ru"/><input type="hidden" name="reqenc" value=""/><input type="hidden" name="submit" value="Найти"/><input type="search" value="" name="text" placeholder="Поиск по RFC2.ru" /></form></div><div itemscope itemtype="http://schema.org/ScholarlyArticle"><meta itemprop="inLanguage" content="ru" /><meta itemprop="editor" content="ru" /><div id="header"><h1><a itemprop="headline" href="../3954.rfc">RFC 3954 — Протокол экспорта NetFlow версии 9</a></h1></div><dl class="mute"><dt></dt><dd><div class="icon i1"></div> RFC: 3954</dd><dd><div class="icon i3"></div> Оригинал: <a href="original" target="_blank" rel="nofollow"><span itemprop="alternativeHeadline">Cisco Systems NetFlow Services Export Version 9</span></a></dd><dd><div class="icon i2"></div> Категория: <span itemprop="articleSection">Информационный</span></dd><dd><div class="icon i4"></div> Дата публикации: <time itemprop="datePublished" datetime="2004-10-02">Октябрь 2004</time></dd><dd><div class="icon i5"></div> Авторы: <span itemprop="author">Vamsidhar Valluri</span>, <span itemprop="author">Martin Djernaes</span>, <span itemprop="author">Ganesh Sadasivan</span>, <span itemprop="author">Benoit Claise</span></dd><dd><div class="icon i6"></div> Перевод: <span itemprop="editor">Николай Малых</span></dd></dl><div class="pages"><p class="r"> <h2 class="pt"><span class="z">RFC 3954,</span> Страница 13 из 18</h2></p><ul><li><noindex><a href="print" rel="nofollow">Одной Страницей</a></noindex></li><li><a accesskey="1" title="Первая страница" href="../3954.rfc" class="arr">&lArr;</a></li><li><a accesskey="2" title="На страницу назад" href="12"><b>&larr;</b></a></li><li><a class="x" href="../3954.rfc">1</a></li><li><a class="x" href="2">2</a></li><li><a class="x" href="3">3</a></li><li><a class="x" href="4">4</a></li><li><a class="x" href="5">5</a></li><li><a class="x" href="6">6</a></li><li><a class="x" href="7">7</a></li><li><a class="x" href="8">8</a></li><li><a href="9">9</a></li><li><a href="10">10</a></li><li><a href="11">11</a></li><li><a href="12">12</a></li><li class="this"><span>13</span></li><li><a href="14">14</a></li><li><a href="15">15</a></li><li><a href="16">16</a></li><li><a href="17">17</a></li><li><a class="x" href="18">18</a></li><li><a accesskey="3" title="На страницу вперед" href="14">&rarr;</a></li><li><a accesskey="4" title="Последняя страница" href="18">&rArr;</a></li></ul></div><div id="text" itemprop="articleBody"><h2 id="p8">8. Определения типов полей</h2><p>В приведенной ниже таблице даны определения всех полей, которые экспортер может поддерживать. Поля могут быть выборкой полей заголовков пакетов, результатами просмотра (например, номерами автономных систем или масками подсетей) и свойствами пакетов (например, размером).</p><table><tr><td>Тип поля</td><td>Код</td><td>Размер в байтах</td><td>Описание</td></tr><tr><td>IN_BYTES</td><td>1</td><td>N</td><td>Счетчик входящих данных с размерностью N x 8 битов для подсчета числа байтов, связанных с потоком IP. По умолчанию N = 4.</td></tr><tr><td>IN_PKTS</td><td>2</td><td>N</td><td>Счетчик входящих данных с размерностью N x 8 битов для подсчета числа пакетов, связанных с потоком IP. По умолчанию N = 4.</td></tr><tr><td>FLOWS</td><td>3</td><td>N</td><td>Число агрегированных потоков; по умолчанию N = 4.</td></tr><tr><td>PROTOCOL</td><td>4</td><td>1</td><td>Тип протокола IP.</td></tr><tr><td>TOS</td><td>5</td><td>1</td><td>Байт типа обслуживания, задаваемый на входном интерфейсе.</td></tr><tr><td>TCP_FLAGS</td><td>6</td><td>1</td><td>Флаги TCP; объединение всех флагов TCP, замеченных в данном потоке.</td></tr><tr><td>L4_SRC_PORT</td><td>7</td><td>2</td><td>Номер порта TCP/UDP на стороне отправителя (например, FTP, <a href="http://putty.org.ru/securecrt.html">Telnet</a> и т. п.).</td></tr><tr><td>IPV4_SRC_ADDR</td><td>8</td><td>4</td><td>Адрес IPv4 на стороне отправителя.</td></tr><tr><td>SRC_MASK</td><td>9</td><td>1</td><td>Число непрерывных битов в маске подсети на стороне отправителя (значение маски в нотации /).</td></tr><tr><td>INPUT_SNMP</td><td>10</td><td>N</td><td>Индекс входного интерфейса. По умолчанию N = 2, но могут использоваться большие значения.</td></tr><tr><td>L4_DST_PORT</td><td>11</td><td>2</td><td>Номер порта TCP/UDP на стороне получателя (например, FTP, Telnet и т. п.).</td></tr><tr><td>IPV4_DST_ADDR</td><td>12</td><td>4</td><td>Адрес IPv4 на стороне получателя.</td></tr><tr><td>DST_MASK</td><td>13</td><td>1</td><td>Число непрерывных битов в маске подсети на стороне получателя (значение маски в нотации /).</td></tr><tr><td>OUTPUT_SNMP</td><td>14</td><td>N</td><td>Индекс выходного интерфейса. По умолчанию N = 2, но могут использоваться большие значения.</td></tr><tr><td>IPV4_NEXT_HOP</td><td>15</td><td>4</td><td>Адрес IPv4 для следующего маршрутизатора.</td></tr><tr><td>SRC_AS</td><td>16</td><td>N</td><td>Номер автономной системы BGP на стороне отправителя. N может принимать значения 2 или 4. По умолчанию N = 2.</td></tr><tr><td>DST_AS</td><td>17</td><td>N</td><td>Номер автономной системы BGP на стороне получателя. N может принимать значения 2 или 4. По умолчанию N = 2.</td></tr><tr><td>BGP_IPV4_NEXT_HOP</td><td>18</td><td>4</td><td>IP-адрес следующего маршрутизатора в домене BGP.</td></tr><tr><td>MUL_DST_PKTS</td><td>19</td><td>N</td><td>Счетчик исходящих пакетов IP с групповой адресацией с размерностью N x 8 битов для учета пакетов, связанных с потоком IP. По умолчанию N = 4.</td></tr><tr><td>MUL_DST_BYTES</td><td>20</td><td>N</td><td>Счетчик исходящих октетов (байтов) с групповой адресацией с размерностью N x 8 битов для учета байтов, связанных с потоком IP. По умолчанию N = 4.</td></tr><tr><td>LAST_SWITCHED</td><td>21</td><td>4</td><td>Значение sysUptime в миллисекундах на момент коммутации последнего пакета в данном потоке.</td></tr><tr><td>FIRST_SWITCHED</td><td>22</td><td>4</td><td>Значение sysUptime в миллисекундах на момент коммутации первого пакета в данном потоке.</td></tr><tr><td>OUT_BYTES</td><td>23</td><td>N</td><td>Счетчик исходящих данных с размерностью N x 8 битов для подсчета числа байтов, связанных с потоком IP. По умолчанию N = 4.</td></tr><tr><td>OUT_PKTS</td><td>24</td><td>N</td><td>Счетчик исходящих данных с размерностью N x 8 битов для подсчета числа пакетов, связанных с потоком IP. По умолчанию N = 4.</td></tr><tr><td>IPV6_SRC_ADDR</td><td>27</td><td>16</td><td>Адрес IPv6 на стороне отправителя.</td></tr><tr><td>IPV6_DST_ADDR</td><td>28</td><td>16</td><td>Адрес IPv6 на стороне получателя.</td></tr><tr><td>IPV6_SRC_MASK</td><td>29</td><td>1</td><td>Число непрерывных битов в маске IPv6 на стороне отправителя.</td></tr><tr><td>IPV6_DST_MASK</td><td>30</td><td>1</td><td>Число непрерывных битов в маске IPv6 на стороне получателя.</td></tr><tr><td>IPV6_FLOW_LABEL</td><td>31</td><td>3</td><td>Метка потока IPv6 в соответствии с <a href="../2460.rfc" title="RFC 2460 — Спецификация IPv6">RFC 2460</a>.</td></tr><tr><td>ICMP_TYPE</td><td>32</td><td>2</td><td>Тип пакета ICM1; в отчете указывается, как ICMP Type * 256 + ICMP code.</td></tr><tr><td>MUL_IGMP_TYPE</td><td>33</td><td>1</td><td>Тип пакета IGMP.</td></tr><tr><td>SAMPLING_INTERVAL</td><td>34</td><td>4</td><td>При использовании выборки NetFlow этот параметр определяет скорость выборки; например, значение 100 показывает, что отбирается каждый сотый пакет.</td></tr><tr><td>SAMPLING_ALGORITHM</td><td>35</td><td>1</td><td>Задает на уровне платформы алгоритм выборки NetFlow: 0x01 — детерминированная выборка; 0x02 — случайная выборка. Используется вместе с SAMPLING_INTERVAL.</td></tr><tr><td>FLOW_ACTIVE_TIMEOUT</td><td>36</td><td>2</td><td>Тайм-аут (в секундах) для активных потоков в кэше NetFlow.</td></tr><tr><td>FLOW_INACTIVE_TIMEOUT</td><td>37</td><td>2</td><td>Тайм-аут (в секундах) для неактивных потоков в кэше NetFlow.</td></tr><tr><td>ENGINE_TYPE</td><td>38</td><td>1</td><td>Тип машины коммутации потоков (маршрутный процессор, интерфейсная плата и т. п.).</td></tr><tr><td>ENGINE_ID</td><td>39</td><td>1</td><td>Числовой идентификатор машины коммутации потоков.</td></tr><tr><td>TOTAL_BYTES_EXP</td><td>40</td><td>N</td><td>Счетчик с размерностью N x 8 битов для подсчета байтов, экспортированных областью наблюдения. По умолчанию N = 4.</td></tr><tr><td>TOTAL_PKTS_EXP</td><td>41</td><td>N</td><td>Счетчик с размерностью N x 8 битов для подсчета пакетов, экспортированных областью наблюдения. По умолчанию N = 4.</td></tr><tr><td>TOTAL_FLOWS_EXP</td><td>42</td><td>N</td><td>Счетчик с размерностью N x 8 битов для подсчета потоков, экспортированных областью наблюдения. По умолчанию N = 4.</td></tr><tr><td>MPLS_TOP_LABEL_TYPE</td><td>46</td><td>1</td><td>Тип метки MPLS:<br />0x00 UNKNOWN<br />0x01 TE-MIDPT<br />0x02 ATOM<br />0x03 VPN<br />0x04 BGP<br />0x05 LDP</td></tr><tr><td>MPLS_TOP_LABEL_IP_ADDR</td><td>47</td><td>4</td><td>Класс эквивалента пересылки, соответствующий метке MPLS.</td></tr><tr><td>FLOW_SAMPLER_ID</td><td>48</td><td>1</td><td>Идентификатор, показываемый в «show flow-sampler».</td></tr><tr><td>FLOW_SAMPLER_MODE</td><td>49</td><td>1</td><td>Тип алгоритма, используемого для выборки данных: 0x02 — случайная выборка. Используется вместе с FLOW_SAMPLER_RANDOM_INTERVAL</td></tr><tr><td>FLOW_SAMPLER_RANDOM_INTERVAL</td><td>50</td><td>4</td><td>Интервал выборки (в пакетах). Используется вместе с FLOW_SAMPLER_MODE</td></tr><tr><td>DST_TOS</td><td>55</td><td>1</td><td>Байт типа обслуживания, задаваемый на выходном интерфейсе.</td></tr><tr><td>SRC_MAC</td><td>56</td><td>6</td><td>MAC-адрес на стороне отправителя.</td></tr><tr><td>DST_MAC</td><td>57</td><td>6</td><td>MAC-адрес на стороне получателя.</td></tr><tr><td>SRC_VLAN</td><td>58</td><td>2</td><td>Идентификатор виртуальной ЛВС (VLAN), связанной со входным интерфейсом.</td></tr><tr><td>DST_VLAN</td><td>59</td><td>2</td><td>Идентификатор виртуальной ЛВС (VLAN), связанной с выходным интерфейсом.</td></tr><tr><td>IP_PROTOCOL_VERSION</td><td>60</td><td>1</td><td>Номер версии протокола IP (4 для IPv4, 6 для IPv6). При отсутствии в шаблоне предполагается версия 4.</td></tr><tr><td>DIRECTION</td><td>61</td><td>1</td><td>Направление потока: 0 — входной; 1 — выходной.</td></tr><tr><td>IPV6_NEXT_HOP</td><td>62</td><td>16</td><td>Адрес IPv6 для следующего маршрутизатора.</td></tr><tr><td>BGP_IPV6_NEXT_HOP</td><td>63</td><td>16</td><td>Следующий маршрутизатор в домене BGP.</td></tr><tr><td>IPV6_OPTION_HEADERS</td><td>64</td><td>4</td><td>Битовое поле, показывающее заголовки опций IPv6, обнаруженные в потоке.</td></tr><tr><td>MPLS_LABEL_1</td><td>70</td><td>3</td><td>Метка MPLS на позиции 1 в стеке.</td></tr><tr><td>MPLS_LABEL_2</td><td>71</td><td>3</td><td>Метка MPLS на позиции 2 в стеке.</td></tr><tr><td>MPLS_LABEL_3</td><td>72</td><td>3</td><td>Метка MPLS на позиции 3 в стеке.</td></tr><tr><td>MPLS_LABEL_4</td><td>73</td><td>3</td><td>Метка MPLS на позиции 4 в стеке.</td></tr><tr><td>MPLS_LABEL_5</td><td>74</td><td>3</td><td>Метка MPLS на позиции 5 в стеке.</td></tr><tr><td>MPLS_LABEL_6</td><td>75</td><td>3</td><td>Метка MPLS на позиции 6 в стеке.</td></tr><tr><td>MPLS_LABEL_7</td><td>76</td><td>3</td><td>Метка MPLS на позиции 7 в стеке.</td></tr><tr><td>MPLS_LABEL_8</td><td>77</td><td>3</td><td>Метка MPLS на позиции 8 в стеке.</td></tr><tr><td>MPLS_LABEL_9</td><td>78</td><td>3</td><td>Метка MPLS на позиции 9 в стеке.</td></tr><tr><td>MPLS_LABEL_10</td><td>79</td><td>3</td><td>Метка MPLS на позиции 10 в стеке.</td></tr></table><p>Значение поля является числовым идентификатором данного типа. Для фирменных полей зарезервированы значения: 25, 26, 43 - 45, 51 - 54 и 65 - 69.</p><p>При необходимости расширения в список будут добавляться новые типы полей. Новые типы учитываются на стороне экспортера и коллектора, но формат экспорта NetFlow при этом не меняется. Список обновлений типов полей доступен на сайте Cisco.</p><p>В некоторых случаях размер поля фиксирован по определению (например, для полей PROTOCOL и IPV4_SRC_ADDR). Однако часть типов имеет переменный размер. Это повышает эффективность использования памяти на коллекторе и снижает загрузку сети, по которой осуществляется обмен данными между экспортером и коллектором. Например, для поля IN_BYTES маршрутизатору доступа может быть достаточно 32-битового счетчика (N = 4), а магистральному маршрутизатору потребуется 64 бита (N = 8).</p><p>Все счетчики и другие числовые объекты выражаются бесзнаковыми целыми числами размерностью N * 8 битов.</p></div></div><noindex><div class="pages"><p class="r"> <b>Страница 13 из 18</b></p><ul><li><noindex><a href="print" rel="nofollow">Одной Страницей</a></noindex></li><li><a title="Первая страница" href="../3954.rfc" class="arr">&lArr;</a></li><li><a title="На страницу назад" href="12"><b>&larr;</b></a></li><li><a class="x" href="../3954.rfc">1</a></li><li><a class="x" href="2">2</a></li><li><a class="x" href="3">3</a></li><li><a class="x" href="4">4</a></li><li><a class="x" href="5">5</a></li><li><a class="x" href="6">6</a></li><li><a class="x" href="7">7</a></li><li><a class="x" href="8">8</a></li><li><a href="9">9</a></li><li><a href="10">10</a></li><li><a href="11">11</a></li><li><a href="12">12</a></li><li class="this"><span>13</span></li><li><a href="14">14</a></li><li><a href="15">15</a></li><li><a href="16">16</a></li><li><a href="17">17</a></li><li><a class="x" href="18">18</a></li><li><a title="На страницу вперед" href="14">&rarr;</a></li><li><a title="Последняя страница" href="18">&rArr;</a></li></ul></div></noindex><div id="disqus_thread"></div><script type="text/javascript">var disqus_shortname="rfc2",disqus_title="RFC 3954 - Протокол экспорта NetFlow версии 9",disqus_identifier="3954.rfc",disqus_url="http://rfc2.ru/3954.rfc";(function(){var dsq=document.createElement("script");dsq.type="text/javascript";dsq.async=true;dsq.src = "//"+disqus_shortname+".disqus.com/embed.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(dsq);})();</script><div class="bubble">2007 - 2014 © <a href="../index.html" title="Русские переводы RFC">Русские переводы RFC</a>, IETF, ISOC.</div></div><div id="bottom" style="position:static !important;bottom:auto !important"><div class="bubble"><ul><li><!--723572853672--></li></ul></div></div><!-- Yandex.Metrika counter --><script type="text/javascript">(function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter4680559 = new Ya.Metrika({id:4680559, webvisor:true, clickmap:true, accurateTrackBounce:true, trackHash:true}); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="http://mc.yandex.ru/watch/4680559" style="position:absolute; left:-9999px;" alt="" /></div></noscript><!-- /Yandex.Metrika counter --></body></html>